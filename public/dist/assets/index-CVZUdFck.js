import{r as t,j as e,R as Ot,F as ge,u as je,z as le,y as re,d as pe,L as Ye,c as Ee,e as Je,C as Xe,f as ya,h as wa,i as va,k as Na,l as ma,m as Ra,n as ua,o as _a,p as Ue,q as Ea,O as Ua,t as Rt,v as Et,w as Ut,x as qt,B as zt,A as Wt,D as ze,N as mt,E as Jt}from"./react-D0dwMpWz.js";import{S as k,c as et,a as Ie,b as at,o as Gt}from"./vendor-CvYCqVRQ.js";import{f as qa,a as Ne,b as za,c as Yt,d as Vt,e as Wa,g as Ht,h as Qt,j as Zt,k as Xt,l as es,m as as,n as na,o as Ve,q as ut,r as ts,s as ss,t as ns,u as Ma,v as Ba,w as ls,x as rs}from"./fontawesome-B-3jVuOV.js";import{a as is}from"./axios-t--hEgTQ.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const x of n)if(x.type==="childList")for(const b of x.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&r(b)}).observe(document,{childList:!0,subtree:!0});function l(n){const x={};return n.integrity&&(x.integrity=n.integrity),n.referrerPolicy&&(x.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?x.credentials="include":n.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function r(n){if(n.ep)return;n.ep=!0;const x=l(n);fetch(n.href,x)}})();const G="http://localhost:8000/api/",os={tambah:["admin","superadmin"],edit:["admin","superadmin"],delete:["admin","superadmin"],kelembagaan:["admin","superadmin"],akademik:["admin","superadmin"],pindah:["admin","superadmin"],keluar:["admin","superadmin"],approve:["biktren","kamtib","pengasuh"]},ds=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),_=t.useRef(""),[f,v]=t.useState(c);t.useEffect(()=>{const y=setTimeout(()=>{v(c)},400);return()=>{clearTimeout(y)}},[c]);const S=t.useCallback(async(y=!1)=>{let N=`${G}data-pokok/catatan-afektif?limit=${i}&page=${u}`;if(f&&(N+=`&nama=${encodeURIComponent(f)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(N+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(N+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(N+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(N+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&(N+=`&wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&(N+=`&blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&(N+=`&kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(N+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&(N+=`&jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&(N+=`&kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&(N+=`&rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.jenisKelamin&&(N+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.kategori&&a.kategori!==""&&(N+=`&kategori=${encodeURIComponent(a.kategori)}`),a!=null&&a.nilai&&a.nilai!==""&&(N+=`&score=${encodeURIComponent(a.nilai)}`),a!=null&&a.periode&&a.periode!==""&&(N+=`&periode=${encodeURIComponent(a.periode)}`),!y&&_.current===N){console.log("Skip duplicate request");return}_.current=N,console.log("Fetching data from:",N);try{n(!0);const T=await fetch(N);if(!T.ok)throw new Error(`HTTP ${T.status}`);const C=await T.json(),P=C.data.map(F=>({...F,waktu_pencatatan:new Date(F.waktu_pencatatan).toLocaleString("id-ID"),foto:F.foto||null,fotoPencatat:F.fotoPencatat||null}));l(P),p(C.total_data||0),h(C.total_pages||1),w(C.current_page||1)}catch(T){b(T.message),l([])}finally{n(!1)}},[u,a,i,f]);t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i,c]);const j=t.useMemo(()=>s.reduce((y,N)=>(y[N.id_santri]||(y[N.id_santri]={...N,catatan:[]}),y[N.id_santri].catatan.push(N),y),{}),[s]);return{data:s,groupedData:j,loading:r,error:x,limit:i,setLimit:m,totalData:d,totalPages:g,currentPage:u,setCurrentPage:w,searchTerm:c,setSearchTerm:o,fetchData:S}},Me="/assets/blank_profile-Ci1GeHlm.png",cs=({biodata:a})=>e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between",children:[e.jsx("div",{className:"flex flex-col space-y-1",children:[{label:"Nomor KK",value:a.nokk},{label:"NIK/No. Pasport",value:a.nik_nopassport},{label:"NIUP",value:a.niup},{label:"Nama",value:a.nama},{label:"Jenis Kelamin",value:a.jenis_kelamin==="p"?"Perempuan":"Laki-laki"},{label:"Tempat, Tgl Lahir",value:a.tempat_tanggal_lahir},{label:"Anak Ke",value:a.anak_ke},{label:"Umur",value:a.umur},{label:"Kecamatan",value:a.kecamatan},{label:"Kabupaten",value:a.kabupaten},{label:"Provinsi",value:a.provinsi},{label:"Warganegara",value:a.warganegara}].map((s,l)=>e.jsx(Ot.Fragment,{children:e.jsxs("div",{className:"flex sm:flex-row flex-col sm:space-x-3",children:[e.jsxs("p",{className:"w-40 font-semibold",children:[s.label," :"]}),e.jsx("p",{children:s.value||"-"})]})},l))}),e.jsx("img",{src:a==null?void 0:a.foto_profil,alt:"Foto Profil",className:"w-46 h-54 object-cover rounded mt-4 sm:mt-0 sm:ml-8 border border-gray-500 p-1",onError:s=>{s.target.onerror=null,s.target.src=Me}})]}),ms=a=>a===!0||a===1?e.jsx(ge,{icon:qa,className:"text-green-600"}):a===!1||a===0||a===null?"":"-",us=({keluarga:a})=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIK"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Status Keluarga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Sebagai Wali"})]})}),e.jsx("tbody",{className:"text-gray-800",children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:"Tidak ada data"})}):a.map((s,l)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:l+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.nik||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b capitalize",children:s.status||s.status_keluarga||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ms(s.wali||s.sebagai_wali||s["sebagai wali"])})]},s.id||l))})]})}),hs=({pendidikan:a})=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"No. Induk"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama Lembaga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jurusan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kelas"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Rombel"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tahun Masuk"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tahun Lulus"})]})}),e.jsx("tbody",{className:"text-gray-800",children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:"Tidak ada data"})}):a.map((s,l)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:l+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.no_induk||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.nama_lembaga||"-"}),e.jsx("td",{className:"px-3 py-2 border-b capitalize",children:s.nama_jurusan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b capitalize",children:s.nama_kelas||"-"}),e.jsx("td",{className:"px-3 py-2 border-b capitalize",children:s.nama_rombel||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.tahun_masuk||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.tahun_lul||"-"})]},s.id||l))})]})}),xs=({statusSantri:a})=>{var n,x,b,i,m;const s=[((n=a==null?void 0:a.Kewaliasuhan)==null?void 0:n.length)>0&&{id:"kewaliasuhan",label:"Kewaliasuhan",content:e.jsx("div",{className:"space-y-2",children:a==null?void 0:a.Kewaliasuhan.map((d,p)=>e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md flex items-center space-x-4 cursor-pointer",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-bold text-gray-400 border-b w-full pb-2",children:["Group Kewaliasuhan: ",d.group||"-"]}),e.jsxs("p",{className:"text-gray-600 pt-2",children:[e.jsx("strong",{children:"Sebagai: "}),d.sebagai||"-"]}),e.jsxs("p",{className:"text-gray-600",children:[e.jsx("strong",{children:"Nama Wali Asuh: "}),d["Nama Wali Asuh"]||"-"]})]})},`${d.id} - ${p}`))})},((x=a==null?void 0:a.Info_Perizinan)==null?void 0:x.length)>0&&{id:"info_perizinan",label:"Info Perizinan",content:e.jsx("div",{className:"space-y-2",children:a==null?void 0:a.Info_Perizinan.map((d,p)=>e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md cursor-pointer",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-start space-y-2 md:space-y-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:d.tanggal||"-"}),e.jsx("p",{className:"font-semibold",children:d.keterangan||"-"})]}),e.jsxs("div",{className:"text-left md:text-right",children:[e.jsx("p",{className:"text-gray-600",children:d.lama_waktu||"-"}),e.jsx("p",{className:"text-gray-600 italic",children:d.status||"-"})]})]})},`${d.id} - ${p}`))})}].filter(Boolean),[l,r]=t.useState(((b=s[0])==null?void 0:b.id)||null);return e.jsxs("div",{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIS"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Mulai"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Akhir"})]})}),e.jsx("tbody",{className:"text-gray-800",children:((i=a==null?void 0:a.Santri)==null?void 0:i.length)===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-6",children:"Tidak ada data"})}):a==null?void 0:a.Santri.map((d,p)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:p+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:d.NIS||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:d.Tanggal_Mulai||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:d.Tanggal_Akhir||"-"})]},d.id||p))})]})}),s.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("ul",{className:"flex flex-wrap text-sm font-medium text-center text-gray-500 border-b border-gray-500 mt-4",children:s.map(d=>e.jsx("li",{children:e.jsx("button",{onClick:()=>r(d.id),className:`inline-block p-3 rounded-t-lg border-b-2 ${l===d.id?"text-blue-600 border-blue-600 bg-gray-200":"border-transparent hover:text-gray-600 hover:bg-gray-50"}`,children:d.label})},d.id))}),e.jsx("div",{className:"pt-4",children:(m=s.find(d=>d.id===l))==null?void 0:m.content})]})]})},gs=({domisili:a})=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kamar"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Blok"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Wilayah"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Ditempati"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Pindah"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Status"})]})}),e.jsx("tbody",{className:"text-gray-800",children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-6",children:"Tidak ada data"})}):a.map((s,l)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:l+1}),e.jsx("td",{className:"px-3 py-2 border-b capitalize",children:s.kamar||"-"}),e.jsx("td",{className:"px-3 py-2 border-b capitalize",children:s.blok||"-"}),e.jsx("td",{className:"px-3 py-2 border-b capitalize",children:s.wilayah||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.tanggal_ditempati||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.tanggal_pindah||"-"}),e.jsx("td",{className:"px-3 py-2 border-b capitalize",children:s.status||"-"})]},s.id||l))})]})}),ps=({kunjunganMahrom:a})=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal"})]})}),e.jsx("tbody",{className:"text-gray-800",children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center py-6",children:"Tidak ada data"})}):a.map((s,l)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:l+1}),e.jsxs("td",{className:"px-3 py-2 border-b capitalize",children:[e.jsx("span",{className:"font-semibold",children:s.nama_pengunjung||"-"}),s.status?e.jsxs("span",{className:"text-gray-500",children:[" (",s.status,")"]}):""]}),e.jsx("td",{className:"px-3 py-2 border-b capitalize",children:s.tanggal_kunjungan||"-"})]},s.id||l))})]})}),bs=({catatanProgress:a})=>{var n,x,b,i,m,d,p,g,h,c,o,u,w,_,f,v,S,j,y,N,T,C;const s=[(a==null?void 0:a.Afektif)&&((n=Object.keys(a==null?void 0:a.Afektif))==null?void 0:n.length)>0&&{id:"afektif",label:"Afektif",content:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Aspek"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Nilai"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Tindak Lanjut"})]})}),e.jsxs("tbody",{className:"text-gray-800",children:[e.jsxs("tr",{className:"hover:bg-gray-50 text-left",children:[e.jsx("td",{className:"px-4 py-2 border-b",children:"1"}),e.jsx("td",{className:"px-4 py-2 border-b",children:"Kebersihan"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((x=a==null?void 0:a.Afektif)==null?void 0:x.kebersihan)||"-"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((b=a==null?void 0:a.Afektif)==null?void 0:b.tindak_lanjut_kebersihan)||"-"})]}),e.jsxs("tr",{className:"hover:bg-gray-50 text-left",children:[e.jsx("td",{className:"px-4 py-2 border-b",children:"2"}),e.jsx("td",{className:"px-4 py-2 border-b",children:"Kepedulian"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((i=a==null?void 0:a.Afektif)==null?void 0:i.kepedulian)||"-"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((m=a==null?void 0:a.Afektif)==null?void 0:m.tindak_lanjut_kepedulian)||"-"})]}),e.jsxs("tr",{className:"hover:bg-gray-50 text-left",children:[e.jsx("td",{className:"px-4 py-2 border-b",children:"3"}),e.jsx("td",{className:"px-4 py-2 border-b",children:"Akhlak"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((d=a==null?void 0:a.Afektif)==null?void 0:d.akhlak)||"-"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((p=a==null?void 0:a.Afektif)==null?void 0:p.tindak_lanjut_akhlak)||"-"})]})]})]})})},(a==null?void 0:a.Kognitif)&&((g=Object.keys(a==null?void 0:a.Kognitif))==null?void 0:g.length)>0&&{id:"kognitif",label:"Kognitif",content:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Aspek"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Nilai"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Tindak Lanjut"})]})}),e.jsxs("tbody",{className:"text-gray-800",children:[e.jsxs("tr",{className:"hover:bg-gray-50 text-left",children:[e.jsx("td",{className:"px-4 py-2 border-b",children:"1"}),e.jsx("td",{className:"px-4 py-2 border-b",children:"Kebahasaan"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((h=a==null?void 0:a.Kognitif)==null?void 0:h.kebahasaan)||"-"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((c=a==null?void 0:a.Kognitif)==null?void 0:c.tindak_lanjut_kebahasaan)||"-"})]}),e.jsxs("tr",{className:"hover:bg-gray-50 text-left",children:[e.jsx("td",{className:"px-4 py-2 border-b",children:"2"}),e.jsx("td",{className:"px-4 py-2 border-b",children:"Baca Kitab Kuning"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((o=a==null?void 0:a.Kognitif)==null?void 0:o.baca_kitab_kuning)||"-"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((u=a==null?void 0:a.Kognitif)==null?void 0:u.tindak_lanjut_baca_kitab_kuning)||"-"})]}),e.jsxs("tr",{className:"hover:bg-gray-50 text-left",children:[e.jsx("td",{className:"px-4 py-2 border-b",children:"3"}),e.jsx("td",{className:"px-4 py-2 border-b",children:"Hafalan Tahfidz"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((w=a==null?void 0:a.Kognitif)==null?void 0:w.hafalan_tahfidz)||"-"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((_=a==null?void 0:a.Kognitif)==null?void 0:_.tindak_lanjut_hafalan_tahfidz)||"-"})]}),e.jsxs("tr",{className:"hover:bg-gray-50 text-left",children:[e.jsx("td",{className:"px-4 py-2 border-b",children:"4"}),e.jsx("td",{className:"px-4 py-2 border-b",children:"Furudul Ainiyah"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((f=a==null?void 0:a.Kognitif)==null?void 0:f.furudul_ainiyah)||"-"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((v=a==null?void 0:a.Kognitif)==null?void 0:v.tindak_lanjut_furudul_ainiyah)||"-"})]}),e.jsxs("tr",{className:"hover:bg-gray-50 text-left",children:[e.jsx("td",{className:"px-4 py-2 border-b",children:"5"}),e.jsx("td",{className:"px-4 py-2 border-b",children:"Tulis Al-Quran"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((S=a==null?void 0:a.Kognitif)==null?void 0:S.tulis_alquran)||"-"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((j=a==null?void 0:a.Kognitif)==null?void 0:j.tindak_lanjut_tulis_alquran)||"-"})]}),e.jsxs("tr",{className:"hover:bg-gray-50 text-left",children:[e.jsx("td",{className:"px-4 py-2 border-b",children:"6"}),e.jsx("td",{className:"px-4 py-2 border-b",children:"Baca Al-Quran"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((y=a==null?void 0:a.Kognitif)==null?void 0:y.baca_alquran)||"-"}),e.jsx("td",{className:"px-4 py-2 border-b",children:((N=a==null?void 0:a.Kognitif)==null?void 0:N.tindak_lanjut_baca_alquran)||"-"})]})]})]})})}].filter(Boolean),[l,r]=t.useState(((T=s[0])==null?void 0:T.id)||null);return e.jsx("div",{children:s.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("ul",{className:"flex flex-wrap text-sm font-medium text-center text-gray-500 border-b border-gray-500 mt-4",children:s.map(P=>e.jsx("li",{children:e.jsx("button",{onClick:()=>r(P.id),className:`inline-block p-3 rounded-t-lg border-b-2 ${l===P.id?"text-blue-600 border-blue-600 bg-gray-200":"border-transparent hover:text-gray-600 hover:bg-gray-50"}`,children:P.label})},P.id))}),e.jsx("div",{className:"pt-4",children:(C=s.find(P=>P.id===l))==null?void 0:C.content})]})})},js=({khadam:a})=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Deskripsi"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Mulai"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Akhir"})]})}),e.jsx("tbody",{className:"text-gray-800",children:(a==null?void 0:a.length)===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-6",children:"Tidak ada data"})}):a==null?void 0:a.map((s,l)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:l+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.keterangan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.tanggal_mulai||"-"}),e.jsx("td",{className:"px-3 py-2 border-b capitalize",children:s.tanggal_akhir||"-"})]},l+1))})]})}),ks=({pengurus:a})=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jabatan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Mulai"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Akhir"})]})}),e.jsx("tbody",{className:"text-gray-800",children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-6",children:"Tidak ada data"})}):a.map((s,l)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:l+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.keterangan_jabatan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.tanggal_mulai||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.tanggal_akhir||"-"})]},s.id||l))})]})}),fs=({karyawan:a})=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Lembaga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jabatan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Mulai"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Akhir"})]})}),e.jsx("tbody",{className:"text-gray-800",children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:"Tidak ada data"})}):a.map((s,l)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:l+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.lembaga||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.keterangan_jabatan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.tanggal_mulai||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.tanggal_selesai||"-"})]},s.id||l))})]})}),ys=({waliKelas:a})=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Lembaga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jurusan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kelas"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Rombel"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Periode Awal"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Periode Akhir"})]})}),e.jsx("tbody",{className:"text-gray-800",children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:"Tidak ada data"})}):a.map((s,l)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:l+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.Lembaga||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.Jurusan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.Kelas||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.Rombel||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.Periode_awal||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.Periode_akhir||"-"})]},s.id||l))})]})}),ws=({pengajar:a})=>{var s,l,r,n,x,b,i,m,d,p,g,h,c,o;return e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-lg mb-2",children:"Pangkalan Lembaga"}),e.jsxs("div",{className:"pl-2 border-l-2 border-gray-400 mb-6",children:[e.jsx("p",{className:"font-bold text-md text-gray-600",children:(l=(s=a==null?void 0:a.Pangkalan)==null?void 0:s[0])==null?void 0:l.lembaga}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"capitalize",children:(n=(r=a==null?void 0:a.Pangkalan)==null?void 0:r[0])==null?void 0:n.pekerjaan_kontrak})," | ",(b=(x=a==null?void 0:a.Pangkalan)==null?void 0:x[0])==null?void 0:b.kategori_golongan," | ",(m=(i=a==null?void 0:a.Pangkalan)==null?void 0:i[0])==null?void 0:m.nama_golongan]}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"flex text-gray-600",children:[e.jsx("span",{className:"w-10",children:"Sejak"}),e.jsxs("span",{children:[": ",(p=(d=a==null?void 0:a.Pangkalan)==null?void 0:d[0])==null?void 0:p.sejak]})]}),e.jsxs("div",{className:"flex text-gray-600",children:[e.jsx("span",{className:"w-19",children:"Masa Kerja"}),e.jsxs("span",{children:[": ",(h=(g=a==null?void 0:a.Pangkalan)==null?void 0:g[0])==null?void 0:h.masa_kerja]})]})]})]}),e.jsx("h1",{className:"text-lg font-bold mb-2",children:"Materi Ajar"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Lembaga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Materi"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Mulai"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Akhir"})]})}),e.jsx("tbody",{className:"text-gray-800",children:((c=a==null?void 0:a.Materi_Ajar)==null?void 0:c.length)===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-6",children:"Tidak ada data"})}):(o=a==null?void 0:a.Materi_Ajar)==null?void 0:o.map((u,w)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:w+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:u.lembaga||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:u.daftar_materi||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:u.tanggal_mulai||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:u.tanggal_akhir||"-"})]},u.id||w))})]})})]})},vs=({waliAsuh:a})=>(console.log(a),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Mulai"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Akhir"})]})}),e.jsx("tbody",{className:"text-gray-800",children:(a==null?void 0:a.length)===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:"Tidak ada data"})}):a==null?void 0:a.map((s,l)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:l+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.tanggal_mulai||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:s.tanggal_akhir||"-"})]},s.id||l))})]})})),Ns=a=>{const l=Date.now()+6048e5,r=new Date,n=new Date;n.setDate(r.getDate()+8),n.setHours(0,0,0,0);const x=n.toUTCString();document.cookie=`token=${a}; expires=${x}; path=/`,document.cookie=`expiredAt=${l}; expires=${x}; path=/`},xe=a=>{const s=document.cookie.split(";");for(const l of s){const[r,n]=l.trim().split("=");if(r===a)return n}return null},ht=()=>{document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/",document.cookie="expiredAt=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC"},ke=()=>{const[a,s]=t.useState(!1),[l,r]=t.useState(null),n=()=>{ht(),localStorage.clear(),sessionStorage.clear()},x=je();return{logout:t.useCallback(async()=>{const i=`${G}logout`,m=sessionStorage.getItem("token")||xe("token");if(!m){r("Token tidak ditemukan");return}s(!0),r(null);try{const d=await fetch(i,{method:"POST",headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json"}});if(d.status===401)throw n(),x("/login"),new Error("Unauthorized. Logging out.");if(!d.ok){let p="Logout gagal";try{p=(await d.json()).message||p}catch(g){console.log(g)}throw new Error(p)}if(d.status!==204){const p=await d.json();console.log("Logout berhasil:",p)}else console.log("Logout berhasil (204 No Content)");n()}catch(d){throw console.error("Logout error:",d),r(d.message),d}finally{s(!1)}},[]),clearAuthData:n,isLoggingOut:a,logoutError:l}},Sa=()=>{const[a,s]=t.useState([]);return t.useEffect(()=>{const l=sessionStorage.getItem("menuSantri");if(l)try{const r=JSON.parse(l);s(r)}catch(r){console.error("Gagal parsing data dari sessionStorage:",r),sessionStorage.removeItem("menuSantri")}else console.log("Mengambil data dari API..."),fetch(`${G}data-pokok/santri`).then(r=>r.json()).then(r=>{console.log("Meta response:",r);const n=r.total_data;if(!n||isNaN(n))throw new Error("Gagal mendapatkan total_data");return fetch(`${G}data-pokok/santri?limit=${n}`)}).then(r=>r.json()).then(r=>{if(Array.isArray(r.data)){const n=[{label:"Pilih Santri",value:"",id:null},...r.data.map(x=>({bio_id:x.biodata_id,id:x.id,value:x.nama,label:x.nama,nis:x.nis||"-",niup:x.niup||"-",lembaga:x.lembaga||"-",wilayah:x.wilayah||"-",kamar:x.kamar||"-",blok:x.blok||"-",angkatan:x.angkatan||"-",kota_asal:x.kota_asal||"-",foto_profil:x.foto_profil||"-"}))];console.log("Final formatted data:",n),console.log("Jumlah data santri:",n.length-1),sessionStorage.setItem("menuSantri",JSON.stringify(n)),s(n)}else throw new Error("Data tidak valid dari API")}).catch(r=>{console.error("Gagal mengambil data santri:",r),s([{label:"Pilih Santri",value:"",id:null}])})},[]),{menuSantri:a}},ha=({isOpen:a,onClose:s,onSantriSelected:l})=>{const[r,n]=t.useState(""),{menuSantri:x}=Sa(),b=x.filter(i=>{var m;return i.value.toLowerCase().includes(r.toLowerCase())||((m=i.nis)==null?void 0:m.toString().includes(r))});return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"relative z-50",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"w-full max-w-4xl transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl",children:[e.jsx(re.Title,{className:"text-lg font-medium text-gray-900 mb-4 text-center",children:"Pilih Santri"}),e.jsx("input",{type:"text",placeholder:"Cari nama atau NIS...",className:"w-full p-2 border rounded mb-4",value:r,onChange:i=>n(i.target.value)}),e.jsx("div",{className:"overflow-x-auto max-h-[400px] overflow-y-auto rounded",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2",children:"NIS"}),e.jsx("th",{className:"p-2",children:"Nama"}),e.jsx("th",{className:"p-2",children:"Lembaga"}),e.jsx("th",{className:"p-2",children:"Wilayah"}),e.jsx("th",{className:"p-2",children:"Kamar"})]})}),e.jsx("tbody",{children:b.filter(i=>i.id!==null).map((i,m)=>e.jsxs("tr",{className:"hover:bg-blue-50 cursor-pointer",onClick:()=>{l(i),s()},children:[e.jsx("td",{className:"p-2",children:i.nis}),e.jsx("td",{className:"p-2",children:i.label}),e.jsx("td",{className:"p-2",children:i.lembaga}),e.jsx("td",{className:"p-2",children:i.wilayah}),e.jsx("td",{className:"p-2",children:i.kamar})]},m))})]})})]})})})})]})})},_s=({isOpen:a,onClose:s,refetchData:l,feature:r,id:n,nama:x})=>{const{menuSantri:b}=Sa(),{clearAuthData:i}=ke(),m=je(),[d,p]=t.useState(""),[g,h]=t.useState(!1),[c,o]=t.useState({pengasuh_id:"",biktren_id:"",kamtib_id:"",pengantar_id:"",alasan_izin:"",alamat_tujuan:"",tanggal_mulai:"",tanggal_akhir:"",tanggal_kembali:"",jenis_izin:"",status:"",keterangan:""});t.useEffect(()=>{if(a&&r===1&&(p(null),o({pengasuh_id:"",biktren_id:"",kamtib_id:"",pengantar_id:"",alasan_izin:"",alamat_tujuan:"",tanggal_mulai:"",tanggal_akhir:"",tanggal_kembali:"",jenis_izin:"",status:"sedang proses izin",keterangan:""})),a&&r===2&&x&&b.length>0){const w=b.find(_=>_.label===x);w&&p(w)}},[a,r,x,b]),t.useEffect(()=>{const w=async()=>{try{const _=sessionStorage.getItem("token")||xe("token"),f=await fetch(`${G}crud/${n}/perizinan/show`,{headers:{Authorization:`Bearer ${_}`}});if(!f.ok)throw new Error("Gagal mengambil data");const v=await f.json();v.data&&o({pengasuh_id:v.data.pengasuh_id??"",biktren_id:v.data.biktren_id??"",kamtib_id:v.data.kamtib_id??"",pengantar_id:v.data.pengantar_id??"",alasan_izin:v.data.alasan_izin??"",alamat_tujuan:v.data.alamat_tujuan??"",tanggal_mulai:v.data.tanggal_mulai??"",tanggal_akhir:v.data.tanggal_akhir??"",tanggal_kembali:v.data.tanggal_kembali??"",jenis_izin:v.data.jenis_izin??"",status:v.data.status??"",keterangan:v.data.keterangan??""})}catch(_){console.error("Gagal mengambil data perizinan:",_),k.fire("Error","Gagal mengambil data perizinan","error")}};a&&r===2&&(o({pengasuh_id:"",biktren_id:"",kamtib_id:"",pengantar_id:"",alasan_izin:"",alamat_tujuan:"",tanggal_mulai:"",tanggal_akhir:"",tanggal_kembali:"",jenis_izin:"",status:"",keterangan:""}),w())},[r,n,a]);const u=async w=>{w.preventDefault();const _=r==1,f=_?"POST":"PUT",v=_?d.bio_id:n;if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),console.log(d.bio_id),console.log("Payload yang dikirim ke API:",JSON.stringify(c,null,2));const j=sessionStorage.getItem("token")||xe("token"),y=await fetch(`${G}crud/${v}/perizinan`,{method:f,headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`},body:JSON.stringify(c)});if(console.log("Response dari API:",y),k.close(),!y)throw new Error("Tidak ada response dari server.");if(y.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),i(),m("/login");return}const N=await y.json();if(console.log(N),!("data"in N)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${N.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),l==null||l(!0),s==null||s()}catch(j){console.error("Terjadi kesalahan:",j),await k.fire({icon:"error",title:"Oops!",text:`Terjadi kesalahan saat mengirim data. ${j}`})}};return e.jsxs(le,{appear:!0,show:a,as:t.Fragment,children:[e.jsxs(re,{as:"div",className:"fixed inset-0 z-50",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"w-full max-w-3xl bg-white rounded-lg shadow-xl relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mt-6",children:r==1?"Tambah Data Baru":"Edit Data"}),e.jsxs("form",{className:"w-full",onSubmit:u,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4 overflow-y-auto max-h-[70vh]",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[r===1&&e.jsx("div",{className:`mb-4 flex ${d?"justify-end":"justify-center"}`,children:e.jsxs("div",{className:"flex-1 flex justify-between items-center max-w-2xl mx-auto",children:[!d&&e.jsx("h2",{className:"text-lg font-semibold absolute left-1/2 transform -translate-x-1/2",children:"Pilih Data Santri Terlebih Dahulu"}),e.jsx("div",{className:`ml-auto ${d?"":"relative"}`,children:e.jsx("button",{type:"button",onClick:()=>h(!0),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:d?"Ganti Santri":"Pilih Santri"})})]})}),d&&e.jsx(Ts,{santri:d}),(d||r===2)&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"alasan_izin",className:"block text-gray-700",children:"Alasan Izin *"}),e.jsx("textarea",{name:"alasan_izin",onChange:w=>o({...c,alasan_izin:w.target.value}),value:c.alasan_izin,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"alamat_tujuan",className:"block text-gray-700",children:"Alamat Tujuan *"}),e.jsx("textarea",{name:"alamat_tujuan",onChange:w=>o({...c,alamat_tujuan:w.target.value}),value:c.alamat_tujuan,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_mulai",className:"block text-gray-700",children:"Tanggal Mulai *"}),e.jsx("input",{type:"datetime-local",id:"tanggal_mulai",name:"tanggal_mulai",value:c.tanggal_mulai,onChange:w=>o({...c,tanggal_mulai:w.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_akhir",className:"block text-gray-700",children:"Tanggal Akhir *"}),e.jsx("input",{type:"datetime-local",id:"tanggal_akhir",name:"tanggal_akhir",value:c.tanggal_akhir,onChange:w=>o({...c,tanggal_akhir:w.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),r==2&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_kembali",className:"block text-gray-700",children:"Tanggal Kembali *"}),e.jsx("input",{type:"datetime-local",id:"tanggal_kembali",name:"tanggal_kembali",value:c.tanggal_kembali,onChange:w=>o({...c,tanggal_kembali:w.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"jenis_izin",className:"block text-gray-700",children:"Jenis Izin *"}),e.jsxs("select",{className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",onChange:w=>o({...c,jenis_izin:w.target.value}),value:c.jenis_izin,required:!0,children:[e.jsx("option",{value:"",children:"Pilih Jenis Izin"}),e.jsx("option",{value:"Personal",children:"Personal"}),e.jsx("option",{value:"Rombongan",children:"Rombongan"})]})]}),r==2&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-gray-700",children:"Status *"}),e.jsxs("select",{className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",onChange:w=>o({...c,status:w.target.value}),value:c.status,required:!0,children:[e.jsx("option",{value:"",children:"Pilih Status"}),e.jsx("option",{value:"sedang proses izin",children:"Sedang proses izin"}),e.jsx("option",{value:"perizinan diterima",children:"Perizinan diterima"}),e.jsx("option",{value:"sudah berada diluar pondok",children:"Sudah berada diluar pondok"}),e.jsx("option",{value:"perizinan ditolak",children:"Perizinan ditolak"}),e.jsx("option",{value:"dibatalkan",children:"Dibatalkan"}),e.jsx("option",{value:"telat(sudah kembali)",children:"Telat(sudah kembali)"}),e.jsx("option",{value:"telat(belum kembali)",children:"Telat(belum kembali)"}),e.jsx("option",{value:"kembali tepat waktu",children:"Kembali tepat waktu"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"keterangan",className:"block text-gray-700",children:"Keterangan *"}),e.jsx("textarea",{name:"keterangan",onChange:w=>o({...c,keterangan:w.target.value}),value:c.keterangan,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]})]})]})})}),e.jsxs("div",{className:"bg-gray-100 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse rounded-b-lg",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm cursor-pointer",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]}),e.jsx(ha,{isOpen:g,onClose:()=>h(!1),onSantriSelected:w=>p(w)})]})},Ss=({isOpen:a,onClose:s,id:l,close:r})=>{var p;const{clearAuthData:n}=ke(),x=je(),[b,i]=t.useState(null),m=g=>{const h=g.target.files[0];if(h){if(!["application/pdf","image/jpeg","image/jpg","image/png"].includes(h.type)){alert("Format file harus PDF, JPG, JPEG, atau PNG");return}if(h.size>2*1024*1024){alert("Ukuran file maksimal 2MB");return}i(h)}},d=async g=>{if(g.preventDefault(),!b){alert("File wajib diunggah");return}if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const c=sessionStorage.getItem("token")||xe("token"),o=new FormData;o.append("file_path",b);const u=await fetch(`${G}crud/${l}/berkas-perizinan`,{method:"POST",headers:{Authorization:`Bearer ${c}`},body:o});if(k.close(),!u)throw new Error("Tidak ada response dari server.");if(u.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}const w=await u.json();if(!u.ok)throw new Error(w.message||"Terjadi kesalahan pada server.");if(!("data"in w)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${w.message}</div>`});return}console.log(w),await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),s==null||s(),r==null||r()}catch(c){console.error("Terjadi kesalahan:",c),await k.fire({icon:"error",title:"Oops!",text:`Terjadi kesalahan saat mengirim data. ${c.message}`})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"w-full max-w-lg bg-white rounded-lg shadow-xl relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mt-6",children:"Tambah Berkas Perizinan"}),e.jsxs("form",{className:"w-full",onSubmit:d,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4 overflow-y-auto max-h-[70vh]",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsx("div",{className:"mt-2 sm:mt-0 text-left w-full",children:e.jsx("div",{className:"p-2 rounded-xl border border-gray-300 bg-white",children:e.jsxs("label",{htmlFor:"file_path",className:`relative flex flex-col items-center justify-center w-full aspect-[4/3] min-h-[150px] cursor-pointer ${b?"":"bg-gray-50 hover:bg-gray-100 border-2 border-gray-300 border-dashed rounded-lg"}`,children:[b?typeof b=="object"&&((p=b.type)!=null&&p.startsWith("image"))?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:URL.createObjectURL(b),alt:"preview",className:"h-full object-contain w-full"}),e.jsx("button",{type:"button",onClick:()=>i(null),className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded hover:bg-red-600",children:"×"})]}):typeof b=="string"?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:b,alt:"preview",className:"h-full object-contain w-full",onError:()=>i(null)}),e.jsx("button",{type:"button",onClick:()=>i(null),className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded hover:bg-red-600",children:"×"})]}):e.jsxs("div",{className:"text-center p-4",children:[e.jsxs("p",{className:"text-sm font-semibold",children:["File ",b.name," telah diunggah"]}),e.jsx("p",{className:"text-blue-600 underline",children:"Klik untuk ganti"})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx("svg",{className:"w-8 h-8 mb-4 text-gray-500",fill:"none",viewBox:"0 0 20 16",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})}),e.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[e.jsx("span",{className:"font-semibold",children:"Klik untuk upload"})," atau drag & drop"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PDF, JPG, PNG (max 2MB)"})]}),e.jsx("input",{type:"file",id:"file_path",accept:".pdf,image/jpeg,image/jpg,image/png",onChange:m,className:"hidden"})]})})})})}),e.jsxs("div",{className:"bg-gray-100 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse rounded-b-lg",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm cursor-pointer",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},Ts=({santri:a})=>a?e.jsx("div",{className:" p-4 rounded-md bg-gray-50 shadow-sm mb-6",children:e.jsxs("div",{className:"flex items-start space-x-12",children:[a.foto_profil?e.jsx("img",{src:a.foto_profil,alt:a.value,className:"w-24 h-24 rounded object-cover"}):e.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-md flex items-center justify-center",children:e.jsx("i",{className:"fas fa-user text-gray-400 text-4xl"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-12 gap-y-2 text-sm",children:[e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-1",children:[e.jsx("span",{className:"font-semibold",children:"Nama"})," ",e.jsxs("span",{children:[": ",a.value]}),e.jsx("span",{className:"font-semibold",children:"NIS"})," ",e.jsxs("span",{children:[": ",a.nis]}),e.jsx("span",{className:"font-semibold",children:"NIUP"})," ",e.jsxs("span",{children:[": ",a.niup]}),e.jsx("span",{className:"font-semibold",children:"Angkatan"})," ",e.jsxs("span",{children:[": ",a.angkatan]}),e.jsx("span",{className:"font-semibold",children:"Kota Asal"})," ",e.jsxs("span",{children:[": ",a.kota_asal]})]}),e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-1",children:[e.jsx("span",{className:"font-semibold",children:"Lembaga"})," ",e.jsxs("span",{children:[": ",a.lembaga]}),e.jsx("span",{className:"font-semibold",children:"Wilayah"})," ",e.jsxs("span",{children:[": ",a.wilayah]}),e.jsx("span",{className:"font-semibold",children:"Blok"})," ",e.jsxs("span",{children:[": ",a.blok]}),e.jsx("span",{className:"font-semibold",children:"Kamar"})," ",e.jsxs("span",{children:[": ",a.kamar]})]})]})]})}):null,Ps=({isOpen:a,onClose:s,onConfirm:l,isLoading:r,roleName:n})=>a?e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"w-full max-w-md bg-white rounded-lg shadow-xl relative max-h-[90vh] flex flex-col",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mt-6",children:"Konfirmasi Approval"}),e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4 overflow-y-auto",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsx("div",{className:"mt-2 sm:mt-0 text-center w-full",children:e.jsxs("p",{className:"mb-4",children:["Anda yakin ingin menyetujui perizinan ini sebagai"," ",e.jsx("span",{className:"font-semibold capitalize",children:n}),"?"]})})})}),e.jsxs("div",{className:"bg-gray-100 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse rounded-b-lg",children:[e.jsx("button",{onClick:l,disabled:r,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 flex items-center gap-2",children:r?e.jsxs(e.Fragment,{children:[e.jsx(pe,{variant:"disc",color:"#fff",size:"small",text:"",textColor:""}),"Memproses..."]}):"Ya, Setujui"}),e.jsx("button",{onClick:s,disabled:r,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm disabled:opacity-50",children:"Batal"})]})]})})})]})}):null,Cs=({isOpen:a,onClose:s,refetchData:l,feature:r,id:n,nama:x})=>{const{menuSantri:b}=Sa(),{clearAuthData:i}=ke(),m=je(),[d,p]=t.useState(null),[g,h]=t.useState(!1),[c,o]=t.useState({status_pelanggaran:"",jenis_putusan:"",jenis_pelanggaran:"",diproses_mahkamah:null,keterangan:""});t.useEffect(()=>{a&&r==1&&(p(null),o({status_pelanggaran:"",jenis_putusan:"",jenis_pelanggaran:"",diproses_mahkamah:null,keterangan:""}))},[r,a]),t.useEffect(()=>{if(r===2&&x&&b.length>0){const w=b.find(_=>_.label===x);w&&p(w)}},[r,x,b]),t.useEffect(()=>{const w=async()=>{try{const _=sessionStorage.getItem("token")||xe("token"),f=await fetch(`${G}crud/${n}/pelanggaran/show`,{headers:{Authorization:`Bearer ${_}`}});if(!f.ok)throw new Error("Gagal mengambil data");const v=await f.json();v.data&&o({status_pelanggaran:v.data.status_pelanggaran??"",jenis_putusan:v.data.jenis_putusan??"",jenis_pelanggaran:v.data.jenis_pelanggaran??"",diproses_mahkamah:v.data.diproses_mahkamah??"",keterangan:v.data.keterangan??""})}catch(_){console.error("Gagal mengambil data perizinan:",_),k.fire("Error","Gagal mengambil data perizinan","error")}};a&&r===2&&(o({status_pelanggaran:"",jenis_putusan:"",jenis_pelanggaran:"",diproses_mahkamah:null,keterangan:""}),w())},[r,n,a]);const u=async w=>{w.preventDefault();const _=r==1,f=_?"POST":"PUT",v=_?d.bio_id:n;if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),console.log(d),console.log("Payload yang dikirim ke API:",JSON.stringify(c,null,2));const j=sessionStorage.getItem("token")||xe("token"),y=await fetch(`${G}crud/${v}/pelanggaran`,{method:f,headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`},body:JSON.stringify(c)});if(console.log(`Mengirim ke: ${G}crud/${d}/pelanggaran`),k.close(),!y)throw new Error("Tidak ada response dari server.");if(y.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),i(),m("/login");return}const N=await y.json();if(!("data"in N)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${N.message}</div>`});return}console.log(N),await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),l==null||l(!0),s==null||s()}catch(j){console.error("Terjadi kesalahan:",j),await k.fire({icon:"error",title:"Oops!",text:`Terjadi kesalahan saat mengirim data. ${j}`})}};return e.jsxs(le,{appear:!0,show:a,as:t.Fragment,children:[e.jsxs(re,{as:"div",className:"fixed inset-0 z-50",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"w-full max-w-3xl bg-white rounded-lg shadow-xl relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mt-6",children:r==1?"Tambah Data Baru":"Edit Data"}),e.jsxs("form",{className:"w-full",onSubmit:u,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4 overflow-y-auto max-h-[70vh]",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[r===1&&e.jsx("div",{className:`mb-4 flex ${d?"justify-end":"justify-center"}`,children:e.jsxs("div",{className:"flex-1 flex justify-between items-center max-w-2xl mx-auto",children:[!d&&e.jsx("h2",{className:"text-lg font-semibold absolute left-1/2 transform -translate-x-1/2",children:"Pilih Data Santri Terlebih Dahulu"}),e.jsx("div",{className:`ml-auto ${d?"":"relative"}`,children:e.jsx("button",{type:"button",onClick:()=>h(!0),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:d?"Ganti Santri":"Pilih Santri"})})]})}),d&&e.jsx(Fs,{santri:d}),(d||r===2)&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status_pelanggaran",className:"block text-gray-700",children:"Status Pelanggaran *"}),e.jsxs("select",{className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",onChange:w=>o({...c,status_pelanggaran:w.target.value}),value:c.status_pelanggaran,required:!0,children:[e.jsx("option",{value:"",children:"Pilih Status"}),e.jsx("option",{value:"Belum diproses",children:"Belum Diproses"}),e.jsx("option",{value:"Sedang diproses",children:"Sedang Diproses"}),e.jsx("option",{value:"Rombongan",children:"Sudah Diproses"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"jenis_putusan",className:"block text-gray-700",children:"Jenis Putusan *"}),e.jsxs("select",{className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",onChange:w=>o({...c,jenis_putusan:w.target.value}),value:c.jenis_putusan,required:!0,children:[e.jsx("option",{value:"",children:"Pilih Jenis Putusan"}),e.jsx("option",{value:"Belum ada putusan",children:"Belum ada putusan"}),e.jsx("option",{value:"Disanksi",children:"Disanksi"}),e.jsx("option",{value:"Dibebaskan",children:"Dibebaskan"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"jenis_pelanggaran",className:"block text-gray-700",children:"Jenis Pelanggaran *"}),e.jsxs("select",{className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",onChange:w=>o({...c,jenis_pelanggaran:w.target.value}),value:c.jenis_pelanggaran,required:!0,children:[e.jsx("option",{value:"",children:"Pilih Jenis Pelanggaran"}),e.jsx("option",{value:"Ringan",children:"Ringan"}),e.jsx("option",{value:"Sedang",children:"Sedang"}),e.jsx("option",{value:"Berat",children:"Berat"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-1",children:"Diproses Mahkamah *"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"diproses_mahkamah",value:"true",checked:c.diproses_mahkamah===!0||c.diproses_mahkamah==1,onChange:()=>o({...c,diproses_mahkamah:!0}),required:!0,className:"form-radio text-blue-500"}),e.jsx("span",{className:"ml-2",children:"Ya"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"diproses_mahkamah",value:"false",checked:c.diproses_mahkamah===!1||c.diproses_mahkamah==0,onChange:()=>o({...c,diproses_mahkamah:!1}),required:!0,className:"form-radio text-blue-500"}),e.jsx("span",{className:"ml-2",children:"Tidak"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"keterangan",className:"block text-gray-700",children:"Keterangan *"}),e.jsx("textarea",{name:"keterangan",onChange:w=>o({...c,keterangan:w.target.value}),value:c.keterangan,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]})]})]})})}),e.jsxs("div",{className:"bg-gray-100 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse rounded-b-lg",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm cursor-pointer",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]}),e.jsx(ha,{isOpen:g,onClose:()=>h(!1),onSantriSelected:w=>p(w)})]})},Fs=({santri:a})=>a?e.jsx("div",{className:" p-4 rounded-md bg-gray-50 shadow-sm mb-6",children:e.jsxs("div",{className:"flex items-start space-x-12",children:[a.foto_profil?e.jsx("img",{src:a.foto_profil,alt:a.value,className:"w-24 h-24 rounded object-cover"}):e.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-md flex items-center justify-center",children:e.jsx("i",{className:"fas fa-user text-gray-400 text-4xl"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-12 gap-y-2 text-sm",children:[e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-1",children:[e.jsx("span",{className:"font-semibold",children:"Nama"})," ",e.jsxs("span",{children:[": ",a.value]}),e.jsx("span",{className:"font-semibold",children:"NIS"})," ",e.jsxs("span",{children:[": ",a.nis]}),e.jsx("span",{className:"font-semibold",children:"NIUP"})," ",e.jsxs("span",{children:[": ",a.niup]}),e.jsx("span",{className:"font-semibold",children:"Angkatan"})," ",e.jsxs("span",{children:[": ",a.angkatan]}),e.jsx("span",{className:"font-semibold",children:"Kota Asal"})," ",e.jsxs("span",{children:[": ",a.kota_asal]})]}),e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-1",children:[e.jsx("span",{className:"font-semibold",children:"Lembaga"})," ",e.jsxs("span",{children:[": ",a.lembaga]}),e.jsx("span",{className:"font-semibold",children:"Wilayah"})," ",e.jsxs("span",{children:[": ",a.wilayah]}),e.jsx("span",{className:"font-semibold",children:"Blok"})," ",e.jsxs("span",{children:[": ",a.blok]}),e.jsx("span",{className:"font-semibold",children:"Kamar"})," ",e.jsxs("span",{children:[": ",a.kamar]})]})]})]})}):null,$s=({isOpen:a,onClose:s,id:l,close:r})=>{var p;const{clearAuthData:n}=ke(),x=je(),[b,i]=t.useState(null),m=g=>{const h=g.target.files[0];if(h){if(!["application/pdf","image/jpeg","image/jpg","image/png"].includes(h.type)){alert("Format file harus PDF, JPG, JPEG, atau PNG");return}if(h.size>2*1024*1024){alert("Ukuran file maksimal 2MB");return}i(h)}},d=async g=>{if(g.preventDefault(),!b){alert("File wajib diunggah");return}if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const c=sessionStorage.getItem("token")||xe("token"),o=new FormData;o.append("file_path",b);const u=await fetch(`${G}crud/${l}/berkas-pelanggaran`,{method:"POST",headers:{Authorization:`Bearer ${c}`},body:o});if(k.close(),!u)throw new Error("Tidak ada response dari server.");if(u.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}const w=await u.json();if(!u.ok)throw new Error(w.message||"Terjadi kesalahan pada server.");if(!("data"in w)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${w.message}</div>`});return}console.log(w),await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),s==null||s(),r==null||r()}catch(c){console.error("Terjadi kesalahan:",c),await k.fire({icon:"error",title:"Oops!",text:`Terjadi kesalahan saat mengirim data. ${c.message}`})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"w-full max-w-lg bg-white rounded-lg shadow-xl relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mt-6",children:"Tambah Berkas Pelanggaran"}),e.jsxs("form",{className:"w-full",onSubmit:d,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4 overflow-y-auto max-h-[70vh]",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsx("div",{className:"mt-2 sm:mt-0 text-left w-full",children:e.jsx("div",{className:"p-2 rounded-xl border border-gray-300 bg-white",children:e.jsxs("label",{htmlFor:"file_path",className:`relative flex flex-col items-center justify-center w-full aspect-[4/3] min-h-[150px] cursor-pointer ${b?"":"bg-gray-50 hover:bg-gray-100 border-2 border-gray-300 border-dashed rounded-lg"}`,children:[b?typeof b=="object"&&((p=b.type)!=null&&p.startsWith("image"))?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:URL.createObjectURL(b),alt:"preview",className:"h-full object-contain w-full"}),e.jsx("button",{type:"button",onClick:()=>i(null),className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded hover:bg-red-600",children:"×"})]}):typeof b=="string"?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:b,alt:"preview",className:"h-full object-contain w-full",onError:()=>i(null)}),e.jsx("button",{type:"button",onClick:()=>i(null),className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded hover:bg-red-600",children:"×"})]}):e.jsxs("div",{className:"text-center p-4",children:[e.jsxs("p",{className:"text-sm font-semibold",children:["File ",b.name," telah diunggah"]}),e.jsx("p",{className:"text-blue-600 underline",children:"Klik untuk ganti"})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx("svg",{className:"w-8 h-8 mb-4 text-gray-500",fill:"none",viewBox:"0 0 20 16",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})}),e.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[e.jsx("span",{className:"font-semibold",children:"Klik untuk upload"})," atau drag & drop"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PDF, JPG, PNG (max 2MB)"})]}),e.jsx("input",{type:"file",id:"file_path",accept:".pdf,image/jpeg,image/jpg,image/png",onChange:m,className:"hidden"})]})})})})}),e.jsxs("div",{className:"bg-gray-100 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse rounded-b-lg",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm cursor-pointer",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},As=({berkas:a,menu:s,id:l,close:r})=>{const[n,x]=t.useState(!1),[b,i]=t.useState(!1),m=()=>{s===17?x(!0):s===18&&i(!0)};return e.jsxs("div",{children:[e.jsx(Ss,{isOpen:n,onClose:()=>x(!1),id:l,close:r}),e.jsx($s,{isOpen:b,onClose:()=>i(!1),id:l,close:r}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-xl font-bold flex items-center justify-between",children:"Daftar Berkas"}),e.jsxs("button",{onClick:d=>{d.stopPropagation(),m()},type:"button",className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Tambah"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map((d,p)=>e.jsx(Ks,{url:d,index:p},p))})]})},Ks=({url:a,index:s})=>{const[l,r]=t.useState(!1);return e.jsxs("div",{className:"border rounded-lg overflow-hidden shadow hover:shadow-md transition-shadow",children:[l?e.jsx("div",{className:"flex items-center justify-center w-full h-64 bg-gray-100 text-gray-400",children:e.jsx(ge,{icon:za,className:"text-4xl"})}):e.jsx("img",{src:a,alt:`Berkas ${s+1}`,className:"w-full h-64 object-cover",onError:()=>r(!0)}),e.jsxs("div",{className:"p-2 text-sm text-center text-gray-600",children:["Berkas ",s+1]})]})},Is=({pemohonIzin:a})=>{const[s,l]=t.useState(!1);if(!a)return e.jsx("p",{className:"text-gray-500",children:"Data pemohon izin tidak tersedia."});const r=({kamar:x,blok:b,wilayah:i})=>{const d=[x,b,i].map(p=>p&&p!=="-"&&p!==null?p:null).filter(p=>p);return d.length>0?d.join(" - "):"-"},n=({kecamatan:x,kabupaten:b,provinsi:i})=>{const m=[x,b].filter(g=>g&&g!=="-"&&g!==null),d=i&&i!=="-"&&i!==null?i:null;if(m.length===0&&!d)return"-";const p=m.join(" - ");return d?`${p}${p?", ":""}${d}`:p};return e.jsxs("div",{className:"space-y-6 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("div",{className:"w-full md:w-1/4",children:e.jsx("div",{className:"border rounded overflow-hidden shadow",children:s?e.jsx("div",{className:"flex items-center justify-center w-full h-48 bg-gray-100 text-gray-400",children:e.jsx(ge,{icon:za,className:"text-4xl"})}):e.jsx("img",{src:a.foto_profil,alt:a.nama,className:"w-full h-48 object-cover",onError:()=>l(!0)})})}),e.jsxs("div",{className:"w-full md:w-3/4 grid grid-cols-1 gap-x-8 gap-y-2",children:[e.jsx(Oe,{label:"Nama Lengkap",value:a.nama||"-"}),e.jsx(Oe,{label:"Jenis Kelamin",value:a.jenis_kelamin==="p"?"Perempuan":"Laki-laki"}),e.jsx(Oe,{label:"Domisili",value:r(a)}),e.jsx(Oe,{label:"Lembaga",value:a.lembaga||"-"}),e.jsx(Oe,{label:"Alamat",value:n(a)}),e.jsx(Oe,{label:"Alasan Izin",value:a.alasan_izin||"-"}),e.jsx(Oe,{label:"Alamat Tujuan",value:a.alamat_tujuan||"-"}),e.jsx(Oe,{label:"Tanggal Mulai",value:a.tanggal_mulai||"-"}),e.jsx(Oe,{label:"Tanggal Akhir",value:a.tanggal_akhir||"-"}),e.jsx(Oe,{label:"Tanggal Kembali",value:a.tanggal_kembali||"-"}),e.jsx(Oe,{label:"Lama Izin",value:a.lama_izin||"-"}),e.jsx(Oe,{label:"Bermalam",value:a.bermalam||"-"}),e.jsx(Oe,{label:"Jenis Izin",value:a.jenis_izin||"-"}),e.jsx(Oe,{label:"Status",value:a.status||"-"}),e.jsx(Oe,{label:"Keterangan",value:a.keterangan||"-"})]})]}),e.jsx("hr",{className:"my-4"}),e.jsxs("div",{className:"grid grid-cols-1 gap-x-8 gap-y-2",children:[e.jsx(Oe,{label:"Pembuat Izin",value:a.pembuat||"-"}),e.jsx(Oe,{label:"Biktren",value:a.biktren||"-"}),e.jsx(Oe,{label:"Pengasuh",value:a.pengasuh||"-"}),e.jsx(Oe,{label:"Kamtib",value:a.kamtib||"-"})]}),e.jsx("hr",{className:"my-4"})]})},Oe=({label:a,value:s})=>e.jsxs("div",{className:"flex",children:[e.jsxs("span",{className:"w-30 font-medium text-gray-800",children:[a,":"]}),e.jsx("span",{className:"text-gray-600",children:s||"-"})]}),Ms=({pengantar:a})=>a?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"border rounded-lg shadow-md p-4",children:[e.jsx("div",{className:"flex flex-col md:flex-row gap-6",children:e.jsx("div",{className:"flex gap-4 w-full md:w-1/2",children:e.jsxs("div",{className:"flex flex-col justify-center space-y-1 text-sm",children:[e.jsx("div",{className:"font-semibold flex items-center gap-1",children:a.nama}),e.jsxs("div",{className:"text-gray-600",children:[a.usia," Tahun"]}),e.jsx("div",{className:"text-gray-600 capitalize",children:a.status})]})})}),e.jsx("hr",{className:"my-4"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm text-gray-700",children:[e.jsx(ja,{label:"Pembuat Izin",value:a.pembuat}),e.jsx(ja,{label:"Biktren",value:a.biktren}),e.jsx(ja,{label:"Pengasuh",value:a.pengasuh}),e.jsx(ja,{label:"Kamtib",value:a.kamtib})]})]})}):e.jsx("p",{className:"text-gray-500",children:"Data pengantar tidak tersedia."}),ja=({label:a,value:s})=>e.jsxs("div",{children:[e.jsxs("span",{className:"inline-block font-medium text-gray-800 w-25",children:[a,":"]})," ",e.jsx("span",{className:"text-gray-600",children:s||"-"})]}),Bs=({pelanggaran:a})=>{const[s,l]=t.useState(!1);return a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("div",{className:"w-full md:w-1/3 text-sm text-gray-700",children:e.jsx("div",{className:"border rounded-md overflow-hidden shadow",children:s?e.jsx("div",{className:"flex items-center justify-center w-full h-60 bg-gray-100 text-gray-400",children:e.jsx(ge,{icon:za,className:"text-4xl"})}):e.jsx("img",{src:a.foto_profil,alt:a.nama_santri,className:"w-full h-60 object-cover",onError:()=>l(!0)})})}),e.jsxs("div",{className:"w-full md:w-2/3 text-sm text-gray-700",children:[e.jsx("div",{className:"text-lg font-semibold mb-2",children:a.nama_santri}),e.jsx(Da,{label:"Alamat",value:Ds(a)}),e.jsx(Da,{label:"Domisili",value:Ls(a)}),e.jsx(Da,{label:"Lembaga",value:a.lembaga})]})]}),e.jsxs("div",{className:"text-sm text-gray-700 space-y-4",children:[e.jsxs(tt,{title:"Pelanggaran",children:[e.jsx(sa,{label:"Jenis Pelanggaran",value:a.jenis_pelanggaran}),e.jsx(sa,{label:"Diproses Mahkamah",value:a.diproses_mahkamah?"Ya":e.jsxs("span",{className:"text-red-500",children:["Tidak ",e.jsx(ge,{icon:Yt})]})}),e.jsx(sa,{label:"Status Pelanggaran",value:a.status_pelanggaran}),e.jsx(sa,{label:"Pencatat",value:a.pencatat||"(AutoSystem)"}),e.jsx(sa,{label:"Tanggal Input",value:a.tgl_input})]}),e.jsxs(tt,{title:"Putusan",children:[e.jsx(sa,{label:"Jenis Putusan",value:a.jenis_putusan||"-"}),e.jsx(sa,{label:"Keterangan",value:a.keterangan||"-"})]}),e.jsx("hr",{className:"my-2"})]})]}):e.jsx("p",{className:"text-gray-500",children:"Data pelanggaran tidak tersedia."})},Da=({label:a,value:s})=>e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"font-medium w-24",children:a}),": ",s||"-"]}),sa=({label:a,value:s})=>e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-40",children:a}),e.jsxs("div",{className:"flex-1",children:[": ",s||"-"]})]}),tt=({title:a,children:s})=>e.jsxs("div",{children:[e.jsx("hr",{className:"my-2"}),e.jsx("div",{className:"font-semibold text-base mb-1",children:a}),e.jsx("div",{className:"space-y-1",children:s})]}),Ds=({kecamatan:a,kabupaten:s,provinsi:l})=>{const r=[s,a].filter(b=>b&&b!=="-"&&b!==null),n=l&&l!=="-"&&l!==null?l:null;if(r.length===0&&!n)return"-";const x=r.join(", ");return n?`${x}, ${n}`:x},Ls=({wilayah:a,blok:s,kamar:l})=>{const r=[a,s,l].filter(n=>n&&n!=="-"&&n!==null);return r.length?r.join(" - "):"-"},Os=()=>e.jsx("h1",{className:"text-xl font-bold",children:"Warga Pesantren"}),De=({title:a,menu:s,item:l,onClose:r})=>{var o;const[n,x]=t.useState(null),[b,i]=t.useState(!0),[m,d]=t.useState(null);t.useEffect(()=>{const u=async()=>{i(!0),d(null);try{let w="";if(s===1?w=`pesertadidik/${l.biodata_id}`:s===2?w=`santri/${l.biodata_id}`:s===3?w=`santri-nondomisili/${l.biodata_id}`:s===4?w=`pelajar/${l.biodata_id}`:s===5?w=`pesertadidik-bersaudara/${l.biodata_id}`:s===6?w=`orangtua/${l.biodata_id}`:s===7?w=`wali/${l.biodata_id}`:s===8?w=`pengajar/${l.biodata_id}`:s===9?w=`pengurus/${l.biodata_id}`:s===10?w=`karyawan/${l.biodata_id}`:s===11?w=`walikelas/${l.id}`:s===12?w=`khadam/${l.biodata_id}`:s===13?w=`alumni/${l.biodata_id}`:s===14?w=`waliasuh/${l.biodata_id}`:s===16?w=`anakasuh/${l.biodata_id}`:s===17?w=`perizinan/${l.id}`:s===18?w=`pelanggaran/${l.id}`:s===19?w=`catatan-afektif/${l}`:s===20?w=`catatan-kognitif/${l}`:s===21?w=`pegawai/${l.biodata_id}`:s===22?w=`anakpegawai/${l.biodata_id}`:s===23&&(w=`pengunjung/${l.id}`),!w)throw new Error("Menu tidak valid");const _=await fetch(`${G}data-pokok/${w}`),f=await _.json();if(!_.ok||f.status===!1)throw new Error(f.message||"Gagal mengambil data");console.log(w),x(f.data),console.log(s)}catch(w){console.error(w),d("Gagal memuat data.")}finally{i(!1)}};(l!=null&&l.biodata_id||l!=null&&l.id_khadam||l!=null&&l.id||l)&&u()},[l,l.biodata_id,l.id,l.id_khadam,s]);const p=n&&Object.keys(n).length===1&&n.error,g=t.useMemo(()=>{var u,w,_,f,v,S,j,y,N,T,C,P,F,M,L,I,D,Q,E,B,V;return p?[]:[(n==null?void 0:n.Biodata)&&{id:"biodata",label:"Biodata",content:e.jsx(cs,{biodata:n.Biodata})},((u=n==null?void 0:n.Keluarga)==null?void 0:u.length)>0&&{id:"keluarga",label:"Keluarga",content:e.jsx(us,{keluarga:n.Keluarga})},(((_=(w=n==null?void 0:n.Status_Santri)==null?void 0:w.Santri)==null?void 0:_.length)>0||((v=(f=n==null?void 0:n.Status_Santri)==null?void 0:f.Kewaliasuhan)==null?void 0:v.length)>0||((j=(S=n==null?void 0:n.Status_Santri)==null?void 0:S.Info_Perizinan)==null?void 0:j.length)>0)&&{id:"Status Santri",label:"Status Santri",content:e.jsx(xs,{statusSantri:n.Status_Santri})},((y=n==null?void 0:n.Domisili)==null?void 0:y.length)>0&&{id:"domisili",label:"Domisili",content:e.jsx(gs,{domisili:n.Domisili})},((N=n==null?void 0:n.Pendidikan)==null?void 0:N.length)>0&&{id:"pendidikan",label:"Pendidikan",content:e.jsx(hs,{pendidikan:n.Pendidikan})},((T=n==null?void 0:n.Wali_Asuh)==null?void 0:T.length)>0&&{id:"waliasuh",label:"Wali Asuh",content:e.jsx(vs,{waliAsuh:n.Wali_Asuh})},((C=n==null?void 0:n.Karyawan)==null?void 0:C.length)>0&&{id:"karyawan",label:"Karyawan",content:e.jsx(fs,{karyawan:n.Karyawan})},(n==null?void 0:n.Pengajar)&&(Object.keys((P=n.Pengajar)==null?void 0:P.Pangkalan).length>0||Object.keys((F=n.Pengajar)==null?void 0:F.Materi_Ajar).length>0)&&{id:"pengajar",label:"Pengajar",content:e.jsx(ws,{pengajar:n.Pengajar})},((M=n==null?void 0:n.Pengurus)==null?void 0:M.length)>0&&{id:"pengurus",label:"Pengurus",content:e.jsx(ks,{pengurus:n.Pengurus})},((L=n==null?void 0:n.Wali_Kelas)==null?void 0:L.length)>0&&{id:"wali_kelas",label:"Wali Kelas",content:e.jsx(ys,{waliKelas:n.Wali_Kelas})},((I=n==null?void 0:n.WargaPesantren)==null?void 0:I.length)>0&&{id:"warpes",label:"Warga Pesantren",content:e.jsx(Os,{})},(n==null?void 0:n.Catatan_Progress)&&(Object.keys((D=n.Catatan_Progress)==null?void 0:D.Afektif).length>0||Object.keys((Q=n.Catatan_Progress)==null?void 0:Q.Kognitif).length>0)&&{id:"progress",label:"Catatan Progress",content:e.jsx(bs,{catatanProgress:n.Catatan_Progress})},((E=n==null?void 0:n.Kunjungan_Mahrom)==null?void 0:E.length)>0&&{id:"kunjungan_mahrom",label:"Kunjungan Mahrom",content:e.jsx(ps,{kunjunganMahrom:n.Kunjungan_Mahrom})},((B=n==null?void 0:n.Khadam)==null?void 0:B.length)>0&&{id:"khadam",label:"Khadam",content:e.jsx(js,{khadam:n.Khadam})},(n==null?void 0:n["Pemohon Izin"])&&Object.keys(n==null?void 0:n["Pemohon Izin"]).length>0&&{id:"pemohon_izin",label:"Pemohon Izin",content:e.jsx(Is,{pemohonIzin:n==null?void 0:n["Pemohon Izin"]})},(n==null?void 0:n.pelanggaran)&&Object.keys(n==null?void 0:n.pelanggaran).length>0&&{id:"pelanggaran",label:"Pelanggaran",content:e.jsx(Bs,{pelanggaran:n.pelanggaran})},(n==null?void 0:n.Pengantar)&&Object.keys(n==null?void 0:n.Pengantar).length>0&&{id:"pengantar",label:"Pengantar",content:e.jsx(Ms,{pengantar:n.Pengantar})},(s===17||s===18||((V=n==null?void 0:n.Berkas)==null?void 0:V.length)>0)&&{id:"berkas",label:"Berkas",content:e.jsx(As,{berkas:(n==null?void 0:n.Berkas)||[],menu:s,id:l.id,close:r})},(n==null?void 0:n.error)&&{id:"error",label:"Error",content:e.jsx("div",{children:n==null?void 0:n.error})}].filter(Boolean)},[n,p,l.id,s,r]),[h,c]=t.useState(null);return t.useEffect(()=>{g.length>0&&c(g[0].id)},[g]),e.jsx(le,{appear:!0,show:!0,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:r,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 overflow-y-auto",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"bg-white p-6 rounded-lg shadow-xl max-w-3xl w-full h-full relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:r,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx("div",{className:"pb-4",children:e.jsxs(re.Title,{className:"text-lg font-semibold text-gray-900",children:["Detail ",a]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2",children:[b&&e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small"})}),m&&e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"text-center text-red-500 font-semibold",children:m})}),n&&(p?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"text-center text-red-500 font-semibold",children:n.error})}):e.jsxs(e.Fragment,{children:[e.jsx("ul",{className:"flex flex-wrap text-sm font-medium text-center text-gray-500 border-b border-gray-500",children:g.map(u=>e.jsx("li",{children:e.jsx("button",{onClick:()=>c(u.id),className:`inline-block p-3 rounded-t-lg border-b-2 cursor-pointer ${h===u.id?"text-blue-600 border-blue-600 bg-gray-200":"border-transparent hover:text-gray-600 hover:bg-gray-50"}`,children:u.label})},u.id))}),e.jsx("div",{className:"pt-4",children:(o=g.find(u=>u.id===h))==null?void 0:o.content})]}))]}),e.jsxs("div",{className:"mt-4 pt-4 text-right space-x-2",children:[s!==23&&s!==17&&s!=18&&e.jsx(Ye,{to:`/formulir/${l.biodata_id||l.id||l}/biodata`,children:e.jsx("button",{onClick:r,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 cursor-pointer",children:"Buka di Formulir"})}),e.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 cursor-pointer",children:"Tutup"})]})]})})})]})})},xt=({santri:a,menu:s})=>{var g;const l={A:{label:"sangat baik",color:" text-green-800"},B:{label:"baik",color:" text-blue-800"},C:{label:"cukup",color:" text-yellow-800"},D:{label:"kurang",color:" text-red-800"},E:{label:"sangat kurang",color:" text-pink-800"}},[r,n]=t.useState(null),[x,b]=t.useState(!1),[i,m]=t.useState(""),d=h=>{n(h),b(!0)},p=()=>{n(null),b(!1)};return e.jsxs("div",{className:"rounded-lg mb-4",children:[(g=a.catatan)==null?void 0:g.map((h,c)=>{var o,u;return e.jsxs("div",{className:"grid grid-cols-12 p-4 rounded-lg shadow-sm gap-4 items-center bg-white mb-4",children:[e.jsx("div",{className:"col-span-12 md:col-span-2 lg:col-span-2 flex justify-center h-24 rounded-md bg-gray-200 overflow-hidden cursor-pointer",onClick:w=>{w.stopPropagation(),m("Peserta Didik"),d(h.Biodata_uuid)},children:a.foto?e.jsx("img",{src:a.foto,alt:a.nama_santri,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-md flex items-center justify-center",children:e.jsx("i",{className:"fas fa-user text-gray-400 text-4xl"})})}),e.jsxs("div",{className:"col-span-12 md:col-span-3 lg:col-span-3 space-y-2 cursor-pointer",onClick:w=>{w.stopPropagation(),m("Peserta Didik"),d(h.Biodata_uuid)},children:[e.jsx("h2",{className:"text-lg font-semibold",children:a.nama_santri}),e.jsxs("p",{className:"text-sm text-gray-800",children:["Domisili: ",a.blok," - ",a.wilayah]}),e.jsxs("p",{className:"text-sm text-gray-800",children:["Pendidikan: ",[a.pendidikan,a.lembaga].filter(Boolean).join(" - ")||"Tidak ada"]})]}),e.jsxs("div",{className:"col-span-12 md:col-span-5 lg:col-span-5 space-y-1 cursor-pointer",onClick:w=>{w.stopPropagation(),m("Peserta Didik"),d(h.Biodata_uuid)},children:[e.jsxs("h2",{className:"text-lg font-semibold",children:[h.kategori,":"," ",e.jsxs("span",{className:`${((o=l[h.nilai])==null?void 0:o.color)||"text-gray-600"}`,children:["[ ",h.nilai," ]"]})]}),e.jsx("p",{className:"text-md text-gray-800",children:((u=l[h.nilai])==null?void 0:u.label)||"Tidak ada"}),e.jsx("h2",{className:"text-md font-semibold",children:"Tindak Lanjut :"}),e.jsx("p",{className:"text-md text-gray-800",children:h.tindak_lanjut||"Tidak ada"})]}),e.jsxs("div",{className:"col-span-12 md:col-span-2 lg:col-span-2 space-y-2 cursor-pointer",onClick:w=>{w.stopPropagation(),m("Pencatat"),d(h.Pencatat_uuid)},children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-1 flex items-center justify-center flex-shrink-0",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:h.fotoPencatat?e.jsx("img",{src:h.fotoPencatat,alt:h.pencatat,className:"w-full h-full object-cover"}):e.jsx("i",{className:"fas fa-user text-gray-400"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-bold",children:"Pencatat:"}),e.jsx("p",{className:"text-sm",children:h.pencatat||"Tidak ada"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["(",h.jabatanPencatat||"Tidak ada",")"]}),e.jsx("br",{})]})]}),e.jsx("p",{className:"text-end text-xs text-gray-500",children:h.waktu_pencatatan||"Tidak ada"})]})]},c)}),x&&e.jsx(De,{title:i,menu:s,item:r,onClose:p})]})},Ce=({searchTerm:a,setSearchTerm:s,totalData:l,toggleFilters:r,toggleView:n,limit:x,toggleLimit:b,showViewButtons:i=!0,showFilterButtons:m=!0,showSearch:d=!0})=>{const[p,g]=t.useState("table");t.useEffect(()=>{const c=sessionStorage.getItem("viewMode");c&&g(c)},[]);const h=c=>{g(c),sessionStorage.setItem("viewMode",c),n(c)};return e.jsxs("div",{className:"flex flex-col md:flex-row-reverse justify-between md:items-center items-left mb-4 w-95 md:w-auto space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("input",{className:"border border-gray-300 rounded p-2 w-40",placeholder:"Cari Nama ...",type:"text",value:a,onChange:c=>s(c.target.value)}),i&&e.jsxs("div",{className:"flex border rounded-sm overflow-hidden",children:[e.jsx("button",{"aria-label":"list",className:`p-3 flex items-center justify-center cursor-pointer ${p==="list"?"bg-blue-500 text-white":"bg-white text-blue-500"}`,onClick:()=>h("list"),children:e.jsx("i",{className:"fas fa-list text-lg"})}),e.jsx("button",{"aria-label":"table",className:`p-3 flex items-center justify-center cursor-pointer ${p==="table"?"bg-blue-500 text-white":"bg-white text-blue-500"}`,onClick:()=>h("table"),children:e.jsx("i",{className:"fas fa-table text-lg"})})]}),m&&e.jsx("button",{"aria-label":"filter",className:"p-3 bg-green-500 text-white rounded flex items-center justify-center cursor-pointer",onClick:r,children:e.jsx("i",{className:"fas fa-filter text-lg"})})]}),e.jsxs("div",{children:[e.jsxs("select",{"aria-label":"limit",className:"border border-gray-300 rounded p-2 mr-4",value:x,onChange:b,children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsxs("span",{children:["Total Data: ",l||0]})]})]})},ue=({showFilters:a,filterOptions:s,onChange:l,selectedFilters:r})=>a?e.jsx("div",{className:"flex flex-col gap-4 w-full mb-4",children:Object.entries(s).map(([n,x],b)=>e.jsx("select",{className:`border border-gray-300 rounded p-2 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:i=>l({[n]:i.target.value}),value:r[n]||"",disabled:x.length<=1,children:x.map((i,m)=>e.jsx("option",{value:i.value,children:i.label},m))},`${n}-${b}`))}):null,Fe=({currentPage:a,totalPages:s,handlePageChange:l})=>{const r=()=>{if(s<=5)return Array.from({length:s},(b,i)=>i+1);let n=Math.max(1,a-2),x=Math.min(s,a+2);return a<=2?(n=1,x=5):a>=s-1&&(n=s-4,x=s),Array.from({length:x-n+1},(b,i)=>n+i)};return e.jsx("nav",{"aria-label":"Page navigation",className:"flex justify-end mt-6",children:e.jsxs("ul",{className:"flex items-center -space-x-px h-10 text-sm",children:[e.jsx("li",{children:e.jsxs("button",{onClick:()=>l(a-1),disabled:a===1,className:`flex items-center justify-center px-4 h-10 border border-gray-300 rounded-s-lg hover:bg-gray-100 hover:text-gray-700 
                            ${a===1?"opacity-50 cursor-not-allowed text-gray-500":"bg-white text-gray-500"}`,children:[e.jsx("span",{className:"sr-only",children:"Previous"}),e.jsx("svg",{className:"w-3 h-3 rtl:rotate-180",fill:"none",viewBox:"0 0 6 10",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 1 1 5l4 4"})})]})}),r().map(n=>e.jsx("li",{children:e.jsx("button",{onClick:()=>l(n),className:`flex items-center justify-center px-4 h-10 border border-gray-300 hover:bg-gray-100 hover:text-gray-700 
                                ${a===n?"z-10 text-blue-600 border-blue-300 bg-blue-50 hover:bg-blue-100 hover:text-blue-700":"text-gray-500 bg-white"}`,children:n})},n)),e.jsx("li",{children:e.jsxs("button",{onClick:()=>l(a+1),disabled:a===s,className:`flex items-center justify-center px-4 h-10 border border-gray-300 rounded-e-lg hover:bg-gray-100 hover:text-gray-700 
                            ${a===s?"opacity-50 cursor-not-allowed text-gray-500":"bg-white text-gray-500"}`,children:[e.jsx("span",{className:"sr-only",children:"Next"}),e.jsx("svg",{className:"w-3 h-3 rtl:rotate-180",fill:"none",viewBox:"0 0 6 10",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 9 4-4-4-4"})})]})})]})})},Ae=()=>{const[a,s]=t.useState([]),[l,r]=t.useState({negara:[],provinsi:[],kabupaten:[],kecamatan:[]}),[n,x]=t.useState({negara:"",provinsi:"",kabupaten:"",kecamatan:""});t.useEffect(()=>{const i=sessionStorage.getItem("menuNegara");if(i){const m=JSON.parse(i);s(m.negara),r({negara:[{value:"",label:"Semua Negara"},...m.negara.map(d=>({value:d.id,label:d.nama_negara}))],provinsi:[{value:"",label:"Semua Provinsi"}],kabupaten:[{value:"",label:"Semua Kabupaten"}],kecamatan:[{value:"",label:"Semua Kecamatan"}]})}else fetch(`${G}dropdown/negara`).then(m=>m.json()).then(m=>{s(m.negara),r({negara:[{value:"",label:"Semua Negara"},...m.negara.map(d=>({value:d.id,label:d.nama_negara}))],provinsi:[{value:"",label:"Semua Provinsi"}],kabupaten:[{value:"",label:"Semua Kabupaten"}],kecamatan:[{value:"",label:"Semua Kecamatan"}]}),sessionStorage.setItem("menuNegara",JSON.stringify(m))}).catch(m=>{console.error("Error fetching data:",m),r({negara:[{value:"",label:"Semua Negara"}],provinsi:[{value:"",label:"Semua Provinsi"}],kabupaten:[{value:"",label:"Semua Kabupaten"}],kecamatan:[{value:"",label:"Semua Kecamatan"}]})})},[]);const b=i=>{x(m=>{const d={...m,...i};return i.negara?(d.provinsi="",d.kabupaten="",d.kecamatan=""):i.provinsi?(d.kabupaten="",d.kecamatan=""):i.kabupaten&&(d.kecamatan=""),d})};return t.useEffect(()=>{var p,g,h,c,o;if(n.negara===""){r(u=>({...u,provinsi:[{value:"",label:"Semua Provinsi"}],kabupaten:[{value:"",label:"Semua Kabupaten"}],kecamatan:[{value:"",label:"Semua Kecamatan"}]}));return}const i=a.find(u=>u.id==n.negara)||{},m=((p=i.provinsi)==null?void 0:p.find(u=>u.id==n.provinsi))||{},d=((g=m.kabupaten)==null?void 0:g.find(u=>u.id==n.kabupaten))||{};r({negara:l.negara,provinsi:[{value:"",label:"Semua Provinsi"},...((h=i.provinsi)==null?void 0:h.map(u=>({value:u.id,label:u.nama_provinsi})))||[]],kabupaten:[{value:"",label:"Semua Kabupaten"},...((c=m.kabupaten)==null?void 0:c.map(u=>({value:u.id,label:u.nama_kabupaten})))||[]],kecamatan:[{value:"",label:"Semua Kecamatan"},...((o=d.kecamatan)==null?void 0:o.map(u=>({value:u.id,label:u.nama_kecamatan})))||[]]})},[n.negara,a,n.provinsi,n.kabupaten,l.negara]),{filterNegara:l,selectedNegara:n,handleFilterChangeNegara:b}},Be=()=>{const[a,s]=t.useState([]),[l,r]=t.useState({wilayah:[],blok:[],kamar:[]}),[n,x]=t.useState({wilayah:"",blok:"",kamar:""});t.useEffect(()=>{fetch(`${G}dropdown/wilayah`).then(i=>i.json()).then(i=>{s(i.wilayah),r({wilayah:[{value:"",label:"Semua Wilayah"},...i.wilayah.map(m=>({value:m.id,label:m.nama_wilayah}))],blok:[{value:"",label:"Semua Blok"}],kamar:[{value:"",label:"Semua Kamar"}]})}).catch(i=>{console.error("Error fetching data:",i),r({wilayah:[{value:"",label:"Semua Wilayah"}],blok:[{value:"",label:"Semua Blok"}],kamar:[{value:"",label:"Semua Kamar"}]})})},[]);const b=i=>{x(m=>{const d={...m,...i};return i.wilayah?(d.blok="",d.kamar=""):i.blok&&(d.kamar=""),d})};return t.useEffect(()=>{var d,p,g;if(n.wilayah===""){r(h=>({...h,blok:[{value:"",label:"Semua Blok"}],kamar:[{value:"",label:"Semua Kamar"}]}));return}const i=a.find(h=>h.id==n.wilayah)||{},m=((d=i.blok)==null?void 0:d.find(h=>h.id==n.blok))||{};r({wilayah:l.wilayah,blok:[{value:"",label:"Semua Blok"},...((p=i.blok)==null?void 0:p.map(h=>({value:h.id,label:h.nama_blok})))||[]],kamar:[{value:"",label:"Semua Kamar"},...((g=m.kamar)==null?void 0:g.map(h=>({value:h.id,label:h.nama_kamar})))||[]]})},[n.wilayah,a,n.blok,l.wilayah]),{filterWilayah:l,selectedWilayah:n,handleFilterChangeWilayah:b}},Te=()=>{const[a,s]=t.useState([]),[l,r]=t.useState({lembaga:[],jurusan:[],kelas:[],rombel:[]}),[n,x]=t.useState({lembaga:"",jurusan:"",kelas:"",rombel:""});t.useEffect(()=>{const i=sessionStorage.getItem("menuLembaga");if(i){const m=JSON.parse(i);s(m.lembaga),r({lembaga:[{value:"",label:"Semua Lembaga"},...m.lembaga.map(d=>({value:d.id,label:d.nama_lembaga}))],jurusan:[{value:"",label:"Semua Jurusan"}],kelas:[{value:"",label:"Semua Kelas"}],rombel:[{value:"",label:"Semua Rombel"}]})}else fetch(`${G}dropdown/lembaga`).then(m=>m.json()).then(m=>{s(m.lembaga),r({lembaga:[{value:"",label:"Semua Lembaga"},...m.lembaga.map(d=>({value:d.id,label:d.nama_lembaga}))],jurusan:[{value:"",label:"Semua Jurusan"}],kelas:[{value:"",label:"Semua Kelas"}],rombel:[{value:"",label:"Semua Rombel"}]}),sessionStorage.setItem("menuLembaga",JSON.stringify(m))}).catch(m=>{console.error("Error fetching data:",m),r({lembaga:[{value:"",label:"Semua Lembaga"}],jurusan:[{value:"",label:"Semua Jurusan"}],kelas:[{value:"",label:"Semua Kelas"}],rombel:[{value:"",label:"Semua Rombel"}]})})},[]);const b=i=>{x(m=>{const d={...m,...i};return i.lembaga?(d.jurusan="",d.kelas="",d.rombel=""):i.jurusan?(d.kelas="",d.rombel=""):i.kelas&&(d.rombel=""),d})};return t.useEffect(()=>{var p,g,h,c,o;if(n.lembaga===""){r(u=>({...u,jurusan:[{value:"",label:"Semua Jurusan"}],kelas:[{value:"",label:"Semua Kelas"}],rombel:[{value:"",label:"Semua Rombel"}]}));return}const i=a.find(u=>u.id==n.lembaga)||{},m=((p=i.jurusan)==null?void 0:p.find(u=>u.id==n.jurusan))||{},d=((g=m.kelas)==null?void 0:g.find(u=>u.id==n.kelas))||{};r({lembaga:l.lembaga,jurusan:[{value:"",label:"Semua Jurusan"},...((h=i.jurusan)==null?void 0:h.map(u=>({value:u.id,label:u.nama_jurusan})))||[]],kelas:[{value:"",label:"Semua Kelas"},...((c=m.kelas)==null?void 0:c.map(u=>({value:u.id,label:u.nama_kelas})))||[]],rombel:[{value:"",label:"Semua Rombel"},...((o=d.rombel)==null?void 0:o.map(u=>({value:u.id,label:u.nama_rombel})))||[]]})},[n.lembaga,a,n.jurusan,n.kelas,l.lembaga]),{filterLembaga:l,selectedLembaga:n,handleFilterChangeLembaga:b}},la=()=>{const[a,s]=t.useState([]),[l,r]=t.useState([]),[n,x]=t.useState([]);return t.useEffect(()=>{const b=sessionStorage.getItem("menuWaliAsuh");if(b)try{const i=JSON.parse(b);s(i)}catch(i){console.error("Gagal parsing data dari sessionStorage:",i),sessionStorage.removeItem("menuWaliAsuh")}else fetch(`${G}dropdown/wali-asuh`).then(i=>i.json()).then(i=>{if(i.status&&Array.isArray(i.data)){const m=[{label:"Pilih Wali Asuh",value:"",id:null},...i.data.map(d=>({id:d.id,value:d.nama,label:d.nama}))];sessionStorage.setItem("menuWaliAsuh",JSON.stringify(m)),s(m)}else throw new Error("Data tidak valid dari API")}).catch(i=>{console.error("Gagal mengambil data wali asuh:",i),s([{label:"Pilih Wali Asuh",value:"",id:null}])})},[]),t.useEffect(()=>{const b=sessionStorage.getItem("menuWaliAsuh2");if(b)try{r(JSON.parse(b))}catch{sessionStorage.removeItem("menuWaliAsuh2")}else fetch(`${G}dropdown/waliasuh`).then(i=>i.json()).then(i=>{if(Array.isArray(i)){const m=[{label:"Pilih Wali Asuh",value:"",id:""},...i.map(d=>({id:d.id,value:d.nama,label:`${d.nama} (${d.nama_grup})`}))];sessionStorage.setItem("menuWaliAsuh2",JSON.stringify(m)),r(m)}}).catch(()=>r([{label:"Pilih Wali Asuh",value:"",id:""}]))},[]),t.useEffect(()=>{const b=sessionStorage.getItem("menuWaliAsuh3");if(b)try{const i=JSON.parse(b);x(i)}catch(i){console.error("Gagal parsing data dari sessionStorage:",i),sessionStorage.removeItem("menuWaliAsuh3")}else fetch(`${G}data-pokok/waliasuh`).then(i=>i.json()).then(i=>{console.log("Meta response:",i);const m=i.total_data;if(!m||isNaN(m))throw new Error("Gagal mendapatkan total_data");return fetch(`${G}data-pokok/waliasuh?limit=${m}`)}).then(i=>i.json()).then(i=>{if(Array.isArray(i.data)){const m=[{label:"Pilih Wali Asuh",value:"",id:null},...i.data.map(d=>({...d,value:d.nama||"-",label:d.nama||"-"}))];sessionStorage.setItem("menuWaliAsuh3",JSON.stringify(m)),x(m)}else throw new Error("Data tidak valid dari API")}).catch(i=>{console.error("Gagal mengambil data wali asuh:",i),x([{label:"Pilih Wali Asuh",value:"",id:null}])})},[]),{menuWaliAsuh:a,menuWaliAsuh2:l,menuWaliAsuh3:n}},Ta=({waliAsuh:a,setShowSelectWaliAsuh:s})=>a?e.jsxs("div",{className:"relative p-4 pr-12 rounded-md bg-gray-50 shadow-sm mb-6 border border-blue-200",children:[e.jsx("div",{className:"absolute -top-3 left-3 bg-blue-500 text-white text-xs font-semibold px-2 py-1 rounded shadow",children:"Data Wali Asuh/Pencatat"}),e.jsx("button",{type:"button",onClick:()=>s(!0),className:"absolute top-3 right-3 px-2 py-1 rounded hover:bg-blue-700 text-gray-700 bg-blue-500 text-white","aria-label":"Ganti Wali Asuh",children:e.jsx("i",{className:"fas fa-exchange-alt"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:space-x-6 space-y-4 sm:space-y-0",children:[e.jsx("div",{className:"flex justify-center sm:justify-start",children:e.jsx("img",{src:a.foto_profil,alt:a.value,className:"w-32 h-40 object-cover rounded",onError:l=>{l.target.onerror=null,l.target.src=Me}})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-2 text-sm flex-1",children:[e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-1",children:[e.jsx("span",{className:"font-semibold",children:"Nama"})," ",e.jsxs("span",{children:[": ",a.value]}),e.jsx("span",{className:"font-semibold",children:"NIS"})," ",e.jsxs("span",{children:[": ",a.nis]}),e.jsx("span",{className:"font-semibold",children:"Angkatan"})," ",e.jsxs("span",{children:[": ",a.angkatan]}),e.jsx("span",{className:"font-semibold",children:"Kota Asal"})," ",e.jsxs("span",{children:[": ",a.kota_asal]})]}),e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-1",children:[e.jsx("span",{className:"font-semibold",children:"Wilayah"})," ",e.jsxs("span",{children:[": ",a.wilayah]}),e.jsx("span",{className:"font-semibold",children:"Blok"})," ",e.jsxs("span",{children:[": ",a.blok]}),e.jsx("span",{className:"font-semibold",children:"Kamar"})," ",e.jsxs("span",{children:[": ",a.kamar]})]})]})]})]}):null,gt=({santri:a,setShowSelectSantri:s})=>a?e.jsxs("div",{className:"relative p-4 pr-12 rounded-md bg-gray-50 shadow-sm mb-6 border border-blue-200",children:[e.jsx("div",{className:"absolute -top-3 left-3 bg-blue-500 text-white text-xs font-semibold px-2 py-1 rounded shadow",children:"Data Santri"}),e.jsx("button",{type:"button",onClick:()=>s(!0),className:"absolute top-3 right-3 px-2 py-1 rounded hover:bg-blue-700 text-gray-700 bg-blue-500 text-white","aria-label":"Ganti Santri",children:e.jsx("i",{className:"fas fa-exchange-alt"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:space-x-6 space-y-4 sm:space-y-0",children:[e.jsx("div",{className:"flex justify-center sm:justify-start",children:e.jsx("img",{src:a.foto_profil,alt:a.value,className:"w-32 h-40 object-cover rounded",onError:l=>{l.target.onerror=null,l.target.src=Me}})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-2 text-sm flex-1",children:[e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-1",children:[e.jsx("span",{className:"font-semibold",children:"Nama"})," ",e.jsxs("span",{children:[": ",a.value]}),e.jsx("span",{className:"font-semibold",children:"NIS"})," ",e.jsxs("span",{children:[": ",a.nis]}),e.jsx("span",{className:"font-semibold",children:"NIUP"})," ",e.jsxs("span",{children:[": ",a.niup]}),e.jsx("span",{className:"font-semibold",children:"Angkatan"})," ",e.jsxs("span",{children:[": ",a.angkatan]}),e.jsx("span",{className:"font-semibold",children:"Kota Asal"})," ",e.jsxs("span",{children:[": ",a.kota_asal]})]}),e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-1",children:[e.jsx("span",{className:"font-semibold",children:"Lembaga"})," ",e.jsxs("span",{children:[": ",a.lembaga]}),e.jsx("span",{className:"font-semibold",children:"Wilayah"})," ",e.jsxs("span",{children:[": ",a.wilayah]}),e.jsx("span",{className:"font-semibold",children:"Blok"})," ",e.jsxs("span",{children:[": ",a.blok]}),e.jsx("span",{className:"font-semibold",children:"Kamar"})," ",e.jsxs("span",{children:[": ",a.kamar]})]})]})]})]}):null,xa=({isOpen:a,onClose:s,onWaliAsuhSelected:l})=>{const[r,n]=t.useState(""),{menuWaliAsuh3:x}=la(),b=x.filter(i=>{var m;return i.value.toLowerCase().includes(r.toLowerCase())||((m=i.nis)==null?void 0:m.toString().includes(r))});return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"relative z-50",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"w-full h-full max-w-4xl transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl",children:[e.jsx(re.Title,{className:"text-lg font-medium text-gray-900 mb-4 text-center",children:"Pilih Wali Asuh"}),e.jsx("input",{type:"text",placeholder:"Cari nama atau NIS...",className:"w-full p-2 border rounded mb-4",value:r,onChange:i=>n(i.target.value)}),e.jsx("div",{className:"overflow-x-auto max-h-[400px] overflow-y-auto rounded",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2",children:"NIS"}),e.jsx("th",{className:"p-2",children:"Nama"}),e.jsx("th",{className:"p-2",children:"Wilayah"}),e.jsx("th",{className:"p-2",children:"Blok"}),e.jsx("th",{className:"p-2",children:"Kamar"})]})}),e.jsx("tbody",{children:b.filter(i=>i.id!==null).map((i,m)=>e.jsxs("tr",{className:"hover:bg-blue-50 cursor-pointer",onClick:()=>{l(i),s()},children:[e.jsx("td",{className:"p-2",children:i.nis}),e.jsx("td",{className:"p-2",children:i.nama}),e.jsx("td",{className:"p-2",children:i.wilayah}),e.jsx("td",{className:"p-2",children:i.blok}),e.jsx("td",{className:"p-2",children:i.kamar})]},m))})]})})]})})})})]})})},Rs=({isOpen:a,onClose:s,refetchData:l})=>{const{menuWaliAsuh:r}=la(),[n,x]=t.useState(!1),[b,i]=t.useState(""),[m,d]=t.useState(!1),[p,g]=t.useState(""),h=["A","B","C","D","E"],{clearAuthData:c}=ke(),o=je(),[u,w]=t.useState({id_santri:"",id_wali_asuh:"",kepedulian_nilai:"",kepedulian_tindak_lanjut:"",kebersihan_nilai:"",kebersihan_tindak_lanjut:"",akhlak_nilai:"",akhlak_tindak_lanjut:"",tanggal_buat:""});t.useEffect(()=>{i(""),g(""),a&&w({id_santri:"",id_wali_asuh:"",kepedulian_nilai:"",kepedulian_tindak_lanjut:"",kebersihan_nilai:"",kebersihan_tindak_lanjut:"",akhlak_nilai:"",akhlak_tindak_lanjut:"",tanggal_buat:""})},[a]),t.useEffect(()=>{a&&(b!=null&&b.id)&&u.id_wali_asuh!==b.id&&w(f=>({...f,id_wali_asuh:b.id}))},[b,a]),t.useEffect(()=>{a&&(p!=null&&p.id)&&u.id_santri!==p.id&&w(f=>({...f,id_santri:p.id}))},[p,a]);const _=async f=>{if(f.preventDefault(),!u.id_santri){await k.fire({icon:"warning",title:"Santri belum dipilih",text:"Harap pilih Santri terlebih dahulu."});return}if(!u.id_wali_asuh){await k.fire({icon:"warning",title:"Wali Asuh belum dipilih",text:"Harap pilih Wali Asuh terlebih dahulu."});return}if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),console.log("Payload yang dikirim ke API:",JSON.stringify(u,null,2));const S=sessionStorage.getItem("token")||xe("token"),j=await fetch(`${G}crud/catatan-afektif`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S}`},body:JSON.stringify(u)});console.log(`Mengirim ke: ${G}crud/catatan-afektif`);const y=await j.json();if(k.close(),j.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),c(),o("/login");return}if(!j.ok)throw new Error(y.message||"Terjadi kesalahan pada server.");if(!("data"in y)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${y.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),l==null||l(!0),s==null||s()}catch(S){console.error("Terjadi kesalahan:",S),await k.fire({icon:"error",title:"Oops!",text:`Terjadi kesalahan saat mengirim data. ${S}`})}};return e.jsxs(le,{appear:!0,show:a,as:t.Fragment,children:[e.jsxs(re,{as:"div",className:"fixed inset-0 z-50",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"w-full max-w-2xl bg-white rounded-lg shadow-xl relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mt-6",children:"Tambah Data Baru"}),e.jsxs("form",{className:"w-full",onSubmit:_,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4 overflow-y-auto max-h-[70vh]",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsx("div",{className:"mt-2 sm:mt-0 text-left w-full",children:e.jsxs("div",{className:"space-y-4",children:[b?e.jsx(Ta,{waliAsuh:b,setShowSelectWaliAsuh:x}):e.jsxs("div",{className:"text-center bg-gray-100 p-6 rounded-md border border-dashed border-gray-400",children:[e.jsx("p",{className:"text-gray-600 mb-3",children:"Belum ada data Wali Asuh/Pencatat dipilih"}),e.jsx("button",{type:"button",onClick:()=>x(!0),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Pilih Wali Asuh"})]}),p?e.jsx(gt,{santri:p,setShowSelectSantri:d}):e.jsxs("div",{className:"text-center bg-gray-100 p-6 rounded-md border border-dashed border-gray-400",children:[e.jsx("p",{className:"text-gray-600 mb-3",children:"Belum ada data Santri dipilih"}),e.jsx("button",{type:"button",onClick:()=>d(!0),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Pilih Santri"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kepedulian_nilai",className:"block text-gray-700",children:"Nilai Kepedulian *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${r.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:f=>w({...u,kepedulian_nilai:f.target.value}),value:u.kepedulian_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),h.map(f=>e.jsx("option",{value:f,children:f},f))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kepedulian_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Kepedulian *"}),e.jsx("textarea",{name:"kepedulian_tindak_lanjut",onChange:f=>w({...u,kepedulian_tindak_lanjut:f.target.value}),value:u.kepedulian_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kebersihan_nilai",className:"block text-gray-700",children:"Nilai Kebersihan *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${r.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:f=>w({...u,kebersihan_nilai:f.target.value}),value:u.kebersihan_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),h.map(f=>e.jsx("option",{value:f,children:f},f))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kebersihan_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Kebersihan *"}),e.jsx("textarea",{name:"kebersihan_tindak_lanjut",onChange:f=>w({...u,kebersihan_tindak_lanjut:f.target.value}),value:u.kebersihan_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"akhlak_nilai",className:"block text-gray-700",children:"Nilai Akhlak *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${r.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:f=>w({...u,akhlak_nilai:f.target.value}),value:u.akhlak_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),h.map(f=>e.jsx("option",{value:f,children:f},f))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"akhlak_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Akhlak *"}),e.jsx("textarea",{name:"akhlak_tindak_lanjut",onChange:f=>w({...u,akhlak_tindak_lanjut:f.target.value}),value:u.akhlak_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_buat",className:"block text-gray-700",children:"Tanggal Buat *"}),e.jsx("input",{type:"date",id:"tanggal_buat",name:"tanggal_buat",value:u.tanggal_buat,onChange:f=>w({...u,tanggal_buat:f.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})})})}),e.jsxs("div",{className:"bg-gray-100 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse rounded-b-lg",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm cursor-pointer",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]}),e.jsx(xa,{isOpen:n,onClose:()=>x(!1),onWaliAsuhSelected:f=>i(f)}),e.jsx(ha,{isOpen:m,onClose:()=>d(!1),onSantriSelected:f=>g(f)})]})},Es=({isOpen:a,onClose:s,refetchData:l})=>{const{clearAuthData:r}=ke(),n=je(),{menuWaliAsuh:x}=la(),[b,i]=t.useState(!1),[m,d]=t.useState(""),[p,g]=t.useState(!1),[h,c]=t.useState(""),o=["A","B","C","D","E"],[u,w]=t.useState({id_santri:"",id_wali_asuh:"",kebahasaan_nilai:"",kebahasaan_tindak_lanjut:"",baca_kitab_kuning_nilai:"",baca_kitab_kuning_tindak_lanjut:"",hafalan_tahfidz_nilai:"",hafalan_tahfidz_tindak_lanjut:"",furudul_ainiyah_nilai:"",furudul_ainiyah_tindak_lanjut:"",tulis_alquran_nilai:"",tulis_alquran_tindak_lanjut:"",baca_alquran_nilai:"",baca_alquran_tindak_lanjut:"",tanggal_buat:""});t.useEffect(()=>{d(""),c(""),a&&w({id_santri:"",id_wali_asuh:"",kebahasaan_nilai:"",kebahasaan_tindak_lanjut:"",baca_kitab_kuning_nilai:"",baca_kitab_kuning_tindak_lanjut:"",hafalan_tahfidz_nilai:"",hafalan_tahfidz_tindak_lanjut:"",furudul_ainiyah_nilai:"",furudul_ainiyah_tindak_lanjut:"",tulis_alquran_nilai:"",tulis_alquran_tindak_lanjut:"",baca_alquran_nilai:"",baca_alquran_tindak_lanjut:"",tanggal_buat:""})},[a]),t.useEffect(()=>{a&&(m!=null&&m.id)&&u.id_wali_asuh!==m.id&&w(f=>({...f,id_wali_asuh:m.id}))},[m,a]),t.useEffect(()=>{a&&(h!=null&&h.id)&&u.id_santri!==h.id&&w(f=>({...f,id_santri:h.id}))},[h,a]);const _=async f=>{if(f.preventDefault(),!u.id_santri){await k.fire({icon:"warning",title:"Santri belum dipilih",text:"Harap pilih Santri terlebih dahulu."});return}if(!u.id_wali_asuh){await k.fire({icon:"warning",title:"Wali Asuh belum dipilih",text:"Harap pilih Wali Asuh terlebih dahulu."});return}if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),console.log("Payload yang dikirim ke API:",JSON.stringify(u,null,2));const S=sessionStorage.getItem("token")||xe("token"),j=await fetch(`${G}crud/catatan-kognitif`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S}`},body:JSON.stringify(u)});console.log(`Mengirim ke: ${G}crud/catatan-kognitif`);const y=await j.json();if(k.close(),j.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r(),n("/login");return}if(!j.ok)throw new Error(y.message||"Terjadi kesalahan pada server.");if(!("data"in y)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${y.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),l==null||l(!0),s==null||s()}catch(S){console.error("Terjadi kesalahan:",S),await k.fire({icon:"error",title:"Oops!",text:`Terjadi kesalahan saat mengirim data. ${S}`})}};return e.jsxs(le,{appear:!0,show:a,as:t.Fragment,children:[e.jsxs(re,{as:"div",className:"fixed inset-0 z-50",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"w-full max-w-2xl bg-white rounded-lg shadow-xl relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mt-6",children:"Tambah Data Baru"}),e.jsxs("form",{className:"w-full",onSubmit:_,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4 overflow-y-auto max-h-[70vh]",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsx("div",{className:"mt-2 sm:mt-0 text-left w-full",children:e.jsxs("div",{className:"space-y-4",children:[m?e.jsx(Ta,{waliAsuh:m,setShowSelectWaliAsuh:i}):e.jsxs("div",{className:"text-center bg-gray-100 p-6 rounded-md border border-dashed border-gray-400",children:[e.jsx("p",{className:"text-gray-600 mb-3",children:"Belum ada data Wali Asuh/Pencatat dipilih"}),e.jsx("button",{type:"button",onClick:()=>i(!0),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Pilih Wali Asuh"})]}),h?e.jsx(gt,{santri:h,setShowSelectSantri:g}):e.jsxs("div",{className:"text-center bg-gray-100 p-6 rounded-md border border-dashed border-gray-400",children:[e.jsx("p",{className:"text-gray-600 mb-3",children:"Belum ada data Santri dipilih"}),e.jsx("button",{type:"button",onClick:()=>g(!0),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Pilih Santri"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kebahasaan_nilai",className:"block text-gray-700",children:"Nilai Kebahasaan *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:f=>w({...u,kebahasaan_nilai:f.target.value}),value:u.kebahasaan_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),o.map(f=>e.jsx("option",{value:f,children:f},f))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kebahasaan_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Kebahasaan *"}),e.jsx("textarea",{name:"kebahasaan_tindak_lanjut",onChange:f=>w({...u,kebahasaan_tindak_lanjut:f.target.value}),value:u.kebahasaan_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"baca_kitab_kuning_nilai",className:"block text-gray-700",children:"Nilai Baca Kitab Kuning *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:f=>w({...u,baca_kitab_kuning_nilai:f.target.value}),value:u.baca_kitab_kuning_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),o.map(f=>e.jsx("option",{value:f,children:f},f))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"baca_kitab_kuning_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Baca Kitab Kuning *"}),e.jsx("textarea",{name:"baca_kitab_kuning_tindak_lanjut",onChange:f=>w({...u,baca_kitab_kuning_tindak_lanjut:f.target.value}),value:u.baca_kitab_kuning_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"hafalan_tahfidz_nilai",className:"block text-gray-700",children:"Nilai Hafalan Tahfidz *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:f=>w({...u,hafalan_tahfidz_nilai:f.target.value}),value:u.hafalan_tahfidz_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),o.map(f=>e.jsx("option",{value:f,children:f},f))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"hafalan_tahfidz_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Hafalan Tahfidz *"}),e.jsx("textarea",{name:"hafalan_tahfidz_tindak_lanjut",onChange:f=>w({...u,hafalan_tahfidz_tindak_lanjut:f.target.value}),value:u.hafalan_tahfidz_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"furudul_ainiyah_nilai",className:"block text-gray-700",children:"Nilai Furudul Ainiyah *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:f=>w({...u,furudul_ainiyah_nilai:f.target.value}),value:u.furudul_ainiyah_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),o.map(f=>e.jsx("option",{value:f,children:f},f))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"furudul_ainiyah_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Furudul Ainiyah *"}),e.jsx("textarea",{name:"furudul_ainiyah_tindak_lanjut",onChange:f=>w({...u,furudul_ainiyah_tindak_lanjut:f.target.value}),value:u.furudul_ainiyah_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tulis_alquran_nilai",className:"block text-gray-700",children:"Nilai Tulis Al-Quran *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:f=>w({...u,tulis_alquran_nilai:f.target.value}),value:u.tulis_alquran_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),o.map(f=>e.jsx("option",{value:f,children:f},f))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tulis_alquran_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Tulis Al-Quran *"}),e.jsx("textarea",{name:"tulis_alquran_tindak_lanjut",onChange:f=>w({...u,tulis_alquran_tindak_lanjut:f.target.value}),value:u.tulis_alquran_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"baca_alquran_nilai",className:"block text-gray-700",children:"Nilai Baca Al-Quran *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:f=>w({...u,baca_alquran_nilai:f.target.value}),value:u.baca_alquran_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),o.map(f=>e.jsx("option",{value:f,children:f},f))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"baca_alquran_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Baca Al-Quran *"}),e.jsx("textarea",{name:"baca_alquran_tindak_lanjut",onChange:f=>w({...u,baca_alquran_tindak_lanjut:f.target.value}),value:u.baca_alquran_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_buat",className:"block text-gray-700",children:"Tanggal Buat *"}),e.jsx("input",{type:"date",id:"tanggal_buat",name:"tanggal_buat",value:u.tanggal_buat,onChange:f=>w({...u,tanggal_buat:f.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})})})}),e.jsxs("div",{className:"bg-gray-100 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse rounded-b-lg",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm cursor-pointer",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]}),e.jsx(xa,{isOpen:b,onClose:()=>i(!1),onWaliAsuhSelected:f=>d(f)}),e.jsx(ha,{isOpen:p,onClose:()=>g(!1),onSantriSelected:f=>c(f)})]})},Ke=a=>{const s=localStorage.getItem("roles")||sessionStorage.getItem("roles")||"[]",l=JSON.parse(s);return(os[a]||[]).some(n=>l.includes(n))},ye=({action:a,children:s})=>Ke(a)?e.jsx(e.Fragment,{children:s}):null,Us=()=>{var U,q,se,Y,de,oe,W,X,ae,O,K;const[a,s]=t.useState({negara:"",provinsi:"",kabupaten:"",kecamatan:"",wilayah:"",blok:"",kamar:"",lembaga:"",jurusan:"",kelas:"",rombel:"",jenisKelamin:"",kategori:"",nilai:"",periode:""});t.useEffect(()=>{(async()=>{try{const ce=(await(await fetch(`${G}dropdown/periode`)).json()).afektif,fe=[{label:"Semua Periode",value:""},...ce.map(H=>({label:H,value:H}))];r(fe)}catch(ee){console.error("Gagal mengambil data periode:",ee)}finally{}})()},[]);const[l,r]=t.useState([]),{filterNegara:n,selectedNegara:x,handleFilterChangeNegara:b}=Ae(),{filterWilayah:i,selectedWilayah:m,handleFilterChangeWilayah:d}=Be(),{filterLembaga:p,selectedLembaga:g,handleFilterChangeLembaga:h}=Te(),c=((U=n.negara.find(A=>A.value==x.negara))==null?void 0:U.label)||"",o=((q=n.provinsi.find(A=>A.value==x.provinsi))==null?void 0:q.label)||"",u=((se=n.kabupaten.find(A=>A.value==x.kabupaten))==null?void 0:se.label)||"",w=((Y=n.kecamatan.find(A=>A.value==x.kecamatan))==null?void 0:Y.label)||"",_=((de=i.wilayah.find(A=>A.value==m.wilayah))==null?void 0:de.label)||"",f=((oe=i.blok.find(A=>A.value==m.blok))==null?void 0:oe.label)||"",v=((W=i.kamar.find(A=>A.value==m.kamar))==null?void 0:W.label)||"",S=((X=p.lembaga.find(A=>A.value==g.lembaga))==null?void 0:X.label)||"",j=((ae=p.jurusan.find(A=>A.value==g.jurusan))==null?void 0:ae.label)||"",y=((O=p.kelas.find(A=>A.value==g.kelas))==null?void 0:O.label)||"",N=((K=p.rombel.find(A=>A.value==g.rombel))==null?void 0:K.label)||"",T=t.useMemo(()=>({...a,negara:c,provinsi:o,kabupaten:u,kecamatan:w,wilayah:_,blok:f,kamar:v,lembaga:S,jurusan:j,kelas:y,rombel:N}),[a,c,o,u,w,_,f,v,S,j,y,N]),{groupedData:C,loading:P,error:F,limit:M,setLimit:L,totalData:I,totalPages:D,currentPage:Q,setCurrentPage:E,searchTerm:B,setSearchTerm:V,fetchData:ne}=ds(T),[te,R]=t.useState(!1),Z={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],kategori:[{label:"Semua Materi",value:""},{label:"Akhlak",value:"akhlak"},{label:"Kebersihan",value:"kebersihan"},{label:"Kepedulian",value:"kepedulian"}],nilai:[{label:"Semua Score",value:""},{label:"Score A",value:"A"},{label:"Score B",value:"B"},{label:"Score C",value:"C"},{label:"Score D",value:"D"},{label:"Score E",value:"E"}],periode:l},z=A=>{A>=1&&A<=D&&E(A)},[me,he]=t.useState(!1);return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Catatan Afektif"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>he(!0),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer flex items-center gap-2",children:[e.jsx(Ee,{}),"Tambah"]})})})]}),me&&e.jsx(Rs,{isOpen:me,onClose:()=>he(!1),refetchData:ne}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${te?"mb-4":""}`,children:[e.jsx(ue,{showFilters:te,filterOptions:n,onChange:b,selectedFilters:x}),e.jsx(ue,{showFilters:te,filterOptions:i,onChange:d,selectedFilters:m}),e.jsx(ue,{showFilters:te,filterOptions:p,onChange:h,selectedFilters:g}),e.jsx(ue,{showFilters:te,filterOptions:{...Z,nilai:a.kategori?Z.nilai:[{label:"Semua Score",value:"",disabled:!0}],periode:Z.periode},onChange:A=>s(ee=>({...ee,...A})),selectedFilters:a})]}),e.jsx(Ce,{searchTerm:B,setSearchTerm:V,totalData:I,limit:M,toggleLimit:A=>L(Number(A.target.value)),toggleFilters:()=>R(!te),showViewButtons:!1}),e.jsxs("div",{children:[F&&e.jsxs("div",{className:"bg-red-50 text-red-600 p-3 rounded mb-4",children:["Error: ",F]}),e.jsx("div",{className:"space-y-4",children:P?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):Object.values(C).length>0?Object.values(C).map(A=>e.jsx(xt,{santri:A,menu:19},A.id_santri)):e.jsx("p",{className:"text-center py-8 text-gray-500",children:"Tidak ada data"})})]}),D>1&&e.jsx(Fe,{currentPage:Q,totalPages:D,handlePageChange:z})]})]})},qs=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const y=setTimeout(()=>{f(c)},400);return()=>clearTimeout(y)},[c]);const S=t.useCallback(async(y=!1)=>{let N=`${G}data-pokok/catatan-kognitif?limit=${i}`;if(u>1&&(N+=`&page=${u}`),_&&(N+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(N+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(N+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(N+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(N+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&(N+=`&wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&(N+=`&blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&(N+=`&kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(N+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&(N+=`&jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&(N+=`&kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&(N+=`&rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.jenisKelamin&&(N+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.kategori&&a.kategori!==""&&(N+=`&kategori=${encodeURIComponent(a.kategori)}`),a!=null&&a.nilai&&a.nilai!==""&&(N+=`&score=${encodeURIComponent(a.nilai)}`),a!=null&&a.periode&&a.periode!==""&&(N+=`&periode=${encodeURIComponent(a.periode)}`),!y&&v.current===N){console.log("Skip duplicate request");return}v.current=N,console.log("Fetching data from:",N),n(!0),b(null);try{const T=await fetch(N);if(!T.ok)throw new Error(`HTTP ${T.status}`);const C=await T.json();console.log("Data Catatan Kognitif:",C),l(C.data||[]),p(C.total_data||0),h(C.total_pages||1)}catch(T){b(T.message),l([])}finally{n(!1)}},[u,a,i,_]);t.useEffect(()=>{S(a)},[S,a]),t.useEffect(()=>{w(1)},[i]);const j=t.useMemo(()=>s.reduce((y,N)=>{const T=N.id_santri;return y[T]||(y[T]={...N,catatan:[]}),y[T].catatan.push(N),y},{}),[s]);return{catatanKognitif:s,groupedData:j,loading:r,error:x,searchTerm:c,setSearchTerm:o,limit:i,setLimit:m,totalData:d,totalPages:g,currentPage:u,setCurrentPage:w,fetchData:S}},zs=()=>{var U,q,se,Y,de,oe,W,X,ae,O,K;const[a,s]=t.useState({negara:"",provinsi:"",kabupaten:"",kecamatan:"",lembaga:"",jurusan:"",kelas:"",rombel:"",jenisKelamin:"",kategori:"",nilai:"",periode:""});t.useEffect(()=>{(async()=>{try{const ce=(await(await fetch(`${G}dropdown/periode`)).json()).kognitif,fe=[{label:"Semua Periode",value:""},...ce.map(H=>({label:H,value:H}))];r(fe)}catch(ee){console.error("Gagal mengambil data periode:",ee)}finally{}})()},[]);const[l,r]=t.useState([]),{filterNegara:n,selectedNegara:x,handleFilterChangeNegara:b}=Ae(),{filterWilayah:i,selectedWilayah:m,handleFilterChangeWilayah:d}=Be(),{filterLembaga:p,selectedLembaga:g,handleFilterChangeLembaga:h}=Te(),c=((U=n.negara.find(A=>A.value==x.negara))==null?void 0:U.label)||"",o=((q=n.provinsi.find(A=>A.value==x.provinsi))==null?void 0:q.label)||"",u=((se=n.kabupaten.find(A=>A.value==x.kabupaten))==null?void 0:se.label)||"",w=((Y=n.kecamatan.find(A=>A.value==x.kecamatan))==null?void 0:Y.label)||"",_=((de=i.wilayah.find(A=>A.value==m.wilayah))==null?void 0:de.label)||"",f=((oe=i.blok.find(A=>A.value==m.blok))==null?void 0:oe.label)||"",v=((W=i.kamar.find(A=>A.value==m.kamar))==null?void 0:W.label)||"",S=((X=p.lembaga.find(A=>A.value==g.lembaga))==null?void 0:X.label)||"",j=((ae=p.jurusan.find(A=>A.value==g.jurusan))==null?void 0:ae.label)||"",y=((O=p.kelas.find(A=>A.value==g.kelas))==null?void 0:O.label)||"",N=((K=p.rombel.find(A=>A.value==g.rombel))==null?void 0:K.label)||"",T=t.useMemo(()=>({...a,negara:c,provinsi:o,kabupaten:u,kecamatan:w,wilayah:_,blok:f,kamar:v,lembaga:S,jurusan:j,kelas:y,rombel:N}),[a,c,o,u,w,_,f,v,S,j,y,N]),{groupedData:C,loading:P,error:F,limit:M,setLimit:L,totalData:I,totalPages:D,currentPage:Q,setCurrentPage:E,searchTerm:B,setSearchTerm:V,fetchData:ne}=qs(T),[te,R]=t.useState(!1),Z=A=>{A>=1&&A<=D&&E(A)},z={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],kategori:[{label:"Semua Materi",value:""},{label:"Kebahasaan",value:"kebahasaan"},{label:"Baca kitab kuning",value:"baca kitab kuning"},{label:"Hafalan / Tahfidz",value:"hafalan tahfidz"},{label:"Furudhul Ainiyah",value:"furudul ainiyah"},{label:"Tulis Al-Quran",value:"tulis al-quran"},{label:"Baca Al-Quran",value:"baca al-quran"}],nilai:[{label:"Semua Score",value:""},{label:"Score A",value:"A"},{label:"Score B",value:"B"},{label:"Score C",value:"C"},{label:"Score D",value:"D"},{label:"Score E",value:"E"}],periode:l},[me,he]=t.useState(!1);return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Catatan Kognitif"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>he(!0),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer flex items-center gap-2",children:[e.jsx(Ee,{}),"Tambah"]})})})]}),me&&e.jsx(Es,{isOpen:me,onClose:()=>he(!1),refetchData:ne}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${te?"mb-4":""}`,children:[e.jsx(ue,{showFilters:te,filterOptions:n,onChange:b,selectedFilters:x}),e.jsx(ue,{showFilters:te,filterOptions:i,onChange:d,selectedFilters:m}),e.jsx(ue,{showFilters:te,filterOptions:p,onChange:h,selectedFilters:g}),e.jsx(ue,{showFilters:te,filterOptions:{...z,nilai:a.kategori?z.nilai:[{label:"Semua Score",value:"",disabled:!0}],periode:z.periode},onChange:A=>s(ee=>({...ee,...A})),selectedFilters:a})]}),e.jsx(Ce,{searchTerm:B,setSearchTerm:V,totalData:I,limit:M,toggleLimit:A=>L(Number(A.target.value)),toggleFilters:()=>R(!te),showViewButtons:!1}),e.jsxs("div",{children:[F&&e.jsxs("div",{className:"bg-red-50 text-red-600 p-3 rounded mb-4",children:["Error: ",F]}),e.jsx("div",{className:"space-y-4",children:P?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):Object.values(C).length>0?Object.values(C).map(A=>e.jsx(xt,{santri:A,menu:20},A.id_santri)):e.jsx("p",{className:"text-center py-8 text-gray-500",children:"Tidak ada data"})})]}),D>1&&e.jsx(Fe,{currentPage:Q,totalPages:D,handlePageChange:Z})]})]})},Ws=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),_=t.useRef(""),[f,v]=t.useState(c);t.useEffect(()=>{const y=setTimeout(()=>{v(c)},400);return()=>{clearTimeout(y)}},[c]);const S=t.useCallback(async(y=!1)=>{let N=`${G}data-pokok/pelanggaran?limit=${i}&page=${u}`;if(f&&(N+=`&nama=${encodeURIComponent(f)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&(N+=`&wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&(N+=`&blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&(N+=`&kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(N+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&(N+=`&jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&(N+=`&kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&(N+=`&rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.jenisKelamin&&a.jenisKelamin!==""&&(N+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.status_pelanggaran&&a.status_pelanggaran!==""&&(N+=`&status_pelanggaran=${encodeURIComponent(a.status_pelanggaran)}`),a!=null&&a.jenis_putusan&&a.jenis_putusan!==""&&(N+=`&jenis_putusan=${encodeURIComponent(a.jenis_putusan)}`),a!=null&&a.jenis_pelanggaran&&a.jenis_pelanggaran!==""&&(N+=`&jenis_pelanggaran=${encodeURIComponent(a.jenis_pelanggaran)}`),!y&&_.current===N){console.log("Skip duplicate request");return}_.current=N,console.log("Fetching data from:",N);try{n(!0);const T=await fetch(N);if(!T.ok)throw new Error(`HTTP ${T.status}`);const C=await T.json(),P=C.data.map(F=>({...F,tgl_input:F.tgl_input,foto_profil:F.foto_profil||null}));l(P),p(C.total_data||0),h(C.total_pages||1),w(C.current_page||1)}catch(T){b(T.message),l([])}finally{n(!1)}},[u,a,i,f]);t.useEffect(()=>{S(a)},[S,a]);const j=t.useMemo(()=>{const y={provinsi:[],kabupaten:[],kecamatan:[],lembaga:[],jenis_pelanggaran:[],status_pelanggaran:[]};return s.forEach(N=>{Object.keys(y).forEach(T=>{N[T]&&!y[T].includes(N[T])&&y[T].push(N[T])})}),y},[s]);return{data:s,loading:r,error:x,limit:i,setLimit:m,totalData:d,totalPages:g,currentPage:u,setCurrentPage:w,searchTerm:c,setSearchTerm:o,filterOptions:j,fetchData:S}},Js=()=>{var Y,de,oe,W,X,ae,O;const[a,s]=t.useState(null),[l,r]=t.useState(""),[n,x]=t.useState(null),[b,i]=t.useState(!1),[m,d]=t.useState(""),p=K=>{s(K),i(!0)},g=()=>{s(null),i(!1)},[h,c]=t.useState({provinsi:" ",lembaga:"",jurusan:"",kelas:"",rombel:"",jenis_pelanggaran:" ",status_pelanggaran:" "}),{filterLembaga:o,selectedLembaga:u,handleFilterChangeLembaga:w}=Te(),{filterWilayah:_,selectedWilayah:f,handleFilterChangeWilayah:v}=Be(),S=((Y=_.wilayah.find(K=>K.value==f.wilayah))==null?void 0:Y.label)||"",j=((de=_.blok.find(K=>K.value==f.blok))==null?void 0:de.label)||"",y=((oe=_.kamar.find(K=>K.value==f.kamar))==null?void 0:oe.label)||"",N=((W=o.lembaga.find(K=>K.value==u.lembaga))==null?void 0:W.label)||"",T=((X=o.jurusan.find(K=>K.value==u.jurusan))==null?void 0:X.label)||"",C=((ae=o.kelas.find(K=>K.value==u.kelas))==null?void 0:ae.label)||"",P=((O=o.rombel.find(K=>K.value==u.rombel))==null?void 0:O.label)||"",F=t.useMemo(()=>({...h,wilayah:S,blok:j,kamar:y,lembaga:N,jurusan:T,kelas:C,rombel:P}),[j,h,T,y,C,N,P,S]),{data:M,loading:L,error:I,limit:D,setLimit:Q,totalData:E,totalPages:B,currentPage:V,setCurrentPage:ne,searchTerm:te,setSearchTerm:R,fetchData:Z}=Ws(F),[z,me]=t.useState(!1);t.useEffect(()=>{Z(F,h)},[F,h,Z]);const he=K=>{K>=1&&K<=B&&ne(K)},U={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],status_pelanggaran:[{label:"Pilih Status Pelanggaran",value:""},{label:"Sudah diproses",value:"Sudah diproses"},{label:"Sedang diproses",value:"Sedang diproses"},{label:"Belum diproses",value:"Belum diproses"}],jenis_putusan:[{label:"Pilih Jenis Putusan",value:""},{label:"Belum ada putusan",value:"Belum ada putusan"},{label:"Disanksi",value:"Disanksi"},{label:"Dibebaskan",value:"Dibebaskan"}],jenis_pelanggaran:[{label:"Pilih Jenis Pelanggaran",value:""},{label:"Ringan",value:"Ringan"},{label:"Sedang",value:"Sedang"},{label:"Berat",value:"Berat"}]},[q,se]=t.useState(!1);return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Pelanggaran"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>{d(1),se(!0)},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer flex items-center gap-2",children:[e.jsx(Ee,{}),"Tambah"]})})})]}),e.jsx(Cs,{isOpen:q,onClose:()=>se(!1),refetchData:Z,feature:m,id:n,nama:l}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${z?"mb-4":""}`,children:[e.jsx(ue,{showFilters:z,filterOptions:_,onChange:v,selectedFilters:f}),e.jsx(ue,{showFilters:z,filterOptions:o,onChange:w,selectedFilters:u}),e.jsx(ue,{showFilters:z,filterOptions:U,onChange:K=>c(A=>({...A,...K})),selectedFilters:h})]}),e.jsx(Ce,{searchTerm:te,setSearchTerm:R,totalData:E,limit:D,toggleLimit:K=>Q(Number(K.target.value)),toggleFilters:()=>me(!z),showViewButtons:!1}),e.jsxs("div",{children:[I&&e.jsxs("div",{className:"bg-red-50 text-red-600 p-3 rounded mb-4",children:["Error: ",I]}),e.jsx("div",{className:"space-y-4",children:L?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):M.length>0?e.jsx("div",{className:"",children:M.map(K=>e.jsx(Gs,{data:K,openModal:p,setShowFormModal:se,setFeature:d,setSelectedId:x,setSelectedName:r},K.id))}):e.jsx("p",{className:"text-center py-8 text-gray-500",children:"Tidak ada data pelanggaran"})})]}),e.jsx(Fe,{currentPage:V,totalPages:B,handlePageChange:he,className:"mt-6"}),b&&e.jsx(De,{title:"Pelanggaran",menu:18,item:a,onClose:g})]})]})},Gs=({data:a,openModal:s,setShowFormModal:l,setFeature:r,setSelectedId:n,setSelectedName:x})=>e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"absolute top-2 right-2 z-10",children:e.jsx(ye,{action:"edit",children:e.jsxs("button",{onClick:b=>{b.stopPropagation(),r(2),n(a.id),x(a.nama_santri),l(!0)},className:"flex items-center gap-2 px-3 py-1 text-sm text-white bg-blue-600 hover:bg-blue-700 rounded shadow cursor-pointer",children:[e.jsx("i",{className:"fas fa-edit"}),e.jsx("span",{children:"Edit"})]})})}),e.jsxs("div",{className:"flex flex-wrap p-4 rounded-lg shadow-sm gap-4 items-center bg-white mb-4 cursor-pointer",onClick:()=>s(a),children:[e.jsx("div",{className:"w-24 h-24 rounded-md bg-gray-200 flex items-center justify-center overflow-hidden",children:a.foto_profil?e.jsx("img",{src:a.foto_profil,alt:a.nama_santri,className:"w-full h-full object-cover",onError:b=>{b.target.onerror=null,b.target.src=Me}}):e.jsx("i",{className:"fas fa-user text-gray-400 text-4xl"})}),e.jsxs("div",{className:"flex-1 space-y-2 min-w-[200px]",children:[e.jsx("h2",{className:"text-lg font-semibold",children:a.nama_santri}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-24 text-black-700",children:"Domisili"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-black-600",children:[": ",a.wilayah," - ",a.blok," ",a.kamar]})})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-24 text-black-700",children:"Pendidikan"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-black-600",children:[": ",a.lembaga]})})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-24 text-black-700",children:"Alamat"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-black-600",children:[": ",a.kabupaten,", ",a.provinsi]})})]}),e.jsx("br",{}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-24 text-black-700",children:"Pencatat"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-black-600",children:[": (",a.pencatat,")"]})})]})]}),e.jsxs("div",{className:"mt-6 md:mt-0 md:pl-8 md:w-1/2",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"Pelanggaran"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-40 text-black-700",children:"Kategori"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:`text-black-600 ${a.jenis_pelanggaran==="Berat"?"text-red-600":a.jenis_pelanggaran==="Sedang"?"text-orange-600":"text-yellow-600"}`,children:[": ",a.jenis_pelanggaran]})})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-40 text-black-700",children:"Diproses Mahkamah"}),e.jsx("div",{className:"flex-1 flex items-center",children:e.jsxs("span",{className:"text-black-600",children:[": ",a.diproses_mahkamah?e.jsxs(e.Fragment,{children:["Ya ",e.jsx(ge,{icon:qa,className:"text-green-600",size:"md"})]}):e.jsxs(e.Fragment,{children:["Tidak ",e.jsx(ge,{icon:Vt,className:"text-red-600",size:"sm"})]})]})})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-40 text-black-700",children:"Status"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:`text-black-600 font-medium ${a.status_pelanggaran==="Sudah diproses"?"text-green-600":a.status_pelanggaran==="Sedang diproses"?"text-yellow-600":"text-gray-600"}`,children:[": ",a.status_pelanggaran]})})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-40 text-black-700",children:"Jenis"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-black-600",children:[": ",a.keterangan]})})]})]}),e.jsx("div",{className:"mt-4 text-right text-gray-500 text-sm",children:a.tgl_input})]})]})]},a.id),Oa=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(10),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),_=t.useRef(""),[f,v]=t.useState(c);t.useEffect(()=>{const y=setTimeout(()=>{v(c)},400);return()=>{clearTimeout(y)}},[c]);const S=t.useCallback(async(y=!1)=>{let N=`${G}data-pokok/perizinan?limit=${i}`;if(u>1&&(N+=`&page=${u}`),f&&(N+=`&nama=${encodeURIComponent(f)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(N+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(N+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(N+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(N+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&(N+=`&wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&(N+=`&blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&(N+=`&kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(N+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&(N+=`&jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&(N+=`&kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&(N+=`&rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.jenisKelamin&&(N+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.bermalam&&(N+=`&bermalam=${encodeURIComponent(a.bermalam)}`),a!=null&&a.jenis_izin&&(N+=`&jenis_izin=${encodeURIComponent(a.jenis_izin)}`),a!=null&&a.status&&a.status!==""&&(N+=`&status=${encodeURIComponent(a.status)}`),a!=null&&a.masa_telat&&a.masa_telat!==""&&(N+=`&masa_telat=${encodeURIComponent(a.masa_telat)}`),!y&&_.current===N){console.log("Skip duplicate request");return}_.current=N,console.log("Fetching data from:",N);try{n(!0);const T=await fetch(N);if(!T.ok)throw new Error(`HTTP ${T.status}`);const C=await T.json(),P=C.data.map(F=>({...F,foto_profil:F.foto_profil||null}));l(P),p(C.total_data||0),h(C.total_pages||1),w(C.current_page||1)}catch(T){b(T.message),l([])}finally{n(!1)}},[u,a,i,f]);t.useEffect(()=>{S(a)},[S,a]),t.useEffect(()=>{w(1)},[i,c]);const j=t.useMemo(()=>{const y={alasan_izin:[],status:[],jenis_izin:[]};return s.forEach(N=>{Object.keys(y).forEach(T=>{N[T]&&!y[T].includes(N[T])&&y[T].push(N[T])})}),y},[s]);return{data:s,loading:r,error:x,limit:i,setLimit:m,totalData:d,totalPages:g,currentPage:u,setCurrentPage:w,searchTerm:c,setSearchTerm:o,filterOptions:j,fetchData:S}},Ys=()=>{const[a,s]=t.useState(!1),[l,r]=t.useState(null);return{approvePerizinan:async(x,b)=>{s(!0),r(null);try{const i=sessionStorage.getItem("token")||xe("token"),m=`${G}approve/perizinan/${b}/${x}`,d=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`}});if(!d.ok){const p=await d.json();throw new Error(p.message||"Gagal melakukan approval")}return!0}catch(i){return r(i.message||"Gagal melakukan approval"),!1}finally{s(!1)}},isApproving:a,error:l}},Ja=()=>{const a=localStorage.getItem("roles")||sessionStorage.getItem("roles")||"[]";return JSON.parse(a).map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(", ")},ea=({isOpen:a,onClose:s,filters:l,searchTerm:r,limit:n,currentPage:x,fields:b=[],endpoint:i})=>{const[m,d]=t.useState([]),[p,g]=t.useState(!1),h=o=>{d(u=>u.includes(o)?u.filter(w=>w!==o):[...u,o])},c=()=>{const o=`${G}${i}`,u=new URLSearchParams;l!=null&&l.phoneNumber&&u.append("phone_number",l.phoneNumber),l!=null&&l.wargaPesantren&&u.append("warga_pesantren",l.wargaPesantren),l!=null&&l.status&&u.append("status",l.status),l!=null&&l.jenisKelamin&&u.append("jenis_kelamin",l.jenisKelamin),l!=null&&l.smartcard&&u.append("smartcard",l.smartcard),l!=null&&l.pemberkasan&&u.append("pemberkasan",l.pemberkasan),l!=null&&l.urutBerdasarkan&&u.append("sort_by",l.urutBerdasarkan),l!=null&&l.urutSecara&&u.append("sort_order",l.urutSecara),l!=null&&l.negara&&l.negara!=="Semua Negara"&&u.append("negara",l.negara),l!=null&&l.provinsi&&l.provinsi!=="Semua Provinsi"&&u.append("provinsi",l.provinsi),l!=null&&l.kabupaten&&l.kabupaten!=="Semua Kabupaten"&&u.append("kabupaten",l.kabupaten),l!=null&&l.kecamatan&&l.kecamatan!=="Semua Kecamatan"&&u.append("kecamatan",l.kecamatan),l!=null&&l.wilayah&&l.wilayah!=="Semua Wilayah"&&u.append("wilayah",l.wilayah),l!=null&&l.blok&&l.blok!=="Semua Blok"&&u.append("blok",l.blok),l!=null&&l.kamar&&l.kamar!=="Semua Kamar"&&u.append("kamar",l.kamar),l!=null&&l.angkatanPelajar&&u.append("angkatan_pelajar",l.angkatanPelajar),l!=null&&l.angkatanSantri&&u.append("angkatan_santri",l.angkatanSantri),l!=null&&l.lembaga&&l.lembaga!=="Semua Lembaga"&&u.append("lembaga",l.lembaga),l!=null&&l.jurusan&&l.jurusan!=="Semua Jurusan"&&u.append("jurusan",l.jurusan),l!=null&&l.kelas&&l.kelas!=="Semua Kelas"&&u.append("kelas",l.kelas),l!=null&&l.rombel&&l.rombel!=="Semua Rombel"&&u.append("rombel",l.rombel),r&&u.append("nama",r),p||(n&&u.append("limit",n),x&&u.append("page",x)),m.forEach(w=>u.append("fields[]",w)),p&&u.append("all","true"),window.location.href=`${o}?${u.toString()}`};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"w-full max-w-lg bg-white rounded-lg shadow-xl relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mt-6",children:"Export Data"}),e.jsxs("div",{className:"pt-6 px-6 overflow-y-auto text-left",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-y-2 gap-x-4",children:b.map(o=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:m.includes(o.value),onChange:()=>h(o.value),className:"mr-2"}),o.label]},o.value))}),e.jsx("hr",{className:"my-4 border-t border-gray-300"}),e.jsxs("label",{className:"block",children:[e.jsx("input",{type:"checkbox",checked:p,onChange:()=>g(!p),className:"mr-2"}),"Semua data tanpa dibatasi perhalaman",e.jsx("div",{className:"text-sm italic text-gray-500",children:"(Bisa memakan waktu yang lama)"})]}),e.jsx("hr",{className:"my-4 border-t border-gray-300"})]}),e.jsx("p",{className:"text-red-600 text-sm mb-2",children:"Note: Jagalah privasi data. Haram disebar & dipergunakan untuk selain kepentingan pesantren."}),e.jsxs("div",{className:"bg-gray-100 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse rounded-b-lg",children:[e.jsx("button",{type:"submit",onClick:c,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm cursor-pointer",children:"Export Excel"}),e.jsx("button",{type:"button",onClick:s,className:"cursor-pointer mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Batal"})]})]})})})]})})},Vs=()=>{var fe,H,ve,Pe,$,we,Re,qe,J,Se,Ge;const[a,s]=t.useState(null),[l,r]=t.useState(!1),[n,x]=t.useState(""),[b,i]=t.useState(null),[m,d]=t.useState(!1),[p,g]=t.useState(""),h=Ja();console.log("Roles:",h);const c=_e=>{s(_e),d(!0)},o=()=>{s(null),d(!1)},[u,w]=t.useState({negara:"",provinsi:"",kabupaten:"",kecamatan:"",lembaga:"",jurusan:"",kelas:"",rombel:"",jenisKelamin:""}),{filterNegara:_,selectedNegara:f,handleFilterChangeNegara:v}=Ae(),{filterWilayah:S,selectedWilayah:j,handleFilterChangeWilayah:y}=Be(),{filterLembaga:N,selectedLembaga:T,handleFilterChangeLembaga:C}=Te(),P=((fe=_.negara.find(_e=>_e.value==f.negara))==null?void 0:fe.label)||"",F=((H=_.provinsi.find(_e=>_e.value==f.provinsi))==null?void 0:H.label)||"",M=((ve=_.kabupaten.find(_e=>_e.value==f.kabupaten))==null?void 0:ve.label)||"",L=((Pe=_.kecamatan.find(_e=>_e.value==f.kecamatan))==null?void 0:Pe.label)||"",I=(($=S.wilayah.find(_e=>_e.value==j.wilayah))==null?void 0:$.label)||"",D=((we=S.blok.find(_e=>_e.value==j.blok))==null?void 0:we.label)||"",Q=((Re=S.kamar.find(_e=>_e.value==j.kamar))==null?void 0:Re.label)||"",E=((qe=N.lembaga.find(_e=>_e.value==T.lembaga))==null?void 0:qe.label)||"",B=((J=N.jurusan.find(_e=>_e.value==T.jurusan))==null?void 0:J.label)||"",V=((Se=N.kelas.find(_e=>_e.value==T.kelas))==null?void 0:Se.label)||"",ne=((Ge=N.rombel.find(_e=>_e.value==T.rombel))==null?void 0:Ge.label)||"",te=t.useMemo(()=>({...u,negara:P,provinsi:F,kabupaten:M,kecamatan:L,wilayah:I,blok:D,kamar:Q,lembaga:E,jurusan:B,kelas:V,rombel:ne}),[u,P,F,M,L,I,D,Q,E,B,V,ne]),{data:R,loading:Z,error:z,limit:me,setLimit:he,totalData:U,totalPages:q,currentPage:se,setCurrentPage:Y,searchTerm:de,setSearchTerm:oe,fetchData:W}=Oa(te),[X,ae]=t.useState(!1);t.useEffect(()=>{W(te,u)},[te,u,W]);const O=_e=>{_e>=1&&_e<=q&&Y(_e)},K={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],bermalam:[{label:"Bermalam / Tidak Bermalam",value:""},{label:"Bermalam",value:"bermalam"},{label:"Tidak Bermalam",value:"tidak bermalam"}],jenis_izin:[{label:"Rombongan / Personal",value:""},{label:"Rombongan",value:"rombongan"},{label:"Personal",value:"personal"}],status:[{label:"Semua Status Izin",value:""},{label:"Sedang Proses Izin",value:"sedang proses izin"},{label:"Perizinan Diterima",value:"perizinan diterima"},{label:"Sudah Berada Di Luar Pondok",value:"sudah berada diluar pondok"},{label:"Perizinan Ditolak",value:"perizinan ditolak"},{label:"Perizinan Dibatalkan",value:"dibatalkan"},{label:"Telat (sudah kembali)",value:"telat(sudah kembali)"},{label:"Telat (belum kembali)",value:"telat(belum kembali)"},{label:"Kembali Tepat Waktu",value:"kembali tepat waktu"}]},A={masa_telat:[{label:"Semua Masa Telat",value:""},{label:"Lebih Dari 1 Minggu",value:"lebih dari seminggu"},{label:"Lebih Dari 2 Minggu",value:"lebih dari 2 minggu"},{label:"Lebih Dari 1 Bulan",value:"lebih dari satu bulan"}]},ee=[{label:"Wewenang",value:""}],[ie,ce]=t.useState(!1);return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Perizinan"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>{g(1),ce(!0)},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer flex items-center gap-2",children:[e.jsx(Ee,{}),"Tambah "]})}),e.jsxs("button",{onClick:()=>r(!0),className:"px-4 py-2 rounded flex items-center gap-2 text-white cursor-pointer bg-blue-500 hover:bg-blue-700",children:[e.jsx(Je,{}),e.jsx("span",{children:"Export"})]})]})]}),e.jsx(_s,{isOpen:ie,onClose:()=>ce(!1),refetchData:W,feature:p,id:b,nama:n}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${X?"mb-4":""}`,children:[e.jsx(ue,{showFilters:X,filterOptions:_,onChange:v,selectedFilters:f}),e.jsx(ue,{showFilters:X,filterOptions:S,onChange:y,selectedFilters:j}),e.jsx(ue,{showFilters:X,filterOptions:N,onChange:C,selectedFilters:T}),e.jsx(ue,{showFilters:X,filterOptions:K,onChange:_e=>w(ra=>({...ra,..._e})),selectedFilters:u}),e.jsx(ue,{showFilters:X,filterOptions:A,onChange:_e=>w(ra=>({...ra,..._e})),selectedFilters:u})]}),e.jsx(Ce,{searchTerm:de,setSearchTerm:oe,totalData:U,limit:me,toggleLimit:_e=>he(Number(_e.target.value)),toggleFilters:()=>ae(!X),showViewButtons:!1}),e.jsxs("div",{children:[z&&e.jsxs("div",{className:"bg-red-50 text-red-600 p-3 rounded mb-4",children:["Error: ",z]}),e.jsx("div",{className:"space-y-4",children:Z?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):R.length>0?e.jsx("div",{className:"",children:R.map(_e=>e.jsx(Hs,{data:_e,openModal:c,setShowFormModal:ce,setFeature:g,setSelectedId:i,setSelectedName:x,refetchData:W,userRole:h},_e.id))}):e.jsx("p",{className:"text-center py-8 text-gray-500",children:"Tidak ada data perizinan"})})]}),e.jsx(Fe,{currentPage:se,totalPages:q,handlePageChange:O,className:"mt-6"}),e.jsx(ea,{isOpen:l,onClose:()=>r(!1),filters:te,searchTerm:de,limit:me,currentPage:se,fields:ee,endpoint:"export/perizinan"}),m&&e.jsx(De,{title:"Perizinan",menu:17,item:a,onClose:o})]})]})},Hs=({data:a,openModal:s,setShowFormModal:l,setFeature:r,setSelectedId:n,setSelectedName:x,refetchData:b})=>{const i=Ja().toLowerCase(),{approvePerizinan:m,isApproving:d,error:p}=Ys(),[g,h]=t.useState(!1),[c,o]=t.useState(null),u=t.useMemo(()=>i?{biktren:!a.approved_by_biktren,kamtib:!a.approved_by_kamtib,pengasuh:!a.approved_by_pengasuh}[i]:!1,[i,a]),w=async()=>{if(o(null),await m(a.id,i)){h(!1);try{await b(!0)}catch(f){console.error("Gagal refetch:",f)}}else o(p)};return console.log(b),console.log("role user:",i),console.log("canApprove:",u),console.log("data:",a),e.jsx("div",{className:"max-w-6xl mx-auto cursor-pointer",onClick:()=>s(a),children:e.jsxs("div",{className:"bg-white rounded border border-gray-200 p-1 shadow-sm mb-4",children:[e.jsxs("div",{className:"flex justify-end",children:[u?e.jsx(ye,{action:"approve",children:e.jsxs("button",{onClick:_=>{_.stopPropagation(),h(!0)},className:"w-24 h-6 flex items-center gap-2 px-3 py-1 text-sm text-white bg-green-600 hover:bg-green-700 rounded shadow cursor-pointer",children:[e.jsx("i",{className:"fas fa-check-circle"}),e.jsx("span",{children:"Approve"})]})}):e.jsx("div",{className:"w-24 h-6"}),e.jsx(ye,{action:"edit",children:e.jsxs("button",{onClick:_=>{_.stopPropagation(),r(2),n(a.id),x(a.nama_santri),l(!0)},className:"w-20 h-6 flex items-center gap-2 px-3 py-1 text-sm text-white bg-blue-600 hover:bg-blue-700 rounded shadow cursor-pointer",children:[e.jsx("i",{className:"fas fa-edit"}),e.jsx("span",{children:"Edit"})]})})]}),e.jsx(Ps,{isOpen:g,onClose:()=>h(!1),onConfirm:w,isLoading:d,roleName:i}),c&&e.jsxs("div",{className:"mt-2 text-red-600 text-sm",children:["Error: ",c]}),e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsx("div",{className:"md:w-1/7 mb-4 md:mb-0 flex item-center justify-center",children:e.jsx("img",{alt:a.nama_santri||"-",className:"w-24 h-24 object-cover",src:a.foto_profil,onError:_=>{_.target.onerror=null,_.target.src=Me}})}),e.jsxs("div",{className:"md:w-3/5 p-1/5",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mr-2",children:a.nama_santri}),e.jsx("span",{className:"text-blue-800",children:a.jenis_kelamin==="p"?"♀":"♂"})]}),e.jsxs("div",{className:"space-y-1/4",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-24 text-gray-700",children:"Domisili"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-gray-600",children:[": ",a.kamar," - ",a.blok," - ",a.wilayah]})})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-24 text-gray-700",children:"Lembaga"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-gray-600",children:[": ",a.lembaga]})})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-24 text-gray-700",children:"Alamat"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-gray-600",children:[": ",a.kecamatan," - Kab. ",a.kabupaten,", ",a.provinsi]})})]}),e.jsxs("div",{className:"flex mt-1",children:[e.jsx("div",{className:"w-24 font-medium text-gray-800",children:"Alasan Izin"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-gray-800 font-medium",children:[": ",a.alasan_izin]})})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-24 text-gray-700",children:"Alamat Tujuan"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-gray-600",children:[": ",a.alamat_tujuan]})})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-24 text-gray-700",children:"Lama Izin"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-gray-600",children:[": Sejak ",e.jsx("span",{className:"ml-8",children:a.tanggal_mulai})]}),e.jsxs("div",{className:"text-gray-600",children:["  Sampai ",e.jsx("span",{className:"ml-4",children:a.tanggal_akhir})]}),e.jsxs("div",{className:"text-gray-600",children:["  ( ",a.bermalam," | ",a.lama_izin," )"]})]})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-24 text-gray-700",children:"Jenis Izin"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-gray-600",children:[": ",a.jenis_izin]})})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-24 text-gray-700",children:"Status"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:`font-medium ${a.status==="telat(sudah kembali)"||a.status==="telat(belum kembali)"?"text-red-600":"text-blue-600"}`,children:[": ",a.status]})})]})]})]}),e.jsxs("div",{className:"md:w-2/5 md:pl-2 p-1/5 border-gray-200 mt-6 md:mt-0",children:[e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{className:"space-y-1/4",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32 text-gray-700",children:"Pembuat Izin"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-gray-600",children:[": ",a.pembuat]})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-32 text-gray-700",children:"Biktren"}),e.jsx("div",{className:"flex-1 flex items-center",children:e.jsxs("span",{className:"text-gray-600",children:[": ",a.nama_biktren]})})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32 text-gray-700",children:"Pengasuh"}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-gray-600",children:[": ",a.nama_pengasuh]})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-32 text-gray-700",children:"Kamtib"}),e.jsx("div",{className:"flex-1 flex items-center",children:e.jsxs("span",{className:"text-gray-600",children:[": ",a.nama_kamtib]})})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-gray-700 font-medium",children:"Keterangan:"}),e.jsx("div",{className:"mt-1 text-gray-600",children:a.keterangan})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-gray-700 font-medium",children:a.status==="kembali tepat waktu"||a.status==="telat(sudah kembali)"||a.status==="telat(belum kembali)"?"Sudah berada di Pondok :":""}),e.jsx("div",{className:"mt-1 font-medium text-blue-800",children:a.tanggal_kembali})]})]})]}),e.jsx("div",{className:"mt-8 border-t pt-4",children:e.jsxs("div",{className:"flex flex-wrap items-center",children:[e.jsxs("div",{className:"flex items-center mr-6 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center bg-blue-500 text-white mr-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("span",{className:"text-gray-700",children:"Sedang proses izin"})]}),e.jsxs("div",{className:"flex items-center mr-6 mb-2",children:[e.jsxs("div",{className:`flex items-center justify-center w-6 h-6 rounded-full border-2 
            ${a.status==="perizinan ditolak"||a.status==="dibatalkan"?"border-red-500 bg-red-500 text-white":a.status!=="sedang proses izin"?"border-blue-500 bg-blue-500 text-white":"border-gray-400 text-gray-400"}`,children:[(a.status==="perizinan diterima"||a.status==="sudah berada diluar pondok"||a.status==="kembali tepat waktu"||a.status==="telat(sudah kembali)"||a.status==="telat(belum kembali)")&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),(a.status==="perizinan ditolak"||a.status==="dibatalkan")&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("span",{className:"text-gray-700",children:a.status==="dibatalkan"?"Perizinan dibatalkan":a.status==="perizinan ditolak"?"Perizinan ditolak":" Perizinan diterima"})]}),e.jsxs("div",{className:"flex items-center mr-6 mb-2",children:[e.jsx("div",{className:`flex items-center justify-center w-6 h-6 rounded-full border-2 
            ${a.status==="sudah berada diluar pondok"||a.status==="kembali tepat waktu"||a.status==="telat(sudah kembali)"||a.status==="telat(belum kembali)"?"border-blue-500 bg-blue-500 text-white":"border-gray-400 text-gray-400"}`,children:(a.status==="sudah berada diluar pondok"||a.status==="kembali tepat waktu"||a.status==="telat(sudah kembali)"||a.status==="telat(belum kembali)")&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("span",{className:"text-gray-700",children:"Sudah berada di luar pondok"})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsxs("div",{className:`flex items-center justify-center w-6 h-6 rounded-full border-2 
            ${a.status==="kembali tepat waktu"?"border-blue-500 bg-blue-500 text-white":a.status==="telat(belum kembali)"||a.status==="telat(sudah kembali)"?"border-red-500 bg-red-500 text-white":"border-gray-400 text-gray-400"}`,children:[a.status==="telat(belum kembali)"?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}):a.status==="kembali tepat waktu"&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),a.status==="telat(sudah kembali)"&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.jsx("span",{className:"text-gray-700",children:a.status==="telat(belum kembali)"||a.status==="telat(sudah kembali)"?" Telat":" Kembali tepat waktu"})]}),e.jsx("div",{className:"justify-end ml-auto",children:e.jsxs("div",{className:"text-right text-gray-500 text-sm mt-2",children:[e.jsxs("div",{children:["Tgl dibuat : ",a.tgl_input]}),e.jsxs("div",{children:["Tgl diubah : ",a.tgl_update]})]})})]})})]})},a.id)},pt=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},500);return()=>{clearTimeout(j)}},[c]);const S=t.useCallback(async(j=!1)=>{let y=`${G}data-pokok/alumni?limit=${i}`;if(u>1&&(y+=`&page=${u}`),_&&(y+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(y+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(y+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(y+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(y+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.jenisKelamin&&(y+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(y+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&(y+=`&jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&(y+=`&kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&(y+=`&rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.status&&a.status!=="Semua Status"&&(y+=`&status=${encodeURIComponent(a.status)}`),a!=null&&a.angkatanPelajar&&(y+=`&angkatan_pelajar=${encodeURIComponent(a.angkatanPelajar)}`),a!=null&&a.angkatanSantri&&(y+=`&angkatan_santri=${encodeURIComponent(a.angkatanSantri)}`),a!=null&&a.wafathidup&&(y+=`&wafat=${encodeURIComponent(a.wafathidup)}`),a!=null&&a.phoneNumber&&(y+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),!j&&v.current===y){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=y,console.log("Fetching data from:",y),n(!0),b(null);try{const N=await fetch(y);if(!N.ok)throw new Error(`Fetch error: ${N.status}`);const T=await N.json();console.log("Data Alumni dari API:",T),l(Array.isArray(T.data)?T.data:[]),p(T.total_data||0),h(T.total_pages||1)}catch(N){console.error("Fetch error:",N),b(N.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{alumni:s,loadingAlumni:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataAlumni:d,totalPages:g,currentPage:u,setCurrentPage:w,fetchData:S}};function We({startYear:a=2e3,placeholder:s="Pilih Tahun",labelTemplate:l="Tahun {year}"}={}){const n=new Date().getFullYear();return[{label:s,value:""},...Array.from({length:n-a+1},(b,i)=>{const m=n-i;return{label:l.replace("{year}",m),value:m}})]}const $e=({children:a})=>{const s=t.useRef(null),l=t.useRef(null);return t.useEffect(()=>{const r=s.current,n=l.current,x=()=>{n&&(n.scrollLeft=r.scrollLeft)},b=()=>{r&&(r.scrollLeft=n.scrollLeft)};return r&&n&&(r.addEventListener("scroll",x),n.addEventListener("scroll",b)),()=>{r&&r.removeEventListener("scroll",x),n&&n.removeEventListener("scroll",b)}},[]),t.useLayoutEffect(()=>{const r=()=>{if(s.current&&l.current){const n=l.current.querySelector("table");n&&(s.current.firstChild.style.width=`${n.scrollWidth}px`)}};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[a]),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{ref:s,className:"overflow-x-auto mb-1",children:e.jsx("div",{className:"h-2 bg-transparent"})}),e.jsx("div",{ref:l,className:"overflow-x-auto",children:a})]})},Qs=()=>{var q,se,Y,de,oe,W,X,ae;const[a,s]=t.useState(!1),[l,r]=t.useState(null),[n,x]=t.useState(!1),b=O=>{r(O),x(!0)},i=()=>{r(null),x(!1)},[m,d]=t.useState({phoneNumber:"",wafathidup:"",status:"",jenisKelamin:"",negara:"",provinsi:"",kabupaten:"",kecamatan:"",angkatanPelajar:"",angkatanSantri:"",lembaga:"",jurusan:"",kelas:"",rombel:""}),{filterNegara:p,selectedNegara:g,handleFilterChangeNegara:h}=Ae(),{filterLembaga:c,selectedLembaga:o,handleFilterChangeLembaga:u}=Te(),w=((q=p.negara.find(O=>O.value==g.negara))==null?void 0:q.label)||"",_=((se=p.provinsi.find(O=>O.value==g.provinsi))==null?void 0:se.label)||"",f=((Y=p.kabupaten.find(O=>O.value==g.kabupaten))==null?void 0:Y.label)||"",v=((de=p.kecamatan.find(O=>O.value==g.kecamatan))==null?void 0:de.label)||"",S=((oe=c.lembaga.find(O=>O.value==o.lembaga))==null?void 0:oe.label)||"",j=((W=c.jurusan.find(O=>O.value==o.jurusan))==null?void 0:W.label)||"",y=((X=c.kelas.find(O=>O.value==o.kelas))==null?void 0:X.label)||"",N=((ae=c.rombel.find(O=>O.value==o.rombel))==null?void 0:ae.label)||"",T=t.useMemo(()=>({...m,negara:w,provinsi:_,kabupaten:f,kecamatan:v,lembaga:S,jurusan:j,kelas:y,rombel:N}),[m,j,f,v,y,S,w,_,N]),{alumni:C,loadingAlumni:P,searchTerm:F,setSearchTerm:M,error:L,limit:I,setLimit:D,totalDataAlumni:Q,totalPages:E,currentPage:B,setCurrentPage:V}=pt(T),[ne,te]=t.useState(!1),[R,Z]=t.useState("");t.useEffect(()=>{const O=sessionStorage.getItem("viewMode");O&&Z(O)},[]);const z=O=>{O>=1&&O<=E&&V(O)},me={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],status:[{label:"Semua Status",value:""},{label:"Alumni Santri",value:"alumni santri"},{label:"Alumni Santri Non Pelajar",value:"alumni santri non pelajar"},{label:"Alumni Santri Tetapi Masih Pelajar Aktif",value:"alumni santri tetapi masih pelajar aktif"},{label:"Alumni Pelajar",value:"alumni pelajar"},{label:"Alumni Pelajar Non Santri",value:"alumni pelajar non santri"},{label:"Alumni Pelajar Tetapi Masih Santri Aktif",value:"alumni pelajar tetapi masih santri aktif"},{label:"Alumni Santri-Pelajar/Alumni Pelajar-Santri",value:"alumni pelajar sekaligus santri"}],angkatanPelajar:We({placeholder:"Semua Angkatan Pelajar",labelTemplate:"Keluar Tahun {year}"}),angkatanSantri:We({placeholder:"Semua Angkatan Santri",labelTemplate:"Keluar Tahun {year}"})},he={wafathidup:[{label:"Pilih Wafat / Hidup",value:""},{label:"Wafat",value:"sudah wafat"},{label:"Hidup",value:"masih hidup"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]},U=[{label:"No. KK",value:"no_kk"},{label:"NIK",value:"nik"},{label:"NIUP",value:"niup"},{label:"Anak ke",value:"anak_ke"},{label:"Jumlah Saudara",value:"jumlah_saudara"},{label:"Alamat",value:"alamat"},{label:"Domisili Santri",value:"domisili_santri"},{label:"Angkatan Santri",value:"angkatan_santri"},{label:"Angkatan Pelajar",value:"angkatan_pelajar"},{label:"Status",value:"status"},{label:"Ibu Kandung",value:"ibu_kandung"},{label:"Tahun Keluar Santri",value:"tahun_keluar_santri"},{label:"Tahun Keluar Pelajar",value:"tahun_keluar_pelajar"}];return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Alumni"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("button",{onClick:()=>s(!0),className:"px-4 py-2 rounded flex items-center gap-2 text-white cursor-pointer bg-blue-500 hover:bg-blue-700",children:[e.jsx(Je,{}),e.jsx("span",{children:"Export"})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-10",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${ne?"mb-4":""}`,children:[e.jsx(ue,{showFilters:ne,filterOptions:p,onChange:h,selectedFilters:g}),e.jsx(ue,{showFilters:ne,filterOptions:c,onChange:u,selectedFilters:o}),e.jsx(ue,{showFilters:ne,filterOptions:me,onChange:O=>d(K=>({...K,...O})),selectedFilters:m}),e.jsx(ue,{showFilters:ne,filterOptions:he,onChange:O=>d(K=>({...K,...O})),selectedFilters:m})]}),e.jsx(Ce,{searchTerm:F,setSearchTerm:M,totalData:Q,toggleFilters:()=>te(!ne),toggleView:Z,limit:I,toggleLimit:O=>D(Number(O.target.value))}),L?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):R==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:P?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):C.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):C.map((O,K)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex items-center space-x-4 cursor-pointer",onClick:()=>b(O),children:[e.jsx("img",{alt:O.nama||"-",className:"w-20 h-24 object-cover",src:O.foto_profil,onError:A=>{A.target.onerror=null,A.target.src=Me}}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl",children:O.nama||"-"}),e.jsx("p",{className:"text-gray-600",children:O.kota_asal||"-"}),e.jsxs("p",{className:"text-gray-600",children:["Pend. Terakhir:"," ",O.lembaga&&O.lembaga!=="-"&&O.tahun_keluar_santri&&O.tahun_keluar_santri!=="-"?e.jsxs(e.Fragment,{children:[O.lembaga," - ",O.tahun_keluar_santri]}):O.lembaga&&O.lembaga!=="-"?O.lembaga:O.tahun_keluar_santri&&O.tahun_keluar_santri!=="-"?O.tahun_keluar_santri:"-"]})]})]},O.id||K))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIUP"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Status Santri Terakhir"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Pendidikan Terakhir"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kota Asal"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update Bio"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input Bio"})]})}),e.jsx("tbody",{className:"text-gray-800",children:P?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):C.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-6",children:"Tidak ada data"})}):C.map((O,K)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center cursor-pointer text-left",onClick:()=>b(O),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(B-1)*I+K+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:O.niup||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:O.nama||"-"}),e.jsxs("td",{className:"px-3 py-2 border-b",children:["Masuk: ",O.tahun_masuk_santri||"-",e.jsx("br",{}),"Bayang: ",O.tahun_keluar_santri||"-"]}),e.jsxs("td",{className:"px-3 py-2 border-b",children:[O.lembaga||"-",e.jsx("br",{}),e.jsxs("span",{className:"italic",children:["Lulus: ",O.tahun_keluar_pendidikan||"-"]})]}),e.jsx("td",{className:"px-3 py-2 border-b",children:O.kota_asal||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:O.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:O.tgl_input||"-"})]},O.id||K))})]})}),e.jsx(ea,{isOpen:a,onClose:()=>s(!1),filters:T,searchTerm:F,limit:I,currentPage:B,fields:U,endpoint:"export/alumni"}),n&&e.jsx(De,{title:"Alumni",menu:13,item:l,onClose:i}),E>1&&e.jsx(Fe,{currentPage:B,totalPages:E,handlePageChange:z})]})]})},bt=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},400);return()=>{clearTimeout(j)}},[c]);const S=t.useCallback(async()=>{let j=`${G}data-pokok/karyawan?limit=${i}`;if(u>1&&(j+=`&page=${u}`),_&&(j+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(j+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(j+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(j+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(j+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.jenisKelamin&&(j+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(j+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.wargaPesantren&&(j+=`&warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.pemberkasan&&(j+=`&pemberkasan=${encodeURIComponent(a.pemberkasan)}`),a!=null&&a.phoneNumber&&(j+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),a!=null&&a.smartcard&&(j+=`&smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.umur&&(j+=`&umur=${encodeURIComponent(a.umur)}`),a!=null&&a.jenisJabatan&&(j+=`&jabatan=${encodeURIComponent(a.jenisJabatan)}`),a!=null&&a.golonganJabatan&&a.golonganJabatan!=="Pilih Golongan Jabatan"&&(j+=`&golongan=${encodeURIComponent(a.golonganJabatan)}`),v.current===j){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=j,console.log("Fetching data from:",j),n(!0),b(null);try{const y=await fetch(j);if(!y.ok)throw new Error(`${y.statusText}: ${y.status}`);const N=await y.json();console.log("Data dari API:",N),l(Array.isArray(N.data)?N.data:[]),p(N.total_data||0),h(N.total_pages||1)}catch(y){console.error("Fetch error:",y),b(y.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{karyawan:s,loadingKaryawan:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataKaryawan:d,totalPages:g,currentPage:u,setCurrentPage:w}},aa=()=>{const[a,s]=t.useState([]);return t.useEffect(()=>{const l=sessionStorage.getItem("menuGolonganJabatan");if(l)try{const r=JSON.parse(l);s(r)}catch(r){console.error("Gagal parsing data dari sessionStorage:",r),sessionStorage.removeItem("menuGolonganJabatan")}else fetch(`${G}dropdown/golongan-jabatan`).then(r=>r.json()).then(r=>{const n=[{label:"Pilih Golongan Jabatan",value:"",id:null},...r.map(x=>({id:x.id,value:x.nama_golongan_jabatan,label:x.nama_golongan_jabatan}))];sessionStorage.setItem("menuGolonganJabatan",JSON.stringify(n)),s(n)}).catch(r=>{console.error("Gagal mengambil data golongan jabatan:",r),s([{label:"Pilih Golongan Jabatan",value:"",id:null}])})},[]),{menuGolonganJabatan:a}};async function ga(a,s){try{s(!0);const l=await fetch(a);if(!l.ok)throw new Error(`Gagal download: ${l.statusText}`);const r=await l.blob(),n=window.URL.createObjectURL(r),x=document.createElement("a");x.href=n,x.download="",document.body.appendChild(x),x.click(),document.body.removeChild(x),window.URL.revokeObjectURL(n)}catch(l){console.error("Terjadi kesalahan saat download:",l),alert("Download gagal. Silakan coba lagi.")}finally{s(!1)}}const Zs=()=>{var me,he,U,q,se;const[a,s]=t.useState(!1),[l,r]=t.useState(null),[n,x]=t.useState(!1),b=Y=>{r(Y),x(!0)},i=()=>{r(null),x(!1)},[m,d]=t.useState({phoneNumber:"",status:"",jenisKelamin:"",lembaga:"",pemberkasan:"",satuanKerja:"",golonganJabatan:"",wargaPesantren:"",umur:"",smartcard:""}),{filterNegara:p,selectedNegara:g,handleFilterChangeNegara:h}=Ae(),{filterLembaga:c}=Te(),{menuGolonganJabatan:o}=aa(),u=((me=p.negara.find(Y=>Y.value==g.negara))==null?void 0:me.label)||"",w=((he=p.provinsi.find(Y=>Y.value==g.provinsi))==null?void 0:he.label)||"",_=((U=p.kabupaten.find(Y=>Y.value==g.kabupaten))==null?void 0:U.label)||"",f=((q=p.kecamatan.find(Y=>Y.value==g.kecamatan))==null?void 0:q.label)||"",v=((se=c.lembaga.find(Y=>Y.value==m.lembaga))==null?void 0:se.label)||"",S=t.useMemo(()=>({...m,negara:u,provinsi:w,kabupaten:_,kecamatan:f,lembaga:v}),[m,_,f,v,u,w]),{karyawan:j,loadingKaryawan:y,searchTerm:N,setSearchTerm:T,error:C,limit:P,setLimit:F,totalDataKaryawan:M,totalPages:L,currentPage:I,setCurrentPage:D}=bt(S),[Q,E]=t.useState(!1),[B,V]=t.useState("");t.useEffect(()=>{const Y=sessionStorage.getItem("viewMode");Y&&V(Y)},[]);const ne=Y=>{Y>=1&&Y<=L&&D(Y)},te={lembaga:c.lembaga},R={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],jenisJabatan:[{label:"Pilih Jenis Jabatan",value:""},{label:"Kultural",value:"kultural"},{label:"Tetap",value:"tetap"},{label:"Kontrak",value:"kontrak"},{label:"Pengkaderan",value:"pengkaderan"}],golonganJabatan:o},Z={wargaPesantren:[{label:"Warga Pesantren",value:""},{label:"Memiliki NIUP",value:"memiliki niup"},{label:"Tanpa NIUP",value:"tanpa niup"}],pemberkasan:[{label:"Pemberkasan",value:""},{label:"Tidak Ada Berkas",value:"tidak ada berkas"},{label:"Tidak Ada Foto Diri",value:"tidak ada foto diri"},{label:"Memiliki Foto Diri",value:"memiliki foto diri"},{label:"Tidak Ada KK",value:"tidak ada kk"},{label:"Tidak Ada Akta Kelahiran",value:"tidak ada akta kelahiran"},{label:"Tidak Ada Ijazah",value:"tidak ada ijazah"}],umur:[{label:"Semua Umur",value:""},{label:"< 20 Tahun",value:"0-20"},{label:"20-29 Tahun",value:"20-29"},{label:"30-39 Tahun",value:"30-39"},{label:"40-49 Tahun",value:"40-49"},{label:"50-59 Tahun",value:"50-59"},{label:"60-65 Tahun",value:"60-65"},{label:"> 65 Tahun",value:"65-200"}]},z={smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]};return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Karyawan"}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:()=>ga(`${G}export/karyawan`,s),disabled:a,className:`px-4 py-2 rounded flex items-center gap-2 text-white cursor-pointer ${a?"bg-blue-300 cursor-not-allowed":"bg-blue-500 hover:bg-blue-700"}`,children:a?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-white"}),e.jsx("span",{children:"Loading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{}),e.jsx("span",{children:"Export"})]})})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${Q?"mb-4":""}`,children:[e.jsx(ue,{showFilters:Q,filterOptions:p,onChange:h,selectedFilters:g}),e.jsx(ue,{showFilters:Q,filterOptions:te,onChange:Y=>d(de=>({...de,...Y})),selectedFilters:m}),e.jsx(ue,{showFilters:Q,filterOptions:R,onChange:Y=>d(de=>({...de,...Y})),selectedFilters:m}),e.jsx(ue,{showFilters:Q,filterOptions:Z,onChange:Y=>d(de=>({...de,...Y})),selectedFilters:m}),e.jsx(ue,{showFilters:Q,filterOptions:z,onChange:Y=>d(de=>({...de,...Y})),selectedFilters:m})]}),e.jsx(Ce,{searchTerm:N,setSearchTerm:T,totalData:M,toggleFilters:()=>E(!Q),toggleView:V,limit:P,toggleLimit:Y=>F(Number(Y.target.value))}),C?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):B==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:y?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):j.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):j.map(Y=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex items-center space-x-4 cursor-pointer",onClick:()=>b(Y),children:[e.jsx("img",{alt:Y.nama||"-",className:"w-20 h-24 object-cover",src:Y.foto_profil,onError:de=>{de.target.onerror=null,de.target.src=Me}}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-xl",children:Y.nama}),e.jsx("p",{className:"text-gray-600",children:Y.nik}),e.jsx("p",{className:"text-gray-600",children:Y.Keterangan_jabatan&&Y.Keterangan_jabatan!=="-"?Y.lembaga&&Y.lembaga!=="-"?`${Y.Keterangan_jabatan} - ${Y.lembaga}`:Y.KeteranganJabatan:Y.lembaga&&Y.lembaga!=="-"?Y.lembaga:""})]})]},Y.id))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIUP"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Umur"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jabatan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Lembaga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jenis"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Golongan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Pendidikan Terakhir"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update Karyawan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input Karyawan"})]})}),e.jsx("tbody",{className:"text-gray-800",children:y?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):j.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center py-6",children:"Tidak ada data"})}):j.map((Y,de)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-left cursor-pointer",onClick:()=>b(Y),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(I-1)*P+de+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:Y.niup||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:Y.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:Y.umur===0?0:Y.umur||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:Y.Keterangan_jabatan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:Y.lembaga||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:Y.jenis_jabatan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:Y.golongan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:Y.pendidikanTerakhir||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:Y.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:Y.tgl_input||"-"})]},Y.id||de))})]})}),n&&e.jsx(De,{title:"Karyawan",menu:10,item:l,onClose:i}),L>1&&e.jsx(Fe,{currentPage:I,totalPages:L,handlePageChange:ne})]})]})},jt=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},400);return()=>{clearTimeout(j)}},[c]);const S=t.useCallback(async(j=!1)=>{let y=`${G}data-pokok/khadam?limit=${i}`;if(u>1&&(y+=`&page=${u}`),_&&(y+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(y+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(y+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(y+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(y+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&(y+=`&wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&(y+=`&blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&(y+=`&kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(y+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&(y+=`&jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&(y+=`&kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&(y+=`&rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.jenisKelamin&&(y+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.smartcard&&(y+=`&smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.wargaPesantren&&(y+=`&warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.pemberkasan&&(y+=`&pemberkasan=${encodeURIComponent(a.pemberkasan)}`),a!=null&&a.phoneNumber&&(y+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),!j&&v.current===y){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=y,console.log("Fetching data from:",y),n(!0),b(null);try{const N=await fetch(y);if(!N.ok)throw new Error(`Fetch error: ${N.status}`);const T=await N.json();console.log("Data Khadam dari API:",T),l(Array.isArray(T.data)?T.data:[]),p(T.total_data||0),h(T.total_pages||1)}catch(N){console.error("Fetch error:",N),b(N.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{khadam:s,loadingKhadam:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataKhadam:d,totalPages:g,currentPage:u,setCurrentPage:w,fetchData:S}},Xs=({register:a,watch:s,setValue:l,control:r,activeTab:n})=>{const{filterNegara:x,selectedNegara:b,handleFilterChangeNegara:i}=Ae(),m=s("modalKhadam.kewarganegaraan"),d=s("modalKhadam.negara_id"),p=s("modalKhadam.provinsi_id"),g=s("modalKhadam.kabupaten_id"),h=s("modalKhadam.kecamatan_id"),c=f=>{const v=f.target.value;l("modalKhadam.kewarganegaraan",v),v==="wna"?(l("modalKhadam.no_kk",""),l("modalKhadam.nik","")):v==="wni"&&l("modalKhadam.no_passport","")};t.useEffect(()=>{n===0&&(console.log("handle"),d&&(console.log("negara handle ",d),i({negara:d})),p&&(console.log("provinsi handle ",p),i({provinsi:p})),g&&(console.log("kabupaten handle ",g),i({kabupaten:g})),h&&(console.log("kecamatan handle ",h),i({kecamatan:h})))},[n]);const o=(f,v)=>f.length>0?[{...f[0],label:v},...f.slice(1)]:f,u={negara:o(x.negara,"Pilih Negara"),provinsi:o(x.provinsi,"Pilih Provinsi"),kabupaten:o(x.kabupaten,"Pilih Kabupaten"),kecamatan:o(x.kecamatan,"Pilih Kecamatan")},w=f=>f.charAt(0).toUpperCase()+f.slice(1),_=({filterOptions:f,control:v,onChange:S,selectedFilters:j})=>e.jsx("div",{className:"space-y-2",children:Object.entries(f).map(([y,N],T)=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsxs("label",{htmlFor:y,className:"md:w-1/4 text-black",children:[w(y)," *"]}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md border border-gray-300 border-gray-500 ${N.length<=1?"bg-gray-200 text-gray-500":""}`,children:e.jsx(Xe,{name:`modalKhadam.${y}_id`,control:v,rules:{required:!0},defaultValue:j[y]||"",render:({field:C})=>e.jsx("select",{...C,id:y,required:!0,disabled:N.length<=1,className:`w-full py-1.5 pr-3 pl-1 text-base focus:outline-none sm:text-sm ${N.length<=1?"text-gray-500":""}`,onChange:P=>{C.onChange(P),S({[y]:P.target.value})},children:N.map((P,F)=>e.jsx("option",{value:P.value,children:P.label},F))})})})})]},`${y}-${T}`))});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"kewarganegaraan",className:"md:w-1/4 text-black",children:"Kewarganegaraan *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"kewarganegaraan",value:"wni",className:"w-4 h-4",...a("modalKhadam.kewarganegaraan",{required:!0}),checked:m==="wni",onChange:c,required:!0}),e.jsx("span",{children:"WNI"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"kewarganegaraan",value:"wna",className:"w-4 h-4",...a("modalKhadam.kewarganegaraan",{required:!0}),checked:m==="wna",onChange:c,required:!0}),e.jsx("span",{children:"WNA"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"passport",className:"md:w-1/4 text-black",children:"No Passport *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-500 ${m==="wna"?"bg-white border-gray-300 ":"bg-gray-300 border-gray-200"}`,children:e.jsx("input",{id:"no_passport",name:"no_passport",type:"text",maxLength:20,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},disabled:m!=="wna",placeholder:"Masukkan No Passport",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.no_passport",{required:m==="wna"}),required:m==="wna"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nokk",className:"md:w-1/4 text-black",children:"Nomor KK *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-500 ${m==="wni"?"bg-white border-gray-300 ":"bg-gray-300 border-gray-200"}`,children:e.jsx("input",{id:"no_kk",name:"no_kk",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},disabled:m!=="wni",placeholder:"Masukkan No KK",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.no_kk",{required:m==="wni"}),required:m==="wni"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4 ",children:[e.jsx("label",{htmlFor:"nonik",className:"md:w-1/4 text-black",children:"NIK *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-500 ${m==="wni"?"bg-white border-gray-300 ":"bg-gray-300 border-gray-200"}`,children:e.jsx("input",{id:"nik",name:"nik",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"").slice(0,16)},disabled:m!=="wni",placeholder:"Masukkan NIK",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.nik",{required:m==="wni"}),required:m==="wni"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama",className:"md:w-1/4 text-black",children:"Nama Lengkap *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama",name:"nama",type:"text",placeholder:"Masukkan Nama Lengkap",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.nama",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jenisKelamin",className:"md:w-1/4 text-black",children:"Jenis Kelamin *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"jenisKelamin",value:"p",className:"w-4 h-4",...a("modalKhadam.jenis_kelamin",{required:!0}),required:!0}),e.jsx("span",{children:"Perempuan"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"jenisKelamin",value:"l",className:"w-4 h-4",...a("modalKhadam.jenis_kelamin",{required:!0}),required:!0}),e.jsx("span",{children:"Laki-Laki"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tempatLahir",className:"md:w-1/4 text-black",children:"Tempat Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tempatLahir",name:"tempatLahir",type:"text",placeholder:"Masukkan Tempat Lahir",...a("modalKhadam.tempat_lahir",{required:!0}),required:!0,className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_lahir",className:"md:w-1/4 text-black",children:"Tanggal Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_lahir",name:"tanggal_lahir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.tanggal_lahir",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"anak_keberapa",className:"md:w-1/4 text-black",children:"Anak Ke *"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"anak_keberapa",name:"anak_keberapa",type:"number",min:"1",className:"w-13 py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.anak_keberapa")})}),e.jsx("span",{children:"Dari"}),e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"dari_saudara",name:"dari_saudara",type:"number",min:"1",className:"w-13 py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.dari_saudara")})})]})]}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tinggal_bersama",className:"md:w-1/4 text-black",children:"Tinggal Bersama"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tinggal_bersama",name:"tinggal_bersama",type:"text",placeholder:"Masukkan Tinggal Bersama",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.tinggal_bersama")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jenjang_pendidikan_terakhir",className:"md:w-1/4 text-black",children:"Jenjang Pendidikan Terakhir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsxs("select",{id:"jenjang_pendidikan_terakhir",name:"jenjang_pendidikan_terakhir",...a("modalKhadam.jenjang_pendidikan_terakhir"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"paud",children:"Paud"}),e.jsx("option",{value:"sd/mi",children:"SD/MI"}),e.jsx("option",{value:"smp/mts",children:"SMP/MTS"}),e.jsx("option",{value:"sma/smk/ma",children:"SMA/SMK/MA"}),e.jsx("option",{value:"d3",children:"D3"}),e.jsx("option",{value:"d4",children:"D4"}),e.jsx("option",{value:"s1",children:"S1"}),e.jsx("option",{value:"s2",children:"S2"})]})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama_pendidikan_terakhir",className:"md:w-1/4 text-black",children:"Nama Pendidikan Terakhir"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama_pendidikan_terakhir",name:"nama_pendidikan_terakhir",type:"text",placeholder:"Masukkan Nama Pendidikan Terakhir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.nama_pendidikan_terakhir")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon",className:"md:w-1/4 text-black",children:"Nomor Telepon 1"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon",name:"no_telepon",type:"tel",maxLength:20,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.no_telepon",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon_2",className:"md:w-1/4 text-black",children:"Nomor Telepon 2"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon_2",name:"no_telepon_2",type:"tel",maxLength:20,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.no_telepon_2")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"email",className:"md:w-1/4 text-black",children:"E-Mail"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"email",name:"email",type:"email",maxLength:100,placeholder:"Masukkan E-Mail",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.email",{required:!0}),required:!0})})})]}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsx(_,{filterOptions:u,onChange:i,selectedFilters:b,control:r}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jalan",className:"md:w-1/4 text-black",children:"Jalan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"jalan",name:"jalan",type:"text",maxLength:255,placeholder:"Masukkan Nama Jalan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.jalan",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"kodepos",className:"md:w-1/4 text-black",children:"Kode Pos *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"kodepos",name:"kodepos",type:"text",maxLength:10,pattern:"\\d*",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},inputMode:"numeric",placeholder:"Masukkan Kode Pos",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.kode_pos",{required:!0}),required:!0})})})]})]})})},en=({register:a})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"keterangan",className:"md:w-1/4 text-black",children:"Keterangan"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md pl-1 border border-gray-500 bg-white border-gray-300",children:e.jsx("input",{id:"keterangan",name:"keterangan",type:"text",placeholder:"Masukkan keterangan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.keterangan")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_mulai",className:"md:w-1/4 text-black",children:"Tanggal Mulai"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md pl-1 border border-gray-500 bg-white border-gray-300",children:e.jsx("input",{id:"tanggal_mulai",name:"tanggal_mulai",type:"date",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalKhadam.tanggal_mulai")})})})]})]})});function an({isOpen:a,onClose:s,formState:l}){var _;const{register:r,handleSubmit:n,control:x,setValue:b,resetData:i,watch:m,activeTab:d,unlockedTabs:p,setActiveTab:g,nextStep:h,prevStep:c,onValidSubmit:o,onInvalidSubmit:u}=l,w=[{id:0,label:"Biodata",content:e.jsx(Xs,{register:r,watch:m,setValue:b,control:x,activeTab:d})},{id:1,label:"Khadam",content:e.jsx(en,{register:r})}];return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 overflow-y-auto",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"bg-white p-6 rounded-lg shadow-xl max-w-3xl w-full h-full relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx("div",{className:"pb-4",children:e.jsx(re.Title,{className:"text-lg font-semibold text-gray-900",children:"Tambah Data Khadam"})}),e.jsxs("form",{onSubmit:n(o,u),className:"flex-1 overflow-y-auto p-2",children:[e.jsx("ul",{className:"flex flex-wrap text-sm font-medium text-center text-gray-500 border-b border-gray-500",children:w.map(f=>e.jsx("li",{children:e.jsx("button",{type:"button",onClick:v=>{v.stopPropagation(),p.includes(f.id)&&g(f.id)},className:`inline-block p-3 rounded-t-lg border-b-2 ${d===f.id?"text-blue-600 border-blue-600 bg-gray-200":p.includes(f.id)?"border-transparent hover:text-gray-600 hover:bg-gray-50":"border-transparent text-gray-300 cursor-not-allowed"}`,disabled:!p.includes(f.id),children:f.label})},f.id))}),e.jsx("div",{className:"pt-4",children:(_=w.find(f=>f.id===d))==null?void 0:_.content})]}),e.jsxs("div",{className:"mt-4 pt-4 flex justify-between",children:[d>0&&e.jsxs("button",{onClick:c,className:"inline-flex items-center gap-2 rounded-md bg-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-400",children:[e.jsx(ya,{}),"Sebelumnya"]}),e.jsxs("div",{className:"ml-auto space-x-2",children:[d<w.length&&e.jsxs("button",{type:"button",onClick:i,className:"inline-flex items-center gap-2 rounded-md bg-red-500 px-4 py-2 text-sm font-medium text-white hover:bg-red-600",children:[e.jsx(wa,{}),"Reset"]}),d<w.length-1?e.jsxs("button",{type:"button",onClick:h,className:"inline-flex items-center gap-2 rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700",children:["Selanjutnya",e.jsx(va,{})]}):e.jsxs("button",{type:"button",onClick:n(o,u),className:"inline-flex items-center gap-2 rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white hover:bg-green-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-green-500 focus-visible:ring-offset-2",children:[e.jsx(Na,{}),"Simpan"]})]})]})]})})})]})})}function tn(a,s){const[l,r]=t.useState(0),[n,x]=t.useState([0]),{clearAuthData:b}=ke(),i=je(),{register:m,handleSubmit:d,trigger:p,watch:g,setValue:h,reset:c,control:o,formState:{errors:u}}=ma(),w=g();t.useEffect(()=>{console.log("Data inputan berubah:",w)},[w]);const _=async()=>{const N=document.querySelector("form");if(N&&!N.reportValidity()||!await p(v(l)))return;const C=l+1;n.includes(C)||x([...n,C]),r(C)},f=()=>{const N=l-1;N>=0&&r(N)},v=N=>{switch(N){case 0:case 1:case 2:case 3:return[];default:return[]}};return{register:m,handleSubmit:d,control:o,setValue:h,resetData:()=>{c({modalKhadam:{}}),r(0),x([0])},watch:g,errors:u,activeTab:l,unlockedTabs:n,setActiveTab:r,nextStep:_,prevStep:f,onValidSubmit:async N=>{try{if(!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)return;k.fire({title:"Mohon tunggu...",html:"Sedang mengirim data...",allowOutsideClick:!1,didOpen:()=>k.showLoading()});const C=xe("token")||sessionStorage.getItem("token"),P=await fetch(`${G}crud/khadam`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},body:JSON.stringify(N.modalKhadam)});k.close();const F=await P.json();if(console.log(F),P.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),b(),i("/login");return}if(!P.ok){const M=F.errors?Object.entries(F.errors).map(([L,I])=>`- ${L.replace(/_/g," ")}: ${I.join(", ")}`):[F.message??"Gagal mengirim data"];throw await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${M.join("<br>")}</div>`}),new Error(F.message)}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),c({modalKhadam:{}}),r(0),x([0]),s==null||s(!0),a==null||a()}catch(T){console.error("Terjadi kesalahan:",T)}},onInvalidSubmit:N=>{console.log("Form tidak valid:",N),k.fire({icon:"warning",title:"Validasi Gagal",text:"Periksa kembali data yang diisi."})}}}const sn=()=>{var ee,ie,ce,fe,H,ve,Pe,$,we,Re,qe;const[a,s]=t.useState(!1),[l,r]=t.useState(null),[n,x]=t.useState(!1),b=J=>{r(J),x(!0)},i=()=>{r(null),x(!1)},[m,d]=t.useState({phoneNumber:"",wafathidup:"",status:"",jenisKelamin:"",negara:"",provinsi:"",kabupaten:"",kecamatan:"",angkatanPelajar:"",angkatanSantri:"",lembaga:"",jurusan:"",kelas:"",rombel:""}),{filterNegara:p,selectedNegara:g,handleFilterChangeNegara:h}=Ae(),{filterLembaga:c,selectedLembaga:o,handleFilterChangeLembaga:u}=Te(),{filterWilayah:w,selectedWilayah:_,handleFilterChangeWilayah:f}=Be(),v=((ee=p.negara.find(J=>J.value==g.negara))==null?void 0:ee.label)||"",S=((ie=p.provinsi.find(J=>J.value==g.provinsi))==null?void 0:ie.label)||"",j=((ce=p.kabupaten.find(J=>J.value==g.kabupaten))==null?void 0:ce.label)||"",y=((fe=p.kecamatan.find(J=>J.value==g.kecamatan))==null?void 0:fe.label)||"",N=((H=w.wilayah.find(J=>J.value==_.wilayah))==null?void 0:H.label)||"",T=((ve=w.blok.find(J=>J.value==_.blok))==null?void 0:ve.label)||"",C=((Pe=w.kamar.find(J=>J.value==_.kamar))==null?void 0:Pe.label)||"",P=(($=c.lembaga.find(J=>J.value==o.lembaga))==null?void 0:$.label)||"",F=((we=c.jurusan.find(J=>J.value==o.jurusan))==null?void 0:we.label)||"",M=((Re=c.kelas.find(J=>J.value==o.kelas))==null?void 0:Re.label)||"",L=((qe=c.rombel.find(J=>J.value==o.rombel))==null?void 0:qe.label)||"",I=t.useMemo(()=>({...m,negara:v,provinsi:S,kabupaten:j,kecamatan:y,wilayah:N,blok:T,kamar:C,lembaga:P,jurusan:F,kelas:M,rombel:L}),[T,m,F,j,C,y,M,P,v,S,L,N]),{khadam:D,loadingKhadam:Q,searchTerm:E,setSearchTerm:B,error:V,limit:ne,setLimit:te,totalDataKhadam:R,totalPages:Z,currentPage:z,setCurrentPage:me,fetchData:he}=jt(I),[U,q]=t.useState(!1),[se,Y]=t.useState("");t.useEffect(()=>{const J=sessionStorage.getItem("viewMode");J&&Y(J)},[]);const de=J=>{J>=1&&J<=Z&&me(J)},oe={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}]},W={wargaPesantren:[{label:"Warga Pesantren",value:""},{label:"Memiliki NIUP",value:"memiliki niup"},{label:"Tanpa NIUP",value:"tanpa niup"}],pemberkasan:[{label:"Pemberkasan",value:""},{label:"Tidak Ada Berkas",value:"tidak ada berkas"},{label:"Tidak Ada Foto Diri",value:"tidak ada foto diri"},{label:"Memiliki Foto Diri",value:"memiliki foto diri"},{label:"Tidak Ada KK",value:"tidak ada kk"},{label:"Tidak Ada Akta Kelahiran",value:"tidak ada akta kelahiran"},{label:"Tidak Ada Ijazah",value:"tidak ada ijazah"}]},X={smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]},ae=[{label:"No. KK",value:"no_kk"},{label:"NIK",value:"nik"},{label:"NIUP",value:"niup"},{label:"Anak ke",value:"anak_ke"},{label:"Jumlah Saudara",value:"jumlah_saudara"},{label:"Alamat",value:"alamat"},{label:"Domisili Santri",value:"domisili_santri"},{label:"Pendidikan",value:"pendidikan"},{label:"Ibu Kandung",value:"ibu_kandung"}],[O,K]=t.useState(!1),A=tn(()=>K(!1),he);return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Khadam"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>K(!0),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer flex items-center gap-2",children:[e.jsx(Ee,{}),"Tambah "]})}),e.jsxs("button",{onClick:()=>s(!0),className:"px-4 py-2 rounded flex items-center gap-2 text-white cursor-pointer bg-blue-500 hover:bg-blue-700",children:[e.jsx(Je,{}),e.jsx("span",{children:"Export"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${U?"mb-4":""}`,children:[e.jsx(ue,{showFilters:U,filterOptions:p,onChange:h,selectedFilters:g}),e.jsx(ue,{showFilters:U,filterOptions:w,onChange:f,selectedFilters:_}),e.jsx(ue,{showFilters:U,filterOptions:c,onChange:u,selectedFilters:o}),e.jsx(ue,{showFilters:U,filterOptions:oe,onChange:J=>d(Se=>({...Se,...J})),selectedFilters:m}),e.jsx(ue,{showFilters:U,filterOptions:W,onChange:J=>d(Se=>({...Se,...J})),selectedFilters:m}),e.jsx(ue,{showFilters:U,filterOptions:X,onChange:J=>d(Se=>({...Se,...J})),selectedFilters:m})]}),e.jsx(Ce,{searchTerm:E,setSearchTerm:B,totalData:R,toggleFilters:()=>q(!U),toggleView:Y,limit:ne,toggleLimit:J=>te(Number(J.target.value))}),V?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):se==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:Q?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):D.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):D.map((J,Se)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex items-center space-x-4 cursor-pointer",onClick:()=>b(J),children:[e.jsx("img",{alt:J.nama||"-",className:"w-20 h-24 object-cover",src:J.foto_profil,onError:Ge=>{Ge.target.onerror=null,Ge.target.src=Me}}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl",children:J.nama||"-"}),e.jsx("p",{className:"text-gray-600",children:J.keterangan||"-"})]})]},J.id||Se))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIUP"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIK"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Deskripsi"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update Khadam"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input Khadam"})]})}),e.jsx("tbody",{className:"text-gray-800",children:Q?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):D.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-6",children:"Tidak ada data"})}):D.map((J,Se)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-left cursor-pointer",onClick:()=>b(J),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(z-1)*ne+Se+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.niup||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.nik||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.keterangan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.tgl_input||"-"})]},J.id||Se))})]})}),e.jsx(ea,{isOpen:a,onClose:()=>s(!1),filters:I,searchTerm:E,limit:ne,currentPage:z,fields:ae,endpoint:"export/khadam"}),e.jsx(an,{isOpen:O,onClose:()=>K(!1),formState:A}),n&&e.jsx(De,{title:"Khadam",menu:12,item:l,onClose:i}),Z>1&&e.jsx(Fe,{currentPage:z,totalPages:Z,handlePageChange:de})]})]})},kt=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},400);return()=>{clearTimeout(j)}},[c]);const S=t.useCallback(async()=>{let j=`${G}data-pokok/orangtua?limit=${i}`;if(u>1&&(j+=`&page=${u}`),_&&(j+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(j+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(j+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(j+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(j+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.jenisKelamin&&(j+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.jenisKelaminPesertaDidik&&(j+=`&jenis_kelamin_anak=${encodeURIComponent(a.jenisKelaminPesertaDidik)}`),a!=null&&a.wafatHidup&&(j+=`&wafat=${encodeURIComponent(a.wafatHidup)}`),a!=null&&a.smartcard&&(j+=`&smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.phoneNumber&&(j+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),v.current===j){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=j,console.log("Fetching data from:",j),n(!0),b(null);try{const y=await fetch(j);if(!y.ok)throw new Error(`${y.statusText}: ${y.status}`);const N=await y.json();console.log("Data dari API Orangtua:",N),l(Array.isArray(N.data)?N.data:[]),p(N.total_data||0),h(N.total_pages||1)}catch(y){console.error("Fetch error:",y),b(y.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{orangtua:s,loadingOrangtua:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataOrangtua:d,totalPages:g,currentPage:u,setCurrentPage:w}},nn=()=>{var B,V,ne,te;const[a,s]=t.useState(null),[l,r]=t.useState(!1),n=R=>{s(R),r(!0)},x=()=>{s(null),r(!1)},[b,i]=t.useState({phoneNumber:"",jenisKelamin:"",jenisKelaminPesertaDidik:"",negara:"",provinsi:"",kabupaten:"",kecamatan:"",wafatHidup:""}),{filterNegara:m,selectedNegara:d,handleFilterChangeNegara:p}=Ae(),g=((B=m.negara.find(R=>R.value==d.negara))==null?void 0:B.label)||"",h=((V=m.provinsi.find(R=>R.value==d.provinsi))==null?void 0:V.label)||"",c=((ne=m.kabupaten.find(R=>R.value==d.kabupaten))==null?void 0:ne.label)||"",o=((te=m.kecamatan.find(R=>R.value==d.kecamatan))==null?void 0:te.label)||"",u=t.useMemo(()=>({...b,negara:g,provinsi:h,kabupaten:c,kecamatan:o}),[b,g,h,c,o]),{orangtua:w,loadingOrangtua:_,searchTerm:f,setSearchTerm:v,error:S,limit:j,setLimit:y,totalDataOrangtua:N,totalPages:T,currentPage:C,setCurrentPage:P}=kt(u),[F,M]=t.useState(!1),[L,I]=t.useState("");t.useEffect(()=>{const R=sessionStorage.getItem("viewMode");R&&I(R)},[]);const D=R=>{R>=1&&R<=T&&P(R)},Q={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],jenisKelaminPesertaDidik:[{label:"Pilih Jenis Kelamin Peserta Didik",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}]},E={wafatHidup:[{label:"Pilih Wafat / Hidup",value:""},{label:"Sudah Wafat",value:"sudah wafat"},{label:"Masih Hidup",value:"masih hidup"}],smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]};return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Data Orang Tua"})}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${F?"mb-4":""}`,children:[e.jsx(ue,{showFilters:F,filterOptions:m,onChange:p,selectedFilters:d}),e.jsx(ue,{showFilters:F,filterOptions:Q,onChange:R=>i(Z=>({...Z,...R})),selectedFilters:b}),e.jsx(ue,{showFilters:F,filterOptions:E,onChange:R=>i(Z=>({...Z,...R})),selectedFilters:b})]}),e.jsx(Ce,{searchTerm:f,setSearchTerm:v,totalData:N,toggleFilters:()=>M(!F),toggleView:I,limit:j,toggleLimit:R=>y(Number(R.target.value))}),S?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):L==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-3 gap-3",children:_?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small"})}):w.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):w.map((R,Z)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex items-center space-x-4 cursor-pointer",onClick:()=>n(R),children:[e.jsx("img",{alt:R.nama||"-",className:"w-20 h-24 object-cover",src:R.foto_profil,onError:z=>{z.target.onerror=null,z.target.src=Me}}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl",children:R.nama||"-"}),e.jsxs("p",{className:"text-gray-600",children:["NIK: ",R.nik_or_passport||"-"]}),e.jsxs("p",{className:"text-gray-600",children:["Phone: ",R.telepon_1||R.telepon_2||"-"]})]})]},R.id_orangtua||Z))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIK"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Telepon 1"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Telepon 2"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kota Asal"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update Bio"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input Bio"})]})}),e.jsx("tbody",{className:"text-gray-800",children:_?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small"})})}):w.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-6",children:"Tidak ada data"})}):w.map((R,Z)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center cursor-pointer",onClick:()=>n(R),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(C-1)*j+Z+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:R.nik_or_passport||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:R.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:R.telepon_1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:R.telepon_2||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:R.kota_asal||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:R.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:R.tgl_input||"-"})]},R.id_orangtua||Z))})]})}),l&&e.jsx(De,{title:"Orang Tua",menu:6,item:a,onClose:x}),T>1&&e.jsx(Fe,{currentPage:C,totalPages:T,handlePageChange:D})]})]})},ft=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},400);return()=>{clearTimeout(j)}},[c]);const S=t.useCallback(async()=>{let j=`${G}data-pokok/pengajar?limit=${i}`;if(u>1&&(j+=`&page=${u}`),_&&(j+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(j+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(j+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(j+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(j+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(j+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.kategori&&a.kategori!=="Pilih Kategori Golongan"&&(j+=`&golongan_jabatan=${encodeURIComponent(a.kategori)}`),a!=null&&a.golongan&&a.golongan!=="Pilih Golongan"&&(j+=`&golongan=${encodeURIComponent(a.golongan)}`),a!=null&&a.jenisKelamin&&(j+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.jenisJabatan&&(j+=`&jabatan=${encodeURIComponent(a.jenisJabatan)}`),a!=null&&a.masaKerja&&(j+=`&masa_kerja=${encodeURIComponent(a.masaKerja)}`),a!=null&&a.smartcard&&(j+=`&smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.wargaPesantren&&(j+=`&warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.pemberkasan&&(j+=`&pemberkasan=${encodeURIComponent(a.pemberkasan)}`),a!=null&&a.phoneNumber&&(j+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),a!=null&&a.umur&&(j+=`&umur=${encodeURIComponent(a.umur)}`),a!=null&&a.totalMateriAjar&&(j+=`&materi_ajar=${encodeURIComponent(a.totalMateriAjar)}`),v.current===j){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=j,console.log("Fetching data from:",j),n(!0),b(null);try{const y=await fetch(j);if(!y.ok)throw new Error(`Gagal mengambil data: ${y.status}`);const N=await y.json();console.log("Data dari API:",N),l(Array.isArray(N.data)?N.data:[]),p(N.total_data||0),h(N.total_pages||1)}catch(y){console.error("Fetch error:",y),b(y.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{pengajar:s,loadingPengajar:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataPengajar:d,totalPages:g,currentPage:u,setCurrentPage:w}},pa=()=>{const[a,s]=t.useState([]),[l,r]=t.useState([]),[n,x]=t.useState(""),[b,i]=t.useState([]),[m,d]=t.useState(!0),[p,g]=t.useState([]);return t.useEffect(()=>{const h=sessionStorage.getItem("menuGolongan");if(h){const c=JSON.parse(h);r(c),s([{label:"Kategori Golongan",value:""},...c.map(o=>({value:o.id,label:o.kategoriGolongan_nama}))])}else fetch(`${G}dropdown/golongan`).then(c=>c.json()).then(c=>{s([{label:"Kategori Golongan",value:""},...c.kategori_golongan.map(o=>({value:o.id,label:o.kategoriGolongan_nama}))]),sessionStorage.setItem("menuGolongan",JSON.stringify(c.kategori_golongan)),r(c.kategori_golongan)}).catch(c=>{console.error("Error fetching data:",c),s([{label:"Kategori Golongan",value:""}])})},[]),t.useEffect(()=>{var h;if(!n)i([{label:"Golongan",value:""}]),d(!0);else{const c=((h=l.find(o=>o.id==n))==null?void 0:h.golongan)||[];i([{label:"Golongan",value:""},...c.map(o=>({value:o.id,label:o.GolonganNama}))]),d(!1)}},[n,l]),t.useEffect(()=>{if(l.length>0){const h=l.flatMap(o=>o.golongan.map(u=>({id:u.id,GolonganNama:u.GolonganNama}))),c=[{id:"",GolonganNama:"Pilih Golongan"},...h];g(c)}},[l]),{kategoriGolongan:a,filteredGolongan:b,setSelectedKategori:x,isGolonganDisabled:m,allGolonganList:p}},ln=()=>{var oe,W,X,ae,O,K,A;const[a,s]=t.useState(!1),[l,r]=t.useState(null),[n,x]=t.useState(!1),b=ee=>{r(ee),x(!0)},i=()=>{r(null),x(!1)},[m,d]=t.useState({negara:"",provinsi:"",kabupaten:"",kecamatan:"",kategori:"",golongan:"",lembaga:"",jenisJabatan:"",masaKerja:"",honeNumber:"",wargaPesantren:"",smartcard:"",pemberkasan:"",umur:"",totalMateriAjar:""}),[p,g]=t.useState({kategori:"",golongan:""}),{filterNegara:h,selectedNegara:c,handleFilterChangeNegara:o}=Ae(),{kategoriGolongan:u,filteredGolongan:w,setSelectedKategori:_}=pa(),{filterLembaga:f}=Te(),v=((oe=h.negara.find(ee=>ee.value==c.negara))==null?void 0:oe.label)||"",S=((W=h.provinsi.find(ee=>ee.value==c.provinsi))==null?void 0:W.label)||"",j=((X=h.kabupaten.find(ee=>ee.value==c.kabupaten))==null?void 0:X.label)||"",y=((ae=h.kecamatan.find(ee=>ee.value==c.kecamatan))==null?void 0:ae.label)||"",N=p.kategori?(O=u.find(ee=>ee.value==p.kategori))==null?void 0:O.label:void 0,T=p.golongan?(K=w.find(ee=>ee.value==p.golongan))==null?void 0:K.label:void 0,C=((A=f.lembaga.find(ee=>ee.value==m.lembaga))==null?void 0:A.label)||"",P=t.useMemo(()=>({...m,negara:v,provinsi:S,kabupaten:j,kecamatan:y,kategori:N,golongan:T,lembaga:C}),[m,T,j,N,y,C,v,S]),{pengajar:F,loadingPengajar:M,searchTerm:L,setSearchTerm:I,error:D,totalDataPengajar:Q,totalPages:E,limit:B,setLimit:V,currentPage:ne,setCurrentPage:te}=ft(P),[R,Z]=t.useState(!1),[z,me]=t.useState("");t.useEffect(()=>{const ee=sessionStorage.getItem("viewMode");ee&&me(ee)},[]);const he=ee=>{const ie=Object.keys(ee)[0],ce=Object.values(ee)[0];g(fe=>{const H={...fe,...ee};return ie==="kategori"&&(_(ce),H.golongan=""),H}),d(fe=>({...fe,[ie]:ce}))},U=ee=>{ee>=1&&ee<=E&&te(ee)},q={lembaga:f.lembaga,kategori:u,golongan:w,totalMateriAjar:[{label:"Pilih Total Materi Ajar",value:""},{label:"Kosong",value:"0"},{label:"1 Materi",value:"1"},{label:"Lebih dari 1 Materi",value:">1"},{label:"2 Materi",value:"2"},{label:"Lebih dari 2 Materi",value:">2"},{label:"3 Materi",value:"3"},{label:"Lebih dari 3 Materi",value:">3"}]},se={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],jenisJabatan:[{label:"Pilih Jenis jabatan",value:""},{label:"Kultural",value:"kultural"},{label:"Tetap",value:"tetap"},{label:"Kontrak",value:"kontrak"},{label:"Pengkaderan",value:"pengkaderan"}],masaKerja:[{label:"Pilih Masa Kerja",value:""},{label:"< 1 Tahun",value:"1"},{label:"1-5 Tahun",value:"1-5"},{label:"6-10 Tahun",value:"6-10"},{label:"11-15 Tahun",value:"11-15"},{label:"16-20 Tahun",value:"16-20"},{label:"21-25 Tahun",value:"21-25"},{label:"26-30 Tahun",value:"26-30"},{label:"31-40 Tahun",value:"31-40"},{label:"> 40 Tahun",value:"40-200"}]},Y={wargaPesantren:[{label:"Warga Pesantren",value:""},{label:"Memiliki NIUP",value:"memiliki niup"},{label:"Tanpa NIUP",value:"tanpa niup"}],pemberkasan:[{label:"Pemberkasan",value:""},{label:"Tidak Ada Berkas",value:"tidak ada berkas"},{label:"Tidak Ada Foto Diri",value:"tidak ada foto diri"},{label:"Memiliki Foto Diri",value:"memiliki foto diri"},{label:"Tidak Ada KK",value:"tidak ada kk"},{label:"Tidak Ada Akta Kelahiran",value:"tidak ada akta kelahiran"},{label:"Tidak Ada Ijazah",value:"tidak ada ijazah"}],umur:[{label:"Semua Umur",value:""},{label:"< 20 Tahun",value:"0-20"},{label:"20-29 Tahun",value:"20-29"},{label:"30-39 Tahun",value:"30-39"},{label:"40-49 Tahun",value:"40-49"},{label:"50-59 Tahun",value:"50-49"},{label:"60-65 Tahun",value:"60-65"},{label:"> 65 Tahun",value:"65-200"}]},de={smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]};return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Pengajar"}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:()=>ga(`${G}export/pengajar`,s),disabled:a,className:`px-4 py-2 rounded flex items-center gap-2 text-white cursor-pointer ${a?"bg-blue-300 cursor-not-allowed":"bg-blue-500 hover:bg-blue-700"}`,children:a?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-white"}),e.jsx("span",{children:"Loading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{}),e.jsx("span",{children:"Export"})]})})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-10 overflow-x-auto",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 sm:gap-4 w-full ${R?"mb-4":""}`,children:[e.jsx(ue,{showFilters:R,filterOptions:h,onChange:o,selectedFilters:c}),e.jsx(ue,{showFilters:R,filterOptions:q,onChange:he,selectedFilters:p}),e.jsx(ue,{showFilters:R,filterOptions:se,onChange:ee=>d(ie=>({...ie,...ee})),selectedFilters:m}),e.jsx(ue,{showFilters:R,filterOptions:Y,onChange:ee=>d(ie=>({...ie,...ee})),selectedFilters:m}),e.jsx(ue,{showFilters:R,filterOptions:de,onChange:ee=>d(ie=>({...ie,...ee})),selectedFilters:m})]}),e.jsx(Ce,{searchTerm:L,setSearchTerm:I,totalData:Q,toggleFilters:()=>Z(!R),toggleView:me,limit:B,toggleLimit:ee=>V(Number(ee.target.value))}),D?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):z==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:M?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):F.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):F.map((ee,ie)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex items-center space-x-4 cursor-pointer",onClick:()=>b(ee),children:[e.jsx("img",{alt:ee.nama||"-",className:"w-20 h-24 object-cover",src:ee.foto_profil,onError:ce=>{ce.target.onerror=null,ce.target.src=Me}}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl",children:ee.nama||"-"}),e.jsx("p",{className:"text-gray-600",children:ee.niup||"-"}),e.jsx("p",{className:"text-gray-600",children:ee.lembaga||"-"})]})]},ee.id||ie))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIUP"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Umur"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Pangkalan Lembaga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Materi Ajar"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Total Materi Ajar"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Masa Kerja"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Golonngan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Pendidikan Terakhir"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update Bio"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input Bio"})]})}),e.jsx("tbody",{className:"text-gray-800",children:M?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center p-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):F.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center p-4",children:"Tidak ada data"})}):F.map((ee,ie)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-left cursor-pointer",onClick:()=>b(ee),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(ne-1)*B+ie+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ee.niup||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ee.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ee.umur===0?0:ee.umur||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ee.lembaga||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ee.daftar_materi||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ee.total_materi===0?0:ee.total_materi||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ee.masa_kerja||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ee.golongan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ee.pendidikan_terakhir||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ee.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ee.tgl_input||"-"})]},ee.id_pengajar||ie))})]})}),n&&e.jsx(De,{title:"Pengajar",menu:8,item:l,onClose:i}),E>1&&e.jsx(Fe,{currentPage:ne,totalPages:E,handlePageChange:U})]})]})},yt=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},400);return()=>{clearTimeout(j)}},[c]);const S=t.useCallback(async()=>{let j=`${G}data-pokok/pengurus?limit=${i}`;if(u>1&&(j+=`&page=${u}`),_&&(j+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(j+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(j+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(j+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(j+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.satuanKerja&&a.satuanKerja!=="Pilih Satuan Kerja"&&(j+=`&satuan_kerja=${encodeURIComponent(a.satuanKerja)}`),a!=null&&a.golonganJabatan&&a.golonganJabatan!=="Pilih Golongan Jabatan"&&(j+=`&golongan=${encodeURIComponent(a.golonganJabatan)}`),a!=null&&a.jenisKelamin&&(j+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.smartcard&&(j+=`&smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.wargaPesantren&&(j+=`&warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.pemberkasan&&(j+=`&pemberkasan=${encodeURIComponent(a.pemberkasan)}`),a!=null&&a.phoneNumber&&(j+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),a!=null&&a.umur&&(j+=`&umur=${encodeURIComponent(a.umur)}`),a!=null&&a.jenisJabatan&&(j+=`&jabatan=${encodeURIComponent(a.jenisJabatan)}`),v.current===j){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=j,console.log("Fetching data from:",j),n(!0),b(null);try{const y=await fetch(j);if(!y.ok)throw p(0),h(1),new Error(`Gagal mengambil data: ${y.status} ${y.statusText}`);const N=await y.json();console.log("Data Pengurus dari API:",N),l(Array.isArray(N.data)?N.data:[]),p(N.total_data||0),h(N.total_pages||1)}catch(y){console.error("Fetch error:",y),b(y.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{pengurus:s,loadingPengurus:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataPengurus:d,totalPages:g,currentPage:u,setCurrentPage:w}},Pa=()=>{const[a,s]=t.useState([]);return t.useEffect(()=>{fetch(`${G}dropdown/satuan-kerja`).then(l=>l.json()).then(l=>{const r=[{label:"Pilih Satuan Kerja",value:""},...l.map(n=>({value:n.nama_satuan_kerja,label:n.nama_satuan_kerja}))];s(r)}).catch(l=>{console.error("Gagal mengambil data satuan kerja:",l),s([{label:"Pilih Satuan Kerja",value:""}])})},[]),{menuSatuanKerja:a}},rn=()=>{var Z,z,me,he;const[a,s]=t.useState(!1),[l,r]=t.useState(null),[n,x]=t.useState(!1),b=U=>{r(U),x(!0)},i=()=>{r(null),x(!1)},[m,d]=t.useState({phoneNumber:"",wargaPesantren:"",status:"",jenisKelamin:"",smartcard:"",pemberkasan:"",jenisJabatan:"",umur:"",satuanKerja:"",golonganJabatan:""}),{filterNegara:p,selectedNegara:g,handleFilterChangeNegara:h}=Ae(),{menuGolonganJabatan:c}=aa(),{menuSatuanKerja:o}=Pa(),u=((Z=p.negara.find(U=>U.value==g.negara))==null?void 0:Z.label)||"",w=((z=p.provinsi.find(U=>U.value==g.provinsi))==null?void 0:z.label)||"",_=((me=p.kabupaten.find(U=>U.value==g.kabupaten))==null?void 0:me.label)||"",f=((he=p.kecamatan.find(U=>U.value==g.kecamatan))==null?void 0:he.label)||"",v=t.useMemo(()=>({...m,negara:u,provinsi:w,kabupaten:_,kecamatan:f}),[m,_,f,u,w]),{pengurus:S,loadingPengurus:j,searchTerm:y,setSearchTerm:N,error:T,limit:C,setLimit:P,totalDataPengurus:F,totalPages:M,currentPage:L,setCurrentPage:I}=yt(v),[D,Q]=t.useState(!1),[E,B]=t.useState("");t.useEffect(()=>{const U=sessionStorage.getItem("viewMode");U&&B(U)},[]);const V=U=>{U>=1&&U<=M&&I(U)},ne={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"l"},{label:"Perempuan",value:"p"}],satuanKerja:o,jenisJabatan:[{label:"Pilih Jenis Jabatan",value:""},{label:"Kultural",value:"kultural"},{label:"Tetap",value:"tetap"},{label:"Kontrak",value:"kontrak"},{label:"Pengkaderan",value:"pengkaderan"}],golonganJabatan:c},te={wargaPesantren:[{label:"Warga Pesantren",value:""},{label:"Memiliki NIUP",value:"memiliki niup"},{label:"Tanpa NIUP",value:"tanpa niup"}],pemberkasan:[{label:"Pemberkasan",value:""},{label:"Tidak Ada Berkas",value:"tidak ada berkas"},{label:"Tidak Ada Foto Diri",value:"tidak ada foto diri"},{label:"Memiliki Foto Diri",value:"memiliki foto diri"},{label:"Tidak Ada KK",value:"tidak ada kk"},{label:"Tidak Ada Akta Kelahiran",value:"tidak ada akta kelahiran"},{label:"Tidak Ada Ijazah",value:"tidak ada ijazah"}],umur:[{label:"Semua Umur",value:""},{label:"< 20 Tahun",value:"0-20"},{label:"20-29 Tahun",value:"20-29"},{label:"30-39 Tahun",value:"30-39"},{label:"40-49 Tahun",value:"40-49"},{label:"50-59 Tahun",value:"50-59"},{label:"60-65 Tahun",value:"60-65"},{label:"> 65 Tahun",value:"65-200"}]},R={smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]};return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Pengurus"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:()=>ga(`${G}export/pengurus`,s),disabled:a,className:`px-4 py-2 rounded flex items-center gap-2 text-white cursor-pointer ${a?"bg-blue-300 cursor-not-allowed":"bg-blue-500 hover:bg-blue-700"}`,children:a?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-white"}),e.jsx("span",{children:"Loading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{}),e.jsx("span",{children:"Export"})]})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-10 overflow-x-auto",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${D?"mb-4":""}`,children:[e.jsx(ue,{showFilters:D,filterOptions:p,onChange:h,selectedFilters:g}),e.jsx(ue,{showFilters:D,filterOptions:ne,onChange:U=>d(q=>({...q,...U})),selectedFilters:m}),e.jsx(ue,{showFilters:D,filterOptions:te,onChange:U=>d(q=>({...q,...U})),selectedFilters:m}),e.jsx(ue,{showFilters:D,filterOptions:R,onChange:U=>d(q=>({...q,...U})),selectedFilters:m})]}),e.jsx(Ce,{searchTerm:y,setSearchTerm:N,totalData:F,limit:C,toggleLimit:U=>P(Number(U.target.value)),toggleFilters:()=>Q(!D),toggleView:B}),T?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):E==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:j?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):S.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):S.map((U,q)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex items-center space-x-4 cursor-pointer",onClick:()=>b(U),children:[e.jsx("img",{alt:U.nama||"-",className:"w-20 h-24 object-cover",src:U.foto_profil,onError:se=>{se.target.onerror=null,se.target.src=Me}}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl",children:U.nama||"-"}),e.jsx("p",{className:"text-gray-600",children:U.nik||"-"}),e.jsx("p",{className:"text-gray-600",children:U.jabatan||"-"})]})]},U.id||q))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIUP"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jabatan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Umur"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Satuan Kerja"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jenis"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Golongan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Pendidikan Terakhir"})]})}),e.jsx("tbody",{className:"text-gray-800",children:j?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):S.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"text-center py-6",children:"Tidak ada data"})}):S.map((U,q)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-left cursor-pointer",onClick:()=>b(U),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(L-1)*C+q+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:U.niup||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:U.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:U.jabatan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:U.umur===0?0:U.umur||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:U.satuan_kerja||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:U.jenis_jabatan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:U.golongan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:U.pendidikan_terakhir||"-"})]},U.id||q))})]})}),n&&e.jsx(De,{title:"Pengurus",menu:9,item:l,onClose:i}),M>1&&e.jsx(Fe,{currentPage:L,totalPages:M,handlePageChange:V})]})]})},wt=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},400);return()=>clearTimeout(j)},[c]);const S=t.useCallback(async(j=!1)=>{let y=`${G}data-pokok/pesertadidik?limit=${i}`;if(u>1&&(y+=`&page=${u}`),_&&(y+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.phoneNumber&&(y+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),a!=null&&a.wargaPesantren&&(y+=`&warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.status&&(y+=`&status=${encodeURIComponent(a.status)}`),a!=null&&a.jenisKelamin&&(y+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.smartcard&&(y+=`&smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.pemberkasan&&(y+=`&pemberkasan=${encodeURIComponent(a.pemberkasan)}`),a!=null&&a.urutBerdasarkan&&(y+=`&sort_by=${encodeURIComponent(a.urutBerdasarkan)}`),a!=null&&a.urutSecara&&(y+=`&sort_order=${encodeURIComponent(a.urutSecara)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(y+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(y+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(y+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(y+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&(y+=`&wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&(y+=`&blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&(y+=`&kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.angkatanPelajar&&(y+=`&angkatan_pelajar=${encodeURIComponent(a.angkatanPelajar)}`),a!=null&&a.angkatanSantri&&(y+=`&angkatan_santri=${encodeURIComponent(a.angkatanSantri)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(y+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&(y+=`&jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&(y+=`&kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&(y+=`&rombel=${encodeURIComponent(a.rombel)}`),!j&&v.current===y){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=y,console.log("Fetching data from:",y),n(!0),b(null);try{const N=await fetch(y);if(!N.ok)throw new Error(`${N.message}: ${N.status}`);const T=await N.json();console.log("Data dari API:",T),l(Array.isArray(T.data)?T.data:[]),p(T.total_data||0),h(T.total_pages||1)}catch(N){console.error("Fetch error:",N),b(N.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{pesertaDidik:s,loadingPesertaDidik:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataPesertaDidik:d,totalPages:g,currentPage:u,setCurrentPage:w,fetchData:S}},ba=({data:a,title:s,menu:l})=>{const[r,n]=t.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex items-center space-x-4 cursor-pointer",onClick:()=>n(!0),children:[e.jsx("img",{alt:a.nama||"-",className:"w-20 h-24 object-cover",src:a.foto_profil,onError:x=>{x.target.onerror=null,x.target.src=Me}}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl",children:a.nama}),e.jsxs("p",{className:"text-gray-600",children:["NIUP: ",a.niup]}),e.jsxs("p",{className:"text-gray-600",children:[" ",a.pendidikan_terakhir&&a.pendidikan_terakhir!=="-"&&a.lembaga&&a.lembaga!=="-"?e.jsxs(e.Fragment,{children:[a.pendidikan_terakhir," - ",a.lembaga]}):a.pendidikan_terakhir&&a.pendidikan_terakhir!=="-"?a.pendidikan_terakhir:a.lembaga&&a.lembaga!=="-"?a.lembaga:"-"]})]})]}),r&&e.jsx(De,{title:s,menu:l,item:a,onClose:()=>n(!1)})]})},on=({register:a,watch:s,setValue:l,control:r,activeTab:n})=>{const{filterNegara:x,selectedNegara:b,handleFilterChangeNegara:i}=Ae(),m=s("modalPeserta.kewarganegaraan"),d=s("modalPeserta.negara"),p=s("modalPeserta.provinsi"),g=s("modalPeserta.kabupaten"),h=s("modalPeserta.kecamatan"),c=f=>{const v=f.target.value;l("modalPeserta.kewarganegaraan",v),v==="wna"?(l("modalPeserta.no_kk",""),l("modalPeserta.nik","")):v==="wni"&&l("modalPeserta.no_passport","")};t.useEffect(()=>{n===0&&(console.log("handle"),d&&(console.log("negara handle ",d),i({negara:d})),p&&(console.log("provinsi handle ",p),i({provinsi:p})),g&&(console.log("kabupaten handle ",g),i({kabupaten:g})),h&&(console.log("kecamatan handle ",h),i({kecamatan:h})))},[n]);const o=(f,v)=>f.length>0?[{...f[0],label:v},...f.slice(1)]:f,u={negara:o(x.negara,"Pilih Negara"),provinsi:o(x.provinsi,"Pilih Provinsi"),kabupaten:o(x.kabupaten,"Pilih Kabupaten"),kecamatan:o(x.kecamatan,"Pilih Kecamatan")},w=f=>f.charAt(0).toUpperCase()+f.slice(1),_=({filterOptions:f,control:v,onChange:S,selectedFilters:j})=>e.jsx("div",{className:"space-y-2",children:Object.entries(f).map(([y,N],T)=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsxs("label",{htmlFor:y,className:"md:w-1/4 text-black",children:[w(y)," *"]}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md border border-gray-300 border-gray-500 ${N.length<=1?"bg-gray-200 text-gray-500":""}`,children:e.jsx(Xe,{name:`modalPeserta.${y}_id`,control:v,rules:{required:!0},defaultValue:j[y]||"",render:({field:C})=>e.jsx("select",{...C,id:y,required:!0,disabled:N.length<=1,className:`w-full py-1.5 pr-3 pl-1 text-base focus:outline-none sm:text-sm ${N.length<=1?"text-gray-500":""}`,onChange:P=>{C.onChange(P),S({[y]:P.target.value})},children:N.map((P,F)=>e.jsx("option",{value:P.value,children:P.label},F))})})})})]},`${y}-${T}`))});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"kewarganegaraan",className:"md:w-1/4 text-black",children:"Kewarganegaraan *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"kewarganegaraan",value:"wni",className:"w-4 h-4",...a("modalPeserta.kewarganegaraan",{required:!0}),checked:m==="wni",onChange:c,required:!0}),e.jsx("span",{children:"WNI"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"kewarganegaraan",value:"wna",className:"w-4 h-4",...a("modalPeserta.kewarganegaraan",{required:!0}),checked:m==="wna",onChange:c,required:!0}),e.jsx("span",{children:"WNA"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"passport",className:"md:w-1/4 text-black",children:"No Passport *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-500 ${m==="wna"?"bg-white border-gray-300 ":"bg-gray-300 border-gray-200"}`,children:e.jsx("input",{id:"no_passport",name:"no_passport",type:"text",maxLength:20,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},disabled:m!=="wna",placeholder:"Masukkan No Passport",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.no_passport",{required:m==="wna"}),required:m==="wna"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nokk",className:"md:w-1/4 text-black",children:"Nomor KK *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-500 ${m==="wni"?"bg-white border-gray-300 ":"bg-gray-300 border-gray-200"}`,children:e.jsx("input",{id:"no_kk",name:"no_kk",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},disabled:m!=="wni",placeholder:"Masukkan No KK",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.no_kk",{required:m==="wni"}),required:m==="wni"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4 ",children:[e.jsx("label",{htmlFor:"nonik",className:"md:w-1/4 text-black",children:"NIK *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-500 ${m==="wni"?"bg-white border-gray-300 ":"bg-gray-300 border-gray-200"}`,children:e.jsx("input",{id:"nik",name:"nik",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"").slice(0,16)},disabled:m!=="wni",placeholder:"Masukkan NIK",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.nik",{required:m==="wni"}),required:m==="wni"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama",className:"md:w-1/4 text-black",children:"Nama Lengkap *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama",name:"nama",type:"text",placeholder:"Masukkan Nama Lengkap",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.nama",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jenisKelamin",className:"md:w-1/4 text-black",children:"Jenis Kelamin *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"jenisKelamin",value:"p",className:"w-4 h-4",...a("modalPeserta.jenis_kelamin",{required:!0}),required:!0}),e.jsx("span",{children:"Perempuan"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"jenisKelamin",value:"l",className:"w-4 h-4",...a("modalPeserta.jenis_kelamin",{required:!0}),required:!0}),e.jsx("span",{children:"Laki-Laki"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tempatLahir",className:"md:w-1/4 text-black",children:"Tempat Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tempatLahir",name:"tempatLahir",type:"text",placeholder:"Masukkan Tempat Lahir",...a("modalPeserta.tempat_lahir",{required:!0}),required:!0,className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_lahir",className:"md:w-1/4 text-black",children:"Tanggal Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_lahir",name:"tanggal_lahir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.tanggal_lahir",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"anak_keberapa",className:"md:w-1/4 text-black",children:"Anak Ke *"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"anak_keberapa",name:"anak_keberapa",type:"number",min:"1",className:"w-13 py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.anak_keberapa")})}),e.jsx("span",{children:"Dari"}),e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"dari_saudara",name:"dari_saudara",type:"number",min:"1",className:"w-13 py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.dari_saudara")})})]})]}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tinggal_bersama",className:"md:w-1/4 text-black",children:"Tinggal Bersama"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tinggal_bersama",name:"tinggal_bersama",type:"text",placeholder:"Masukkan Tinggal Bersama",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.tinggal_bersama")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jenjang_pendidikan_terakhir",className:"md:w-1/4 text-black",children:"Jenjang Pendidikan Terakhir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsxs("select",{id:"jenjang_pendidikan_terakhir",name:"jenjang_pendidikan_terakhir",...a("modalPeserta.jenjang_pendidikan_terakhir"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"paud",children:"Paud"}),e.jsx("option",{value:"sd/mi",children:"SD/MI"}),e.jsx("option",{value:"smp/mts",children:"SMP/MTS"}),e.jsx("option",{value:"sma/smk/ma",children:"SMA/SMK/MA"}),e.jsx("option",{value:"d3",children:"D3"}),e.jsx("option",{value:"d4",children:"D4"}),e.jsx("option",{value:"s1",children:"S1"}),e.jsx("option",{value:"s2",children:"S2"})]})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama_pendidikan_terakhir",className:"md:w-1/4 text-black",children:"Nama Pendidikan Terakhir"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama_pendidikan_terakhir",name:"nama_pendidikan_terakhir",type:"text",placeholder:"Masukkan Nama Pendidikan Terakhir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.nama_pendidikan_terakhir")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon",className:"md:w-1/4 text-black",children:"Nomor Telepon 1"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon",name:"no_telepon",type:"tel",maxLength:20,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.no_telepon",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon_2",className:"md:w-1/4 text-black",children:"Nomor Telepon 2"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon_2",name:"no_telepon_2",type:"tel",maxLength:20,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.no_telepon_2")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"email",className:"md:w-1/4 text-black",children:"E-Mail"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"email",name:"email",type:"email",maxLength:100,placeholder:"Masukkan E-Mail",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.email",{required:!0}),required:!0})})})]}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsx(_,{filterOptions:u,onChange:i,selectedFilters:b,control:r}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jalan",className:"md:w-1/4 text-black",children:"Jalan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"jalan",name:"jalan",type:"text",maxLength:255,placeholder:"Masukkan Nama Jalan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.jalan",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"kodepos",className:"md:w-1/4 text-black",children:"Kode Pos *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"kodepos",name:"kodepos",type:"text",maxLength:10,pattern:"\\d*",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},inputMode:"numeric",placeholder:"Masukkan Kode Pos",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.kode_pos",{required:!0}),required:!0})})})]})]})})},dn=({register:a,errors:s})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-bold text-xl",children:"Data Ayah"}),e.jsx("hr",{className:"border-t border-gray-500 mb-4 mt-2"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nik_ayah",className:"md:w-1/4 text-black",children:"NIK Ayah *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsxs("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:[e.jsx("input",{id:"nik_ayah",name:"nik_ayah",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:l=>{l.target.value=l.target.value.replace(/[^0-9]/g,"").slice(0,16)},placeholder:"Masukkan NIK Ayah",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.nik_ayah",{required:!0}),required:!0}),s.no_kk&&e.jsx("span",{children:"KK wajib diisi"})]})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama_ayah",className:"md:w-1/4 text-black",children:"Nama Ayah *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama_ayah",name:"nama_ayah",type:"text",placeholder:"Masukkan Nama Ayah",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.nama_ayah",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tempat_lahir_ayah",className:"md:w-1/4 text-black",children:"Tempat Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tempat_lahir_ayah",name:"tempat_lahir_ayah",type:"text",placeholder:"Masukkan Tempat Lahir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.tempat_lahir_ayah",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_lahir_ayah",className:"md:w-1/4 text-black",children:"Tanggal Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_lahir_ayah",name:"tanggal_lahir_ayah",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.tanggal_lahir_ayah",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon_ayah",className:"md:w-1/4 text-black",children:"Nomor Telepon Ayah *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon_ayah",name:"no_telepon_ayah",type:"number",placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.no_telepon_ayah",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"pendidikan_terakhir_ayah",className:"md:w-1/4 text-black",children:"Jenjang Pendidikan Terakhir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsxs("select",{id:"pendidikan_terakhir_ayah",name:"pendidikan_terakhir_ayah",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",...a("modalPeserta.pendidikan_terakhir_ayah",{required:!0}),required:!0,children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"paud",children:"Paud"}),e.jsx("option",{value:"sd/mi",children:"SD/MI"}),e.jsx("option",{value:"smp/mts",children:"SMP/MTS"}),e.jsx("option",{value:"sma/smk/ma",children:"SMA/SMK/MA"}),e.jsx("option",{value:"d3",children:"D3"}),e.jsx("option",{value:"d4",children:"D4"}),e.jsx("option",{value:"s1",children:"S1"}),e.jsx("option",{value:"s2",children:"S2"})]})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"pekerjaan_ayah",className:"md:w-1/4 text-black",children:"Pekerjaan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"pekerjaan_ayah",name:"pekerjaan_ayah",type:"text",placeholder:"Masukkan Pekerjaan Ayah",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.pekerjaan_ayah",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"penghasilan_ayah",className:"md:w-1/4 text-black",children:"Penghasilan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"penghasilan_ayah",name:"penghasilan_ayah",type:"number",placeholder:"1.000.000",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.penghasilan_ayah",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"wafat_ayah",className:"md:w-1/4 text-black",children:"Wafat *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"wafat_ayah",value:"0",className:"w-4 h-4",...a("modalPeserta.wafat_ayah",{required:!0}),required:!0}),e.jsx("span",{children:"Tidak"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"wafat_ayah",value:"1",className:"w-4 h-4",...a("modalPeserta.wafat_ayah",{required:!0}),required:!0}),e.jsx("span",{children:"Ya"})]})]}),e.jsx("hr",{className:"border-t border-gray-500 mb-2 mt-8"}),e.jsx("p",{className:"font-bold text-xl",children:"Data Ibu"}),e.jsx("hr",{className:"border-t border-gray-500 mb-4 mt-2"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nik_ibu",className:"md:w-1/4 text-black",children:"NIK Ibu *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nik_ibu",name:"nik_ibu",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:l=>{l.target.value=l.target.value.replace(/[^0-9]/g,"").slice(0,16)},placeholder:"Masukkan NIK Ibu",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.nik_ibu",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama_ibu",className:"md:w-1/4 text-black",children:"Nama Ibu *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama_ibu",name:"nama_ibu",type:"text",placeholder:"Masukkan Nama Ibu",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.nama_ibu",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tempat_lahir_ibu",className:"md:w-1/4 text-black",children:"Tempat Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tempat_lahir_ibu",name:"tempat_lahir_ibu",type:"text",placeholder:"Masukkan Tempat Lahir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.tempat_lahir_ibu",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_lahir_ibu",className:"md:w-1/4 text-black",children:"Tanggal Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_lahir_ibu",name:"tanggal_lahir_ibu",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.tanggal_lahir_ibu",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon_ibu",className:"md:w-1/4 text-black",children:"Nomor Telepon Ibu *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon_ibu",name:"no_telepon_ibu",type:"number",placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.no_telepon_ibu",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"pendidikan_terakhir_ibu",className:"md:w-1/4 text-black",children:"Jenjang Pendidikan Terakhir"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsxs("select",{id:"pendidikan_terakhir_ibu",name:"pendidikan_terakhir_ibu",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",...a("modalPeserta.pendidikan_terakhir_ibu",{required:!0}),required:!0,children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"paud",children:"Paud"}),e.jsx("option",{value:"sd/mi",children:"SD/MI"}),e.jsx("option",{value:"smp/mts",children:"SMP/MTS"}),e.jsx("option",{value:"sma/smk/ma",children:"SMA/SMK/MA"}),e.jsx("option",{value:"d3",children:"D3"}),e.jsx("option",{value:"d4",children:"D4"}),e.jsx("option",{value:"s1",children:"S1"}),e.jsx("option",{value:"s2",children:"S2"})]})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"pekerjaan_ibu",className:"md:w-1/4 text-black",children:"Pekerjaan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"pekerjaan_ibu",name:"pekerjaan_ibu",type:"text",placeholder:"Masukkan Pekerjaan Ibu",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.pekerjaan_ibu",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"penghasilan_ibu",className:"md:w-1/4 text-black",children:"Penghasilan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"penghasilan_ibu",name:"penghasilan_ibu",type:"number",placeholder:"1.000.000",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.penghasilan_ibu",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"wafat_ibu",className:"md:w-1/4 text-black",children:"Wafat *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"wafat_ibu",value:"0",className:"w-4 h-4",...a("modalPeserta.wafat_ibu",{required:!0}),required:!0}),e.jsx("span",{children:"Tidak"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"wafat_ibu",value:"1",className:"w-4 h-4",...a("modalPeserta.wafat_ibu",{required:!0}),required:!0}),e.jsx("span",{children:"Ya"})]})]}),e.jsx("hr",{className:"border-t border-gray-500 mb-2 mt-8"}),e.jsx("p",{className:"font-bold text-xl",children:"Data Wali"}),e.jsx("hr",{className:"border-t border-gray-500 mb-4 mt-2"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nik_wali",className:"md:w-1/4 text-black",children:"NIK Wali *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nik_wali",name:"nik_wali",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:l=>{l.target.value=l.target.value.replace(/[^0-9]/g,"").slice(0,16)},placeholder:"Masukkan NIK Wali",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.nik_wali",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama_wali",className:"md:w-1/4 text-black",children:"Nama Wali *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama_wali",name:"nama_wali",type:"text",placeholder:"Masukkan Nama Wali",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.nama_wali",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tempat_lahir_wali",className:"md:w-1/4 text-black",children:"Tempat Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tempat_lahir_wali",name:"tempat_lahir_wali",type:"text",placeholder:"Masukkan Tempat Lahir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.tempat_lahir_wali",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_lahir_wali",className:"md:w-1/4 text-black",children:"Tanggal Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_lahir_wali",name:"tanggal_lahir_wali",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.tanggal_lahir_wali",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon_wali",className:"md:w-1/4 text-black",children:"Nomor Telepon Wali *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon_wali",name:"no_telepon_wali",type:"number",placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.no_telepon_wali",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"pendidikan_terakhir_wali",className:"md:w-1/4 text-black",children:"Jenjang Pendidikan Terakhir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsxs("select",{id:"pendidikan_terakhir_wali",name:"pendidikan_terakhir_wali",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",...a("modalPeserta.pendidikan_terakhir_wali",{required:!0}),required:!0,children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"paud",children:"Paud"}),e.jsx("option",{value:"sd/mi",children:"SD/MI"}),e.jsx("option",{value:"smp/mts",children:"SMP/MTS"}),e.jsx("option",{value:"sma/smk/ma",children:"SMA/SMK/MA"}),e.jsx("option",{value:"d3",children:"D3"}),e.jsx("option",{value:"d4",children:"D4"}),e.jsx("option",{value:"s1",children:"S1"}),e.jsx("option",{value:"s2",children:"S2"})]})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"pekerjaan_wali",className:"md:w-1/4 text-black",children:"Pekerjaan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"pekerjaan_wali",name:"pekerjaan_wali",type:"text",placeholder:"Masukkan Pekerjaan Wali",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.pekerjaan_wali",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"penghasilan_wali",className:"md:w-1/4 text-black",children:"Penghasilan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"penghasilan_wali",name:"penghasilan_wali",type:"number",placeholder:"1.000.000",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.penghasilan_wali",{required:!0}),required:!0})})})]})]})}),da=()=>{const[a,s]=t.useState([]),[l,r]=t.useState([]);return t.useEffect(()=>{const n=sessionStorage.getItem("menuAngkatan");if(n){const x=JSON.parse(n);s([{label:"Pilih Angkatan",value:""},...x.pelajar.map(b=>({value:b.id,label:b.label}))]),r([{label:"Pilih Angkatan",value:""},...x.santri.map(b=>({value:b.id,label:b.label}))])}else fetch(`${G}dropdown/angkatan`).then(x=>x.json()).then(x=>{const b=x.data.pelajar||[],i=x.data.santri||[];sessionStorage.setItem("menuAngkatan",JSON.stringify({pelajar:b,santri:i})),s([{label:"Pilih Angkatan",value:""},...b.map(m=>({value:m.id,label:m.label}))]),r([{label:"Pilih Angkatan",value:""},...i.map(m=>({value:m.id,label:m.label}))])}).catch(x=>{console.error("Error fetching data:",x),s([{label:"Pilih Angkatan",value:""}]),r([{label:"Pilih Angkatan",value:""}])})},[]),{menuAngkatanPelajar:a,menuAngkatanSantri:l}},cn=({register:a,control:s,watch:l,activeTab:r,setValue:n})=>{const x=l("modalPeserta.lembaga_id"),b=l("modalPeserta.jurusan_id"),i=l("modalPeserta.kelas_id"),m=l("modalPeserta.rombel_id"),d=l("modalPeserta.wilayah_id"),p=l("modalPeserta.blok_id"),g=l("modalPeserta.kamar_id"),h=l("modalPeserta.mondok"),c=h==="0",{filterLembaga:o,selectedLembaga:u,handleFilterChangeLembaga:w}=Te(),{menuAngkatanPelajar:_,menuAngkatanSantri:f}=da(),{filterWilayah:v,selectedWilayah:S,handleFilterChangeWilayah:j}=Be();t.useEffect(()=>{h==="0"&&(n("modalPeserta.wilayah_id",""),n("modalPeserta.blok_id",""),n("modalPeserta.kamar_id",""),n("modalPeserta.tanggal_masuk_domisili",""))},[h,n]),t.useEffect(()=>{r===2&&(x&&o.lembaga.length>=1&&w({lembaga:x}),b&&o.jurusan.length>=1&&w({jurusan:b}),i&&o.kelas.length>=1&&w({kelas:i}),m&&o.rombel.length>=1&&w({rombel:m}),d&&v.wilayah.length>=1&&j({wilayah:d}),p&&v.blok.length>=1&&j({blok:p}),g&&v.kamar.length>=1&&j({kamar:g}))},[r,o.lembaga,o.lembaga.length,v.wilayah,v,v.wilayah.length]);const y=T=>T.charAt(0).toUpperCase()+T.slice(1),N=({filterOptions:T,control:C,onChange:P,selectedFilters:F,disabled:M=!1})=>{const L=l("modalPeserta.wilayah_id");return e.jsx("div",{className:"space-y-2",children:Object.entries(T).map(([I,D],Q)=>{const E=I==="blok"||I==="kamar",B=D.length<=1||M||E&&!L;return e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsxs("label",{htmlFor:I,className:"md:w-1/4 text-black",children:[y(I)," *"]}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md border border-gray-300 border-gray-500 ${B?"bg-gray-200 text-gray-500":""}`,children:e.jsx(Xe,{name:`modalPeserta.${I}_id`,control:C,rules:{required:!0},defaultValue:F[I]||"",render:({field:V})=>e.jsx("select",{...V,id:I,required:!0,disabled:B,className:`w-full py-1.5 pr-3 pl-1 text-base focus:outline-none sm:text-sm ${B?"text-gray-500":""}`,onChange:ne=>{V.onChange(ne),P({[I]:ne.target.value})},children:D.map((ne,te)=>e.jsx("option",{value:ne.value,children:ne.label},te))})})})})]},`${I}-${Q}`)})})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-bold text-xl",children:"Mondok "}),e.jsx("hr",{className:"border-t border-gray-500 mb-4 mt-2"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"mondok",className:"md:w-1/4 text-black",children:"Mondok"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"mondok",value:"1",className:"w-4 h-4",...a("modalPeserta.mondok",{required:!0}),required:!0}),e.jsx("span",{children:"Ya"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"mondok",value:"0",className:"w-4 h-4",...a("modalPeserta.mondok",{required:!0}),required:!0}),e.jsx("span",{children:"Tidak"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nis",className:"md:w-1/4 text-black",children:"NIS"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nis",name:"nis",type:"text",inputMode:"numeric",onInput:T=>{T.target.value=T.target.value.replace(/[^0-9]/g,"").slice(0,15)},maxLength:15,placeholder:"Masukkan NIS",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.nis",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"angkatan_santri_id",className:"md:w-1/4 text-black",children:"Angkatan Santri *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("select",{id:"angkatan_santri_id",name:"angkatan_santri_id",...a("modalPeserta.angkatan_santri_id"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",children:f.map((T,C)=>e.jsx("option",{value:T.value,children:T.label},C))})})})]}),e.jsx("hr",{className:"border-t border-gray-500 mb-2 mt-8"}),e.jsx("p",{className:"font-bold text-xl",children:"Domisili"}),e.jsx("hr",{className:"border-t border-gray-500 mt-2"}),e.jsx("p",{className:"text-sm text-red-500 italic mt-1 mb-4",children:"* Bagian domisili ini boleh dikosongi"}),e.jsx(N,{filterOptions:v,onChange:j,selectedFilters:S,control:s,disabled:c}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_masuk_domisili",className:"md:w-1/4 text-black",children:"Tanggal Masuk Domisili *"}),e.jsx("div",{className:`md:w-full md:max-w-md max-w-none ${c?"bg-gray-200 text-gray-500":""}`,children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_masuk_domisili",name:"tanggal_masuk_domisili",disabled:c,className:`w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm ${c?"bg-gray-200 text-gray-500":""}`,...a("modalPeserta.tanggal_masuk_domisili",{required:!0}),required:!0})})})]}),e.jsx("hr",{className:"border-t border-gray-500 mb-2 mt-8"}),e.jsx("p",{className:"font-bold text-xl",children:"Pendidikan"}),e.jsx("hr",{className:"border-t border-gray-500 mt-2"}),e.jsx("p",{className:"text-sm text-red-500 italic mt-1 mb-4",children:"* Bagian Pendidikan ini boleh dikosongi"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_induk",className:"md:w-1/4 text-black",children:"No. Induk *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_induk",name:"no_induk",type:"text",inputMode:"numeric",onInput:T=>{T.target.value=T.target.value.replace(/[^0-9]/g,"")},placeholder:"Masukkan No. Induk",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.no_induk",{required:!0}),required:!0})})})]}),e.jsx(N,{filterOptions:o,onChange:w,selectedFilters:u,control:s}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"angkatan_pelajar_id",className:"md:w-1/4 text-black",children:"Angkatan Pelajar *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("select",{id:"angkatan_pelajar_id",name:"angkatan_pelajar_id",...a("modalPeserta.angkatan_pelajar_id"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",required:!0,children:_.map((T,C)=>e.jsx("option",{value:T.value,children:T.label},C))})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_masuk_pendidikan",className:"md:w-1/4 text-black",children:"Tanggal Masuk Pendidikan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_masuk_pendidikan",name:"tanggal_masuk_pendidikan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPeserta.tanggal_masuk_pendidikan",{required:!0}),required:!0})})})]})]})})},Ga=({id:a,label:s,required:l,selected:r,onRemove:n,onFileChange:x,control:b,nameModal:i})=>{const m=(p,g)=>{const h=p.target.files[0];if(h){if(h.size>2097152){alert("Ukuran file maksimal 2MB");return}x(h),g(h)}},d=(p,g)=>{p.preventDefault();const h=p.dataTransfer.files[0];if(h){if(h.size>2097152){alert("Ukuran file maksimal 2MB");return}x(h),g(h)}};return e.jsx(Xe,{control:b,name:`${i}.file_${a}`,rules:{required:l&&!r},defaultValue:null,render:({field:p,fieldState:g})=>e.jsxs("div",{className:"p-4 rounded-xl border shadow-sm bg-white",children:[e.jsxs("label",{className:"block text-sm font-semibold mb-2",children:[s," ",l&&e.jsx("span",{className:"text-red-500",children:"* Wajib"})]}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsxs("label",{htmlFor:`dropzone-${a}`,onDragOver:h=>h.preventDefault(),onDrop:h=>d(h,p.onChange),className:`relative flex flex-col items-center justify-center w-full aspect-[4/3] min-h-[150px] cursor-pointer ${r?"":"bg-gray-50 hover:bg-gray-100 border-2 border-gray-300 border-dashed rounded-lg"}`,children:[r?r.file_path.type.startsWith("image")?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:r.preview,alt:s,className:"h-full object-contain w-full"}),e.jsx("button",{type:"button",onClick:()=>n(a),className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded hover:bg-red-600",children:e.jsx(ge,{icon:Ne,className:"text-xl"})})]}):e.jsxs("div",{className:"text-center p-4",children:[e.jsx("p",{className:"text-sm font-semibold",children:"File PDF telah diunggah"}),e.jsx("p",{className:"text-blue-600 underline",children:"Klik untuk ganti"})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx("svg",{className:"w-8 h-8 mb-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 16",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})}),e.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[e.jsx("span",{className:"font-semibold",children:"Klik untuk upload"})," atau drag & drop"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PDF, JPG, PNG (max 2MB)"})]}),e.jsx("input",{id:`dropzone-${a}`,type:"file",accept:".pdf,.jpg,.jpeg,.png",required:l&&!r,onChange:h=>m(h,p.onChange),className:"hidden"})]}),g.invalid&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"Berkas ini wajib diunggah."})]})]})})},mn=({control:a,setValue:s,jenisBerkasList:l})=>{const[r,n]=t.useState([]),x=Ra({control:a,name:l.map(({id:i})=>`modalPeserta.file_${i}`)});t.useEffect(()=>{if(!x)return;const i=l.map(({id:m},d)=>{const p=x[d];return p?{jenis_berkas_id:m,file_path:p,preview:URL.createObjectURL(p)}:null}).filter(Boolean);return n(i),()=>{i.forEach(m=>URL.revokeObjectURL(m.preview))}},[JSON.stringify(x)]);const b=i=>{n(m=>m.filter(d=>d.jenis_berkas_id!==i)),s(`modalPeserta.file_${i}`,null)};return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.map(({id:i,label:m,required:d})=>{const p=r.find(g=>g.jenis_berkas_id===i);return e.jsx(Ga,{id:i,label:m,required:d,selected:p,onRemove:b,onFileChange:g=>{const h=r.filter(c=>c.jenis_berkas_id!==i);h.push({jenis_berkas_id:i,file_path:g,preview:URL.createObjectURL(g)}),n(h)},control:a,nameModal:"modalPeserta"},i)})})};function un({isOpen:a,onClose:s,formState:l}){var f;const{register:r,handleSubmit:n,control:x,setValue:b,resetData:i,watch:m,errors:d,activeTab:p,unlockedTabs:g,setActiveTab:h,nextStep:c,prevStep:o,onValidSubmit:u,onInvalidSubmit:w}=l,_=[{id:0,label:"Biodata",content:e.jsx(on,{register:r,watch:m,setValue:b,control:x,activeTab:p})},{id:1,label:"Keluarga",content:e.jsx(dn,{register:r,errors:d})},{id:2,label:"Domisili & Pendidikan",content:e.jsx(cn,{register:r,control:x,watch:m,activeTab:p,setValue:b})},{id:3,label:"Berkas",content:e.jsx(mn,{errors:d,control:x,setValue:b,jenisBerkasList:ta})}];return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 overflow-y-auto",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"bg-white p-6 rounded-lg shadow-xl max-w-3xl w-full h-full relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx("div",{className:"pb-4",children:e.jsx(re.Title,{className:"text-lg font-semibold text-gray-900",children:"Tambah Data Peserta Didik"})}),e.jsxs("form",{onSubmit:n(u,w),className:"flex-1 overflow-y-auto p-2",children:[e.jsx("ul",{className:"flex flex-wrap text-sm font-medium text-center text-gray-500 border-b border-gray-500",children:_.map(v=>e.jsx("li",{children:e.jsx("button",{type:"button",onClick:S=>{S.stopPropagation(),g.includes(v.id)&&h(v.id)},className:`inline-block p-3 rounded-t-lg border-b-2 ${p===v.id?"text-blue-600 border-blue-600 bg-gray-200":g.includes(v.id)?"border-transparent hover:text-gray-600 hover:bg-gray-50":"border-transparent text-gray-300 cursor-not-allowed"}`,disabled:!g.includes(v.id),children:v.label})},v.id))}),e.jsx("div",{className:"pt-4",children:(f=_.find(v=>v.id===p))==null?void 0:f.content})]}),e.jsxs("div",{className:"mt-4 pt-4 flex justify-between",children:[p>0&&e.jsxs("button",{onClick:o,className:"inline-flex items-center gap-2 rounded-md bg-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-400",children:[e.jsx(ya,{}),"Sebelumnya"]}),e.jsxs("div",{className:"ml-auto space-x-2",children:[p<_.length&&e.jsxs("button",{type:"button",onClick:i,className:"inline-flex items-center gap-2 rounded-md bg-red-500 px-4 py-2 text-sm font-medium text-white hover:bg-red-600",children:[e.jsx(wa,{}),"Reset"]}),p<_.length-1?e.jsxs("button",{type:"button",onClick:c,className:"inline-flex items-center gap-2 rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700",children:["Selanjutnya",e.jsx(va,{})]}):e.jsxs("button",{type:"button",onClick:n(u,w),className:"inline-flex items-center gap-2 rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white hover:bg-green-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-green-500 focus-visible:ring-offset-2",children:[e.jsx(Na,{}),"Simpan"]})]})]})]})})})]})})}function hn(a,s,l){const[r,n]=t.useState(0),[x,b]=t.useState([0]),{clearAuthData:i}=ke(),m=je(),{register:d,handleSubmit:p,trigger:g,watch:h,setValue:c,reset:o,control:u,formState:{errors:w}}=ma(),_=h();t.useEffect(()=>{console.log("Data inputan berubah:",_)},[_]);const f=async()=>{const T=document.querySelector("form");if(T&&!T.reportValidity()||!await g(S(r)))return;const P=r+1;x.includes(P)||b([...x,P]),n(P)},v=()=>{const T=r-1;T>=0&&n(T)},S=T=>{switch(T){case 0:return[];case 1:return[];case 2:return[];case 3:return[];default:return[]}},j=async T=>{const C=s.filter(F=>F.required).filter(F=>{var M;return!((M=T.modalPeserta)!=null&&M[`file_${F.id}`])});if(C.length>0){k.fire({icon:"warning",title:"Berkas wajib diunggah",html:C.map(F=>`- ${F.label}`).join("<br>")});return}try{if(!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)return;k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const M=new FormData;T.modalPeserta&&Object.entries(T.modalPeserta).forEach(([B,V])=>{B.startsWith("file_")||M.append(B,V)});const L=[];for(let B=1;B<=18;B++){const V=`file_${B}`;T.modalPeserta[V]&&L.push({file:T.modalPeserta[V],jenis_berkas_id:B.toString()})}L.forEach((B,V)=>{console.log(`berkas[${V}][jenis_berkas_id]:`,B.jenis_berkas_id),console.log(`berkas[${V}][file_path]:`,B.file)}),L.forEach((B,V)=>{M.append(`berkas[${V}][jenis_berkas_id]`,B.jenis_berkas_id),M.append(`berkas[${V}][file_path]`,B.file)});for(var P of M.entries())console.log(P[0]+":",P[1]);const I=xe("token")||sessionStorage.getItem("token"),D=await fetch(`${G}crud/pesertadidik`,{method:"POST",headers:{Authorization:`Bearer ${I}`},body:M}),Q=await D.json();if(console.log(Q),D.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),i(),m("/login");return}if(k.close(),!D.ok){const B=Q.errors?Object.entries(Q.errors).map(([V,ne])=>`- ${V.replace(/_/g," ")}: ${ne.join(", ")}`):[Q.message||"Gagal mengirim data"];throw await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${B.join("<br>")}</div>`}),new Error(Q.message)}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."});const E={...Object.fromEntries(Object.keys(T.modalPeserta||{}).map(B=>[B,""])),...Object.fromEntries(Array.from({length:18},(B,V)=>[`file_${V+1}`,null]))};o({modalPeserta:E}),l==null||l(!0),a==null||a(),N()}catch(F){console.error("Terjadi kesalahan:",F)}},y=T=>{console.log(T);const C=Object.keys(T).filter(P=>P.startsWith("file_")).map(P=>{const F=parseInt(P.split("_")[1],10),M=s.find(L=>L.id===F);return`- ${(M==null?void 0:M.label)||`Berkas ${F}`} wajib diisi`});C.length>0&&k.fire({icon:"warning",title:"Berkas wajib diunggah",html:`<pre style="text-align: left;">${C.join("<br>")}</pre>`})},N=()=>{const T=h("modalPeserta")||{},C={...Object.fromEntries(Object.keys(T).map(P=>[P,""])),...Object.fromEntries(Array.from({length:18},(P,F)=>[`file_${F+1}`,null]))};o({modalPeserta:C}),n(0),b([0])};return{register:d,handleSubmit:p,control:u,setValue:c,resetData:N,watch:h,errors:w,activeTab:r,unlockedTabs:x,setActiveTab:n,nextStep:f,prevStep:v,onValidSubmit:j,onInvalidSubmit:y}}const xn=()=>{var ee,ie,ce,fe,H,ve,Pe,$,we,Re,qe;const[a,s]=t.useState(!1),[l,r]=t.useState(null),[n,x]=t.useState(!1),b=J=>{r(J),x(!0)},i=()=>{r(null),x(!1)},[m,d]=t.useState({phoneNumber:"",wargaPesantren:"",status:"",jenisKelamin:"",smartcard:"",pemberkasan:"",urutBerdasarkan:"",urutSecara:"",negara:"",provinsi:"",kabupaten:"",kecamatan:"",wilayah:"",blok:"",kamar:"",angkatanPelajar:"",angkatanSantri:""}),{filterNegara:p,selectedNegara:g,handleFilterChangeNegara:h}=Ae(),{filterWilayah:c,selectedWilayah:o,handleFilterChangeWilayah:u}=Be(),{filterLembaga:w,selectedLembaga:_,handleFilterChangeLembaga:f}=Te(),v=((ee=p.negara.find(J=>J.value==g.negara))==null?void 0:ee.label)||"",S=((ie=p.provinsi.find(J=>J.value==g.provinsi))==null?void 0:ie.label)||"",j=((ce=p.kabupaten.find(J=>J.value==g.kabupaten))==null?void 0:ce.label)||"",y=((fe=p.kecamatan.find(J=>J.value==g.kecamatan))==null?void 0:fe.label)||"",N=((H=c.wilayah.find(J=>J.value==o.wilayah))==null?void 0:H.label)||"",T=((ve=c.blok.find(J=>J.value==o.blok))==null?void 0:ve.label)||"",C=((Pe=c.kamar.find(J=>J.value==o.kamar))==null?void 0:Pe.label)||"",P=(($=w.lembaga.find(J=>J.value==_.lembaga))==null?void 0:$.label)||"",F=((we=w.jurusan.find(J=>J.value==_.jurusan))==null?void 0:we.label)||"",M=((Re=w.kelas.find(J=>J.value==_.kelas))==null?void 0:Re.label)||"",L=((qe=w.rombel.find(J=>J.value==_.rombel))==null?void 0:qe.label)||"",I=t.useMemo(()=>({...m,negara:v,provinsi:S,kabupaten:j,kecamatan:y,wilayah:N,blok:T,kamar:C,lembaga:P,jurusan:F,kelas:M,rombel:L}),[T,m,F,j,C,y,M,P,v,S,L,N]),{pesertaDidik:D,loadingPesertaDidik:Q,searchTerm:E,setSearchTerm:B,error:V,limit:ne,setLimit:te,totalDataPesertaDidik:R,totalPages:Z,currentPage:z,setCurrentPage:me,fetchData:he}=wt(I),[U,q]=t.useState(!1),[se,Y]=t.useState("table");t.useEffect(()=>{const J=sessionStorage.getItem("viewMode");J&&Y(J)},[]);const de=J=>{J>=1&&J<=Z&&me(J)},oe={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],status:[{label:"Semua Status",value:""},{label:"Santri",value:"santri"},{label:"Santri Non Pelajar",value:"santri non pelajar"},{label:"Pelajar",value:"pelajar"},{label:"Pelajar Non Santri",value:"pelajar non santri"},{label:"Santri-Pelajar/Pelajar-Santri",value:"santri-pelajar"}],angkatanPelajar:We({placeholder:"Semua Angkatan Pelajar",labelTemplate:"Masuk Tahun {year}"}),angkatanSantri:We({placeholder:"Semua Angkatan Santri",labelTemplate:"Masuk Tahun {year}"})},W={wargaPesantren:[{label:"Warga Pesantren",value:""},{label:"Memiliki NIUP",value:"memiliki niup"},{label:"Tanpa NIUP",value:"tanpa niup"}],pemberkasan:[{label:"Pemberkasan",value:""},{label:"Tidak Ada Berkas",value:"tidak ada berkas"},{label:"Tidak Ada Foto Diri",value:"tidak ada foto diri"},{label:"Memiliki Foto Diri",value:"memiliki foto diri"},{label:"Tidak Ada KK",value:"tidak ada kk"},{label:"Tidak Ada Akta Kelahiran",value:"tidak ada akta kelahiran"},{label:"Tidak Ada Ijazah",value:"tidak ada ijazah"}],urutBerdasarkan:[{label:"Urut Berdasarkan",value:""},{label:"Nama",value:"nama"},{label:"NIUP",value:"niup"},{label:"Angkatan",value:"angkatan"},{label:"Jenis Kelamin",value:"jenis kelamin"},{label:"Tempat Lahir",value:"tempat lahir"}],urutSecara:[{label:"Urut Secara",value:""},{label:"A-Z / 0-9 (Ascending)",value:"asc"},{label:"Z-A / 9-0 (Descending)",value:"desc"}]},X={smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]},ae=[{label:"No. KK",value:"no_kk"},{label:"NIK",value:"nik"},{label:"NIUP",value:"niup"},{label:"Anak ke",value:"anak_ke"},{label:"Jumlah Saudara",value:"jumlah_saudara"},{label:"Alamat",value:"alamat"},{label:"Domisili Santri",value:"domisili_santri"},{label:"Angkatan Santri",value:"angkatan_santri"},{label:"Angkatan Pelajar",value:"angkatan_pelajar"},{label:"Status",value:"status"},{label:"Ibu Kandung",value:"ibu_kandung"}],[O,K]=t.useState(!1),A=hn(()=>K(!1),ta,he);return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Peserta Didik"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>K(!0),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer flex items-center gap-2",children:[e.jsx(Ee,{}),"Tambah "]})}),e.jsxs("button",{onClick:()=>s(!0),className:"px-4 py-2 rounded flex items-center gap-2 text-white cursor-pointer bg-blue-500 hover:bg-blue-700",children:[e.jsx(Je,{}),e.jsx("span",{children:"Export"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-10 overflow-x-auto",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${U?"mb-4":""}`,children:[e.jsx(ue,{showFilters:U,filterOptions:p,onChange:h,selectedFilters:g}),e.jsx(ue,{showFilters:U,filterOptions:c,onChange:u,selectedFilters:o}),e.jsx(ue,{showFilters:U,filterOptions:w,onChange:f,selectedFilters:_}),e.jsx(ue,{showFilters:U,filterOptions:oe,onChange:J=>d(Se=>({...Se,...J})),selectedFilters:m}),e.jsx(ue,{showFilters:U,filterOptions:W,onChange:J=>d(Se=>({...Se,...J})),selectedFilters:m}),e.jsx(ue,{showFilters:U,filterOptions:X,onChange:J=>d(Se=>({...Se,...J})),selectedFilters:m})]}),e.jsx(Ce,{searchTerm:E,setSearchTerm:B,totalData:R,limit:ne,toggleLimit:J=>te(Number(J.target.value)),toggleFilters:()=>q(!U),toggleView:Y}),V?e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"Error!"}),e.jsxs("span",{className:"block sm:inline",children:[" ",V]})]}):se==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:Q?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):D.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):D.map((J,Se)=>e.jsx(ba,{data:J,title:"Peserta Didik",menu:1},Se))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b w-16",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIUP"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIK / No. Passport"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Lembaga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Wilayah"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kota Asal"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update Bio"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input Bio"})]})}),e.jsx("tbody",{className:"text-gray-800",children:Q?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):D.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"text-center py-6",children:"Tidak ada data"})}):D.map((J,Se)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center cursor-pointer text-left",onClick:()=>b(J),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(z-1)*ne+Se+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.niup||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.nik_or_passport||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.lembaga||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.wilayah||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.kota_asal||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.tgl_input||"-"})]},J.id_pengajar||Se))})]})}),e.jsx(ea,{isOpen:a,onClose:()=>s(!1),filters:I,searchTerm:E,limit:ne,currentPage:z,fields:ae,endpoint:"export/pesertadidik"}),n&&e.jsx(De,{title:"Peserta Didik",menu:1,item:l,onClose:i}),O&&e.jsx(un,{isOpen:O,onClose:()=>K(!1),formState:A}),Z>1&&e.jsx(Fe,{currentPage:z,totalPages:Z,handlePageChange:de})]})]})},gn=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},500);return()=>{clearTimeout(j)}},[c]);const S=t.useCallback(async()=>{let j=`${G}data-pokok/pesertadidik-bersaudara?limit=${i}`;if(u>1&&(j+=`&page=${u}`),_&&(j+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.phoneNumber&&(j+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),a!=null&&a.wargaPesantren&&(j+=`&warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.status&&(j+=`&status=${encodeURIComponent(a.status)}`),a!=null&&a.jenisKelamin&&(j+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.smartcard&&(j+=`&smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.pemberkasan&&(j+=`&pemberkasan=${encodeURIComponent(a.pemberkasan)}`),a!=null&&a.urutBerdasarkan&&(j+=`&sort_by=${encodeURIComponent(a.urutBerdasarkan)}`),a!=null&&a.urutSecara&&(j+=`&sort_order=${encodeURIComponent(a.urutSecara)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(j+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(j+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(j+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(j+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&(j+=`&wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&(j+=`&blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&(j+=`&kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.angkatanPelajar&&(j+=`&angkatan_pelajar=${encodeURIComponent(a.angkatanPelajar)}`),a!=null&&a.angkatanSantri&&(j+=`&angkatan_santri=${encodeURIComponent(a.angkatanSantri)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(j+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&(j+=`&jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&(j+=`&kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&(j+=`&rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.statusSaudara&&a.statusSaudara!=="Status Saudara"&&(j+=`&status_saudara=${encodeURIComponent(a.statusSaudara)}`),v.current===j){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=j,console.log("Fetching data from:",j),n(!0),b(null);try{const y=await fetch(j);if(!y.ok)throw new Error(`${y.statusText}: ${y.status}`);const N=await y.json();console.log("Data dari API Peserta Didik Bersaudara:",N),l(Array.isArray(N.data)?N.data:[]),p(N.total_data||0),h(N.total_pages||1)}catch(y){console.error("Fetch error:",y),b(y.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{pesertaDidikBersaudara:s,loadingBersaudara:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataBersaudara:d,totalPages:g,currentPage:u,setCurrentPage:w}},pn=()=>{var ae,O,K,A,ee,ie,ce,fe,H,ve,Pe;const[a,s]=t.useState(null),[l,r]=t.useState(!1),[n,x]=t.useState(!1),b=$=>{s($),x(!0)},i=()=>{s(null),x(!1)},[m,d]=t.useState({phoneNumber:"",wargaPesantren:"",status:"",jenisKelamin:"",smartcard:"",pemberkasan:"",urutBerdasarkan:"",urutSecara:"",negara:"",provinsi:"",kabupaten:"",kecamatan:"",wilayah:"",blok:"",kamar:"",angkatanPelajar:"",angkatanSantri:""}),{filterNegara:p,selectedNegara:g,handleFilterChangeNegara:h}=Ae(),{filterWilayah:c,selectedWilayah:o,handleFilterChangeWilayah:u}=Be(),{filterLembaga:w,selectedLembaga:_,handleFilterChangeLembaga:f}=Te(),v=((ae=p.negara.find($=>$.value==g.negara))==null?void 0:ae.label)||"",S=((O=p.provinsi.find($=>$.value==g.provinsi))==null?void 0:O.label)||"",j=((K=p.kabupaten.find($=>$.value==g.kabupaten))==null?void 0:K.label)||"",y=((A=p.kecamatan.find($=>$.value==g.kecamatan))==null?void 0:A.label)||"",N=((ee=c.wilayah.find($=>$.value==o.wilayah))==null?void 0:ee.label)||"",T=((ie=c.blok.find($=>$.value==o.blok))==null?void 0:ie.label)||"",C=((ce=c.kamar.find($=>$.value==o.kamar))==null?void 0:ce.label)||"",P=((fe=w.lembaga.find($=>$.value==_.lembaga))==null?void 0:fe.label)||"",F=((H=w.jurusan.find($=>$.value==_.jurusan))==null?void 0:H.label)||"",M=((ve=w.kelas.find($=>$.value==_.kelas))==null?void 0:ve.label)||"",L=((Pe=w.rombel.find($=>$.value==_.rombel))==null?void 0:Pe.label)||"",I=t.useMemo(()=>({...m,negara:v,provinsi:S,kabupaten:j,kecamatan:y,wilayah:N,blok:T,kamar:C,lembaga:P,jurusan:F,kelas:M,rombel:L}),[T,m,F,j,C,y,M,P,v,S,L,N]),{pesertaDidikBersaudara:D,loadingBersaudara:Q,searchTerm:E,setSearchTerm:B,error:V,limit:ne,setLimit:te,totalDataBersaudara:R,totalPages:Z,currentPage:z,setCurrentPage:me}=gn(I),[he,U]=t.useState(!1),[q,se]=t.useState("");t.useEffect(()=>{const $=sessionStorage.getItem("viewMode");$&&se($)},[]);const Y=$=>{$>=1&&$<=Z&&me($)},de={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],status:[{label:"Semua Status",value:""},{label:"Santri",value:"santri"},{label:"Santri Non Pelajar",value:"santri non pelajar"},{label:"Pelajar",value:"pelajar"},{label:"Pelajar Non Santri",value:"pelajar non santri"},{label:"Santri-Pelajar/Pelajar-Santri",value:"santri-pelajar"}],angkatanPelajar:We({placeholder:"Semua Angkatan Pelajar",labelTemplate:"Masuk Tahun {year}"}),angkatanSantri:We({placeholder:"Semua Angkatan Santri",labelTemplate:"Masuk Tahun {year}"})},oe={wargaPesantren:[{label:"Warga Pesantren",value:""},{label:"Memiliki NIUP",value:"memiliki niup"},{label:"Tanpa NIUP",value:"tanpa niup"}],pemberkasan:[{label:"Pemberkasan",value:""},{label:"Tidak Ada Berkas",value:"tidak ada berkas"},{label:"Tidak Ada Foto Diri",value:"tidak ada foto diri"},{label:"Memiliki Foto Diri",value:"memiliki foto diri"},{label:"Tidak Ada KK",value:"tidak ada kk"},{label:"Tidak Ada Akta Kelahiran",value:"tidak ada akta kelahiran"},{label:"Tidak Ada Ijazah",value:"tidak ada ijazah"}],urutBerdasarkan:[{label:"Urut Berdasarkan",value:""},{label:"Nama",value:"nama"},{label:"NIUP",value:"niup"},{label:"Jenis Kelamin",value:"jenis_kelamin"}],urutSecara:[{label:"Urut Secara",value:""},{label:"A-Z / 0-9 (Ascending)",value:"asc"},{label:"Z-A / 9-0 (Descending)",value:"desc"}]},W={smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}],statusSaudara:[{label:"Status Saudara",value:""},{label:"Ibu Kandung Terisi",value:"ibu kandung terisi"},{label:"Ibu Kandung Tidak Terisi",value:"ibu kandung tidak terisi"},{label:"KK Sama Dengan Ibu Kandung",value:"kk sama dgn ibu kandung"},{label:"KK Berbeda Dengan Ibu Kandung",value:"kk berbeda dgn ibu kandung"}]},X=[{label:"NIUP",value:"niup"},{label:"Anak ke",value:"anak_ke"},{label:"Jumlah Saudara",value:"jumlah_saudara"},{label:"Alamat",value:"alamat"},{label:"Domisili Santri",value:"domisili_santri"},{label:"Angkatan Santri",value:"angkatan_santri"},{label:"Angkatan Pelajar",value:"angkatan_pelajar"},{label:"Status",value:"status"}];return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Bersaudara Kandung"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("button",{onClick:()=>r(!0),className:"px-4 py-2 rounded flex items-center gap-2 text-white cursor-pointer bg-blue-500 hover:bg-blue-700",children:[e.jsx(Je,{}),e.jsx("span",{children:"Export"})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-10 overflow-x-auto",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${he?"mb-4":""}`,children:[e.jsx(ue,{showFilters:he,filterOptions:p,onChange:h,selectedFilters:g}),e.jsx(ue,{showFilters:he,filterOptions:c,onChange:u,selectedFilters:o}),e.jsx(ue,{showFilters:he,filterOptions:w,onChange:f,selectedFilters:_}),e.jsx(ue,{showFilters:he,filterOptions:de,onChange:$=>d(we=>({...we,...$})),selectedFilters:m}),e.jsx(ue,{showFilters:he,filterOptions:oe,onChange:$=>d(we=>({...we,...$})),selectedFilters:m}),e.jsx(ue,{showFilters:he,filterOptions:W,onChange:$=>d(we=>({...we,...$})),selectedFilters:m})]}),e.jsx(Ce,{searchTerm:E,setSearchTerm:B,totalData:R,limit:ne,toggleLimit:$=>te(Number($.target.value)),toggleFilters:()=>U(!he),toggleView:se}),V?e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"Error!"}),e.jsxs("span",{className:"block sm:inline",children:[" ",V]})]}):q==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:Q?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):D.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):D.map(($,we)=>e.jsx(ba,{data:$,title:"Bersaudara Kandung",menu:5},we))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"No."}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIUP"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"No. KK"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIK / No. Passport"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Lembaga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Wilayah"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kota Asal"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Ibu Kandung"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Ayah Kandung"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update Bio"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input Bio"})]})}),e.jsx("tbody",{className:"text-gray-800",children:Q?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):D.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center py-6",children:"Tidak ada data"})}):D.map(($,we)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center cursor-pointer text-left",onClick:()=>b($),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(z-1)*ne+we+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.niup||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.no_kk||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.nik_nopassport||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.lembaga||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.wilayah||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.kota_asal||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.ibu_kandung||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.ayah_kandung||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.tgl_input||"-"})]},$.id_pengajar||we))})]})}),e.jsx(ea,{isOpen:l,onClose:()=>r(!1),filters:I,searchTerm:E,limit:ne,currentPage:z,fields:X,endpoint:"export/bersaudara"}),n&&e.jsx(De,{title:"Bersaudara Kandung",menu:5,item:a,onClose:i}),Z>1&&e.jsx(Fe,{currentPage:z,totalPages:Z,handlePageChange:Y})]})]})},Ca=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState([]),[c,o]=t.useState(1),[u,w]=t.useState(""),[_,f]=t.useState(1),[v,S]=t.useState(u),j=t.useRef("");t.useEffect(()=>{const T=setTimeout(()=>{S(u)},500);return()=>{clearTimeout(T)}},[u]);const y=t.useCallback(async(T=!1)=>{let C=`${G}data-pokok/pelajar`;const P=[];if(i!=null&&P.push(`limit=${i}`),_>1&&P.push(`page=${_}`),v&&P.push(`nama=${encodeURIComponent(v)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&P.push(`negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&P.push(`provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&P.push(`kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&P.push(`kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&P.push(`wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&P.push(`blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&P.push(`kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&P.push(`lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&P.push(`jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&P.push(`kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&P.push(`rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.jenisKelamin&&P.push(`jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.smartcard&&P.push(`smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.status&&P.push(`status=${encodeURIComponent(a.status)}`),a!=null&&a.angkatanPelajar&&P.push(`angkatan_pelajar=${encodeURIComponent(a.angkatanPelajar)}`),a!=null&&a.wargaPesantren&&P.push(`warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.pemberkasan&&P.push(`pemberkasan=${encodeURIComponent(a.pemberkasan)}`),a!=null&&a.urutBerdasarkan&&P.push(`sort_by=${encodeURIComponent(a.urutBerdasarkan)}`),a!=null&&a.urutSecara&&P.push(`sort_order=${encodeURIComponent(a.urutSecara)}`),a!=null&&a.phoneNumber&&P.push(`phone_number=${encodeURIComponent(a.phoneNumber)}`),P.length>0&&(C+=`?${P.join("&")}`),!T&&j.current===C){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}j.current=C,console.log("Fetching data from:",C),n(!0),b(null);try{const F=await fetch(C);if(!F.ok)throw new Error(`${F.statusText}: ${F.status}`);const M=await F.json();console.log("Data dari API Pelajar:",M),l(Array.isArray(M.data)?M.data:[]),p(M.total_data||0),o(M.total_pages||1)}catch(F){console.error("Fetch error:",F),b(F.message),l([])}finally{n(!1)}},[_,a,i,v]),N=t.useCallback(async()=>{let T=`${G}data-pokok/pelajar`;const C=[];v&&C.push(`nama=${encodeURIComponent(v)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&C.push(`negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&C.push(`provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&C.push(`kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&C.push(`kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&C.push(`wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&C.push(`blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&C.push(`kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&C.push(`lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&C.push(`jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&C.push(`kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&C.push(`rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.jenisKelamin&&C.push(`jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.smartcard&&C.push(`smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.status&&C.push(`status=${encodeURIComponent(a.status)}`),a!=null&&a.angkatanPelajar&&C.push(`angkatan_pelajar=${encodeURIComponent(a.angkatanPelajar)}`),a!=null&&a.wargaPesantren&&C.push(`warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.pemberkasan&&C.push(`pemberkasan=${encodeURIComponent(a.pemberkasan)}`),C.length>0&&(T+=`?${C.join("&")}`);try{const P=await fetch(T);if(!P.ok)throw new Error("Gagal fetch semua ID pelajar");const F=await P.json();if(Array.isArray(F.data)){const M=F.data.map(L=>L.biodata_id);h(M)}else h([])}catch(P){console.error("Fetch all data error:",P),h([])}},[a,v]);return t.useEffect(()=>{y()},[y]),t.useEffect(()=>{f(1)},[i]),{pelajar:s,loadingPelajar:r,searchTerm:u,setSearchTerm:w,error:x,limit:i,setLimit:m,totalDataPelajar:d,fetchData:y,fetchAllData:N,totalPages:c,currentPage:_,setCurrentPage:f,allPelajarIds:g}},bn=()=>{var ae,O,K,A,ee,ie,ce,fe,H,ve,Pe;const[a,s]=t.useState(null),[l,r]=t.useState(!1),[n,x]=t.useState(!1),b=$=>{s($),x(!0)},i=()=>{s(null),x(!1)},[m,d]=t.useState({phoneNumber:"",wargaPesantren:"",status:"",jenisKelamin:"",smartcard:"",pemberkasan:"",urutBerdasarkan:"",urutSecara:"",negara:"",provinsi:"",kabupaten:"",kecamatan:"",wilayah:"",blok:"",kamar:"",angkatanPelajar:"",angkatanSantri:""}),{filterNegara:p,selectedNegara:g,handleFilterChangeNegara:h}=Ae(),{filterWilayah:c,selectedWilayah:o,handleFilterChangeWilayah:u}=Be(),{filterLembaga:w,selectedLembaga:_,handleFilterChangeLembaga:f}=Te(),v=((ae=p.negara.find($=>$.value==g.negara))==null?void 0:ae.label)||"",S=((O=p.provinsi.find($=>$.value==g.provinsi))==null?void 0:O.label)||"",j=((K=p.kabupaten.find($=>$.value==g.kabupaten))==null?void 0:K.label)||"",y=((A=p.kecamatan.find($=>$.value==g.kecamatan))==null?void 0:A.label)||"",N=((ee=c.wilayah.find($=>$.value==o.wilayah))==null?void 0:ee.label)||"",T=((ie=c.blok.find($=>$.value==o.blok))==null?void 0:ie.label)||"",C=((ce=c.kamar.find($=>$.value==o.kamar))==null?void 0:ce.label)||"",P=((fe=w.lembaga.find($=>$.value==_.lembaga))==null?void 0:fe.label)||"",F=((H=w.jurusan.find($=>$.value==_.jurusan))==null?void 0:H.label)||"",M=((ve=w.kelas.find($=>$.value==_.kelas))==null?void 0:ve.label)||"",L=((Pe=w.rombel.find($=>$.value==_.rombel))==null?void 0:Pe.label)||"",I=t.useMemo(()=>({...m,negara:v,provinsi:S,kabupaten:j,kecamatan:y,wilayah:N,blok:T,kamar:C,lembaga:P,jurusan:F,kelas:M,rombel:L}),[T,m,F,j,C,y,M,P,v,S,L,N]),{pelajar:D,loadingPelajar:Q,searchTerm:E,setSearchTerm:B,error:V,limit:ne,setLimit:te,totalDataPelajar:R,totalPages:Z,currentPage:z,setCurrentPage:me}=Ca(I),[he,U]=t.useState(!1),[q,se]=t.useState("");t.useEffect(()=>{const $=sessionStorage.getItem("viewMode");$&&se($)},[]);const Y=$=>{$>=1&&$<=Z&&me($)},de={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],status:[{label:"Semua Status",value:""},{label:"Santri",value:"santri"},{label:"Santri Non Pelajar",value:"santri non pelajar"},{label:"Pelajar",value:"pelajar"},{label:"Pelajar Non Santri",value:"pelajar non santri"},{label:"Santri-Pelajar/Pelajar-Santri",value:"santri-pelajar"}],angkatanPelajar:We({placeholder:"Semua Angkatan Pelajar",labelTemplate:"Masuk Tahun {year}"})},oe={wargaPesantren:[{label:"Warga Pesantren",value:""},{label:"Memiliki NIUP",value:"memiliki niup"},{label:"Tanpa NIUP",value:"tanpa niup"}],pemberkasan:[{label:"Pemberkasan",value:""},{label:"Tidak Ada Berkas",value:"tidak ada berkas"},{label:"Tidak Ada Foto Diri",value:"tidak ada foto diri"},{label:"Memiliki Foto Diri",value:"memiliki foto diri"},{label:"Tidak Ada KK",value:"tidak ada kk"},{label:"Tidak Ada Akta Kelahiran",value:"tidak ada akta kelahiran"},{label:"Tidak Ada Ijazah",value:"tidak ada ijazah"}],urutBerdasarkan:[{label:"Urut Berdasarkan",value:""},{label:"Nama",value:"nama"},{label:"NIUP",value:"niup"},{label:"Jenis Kelamin",value:"jenis_kelamin"}],urutSecara:[{label:"Urut Secara",value:""},{label:"A-Z / 0-9 (Ascending)",value:"asc"},{label:"Z-A / 9-0 (Descending)",value:"desc"}]},W={smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]},X=[{label:"No. KK",value:"no_kk"},{label:"NIK",value:"nik"},{label:"NIUP",value:"niup"},{label:"Anak ke",value:"anak_ke"},{label:"Jumlah Saudara",value:"jumlah_saudara"},{label:"Pendidikan Terakhir",value:"pendidikan"},{label:"Alamat",value:"alamat"},{label:"Status",value:"status"},{label:"Domisili Santri",value:"domisili_santri"},{label:"Ibu Kandung",value:"ibu_kandung"},{label:"Ayah Kandung",value:"ayah_kandung"}];return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Pelajar"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("button",{onClick:()=>r(!0),className:"px-4 py-2 rounded flex items-center gap-2 text-white cursor-pointer bg-blue-500 hover:bg-blue-700",children:[e.jsx(Je,{}),e.jsx("span",{children:"Export"})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-10 overflow-x-auto",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${he?"mb-4":""}`,children:[e.jsx(ue,{showFilters:he,filterOptions:p,onChange:h,selectedFilters:g}),e.jsx(ue,{showFilters:he,filterOptions:c,onChange:u,selectedFilters:o}),e.jsx(ue,{showFilters:he,filterOptions:w,onChange:f,selectedFilters:_}),e.jsx(ue,{showFilters:he,filterOptions:de,onChange:$=>d(we=>({...we,...$})),selectedFilters:m}),e.jsx(ue,{showFilters:he,filterOptions:oe,onChange:$=>d(we=>({...we,...$})),selectedFilters:m}),e.jsx(ue,{showFilters:he,filterOptions:W,onChange:$=>d(we=>({...we,...$})),selectedFilters:m})]}),e.jsx(Ce,{searchTerm:E,setSearchTerm:B,totalData:R,limit:ne,toggleLimit:$=>te(Number($.target.value)),toggleFilters:()=>U(!he),toggleView:se}),V?e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"Error!"}),e.jsxs("span",{className:"block sm:inline",children:[" ",V]})]}):q==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:Q?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):D.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):D.map(($,we)=>e.jsx(ba,{data:$,title:"Pelajar",menu:4},we))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"No."}),e.jsx("th",{className:"px-3 py-2 border-b",children:"No. Induk (Siswa/Mahasiswa)"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Lembaga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jurusan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kelas"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Rombel"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Wilayah"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kota Asal"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update Bio"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input Bio"})]})}),e.jsx("tbody",{className:"text-gray-800",children:Q?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):D.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center py-6",children:"Tidak ada data"})}):D.map(($,we)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center cursor-pointer text-left",onClick:()=>b($),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(z-1)*ne+we+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.no_induk||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.lembaga||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.jurusan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.kelas||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.rombel||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.wilayah||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.kota_asal||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.tgl_input||"-"})]},$.id_pengajar||we))})]})}),e.jsx(ea,{isOpen:l,onClose:()=>r(!1),filters:I,searchTerm:E,limit:ne,currentPage:z,fields:X,endpoint:"export/pelajar"}),n&&e.jsx(De,{title:"Pelajar",menu:4,item:a,onClose:i}),Z>1&&e.jsx(Fe,{currentPage:z,totalPages:Z,handlePageChange:Y})]})]})},Fa=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState([]),[v,S]=t.useState(c),j=t.useRef("");t.useEffect(()=>{const T=setTimeout(()=>{S(c)},400);return()=>{clearTimeout(T)}},[c]);const y=t.useCallback(async(T=!1)=>{let C=`${G}data-pokok/santri`;const P=[];if(i!=null&&P.push(`limit=${i}`),u>1&&P.push(`&page=${u}`),v&&P.push(`&nama=${encodeURIComponent(v)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&P.push(`negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&P.push(`provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&P.push(`kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&P.push(`kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&P.push(`wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&P.push(`blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&P.push(`kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&P.push(`lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&P.push(`jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&P.push(`kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&P.push(`rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.jenisKelamin&&P.push(`jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.smartcard&&P.push(`smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.status&&P.push(`status=${encodeURIComponent(a.status)}`),a!=null&&a.angkatanSantri&&P.push(`angkatan_santri=${encodeURIComponent(a.angkatanSantri)}`),a!=null&&a.wargaPesantren&&P.push(`warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.pemberkasan&&P.push(`pemberkasan=${encodeURIComponent(a.pemberkasan)}`),a!=null&&a.urutBerdasarkan&&P.push(`sort_by=${encodeURIComponent(a.urutBerdasarkan)}`),a!=null&&a.urutSecara&&P.push(`sort_order=${encodeURIComponent(a.urutSecara)}`),a!=null&&a.phoneNumber&&P.push(`phone_number=${encodeURIComponent(a.phoneNumber)}`),a!=null&&a.kewaliasuhan&&P.push(`kewaliasuhan=${encodeURIComponent(a.kewaliasuhan)}`),P.length>0&&(C+=`?${P.join("&")}`),!T&&j.current===C){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}j.current=C,console.log("Fetching data from:",C),n(!0),b(null);try{const F=await fetch(C);if(!F.ok)throw new Error(`${F.statusText}: ${F.status}`);const M=await F.json();console.log("Data dari API Santri:",M),l(Array.isArray(M.data)?M.data:[]),p(M.total_data||0),h(M.total_pages||1)}catch(F){console.error("Fetch error:",F),b(F.message),l([])}finally{n(!1)}},[u,a,i,v]),N=t.useCallback(async()=>{let T=`${G}data-pokok/santri`;const C=[];v&&C.push(`&nama=${encodeURIComponent(v)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&C.push(`negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&C.push(`provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&C.push(`kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&C.push(`kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&C.push(`wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&C.push(`blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&C.push(`kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&C.push(`lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&C.push(`jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&C.push(`kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&C.push(`rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.jenisKelamin&&C.push(`jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.smartcard&&C.push(`smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.status&&C.push(`status=${encodeURIComponent(a.status)}`),a!=null&&a.angkatanSantri&&C.push(`angkatan_santri=${encodeURIComponent(a.angkatanSantri)}`),a!=null&&a.wargaPesantren&&C.push(`warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.pemberkasan&&C.push(`pemberkasan=${encodeURIComponent(a.pemberkasan)}`),a!=null&&a.urutBerdasarkan&&C.push(`sort_by=${encodeURIComponent(a.urutBerdasarkan)}`),a!=null&&a.urutSecara&&C.push(`sort_order=${encodeURIComponent(a.urutSecara)}`),a!=null&&a.phoneNumber&&C.push(`phone_number=${encodeURIComponent(a.phoneNumber)}`),a!=null&&a.kewaliasuhan&&C.push(`kewaliasuhan=${encodeURIComponent(a.kewaliasuhan)}`),C.length>0&&(T+=`?${C.join("&")}`);try{const P=await fetch(T);if(!P.ok)throw new Error("Gagal fetch semua ID santri");const F=await P.json();if(Array.isArray(F.data)){const M=F.data.map(L=>L.id);console.log("Semua ID Santri:",M),f(M)}else f([])}catch(P){console.error("Fetch all data error:",P),f([])}},[a,v]);return t.useEffect(()=>{y()},[y]),t.useEffect(()=>{w(1)},[i]),{santri:s,loadingSantri:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataSantri:d,fetchData:y,fetchAllData:N,totalPages:g,currentPage:u,setCurrentPage:w,allSantriIds:_}},jn=()=>{var ae,O,K,A,ee,ie,ce,fe,H,ve,Pe;const[a,s]=t.useState(null),[l,r]=t.useState(!1),[n,x]=t.useState(!1),b=$=>{s($),x(!0)},i=()=>{s(null),x(!1)},[m,d]=t.useState({phoneNumber:"",wargaPesantren:"",status:"",jenisKelamin:"",smartcard:"",pemberkasan:"",urutBerdasarkan:"",urutSecara:"",negara:"",provinsi:"",kabupaten:"",kecamatan:"",wilayah:"",blok:"",kamar:"",angkatanPelajar:"",angkatanSantri:""}),{filterNegara:p,selectedNegara:g,handleFilterChangeNegara:h}=Ae(),{filterWilayah:c,selectedWilayah:o,handleFilterChangeWilayah:u}=Be(),{filterLembaga:w,selectedLembaga:_,handleFilterChangeLembaga:f}=Te(),v=((ae=p.negara.find($=>$.value==g.negara))==null?void 0:ae.label)||"",S=((O=p.provinsi.find($=>$.value==g.provinsi))==null?void 0:O.label)||"",j=((K=p.kabupaten.find($=>$.value==g.kabupaten))==null?void 0:K.label)||"",y=((A=p.kecamatan.find($=>$.value==g.kecamatan))==null?void 0:A.label)||"",N=((ee=c.wilayah.find($=>$.value==o.wilayah))==null?void 0:ee.label)||"",T=((ie=c.blok.find($=>$.value==o.blok))==null?void 0:ie.label)||"",C=((ce=c.kamar.find($=>$.value==o.kamar))==null?void 0:ce.label)||"",P=((fe=w.lembaga.find($=>$.value==_.lembaga))==null?void 0:fe.label)||"",F=((H=w.jurusan.find($=>$.value==_.jurusan))==null?void 0:H.label)||"",M=((ve=w.kelas.find($=>$.value==_.kelas))==null?void 0:ve.label)||"",L=((Pe=w.rombel.find($=>$.value==_.rombel))==null?void 0:Pe.label)||"",I=t.useMemo(()=>({...m,negara:v,provinsi:S,kabupaten:j,kecamatan:y,wilayah:N,blok:T,kamar:C,lembaga:P,jurusan:F,kelas:M,rombel:L}),[T,m,F,j,C,y,M,P,v,S,L,N]),{santri:D,loadingSantri:Q,searchTerm:E,setSearchTerm:B,error:V,limit:ne,setLimit:te,totalDataSantri:R,totalPages:Z,currentPage:z,setCurrentPage:me}=Fa(I),[he,U]=t.useState(!1),[q,se]=t.useState("");t.useEffect(()=>{const $=sessionStorage.getItem("viewMode");$&&se($)},[]);const Y=$=>{$>=1&&$<=Z&&me($)},de={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],status:[{label:"Semua Status",value:""},{label:"Santri",value:"santri"},{label:"Santri Non Pelajar",value:"santri non pelajar"},{label:"Pelajar",value:"pelajar"},{label:"Pelajar Non Santri",value:"pelajar non santri"},{label:"Santri-Pelajar/Pelajar-Santri",value:"santri-pelajar"}],angkatanSantri:We({placeholder:"Semua Angkatan Santri",labelTemplate:"Masuk Tahun {year}"})},oe={wargaPesantren:[{label:"Warga Pesantren",value:""},{label:"Memiliki NIUP",value:"memiliki niup"},{label:"Tanpa NIUP",value:"tanpa niup"}],pemberkasan:[{label:"Pemberkasan",value:""},{label:"Tidak Ada Berkas",value:"tidak ada berkas"},{label:"Tidak Ada Foto Diri",value:"tidak ada foto diri"},{label:"Memiliki Foto Diri",value:"memiliki foto diri"},{label:"Tidak Ada KK",value:"tidak ada kk"},{label:"Tidak Ada Akta Kelahiran",value:"tidak ada akta kelahiran"},{label:"Tidak Ada Ijazah",value:"tidak ada ijazah"}],urutBerdasarkan:[{label:"Urut Berdasarkan",value:""},{label:"Nama",value:"nama"},{label:"NIUP",value:"niup"},{label:"Jenis Kelamin",value:"jenis_kelamin"}],urutSecara:[{label:"Urut Secara",value:""},{label:"A-Z / 0-9 (Ascending)",value:"asc"},{label:"Z-A / 9-0 (Descending)",value:"desc"}]},W={smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]},X=[{label:"No. KK",value:"no_kk"},{label:"NIK",value:"nik"},{label:"NIUP",value:"niup"},{label:"Tempat Tgl Lahir",value:"tempat_tanggal_lahir"},{label:"Anak ke",value:"anak_ke"},{label:"Jumlah Saudara",value:"jumlah_saudara"},{label:"Alamat",value:"alamat"},{label:"Domisili Santri",value:"domisili_santri"},{label:"Pendidikan",value:"pendidikan"},{label:"Status",value:"status"},{label:"Ibu Kandung",value:"ibu_kandung"},{label:"Ayah Kandung",value:"ayah_kandung"}];return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Santri"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("button",{onClick:()=>r(!0),className:"px-4 py-2 rounded flex items-center gap-2 text-white cursor-pointer bg-blue-500 hover:bg-blue-700",children:[e.jsx(Je,{}),e.jsx("span",{children:"Export"})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-10 overflow-x-auto",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${he?"mb-4":""}`,children:[e.jsx(ue,{showFilters:he,filterOptions:p,onChange:h,selectedFilters:g}),e.jsx(ue,{showFilters:he,filterOptions:c,onChange:u,selectedFilters:o}),e.jsx(ue,{showFilters:he,filterOptions:w,onChange:f,selectedFilters:_}),e.jsx(ue,{showFilters:he,filterOptions:de,onChange:$=>d(we=>({...we,...$})),selectedFilters:m}),e.jsx(ue,{showFilters:he,filterOptions:oe,onChange:$=>d(we=>({...we,...$})),selectedFilters:m}),e.jsx(ue,{showFilters:he,filterOptions:W,onChange:$=>d(we=>({...we,...$})),selectedFilters:m})]}),e.jsx(Ce,{searchTerm:E,setSearchTerm:B,totalData:R,limit:ne,toggleLimit:$=>te(Number($.target.value)),toggleFilters:()=>U(!he),toggleView:se}),V?e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"Error!"}),e.jsxs("span",{className:"block sm:inline",children:[" ",V]})]}):q==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:Q?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):D.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):D.map(($,we)=>e.jsx(ba,{data:$,title:"Santri",menu:2},we))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"No."}),e.jsx("th",{className:"px-3 py-2 border-b",children:"No. Induk Santri"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kamar"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Blok"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Wilayah"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Lembaga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kota Asal"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Angkatan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update Bio"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input Bio"})]})}),e.jsx("tbody",{className:"text-gray-800",children:Q?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):D.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center py-6",children:"Tidak ada data"})}):D.map(($,we)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center cursor-pointer text-left",onClick:()=>b($),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(z-1)*ne+we+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.nis||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.kamar||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.blok||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.wilayah||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.lembaga||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.kota_asal||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.angkatan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.tgl_input||"-"})]},$.id_pengajar||we))})]})}),e.jsx(ea,{isOpen:l,onClose:()=>r(!1),filters:I,searchTerm:E,limit:ne,currentPage:z,fields:X,endpoint:"export/santri"}),n&&e.jsx(De,{title:"Santri",menu:2,item:a,onClose:i}),Z>1&&e.jsx(Fe,{currentPage:z,totalPages:Z,handlePageChange:Y})]})]})},kn=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},400);return()=>{clearTimeout(j)}},[c]);const S=t.useCallback(async()=>{let j=`${G}data-pokok/santri-nondomisili?limit=${i}`;if(u>1&&(j+=`&page=${u}`),_&&(j+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(j+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(j+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(j+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(j+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&(j+=`&wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&(j+=`&blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&(j+=`&kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(j+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&(j+=`&jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&(j+=`&kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&(j+=`&rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.jenisKelamin&&(j+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.smartcard&&(j+=`&smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.status&&(j+=`&status=${encodeURIComponent(a.status)}`),a!=null&&a.angkatanSantri&&(j+=`&angkatan_santri=${encodeURIComponent(a.angkatanSantri)}`),a!=null&&a.wargaPesantren&&(j+=`&warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.pemberkasan&&(j+=`&pemberkasan=${encodeURIComponent(a.pemberkasan)}`),a!=null&&a.urutBerdasarkan&&(j+=`&sort_by=${encodeURIComponent(a.urutBerdasarkan)}`),a!=null&&a.urutSecara&&(j+=`&sort_order=${encodeURIComponent(a.urutSecara)}`),a!=null&&a.phoneNumber&&(j+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),v.current===j){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=j,console.log("Fetching data from:",j),n(!0),b(null);try{const y=await fetch(j);if(!y.ok)throw new Error(`${y.statusText}: ${y.status}`);const N=await y.json();console.log("Data dari API Santri NonDomisili:",N),l(Array.isArray(N.data)?N.data:[]),p(N.total_data||0),h(N.total_pages||1)}catch(y){console.error("Fetch error:",y),b(y.message),l([])}finally{n(!1)}},[u,_,a,i]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{santriNonDomisili:s,loadingSantriNonDomisili:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataSantriNonDomisili:d,totalPages:g,currentPage:u,setCurrentPage:w}},fn=()=>{var oe,W,X,ae,O,K,A,ee,ie,ce,fe;const[a,s]=t.useState(null),[l,r]=t.useState(!1),n=H=>{s(H),r(!0)},x=()=>{s(null),r(!1)},[b,i]=t.useState({phoneNumber:"",wargaPesantren:"",status:"",jenisKelamin:"",smartcard:"",pemberkasan:"",urutBerdasarkan:"",urutSecara:"",negara:"",provinsi:"",kabupaten:"",kecamatan:"",wilayah:"",blok:"",kamar:"",angkatanPelajar:"",angkatanSantri:""}),{filterNegara:m,selectedNegara:d,handleFilterChangeNegara:p}=Ae(),{filterWilayah:g,selectedWilayah:h,handleFilterChangeWilayah:c}=Be(),{filterLembaga:o,selectedLembaga:u,handleFilterChangeLembaga:w}=Te(),_=((oe=m.negara.find(H=>H.value==d.negara))==null?void 0:oe.label)||"",f=((W=m.provinsi.find(H=>H.value==d.provinsi))==null?void 0:W.label)||"",v=((X=m.kabupaten.find(H=>H.value==d.kabupaten))==null?void 0:X.label)||"",S=((ae=m.kecamatan.find(H=>H.value==d.kecamatan))==null?void 0:ae.label)||"",j=((O=g.wilayah.find(H=>H.value==h.wilayah))==null?void 0:O.label)||"",y=((K=g.blok.find(H=>H.value==h.blok))==null?void 0:K.label)||"",N=((A=g.kamar.find(H=>H.value==h.kamar))==null?void 0:A.label)||"",T=((ee=o.lembaga.find(H=>H.value==u.lembaga))==null?void 0:ee.label)||"",C=((ie=o.jurusan.find(H=>H.value==u.jurusan))==null?void 0:ie.label)||"",P=((ce=o.kelas.find(H=>H.value==u.kelas))==null?void 0:ce.label)||"",F=((fe=o.rombel.find(H=>H.value==u.rombel))==null?void 0:fe.label)||"",M=t.useMemo(()=>({...b,negara:_,provinsi:f,kabupaten:v,kecamatan:S,wilayah:j,blok:y,kamar:N,lembaga:T,jurusan:C,kelas:P,rombel:F}),[y,b,C,v,N,S,P,T,_,f,F,j]),{santriNonDomisili:L,loadingSantriNonDomisili:I,searchTerm:D,setSearchTerm:Q,error:E,limit:B,setLimit:V,totalDataSantriNonDomisili:ne,totalPages:te,currentPage:R,setCurrentPage:Z}=kn(M),[z,me]=t.useState(!1),[he,U]=t.useState("");t.useEffect(()=>{const H=sessionStorage.getItem("viewMode");H&&U(H)},[]);const q=H=>{H>=1&&H<=te&&Z(H)},se={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],status:[{label:"Semua Status",value:""},{label:"Santri",value:"santri"},{label:"Santri Non Pelajar",value:"santri non pelajar"},{label:"Pelajar",value:"pelajar"},{label:"Pelajar Non Santri",value:"pelajar non santri"},{label:"Santri-Pelajar/Pelajar-Santri",value:"santri-pelajar"}],angkatanSantri:We({placeholder:"Semua Angkatan Santri",labelTemplate:"Masuk Tahun {year}"})},Y={wargaPesantren:[{label:"Warga Pesantren",value:""},{label:"Memiliki NIUP",value:"memiliki niup"},{label:"Tanpa NIUP",value:"tanpa niup"}],pemberkasan:[{label:"Pemberkasan",value:""},{label:"Tidak Ada Berkas",value:"tidak ada berkas"},{label:"Tidak Ada Foto Diri",value:"tidak ada foto diri"},{label:"Memiliki Foto Diri",value:"memiliki foto diri"},{label:"Tidak Ada KK",value:"tidak ada kk"},{label:"Tidak Ada Akta Kelahiran",value:"tidak ada akta kelahiran"},{label:"Tidak Ada Ijazah",value:"tidak ada ijazah"}],urutBerdasarkan:[{label:"Urut Berdasarkan",value:""},{label:"Nama",value:"nama"},{label:"NIUP",value:"niup"},{label:"Jenis Kelamin",value:"jenis_kelamin"}],urutSecara:[{label:"Urut Secara",value:""},{label:"A-Z / 0-9 (Ascending)",value:"asc"},{label:"Z-A / 9-0 (Descending)",value:"desc"}]},de={smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]};return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6 overflow-y-auto",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Data Santri-Non-Domisili"})}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-10 overflow-x-auto",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${z?"mb-4":""}`,children:[e.jsx(ue,{showFilters:z,filterOptions:m,onChange:p,selectedFilters:d}),e.jsx(ue,{showFilters:z,filterOptions:g,onChange:c,selectedFilters:h}),e.jsx(ue,{showFilters:z,filterOptions:o,onChange:w,selectedFilters:u}),e.jsx(ue,{showFilters:z,filterOptions:se,onChange:H=>i(ve=>({...ve,...H})),selectedFilters:b}),e.jsx(ue,{showFilters:z,filterOptions:Y,onChange:H=>i(ve=>({...ve,...H})),selectedFilters:b}),e.jsx(ue,{showFilters:z,filterOptions:de,onChange:H=>i(ve=>({...ve,...H})),selectedFilters:b})]}),e.jsx(Ce,{searchTerm:D,setSearchTerm:Q,totalData:ne,limit:B,toggleLimit:H=>V(Number(H.target.value)),toggleFilters:()=>me(!z),toggleView:U}),E?e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"Error!"}),e.jsxs("span",{className:"block sm:inline",children:[" ",E]})]}):he==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:I?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):L.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):L.map((H,ve)=>e.jsx(ba,{data:H,title:"Santri-Non-Domisili",menu:3},ve))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"No."}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIS"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIUP"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Lembaga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update Bio"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input Bio"})]})}),e.jsx("tbody",{className:"text-gray-800",children:I?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):L.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-6",children:"Tidak ada data"})}):L.map((H,ve)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center cursor-pointer text-left",onClick:()=>n(H),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(R-1)*B+ve+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:H.nis||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:H.niup||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:H.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:H.lembaga||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:H.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:H.tgl_input||"-"})]},H.id_pengajar||ve))})]})}),l&&e.jsx(De,{title:"Santri-Non-Domisili",menu:3,item:a,onClose:x}),te>1&&e.jsx(Fe,{currentPage:R,totalPages:te,handlePageChange:q})]})]})},vt=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},400);return()=>{clearTimeout(j)}},[c]);const S=t.useCallback(async()=>{let j=`${G}data-pokok/wali?limit=${i}`;if(u>1&&(j+=`&page=${u}`),_&&(j+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(j+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(j+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(j+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(j+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.jenisKelamin&&(j+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.jenisKelaminPesertaDidik&&(j+=`&jenis_kelamin_anak=${encodeURIComponent(a.jenisKelaminPesertaDidik)}`),a!=null&&a.wafatHidup&&(j+=`&wafat=${encodeURIComponent(a.wafatHidup)}`),a!=null&&a.smartcard&&(j+=`&smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.phoneNumber&&(j+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),v.current===j){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=j,console.log("Fetching data from:",j),n(!0),b(null);try{const y=await fetch(j);if(!y.ok)throw new Error(`Fetch error: ${y.status}`);const N=await y.json();console.log("Data Wali dari API:",N),l(Array.isArray(N.data)?N.data:[]),p(N.total_data||0),h(N.total_pages||1)}catch(y){console.error("Fetch error:",y),b(y.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{wali:s,loadingWali:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataWali:d,totalPages:g,currentPage:u,setCurrentPage:w}},yn=()=>{var B,V,ne,te;const[a,s]=t.useState(null),[l,r]=t.useState(!1),n=R=>{s(R),r(!0)},x=()=>{s(null),r(!1)},[b,i]=t.useState({phoneNumber:"",wafathidup:"",status:"",jenisKelamin:"",lembaga:"",jurusan:"",kelas:"",rombel:"",wafatHidup:""}),{filterNegara:m,selectedNegara:d,handleFilterChangeNegara:p}=Ae(),g=((B=m.negara.find(R=>R.value==d.negara))==null?void 0:B.label)||"",h=((V=m.provinsi.find(R=>R.value==d.provinsi))==null?void 0:V.label)||"",c=((ne=m.kabupaten.find(R=>R.value==d.kabupaten))==null?void 0:ne.label)||"",o=((te=m.kecamatan.find(R=>R.value==d.kecamatan))==null?void 0:te.label)||"",u=t.useMemo(()=>({...b,negara:g,provinsi:h,kabupaten:c,kecamatan:o}),[b,g,h,c,o]),{wali:w,loadingWali:_,searchTerm:f,setSearchTerm:v,error:S,limit:j,setLimit:y,totalDataWali:N,totalPages:T,currentPage:C,setCurrentPage:P}=vt(u),[F,M]=t.useState(!1),[L,I]=t.useState("");t.useEffect(()=>{const R=sessionStorage.getItem("viewMode");R&&I(R)},[]);const D=R=>{R>=1&&R<=T&&P(R)},Q={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],jenisKelaminPesertaDidik:[{label:"Pilih Jenis Kelamin Peserta Didik",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}]},E={wafatHidup:[{label:"Pilih Wafat / Hidup",value:""},{label:"Sudah Wafat",value:"sudah wafat"},{label:"Masih Hidup",value:"masih hidup"}],smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]};return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6 overflow-y-auto",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Data Wali"})}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${F?"mb-4":""}`,children:[e.jsx(ue,{showFilters:F,filterOptions:m,onChange:p,selectedFilters:d}),e.jsx(ue,{showFilters:F,filterOptions:Q,onChange:R=>i(Z=>({...Z,...R})),selectedFilters:b}),e.jsx(ue,{showFilters:F,filterOptions:E,onChange:R=>i(Z=>({...Z,...R})),selectedFilters:b})]}),e.jsx(Ce,{searchTerm:f,setSearchTerm:v,totalData:N,toggleFilters:()=>M(!F),toggleView:I,limit:j,toggleLimit:R=>y(Number(R.target.value))}),S?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):L==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:_?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small"})}):w.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):w.map((R,Z)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex items-center space-x-4 cursor-pointer",onClick:()=>n(R),children:[e.jsx("img",{alt:R.nama||"-",className:"w-20 h-24 object-cover",src:R.foto_profil,onError:z=>{z.target.onerror=null,z.target.src=Me}}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl",children:R.nama||"-"}),e.jsxs("p",{className:"text-gray-600",children:["NIK : ",R.nik_or_passport||"-"]}),e.jsxs("p",{className:"text-gray-600",children:["Phone : ",R.telepon_1||R.telepon_2||"-"]})]})]},R.id||Z))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIK"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Telepon 1"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Telepon 2"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input"})]})}),e.jsx("tbody",{className:"text-gray-800",children:_?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small"})})}):w.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-6",children:"Tidak ada data"})}):w.map((R,Z)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-left cursor-pointer",onClick:()=>n(R),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(C-1)*j+Z+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:R.nik_or_passport||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:R.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:R.telepon_1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:R.telepon_2||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:R.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:R.tgl_input||"-"})]},R.id||Z))})]})}),l&&e.jsx(De,{title:"Wali",menu:7,item:a,onClose:x}),T>1&&e.jsx(Fe,{currentPage:C,totalPages:T,handlePageChange:D})]})]})},wn=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},400);return()=>clearTimeout(j)},[c]);const S=t.useCallback(async()=>{let j=`${G}data-pokok/walikelas?limit=${i}`;if(u>1&&(j+=`&page=${u}`),_&&(j+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(j+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(j+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(j+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(j+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(j+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&(j+=`&jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&(j+=`&kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&(j+=`&rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.jenisKelamin&&(j+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.genderRombel&&(j+=`&gender_rombel=${encodeURIComponent(a.genderRombel)}`),a!=null&&a.phoneNumber&&(j+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),v.current===j){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=j,console.log("Fetching data from:",j),n(!0),b(null);try{const y=await fetch(j);if(!y.ok)throw new Error(`${y.statusText}: ${y.status}`);const N=await y.json();console.log("Data Wali Kelas dari API:",N),l(Array.isArray(N.data)?N.data:[]),p(N.total_data||0),h(N.total_pages||1)}catch(y){console.error("Fetch error:",y),b(y.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{waliKelas:s,loadingWaliKelas:r,error:x,searchTerm:c,setSearchTerm:o,limit:i,setLimit:m,totalDataWaliKelas:d,totalPages:g,currentPage:u,setCurrentPage:w}},vn=()=>{var U,q,se,Y,de,oe,W,X;const[a,s]=t.useState(!1),[l,r]=t.useState(null),[n,x]=t.useState(!1),b=ae=>{r(ae),x(!0)},i=()=>{r(null),x(!1)},[m,d]=t.useState({phoneNumber:"",wafathidup:"",status:"",jenisKelamin:"",negara:"",provinsi:"",kabupaten:"",kecamatan:"",angkatanPelajar:"",angkatanSantri:"",lembaga:"",jurusan:"",kelas:"",rombel:""}),{filterNegara:p,selectedNegara:g,handleFilterChangeNegara:h}=Ae(),{filterLembaga:c,selectedLembaga:o,handleFilterChangeLembaga:u}=Te(),w=((U=p.negara.find(ae=>ae.value==g.negara))==null?void 0:U.label)||"",_=((q=p.provinsi.find(ae=>ae.value==g.provinsi))==null?void 0:q.label)||"",f=((se=p.kabupaten.find(ae=>ae.value==g.kabupaten))==null?void 0:se.label)||"",v=((Y=p.kecamatan.find(ae=>ae.value==g.kecamatan))==null?void 0:Y.label)||"",S=((de=c.lembaga.find(ae=>ae.value==o.lembaga))==null?void 0:de.label)||"",j=((oe=c.jurusan.find(ae=>ae.value==o.jurusan))==null?void 0:oe.label)||"",y=((W=c.kelas.find(ae=>ae.value==o.kelas))==null?void 0:W.label)||"",N=((X=c.rombel.find(ae=>ae.value==o.rombel))==null?void 0:X.label)||"",T=t.useMemo(()=>({...m,negara:w,provinsi:_,kabupaten:f,kecamatan:v,lembaga:S,jurusan:j,kelas:y,rombel:N}),[m,j,f,v,y,S,w,_,N]),{waliKelas:C,loadingWaliKelas:P,searchTerm:F,setSearchTerm:M,error:L,limit:I,setLimit:D,totalDataWaliKelas:Q,totalPages:E,currentPage:B,setCurrentPage:V}=wn(T),[ne,te]=t.useState(!1),[R,Z]=t.useState("");t.useEffect(()=>{const ae=sessionStorage.getItem("viewMode");ae&&Z(ae)},[]);const z=ae=>{ae>=1&&ae<=E&&V(ae)},me={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"l"},{label:"Perempuan",value:"p"}],genderRombel:[{label:"Pilih Gender Rombel",value:""},{label:"Putra",value:"putra"},{label:"Putri",value:"putri"}]},he={phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]};return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Wali Kelas"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:()=>ga(`${G}export/walikelas`,s),disabled:a,className:`px-4 py-2 rounded flex items-center gap-2 text-white cursor-pointer ${a?"bg-blue-300 cursor-not-allowed":"bg-blue-500 hover:bg-blue-700"}`,children:a?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-white"}),e.jsx("span",{children:"Loading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{}),e.jsx("span",{children:"Export"})]})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${ne?"mb-4":""}`,children:[e.jsx(ue,{showFilters:ne,filterOptions:p,onChange:h,selectedFilters:g}),e.jsx(ue,{showFilters:ne,filterOptions:c,onChange:u,selectedFilters:o}),e.jsx(ue,{showFilters:ne,filterOptions:me,onChange:ae=>d(O=>({...O,...ae})),selectedFilters:m}),e.jsx(ue,{showFilters:ne,filterOptions:he,onChange:ae=>d(O=>({...O,...ae})),selectedFilters:m})]}),e.jsx(Ce,{searchTerm:F,setSearchTerm:M,totalData:Q,toggleFilters:()=>te(!ne),toggleView:Z,limit:I,toggleLimit:ae=>D(Number(ae.target.value))}),L?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):R==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:P?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):C.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):C.map((ae,O)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex items-center space-x-4 cursor-pointer",onClick:()=>b(ae),children:[e.jsx("img",{alt:ae.nama||"-",className:"w-20 h-24 object-cover",src:ae.foto_profil,onError:K=>{K.target.onerror=null,K.target.src=Me}}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl",children:ae.nama||"-"}),e.jsx("p",{className:"text-gray-600",children:ae.niup||"-"}),e.jsx("p",{className:"text-gray-600",children:ae.lembaga||ae.jurusan})]})]},ae.id||O))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIUP"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIK"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jenis Kelamin"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Lembaga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kelas Rombel"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Gender Rombel"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jumlah Murid"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update Wali Kelas"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input Wali Kelas"})]})}),e.jsx("tbody",{className:"text-gray-800",children:P?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):C.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center py-6",children:"Tidak ada data"})}):C.map((ae,O)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-left cursor-pointer",onClick:()=>b(ae),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(B-1)*I+O+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ae.niup||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ae.nik_or_Passport||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ae.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ae.JenisKelamin||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ae.lembaga||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ae.Kelas||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ae.GenderRombel||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ae.JumlahMurid||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ae.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ae.tgl_input||"-"})]},ae.id||O))})]})}),n&&e.jsx(De,{title:"Wali Kelas",menu:11,item:l,onClose:i}),E>1&&e.jsx(Fe,{currentPage:B,totalPages:E,handlePageChange:z})]})]})},Nn=()=>{const{clearAuthData:a}=ke(),s=je(),[l,r]=t.useState([]),[n,x]=t.useState(!0),[b,i]=t.useState(null),m=sessionStorage.getItem("token")||xe("token"),d=t.useCallback(async()=>{x(!0),i(null);try{const g=await fetch(`${G}crud/golongan`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`}});if(g.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),a(),s("/login");return}if(!g.ok)throw new Error(`Error ${g.status}`);const h=await g.json();r(Array.isArray(h.data)?h.data:[])}catch(g){console.error("Fetch error:",g),i(g.message),r([])}finally{x(!1)}},[m]);return t.useEffect(()=>{d()},[d]),{golongan:l,loadingGolongan:n,error:b,fetchGolongan:d,handleDelete:async g=>{if((await k.fire({title:"Yakin ingin menghapus data ini?",text:"Data yang sudah dihapus tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Menghapus data...",allowOutsideClick:!1,didOpen:()=>k.showLoading()});const c=sessionStorage.getItem("token")||xe("token"),o=await fetch(`${G}crud/${g}/golongan`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`}});if(k.close(),o.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),a(),s("/login");return}if(!o.ok){let u={};try{u=await o.json()}catch{}throw new Error(u.message||"Gagal menghapus data.")}await k.fire({icon:"success",title:"Berhasil",text:"Data berhasil dihapus."}),d()}catch(c){console.error("Error saat menghapus:",c),await k.fire({icon:"error",title:"Gagal",text:c.message||"Terjadi kesalahan saat menghapus data."})}}}},_n=({isOpen:a,onClose:s,data:l,refetchData:r,feature:n})=>{const{clearAuthData:x}=ke(),b=je(),{kategoriGolongan:i}=pa(),m=l.id,[d,p]=t.useState({nama_golongan:"",kategori_golongan_id:""});t.useEffect(()=>{a&&p(n===2&&l?{nama_golongan:l.nama_golongan||"",kategori_golongan_id:l.kategori_golongan_id||""}:{nama_golongan:"",kategori_golongan_id:""})},[a,n,l]);const g=async h=>{if(h.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const o=sessionStorage.getItem("token")||xe("token"),u=n===2,w=u?`${G}crud/${m}/golongan`:`${G}crud/golongan`,_=u?"PUT":"POST",f={nama_golongan:d.nama_golongan,kategori_golongan_id:d.kategori_golongan_id};console.log("Payload yang dikirim ke API:",JSON.stringify(f,null,2));const v=await fetch(w,{method:_,headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(f)}),S=await v.json();if(k.close(),console.log(S),v.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),x(),b("/login");return}if(!v.ok)throw new Error(S.message||"Terjadi kesalahan pada server.");await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),r==null||r(),s==null||s()}catch(o){console.error("Terjadi kesalahan:",o),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:g,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:n==1?"Tambah Data Baru":"Edit"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kategori_golongan_id",className:"block text-gray-700",children:"Kategori Golongan *"}),e.jsx("select",{className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",onChange:h=>p({...d,kategori_golongan_id:h.target.value}),value:d.kategori_golongan_id,required:!0,children:i.map((h,c)=>e.jsx("option",{value:h.value,children:h.label},c))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nama_golongan",className:"block text-gray-700",children:"Nama Golongan *"}),e.jsx("input",{type:"text",id:"nama_golongan",name:"nama_golongan",value:d.nama_golongan,onChange:h=>p({...d,nama_golongan:h.target.value}),maxLength:255,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Masukkan Nama Golongan"})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full cursor-pointer inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 cursor-pointer w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},Sn=()=>{const[a,s]=t.useState(!1),[l,r]=t.useState(""),[n,x]=t.useState(""),{golongan:b,loadingGolongan:i,error:m,fetchGolongan:d,handleDelete:p}=Nn();return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Golongan"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("button",{onClick:()=>{x(1),s(!0)},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer flex items-center gap-2",children:[e.jsx(Ee,{}),"Tambah"]})})]}),e.jsx(_n,{isOpen:a,onClose:()=>s(!1),data:l,refetchData:d,feature:n}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:m?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b w-10",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama Golongan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Status"}),e.jsx("th",{className:"px-3 py-2 border-b text-center",children:"Aksi"})]})}),e.jsx("tbody",{className:"text-gray-800",children:i?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center p-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):b.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-6",children:"Tidak ada data"})}):b.map((g,h)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:h+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:g.nama_golongan}),e.jsx("td",{className:"px-3 py-2 border-b w-30",children:e.jsx("span",{className:`text-sm font-semibold px-3 py-1 rounded-full ${g.status===1?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:g.status===1?"Aktif":"Nonaktif"})}),e.jsxs("td",{className:"px-3 py-2 border-b text-center space-x-2 w-20",children:[e.jsx("button",{onClick:()=>{r(g),x(2),s(!0)},className:"p-2 text-sm text-white bg-blue-500 hover:bg-blue-600 rounded cursor-pointer",children:e.jsx(ua,{})}),e.jsx("button",{onClick:()=>p(g.id),className:"p-2 text-sm text-white bg-red-500 hover:bg-red-600 rounded cursor-pointer",children:e.jsx(_a,{})})]})]},g.id))})]})})})]})},st=({filterOptions:a,onChange:s,selectedFilters:l,vertical:r=!1})=>e.jsx(e.Fragment,{children:Object.entries(a).map(([n,x],b)=>e.jsxs("div",{className:`mb-4 ${r?"w-full":"w-full px-2 sm:w-1/2 md:w-1/3 lg:w-1/4"}`,children:[r&&e.jsxs("label",{className:"block text-gray-700 mb-1 capitalize",children:[n," Tujuan"]}),e.jsx("select",{className:`w-full border border-gray-300 rounded p-2 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:i=>s({[n]:i.target.value}),value:l[n]||"",disabled:x.length<=1,required:r,children:x.map((i,m)=>e.jsx("option",{value:i.value,children:i.label},m))})]},`${n}-${b}`))}),Tn=()=>{var z,me,he,U;const{clearAuthData:a}=ke(),s=je(),[l,r]=t.useState([]),[n,x]=t.useState(!1),[b,i]=t.useState(null),[m,d]=t.useState({lembaga:"",jurusan:"",kelas:"",rombel:""});t.useEffect(()=>{console.log(l)},[l]);const{filterLembaga:p,handleFilterChangeLembaga:g,selectedLembaga:h}=Te(),{filterLembaga:c,handleFilterChangeLembaga:o,selectedLembaga:u}=Te(),w=h.lembaga!=="",{pelajar:_,loadingPelajar:f,error:v,setLimit:S,totalDataPelajar:j,fetchData:y,fetchAllData:N,limit:T,searchTerm:C,setSearchTerm:P,totalPages:F,currentPage:M,setCurrentPage:L,allPelajarIds:I}=Ca(m),D=(q,se)=>q.length>0?[{...q[0],label:se},...q.slice(1)]:q,Q={lembaga:D(p.lembaga,"Pilih Lembaga"),jurusan:D(p.jurusan,"Pilih Jurusan"),kelas:D(p.kelas,"Pilih Kelas"),rombel:D(p.rombel,"Pilih rombel")},E={lembaga:D(c.lembaga,"-- Pilih Lembaga --"),jurusan:D(c.jurusan,"-- Pilih Jurusan --"),kelas:D(c.kelas,"-- Pilih Kelas --"),rombel:D(c.rombel,"-- Pilih rombel --")},B=((z=p.lembaga.find(q=>q.value==h.lembaga))==null?void 0:z.label)||"",V=((me=p.jurusan.find(q=>q.value==h.jurusan))==null?void 0:me.label)||"",ne=((he=p.kelas.find(q=>q.value==h.kelas))==null?void 0:he.label)||"",te=((U=p.rombel.find(q=>q.value==h.rombel))==null?void 0:U.label)||"";t.useEffect(()=>{(B||V||ne||te)&&d({lembaga:B,jurusan:V,kelas:ne,rombel:te})},[B,V,ne,te]),t.useEffect(()=>{n&&I.length>0&&r(I)},[I]);const R=async q=>{q.preventDefault();let se="";if(b=="Naik"?se="naik-jenjang":se="pindah-jenjang",l.length===0){await k.fire({icon:"warning",title:"Peringatan",text:"Pilih minimal satu santri untuk diproses."});return}if(!(await k.fire({title:"Yakin ingin memproses data ini?",text:"Pastikan data tujuan sudah sesuai.",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, proses",cancelButtonText:"Batal"})).isConfirmed)return;const de={biodata_id:l,lembaga_id:u.lembaga,jurusan_id:u.jurusan,kelas_id:u.kelas,rombel_id:u.rombel};try{k.fire({title:"Mohon tunggu...",html:"Sedang memproses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const oe=sessionStorage.getItem("token")||xe("token"),W=await fetch(`${G}fitur/${se}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${oe}`},body:JSON.stringify(de)}),X=await W.json();if(k.close(),W.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),a(),s("/login");return}if(!W.ok){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${X.message||"Terjadi kesalahan saat memproses perpindahan."}</div>`});return}await k.fire({icon:"success",title:"Berhasil",text:`${b} kelas berhasil diproses!`}),r([]),y(!0)}catch(oe){console.error("Terjadi kesalahan:",oe),k.close(),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}},Z=q=>{q>=1&&q<=F&&L(q)};return t.useEffect(()=>{console.log(l)},[l]),e.jsxs("div",{className:"flex flex-col lg:flex-row items-start gap-6 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"w-full lg:w-2/3 bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Daftar Siswa"}),e.jsx("div",{className:"flex flex-wrap w-full mb-4",children:e.jsx(st,{filterOptions:Q,onChange:g,selectedFilters:h})}),w?v?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{searchTerm:C,setSearchTerm:P,totalData:j,limit:T,toggleLimit:q=>S(Number(q.target.value)),showViewButtons:!1,showFilterButtons:!1}),e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b text-center w-10",children:e.jsx("input",{type:"checkbox",checked:n,onChange:async q=>{const se=q.target.checked;x(se),se?(await N(),r(I)):r([])}})}),e.jsx("th",{className:"px-3 py-2 border-b text-center w-10",children:"No"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"No. Induk (Siswa/Mahasiswa)"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kelas"})]})}),e.jsx("tbody",{className:"text-gray-800",children:f?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):_.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:"Tidak ada data"})}):_.map((q,se)=>e.jsxs("tr",{className:"hover:bg-gray-50 text-center",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:e.jsx("input",{type:"checkbox",checked:l.includes(q.biodata_id),onChange:Y=>{const de=Y.target.checked;r(de?oe=>{const W=[...oe,q.biodata_id];return W.length===_.length&&x(!0),W}:oe=>{const W=oe.filter(X=>X!==q.biodata_id);return x(!1),W})}})}),e.jsx("td",{className:"px-3 py-2 border-b",children:(M-1)*T+se+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:q.no_induk}),e.jsx("td",{className:"px-3 py-2 border-b text-left",children:q.nama}),e.jsx("td",{className:"px-3 py-2 border-b",children:q.kelas})]},`${q.id}-${se}`))})]})}),F>1&&e.jsx(Fe,{currentPage:M,totalPages:F,handlePageChange:Z})]}):e.jsx("div",{className:"text-center py-6 text-gray-500 italic",children:"Silakan pilih lembaga terlebih dahulu."})]}),e.jsxs("form",{onSubmit:R,className:"w-full lg:w-1/3 bg-white p-6 rounded-lg shadow-md flex flex-col justify-between self-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Pindahkan ke"}),e.jsx("div",{className:"flex flex-wrap w-full mb-4",children:e.jsx(st,{filterOptions:E,onChange:o,selectedFilters:u,vertical:!0})})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"submit",onClick:()=>i("Naik"),className:"bg-blue-100 hover:bg-blue-200 text-blue-700 font-semibold px-6 py-3 rounded transition duration-200 w-1/2 cursor-pointer",children:"Naik"}),e.jsx("button",{type:"submit",onClick:()=>i("Pindah"),className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded transition duration-200 w-1/2 cursor-pointer",children:"Pindah"})]})]})]})},Pn=()=>{const{clearAuthData:a}=ke(),s=je(),[l,r]=t.useState([]),[n,x]=t.useState(!0),[b,i]=t.useState(null),m=sessionStorage.getItem("token")||xe("token"),d=t.useCallback(async()=>{x(!0),i(null);try{const g=await fetch(`${G}crud/golongan-jabatan`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`}});if(g.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),a(),s("/login");return}if(!g.ok)throw new Error(`Error ${g.status}`);const h=await g.json();r(Array.isArray(h.data)?h.data:[])}catch(g){console.error("Fetch error:",g),i(g.message),r([])}finally{x(!1)}},[m]);return t.useEffect(()=>{d()},[d]),{golonganJabatan:l,loading:n,error:b,fetchGolonganJabatan:d,handleDelete:async g=>{if((await k.fire({title:"Yakin ingin menghapus data ini?",text:"Data yang sudah dihapus tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Menghapus data...",allowOutsideClick:!1,didOpen:()=>k.showLoading()});const c=await fetch(`${G}crud/${g}/golongan-jabatan`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`}});if(await k.close(),c.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),a(),s("/login");return}if(!c.ok){let o={};try{o=await c.json()}catch{}throw new Error(o.message||"Gagal menghapus data.")}await k.fire({icon:"success",title:"Berhasil",text:"Data berhasil dihapus."}),d()}catch(c){console.error("Error saat menghapus:",c),await k.fire({icon:"error",title:"Gagal",text:c.message||"Terjadi kesalahan saat menghapus data."})}}}},Cn=({isOpen:a,onClose:s,data:l,refetchData:r,feature:n})=>{const{clearAuthData:x}=ke(),b=je(),i=l.id,[m,d]=t.useState({nama_golongan_jabatan:""});t.useEffect(()=>{a&&d(n===2&&l?{nama_golongan_jabatan:l.nama_golongan_jabatan||""}:{nama_golongan_jabatan:""})},[a,n,l]);const p=async g=>{if(g.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const c=sessionStorage.getItem("token")||xe("token"),o=n===2,u=o?`${G}crud/${i}/golongan-jabatan`:`${G}crud/golongan-jabatan`,w=o?"PUT":"POST",_={nama_golongan_jabatan:m.nama_golongan_jabatan};console.log("Payload yang dikirim ke API:",JSON.stringify(_,null,2));const f=await fetch(u,{method:w,headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify(_)}),v=await f.json();if(k.close(),console.log(v),f.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),x(),b("/login");return}if(!f.ok)throw new Error(v.message||"Terjadi kesalahan pada server.");await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),r==null||r(),s==null||s()}catch(c){console.error("Terjadi kesalahan:",c),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:p,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:n==1?"Tambah Data Baru":"Edit Data"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nama_golongan_jabatan",className:"block text-gray-700",children:"Nama Golongan *"}),e.jsx("input",{type:"text",id:"nama_golongan_jabatan",name:"nama_golongan_jabatan",value:m.nama_golongan_jabatan,onChange:g=>d({...m,nama_golongan_jabatan:g.target.value}),maxLength:255,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Masukkan Nama Kategori Golongan"})]})})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full cursor-pointer inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 cursor-pointer w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},Fn=()=>{const[a,s]=t.useState(!1),[l,r]=t.useState(""),[n,x]=t.useState(""),{golonganJabatan:b,loading:i,error:m,fetchGolonganJabatan:d,handleDelete:p}=Pn();return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Golongan"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("button",{onClick:()=>{x(1),s(!0)},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer flex items-center gap-2",children:[e.jsx(Ee,{}),"Tambah"]})})]}),e.jsx(Cn,{isOpen:a,onClose:()=>s(!1),data:l,refetchData:d,feature:n}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:m?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b w-10",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama Golongan Jabatan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Status"}),e.jsx("th",{className:"px-3 py-2 border-b text-center",children:"Aksi"})]})}),e.jsx("tbody",{className:"text-gray-800",children:i?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center p-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):b.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-6",children:"Tidak ada data"})}):b.map((g,h)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:h+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:g.nama_golongan_jabatan}),e.jsx("td",{className:"px-3 py-2 border-b w-30",children:e.jsx("span",{className:`text-sm font-semibold px-3 py-1 rounded-full ${g.status===1?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:g.status===1?"Aktif":"Nonaktif"})}),e.jsxs("td",{className:"px-3 py-2 border-b text-center space-x-2 w-20",children:[e.jsx("button",{onClick:()=>{r(g),x(2),s(!0)},className:"p-2 text-sm text-white bg-blue-500 hover:bg-blue-600 rounded cursor-pointer",children:e.jsx(ua,{})}),e.jsx("button",{onClick:()=>p(g.id),className:"p-2 text-sm text-white bg-red-500 hover:bg-red-600 rounded cursor-pointer",children:e.jsx(_a,{})})]})]},g.id))})]})})})]})},$n=()=>{const{clearAuthData:a}=ke(),s=je(),[l,r]=t.useState([]),[n,x]=t.useState(!0),[b,i]=t.useState(null),m=sessionStorage.getItem("token")||xe("token"),d=t.useCallback(async()=>{x(!0),i(null);try{const g=await fetch(`${G}crud/kategori-golongan`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`}});if(g.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),a(),s("/login");return}if(!g.ok)throw new Error(`Error ${g.status}`);const h=await g.json();r(Array.isArray(h.data)?h.data:[])}catch(g){console.error("Fetch error:",g),i(g.message),r([])}finally{x(!1)}},[m]);return t.useEffect(()=>{d()},[d]),{kategoriGolongan:l,loadingKategori:n,error:b,fetchKategoriGolongan:d,handleDelete:async g=>{if((await k.fire({title:"Yakin ingin menghapus data ini?",text:"Data yang sudah dihapus tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Menghapus data...",allowOutsideClick:!1,didOpen:()=>k.showLoading()});const c=await fetch(`${G}crud/${g}/kategori-golongan`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`}});if(k.close(),c.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),a(),s("/login");return}if(!c.ok){let o={};try{o=await c.json()}catch{}throw new Error(o.message||"Gagal menghapus data.")}await k.fire({icon:"success",title:"Berhasil",text:"Data berhasil dihapus."}),d()}catch(c){console.error("Error saat menghapus:",c),await k.fire({icon:"error",title:"Gagal",text:c.message||"Terjadi kesalahan saat menghapus data."})}}}},An=({isOpen:a,onClose:s,data:l,refetchData:r,feature:n})=>{const{clearAuthData:x}=ke(),b=je(),i=l.id,[m,d]=t.useState({nama_kategori_golongan:""});t.useEffect(()=>{a&&d(n===2&&l?{nama_kategori_golongan:l.nama_kategori_golongan||""}:{nama_kategori_golongan:""})},[a,n,l]);const p=async g=>{if(g.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const c=sessionStorage.getItem("token")||xe("token"),o=n===2,u=o?`${G}crud/${i}/kategori-golongan`:`${G}crud/kategori-golongan`,w=o?"PUT":"POST",_={nama_kategori_golongan:m.nama_kategori_golongan};console.log("Payload yang dikirim ke API:",JSON.stringify(_,null,2));const f=await fetch(u,{method:w,headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify(_)}),v=await f.json();if(k.close(),console.log(v),f.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),x(),b("/login");return}if(!f.ok)throw new Error(v.message||"Terjadi kesalahan pada server.");await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),r==null||r(),s==null||s()}catch(c){console.error("Terjadi kesalahan:",c),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:p,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:n==1?"Tambah Data Baru":"Edit Data"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nama_kategori_golongan",className:"block text-gray-700",children:"Nama Golongan *"}),e.jsx("input",{type:"text",id:"nama_kategori_golongan",name:"nama_kategori_golongan",value:m.nama_kategori_golongan,onChange:g=>d({...m,nama_kategori_golongan:g.target.value}),maxLength:255,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Masukkan Nama Kategori Golongan"})]})})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full cursor-pointer inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 cursor-pointer w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},Kn=()=>{const[a,s]=t.useState(!1),[l,r]=t.useState(""),[n,x]=t.useState(""),{kategoriGolongan:b,loadingKategori:i,error:m,fetchKategoriGolongan:d,handleDelete:p}=$n();return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Golongan"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("button",{onClick:()=>{x(1),s(!0)},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer flex items-center gap-2",children:[e.jsx(Ee,{}),"Tambah"]})})]}),e.jsx(An,{isOpen:a,onClose:()=>s(!1),data:l,refetchData:d,feature:n}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:m?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b w-10",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama Kategori Golongan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Status"}),e.jsx("th",{className:"px-3 py-2 border-b text-center",children:"Aksi"})]})}),e.jsx("tbody",{className:"text-gray-800",children:i?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center p-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):b.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-6",children:"Tidak ada data"})}):b.map((g,h)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:h+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:g.nama_kategori_golongan}),e.jsx("td",{className:"px-3 py-2 border-b w-30",children:e.jsx("span",{className:`text-sm font-semibold px-3 py-1 rounded-full ${g.status===1?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:g.status===1?"Aktif":"Nonaktif"})}),e.jsxs("td",{className:"px-3 py-2 border-b text-center space-x-2 w-20",children:[e.jsx("button",{onClick:()=>{r(g),x(2),s(!0)},className:"p-2 text-sm text-white bg-blue-500 hover:bg-blue-600 rounded cursor-pointer",children:e.jsx(ua,{})}),e.jsx("button",{onClick:()=>p(g.id),className:"p-2 text-sm text-white bg-red-500 hover:bg-red-600 rounded cursor-pointer",children:e.jsx(_a,{})})]})]},g.id))})]})})})]})},In=()=>{const{clearAuthData:a}=ke(),s=je(),[l,r]=t.useState([]),[n,x]=t.useState(!0),[b,i]=t.useState(null),m=sessionStorage.getItem("token")||xe("token"),d=t.useCallback(async()=>{x(!0),i(null);try{const g=await fetch(`${G}crud/lembaga`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`}});if(g.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),a(),s("/login");return}if(!g.ok)throw new Error(`Error ${g.status}`);const h=await g.json();r(Array.isArray(h)?h:[])}catch(g){console.error("Fetch error:",g),i(g.message),r([])}finally{x(!1)}},[m]);return t.useEffect(()=>{d()},[d]),{lembaga:l,loadingLembaga:n,error:b,fetchLembaga:d,handleDelete:async g=>{if((await k.fire({title:"Yakin ingin menghapus data ini?",text:"Data yang sudah dihapus tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Menghapus data...",allowOutsideClick:!1,didOpen:()=>k.showLoading()});const c=sessionStorage.getItem("token")||xe("token"),o=await fetch(`${G}crud/${g}/lembaga`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`}});if(await k.close(),o.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),a(),s("/login");return}if(!o.ok){let u={};try{u=await o.json()}catch{}throw new Error(u.message||"Gagal menghapus data.")}await k.fire({icon:"success",title:"Berhasil",text:"Data berhasil dihapus."}),d()}catch(c){console.error("Error saat menghapus:",c),await k.fire({icon:"error",title:"Gagal",text:c.message||"Terjadi kesalahan saat menghapus data."})}}}},Mn=({isOpen:a,onClose:s,data:l,refetchData:r,feature:n})=>{const{clearAuthData:x}=ke(),b=je(),i=l.id,[m,d]=t.useState({nama_lembaga:"",status:""});t.useEffect(()=>{a&&d(n===2&&l?{nama_lembaga:l.nama_lembaga||"",status:l.status===1||l.status===!0}:{nama_lembaga:"",status:""})},[a,n,l]);const p=async g=>{if(g.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const c=sessionStorage.getItem("token")||xe("token"),o=n===2,u=o?`${G}crud/${i}/lembaga`:`${G}crud/lembaga`,w=o?"PUT":"POST",_=o?{nama_lembaga:m.nama_lembaga,status:m.status}:{nama_lembaga:m.nama_lembaga};console.log("Payload yang dikirim ke API:",JSON.stringify(_,null,2));const f=await fetch(u,{method:w,headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify(_)}),v=await f.json();if(k.close(),console.log(v),f.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),x(),b("/login");return}if(!f.ok)throw new Error(v.message||"Terjadi kesalahan pada server.");await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),r==null||r(),s==null||s()}catch(c){console.error("Terjadi kesalahan:",c),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:p,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:n==1?"Tambah Data Baru":"Edit Data"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nama_lembaga",className:"block text-gray-700",children:"Nama Lembaga *"}),e.jsx("input",{type:"text",id:"nama_lembaga",name:"nama_lembaga",value:m.nama_lembaga,onChange:g=>d({...m,nama_lembaga:g.target.value}),maxLength:255,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Masukkan Keterangan"})]}),n==2&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700",children:"Status Aktif *"}),e.jsxs("div",{className:"flex space-x-4 mt-1",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"status",value:"YA",checked:m.status===!0,onChange:()=>d({...m,status:!0}),className:"form-radio text-blue-500 focus:ring-blue-500",required:!0}),e.jsx("span",{className:"ml-2 text-gray-700",children:"Ya"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"status",value:"TIDAK",checked:m.status===!1,onChange:()=>d({...m,status:!1}),className:"form-radio text-blue-500 focus:ring-blue-500",required:!0}),e.jsx("span",{className:"ml-2 text-gray-700",children:"Tidak"})]})]})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full cursor-pointer inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 cursor-pointer w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},Bn=()=>{const[a,s]=t.useState(!1),[l,r]=t.useState(""),[n,x]=t.useState(""),{lembaga:b,loadingLembaga:i,error:m,fetchLembaga:d,handleDelete:p}=In(),g=h=>{const c={year:"numeric",month:"short",day:"2-digit"};return new Date(h).toLocaleDateString("id-ID",c)};return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Lembaga"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("button",{onClick:()=>{x(1),s(!0)},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer flex items-center gap-2",children:[e.jsx(Ee,{}),"Tambah"]})})]}),e.jsx(Mn,{isOpen:a,onClose:()=>s(!1),data:l,refetchData:d,feature:n}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:m?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama Lembaga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Status"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Input"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Update"}),e.jsx("th",{className:"px-3 py-2 border-b text-center",children:"Aksi"})]})}),e.jsx("tbody",{className:"text-gray-800",children:i?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center p-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):b.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-6",children:"Tidak ada data"})}):b.map((h,c)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:c+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:h.nama_lembaga}),e.jsx("td",{className:"px-3 py-2 border-b",children:e.jsx("span",{className:`text-sm font-semibold px-3 py-1 rounded-full ${h.status===1?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:h.status===1?"Aktif":"Nonaktif"})}),e.jsx("td",{className:"px-3 py-2 border-b",children:g(h.created_at)}),e.jsx("td",{className:"px-3 py-2 border-b",children:g(h.updated_at)}),e.jsxs("td",{className:"px-3 py-2 border-b text-center space-x-2",children:[e.jsx("button",{onClick:()=>{r(h),x(2),s(!0)},className:"p-2 text-sm text-white bg-blue-500 hover:bg-blue-600 rounded cursor-pointer",children:e.jsx(ua,{})}),e.jsx("button",{onClick:()=>p(h.id),className:"p-2 text-sm text-white bg-red-500 hover:bg-red-600 rounded cursor-pointer",children:e.jsx(_a,{})})]})]},h.id))})]})})})]})},Dn=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},400);return()=>clearTimeout(j)},[c]);const S=t.useCallback(async(j=!1)=>{let y=`${G}data-pokok/anakpegawai?limit=${i}`;if(u>1&&(y+=`&page=${u}`),_&&(y+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.phoneNumber&&(y+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),a!=null&&a.wargaPesantren&&(y+=`&warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.status&&(y+=`&status=${encodeURIComponent(a.status)}`),a!=null&&a.jenisKelamin&&(y+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.smartcard&&(y+=`&smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.pemberkasan&&(y+=`&pemberkasan=${encodeURIComponent(a.pemberkasan)}`),a!=null&&a.urutBerdasarkan&&(y+=`&sort_by=${encodeURIComponent(a.urutBerdasarkan)}`),a!=null&&a.urutSecara&&(y+=`&sort_order=${encodeURIComponent(a.urutSecara)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(y+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(y+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(y+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(y+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&(y+=`&wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&(y+=`&blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&(y+=`&kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.angkatanPelajar&&(y+=`&angkatan_pelajar=${encodeURIComponent(a.angkatanPelajar)}`),a!=null&&a.angkatanSantri&&(y+=`&angkatan_santri=${encodeURIComponent(a.angkatanSantri)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(y+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&(y+=`&jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&(y+=`&kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&(y+=`&rombel=${encodeURIComponent(a.rombel)}`),!j&&v.current===y){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=y,console.log("Fetching data from:",y),n(!0),b(null);try{const N=await fetch(y);if(!N.ok)throw new Error(`Fetch error: ${N.status}`);const T=await N.json();l(Array.isArray(T.data)?T.data:[]),p(T.total_data||0),h(T.total_pages||1)}catch(N){console.error("Fetch error:",N),b(N.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{anakPegawai:s,loadingAnakPegawai:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataAnakPegawai:d,totalPages:g,currentPage:u,setCurrentPage:w,fetchData:S}},Ln=({register:a,watch:s,setValue:l,control:r,activeTab:n})=>{const{filterNegara:x,selectedNegara:b,handleFilterChangeNegara:i}=Ae(),m=s("modalAnakPegawai.kewarganegaraan"),d=s("modalAnakPegawai.negara_id"),p=s("modalAnakPegawai.provinsi_id"),g=s("modalAnakPegawai.kabupaten_id"),h=s("modalAnakPegawai.kecamatan_id"),c=f=>{const v=f.target.value;l("modalAnakPegawai.kewarganegaraan",v),v==="wna"?(l("modalAnakPegawai.no_kk",""),l("modalAnakPegawai.nik","")):v==="wni"&&l("modalAnakPegawai.no_passport","")};t.useEffect(()=>{n===0&&(console.log("handle"),d&&(console.log("negara handle ",d),i({negara:d})),p&&(console.log("provinsi handle ",p),i({provinsi:p})),g&&(console.log("kabupaten handle ",g),i({kabupaten:g})),h&&(console.log("kecamatan handle ",h),i({kecamatan:h})))},[n]);const o=(f,v)=>f.length>0?[{...f[0],label:v},...f.slice(1)]:f,u={negara:o(x.negara,"Pilih Negara"),provinsi:o(x.provinsi,"Pilih Provinsi"),kabupaten:o(x.kabupaten,"Pilih Kabupaten"),kecamatan:o(x.kecamatan,"Pilih Kecamatan")},w=f=>f.charAt(0).toUpperCase()+f.slice(1),_=({filterOptions:f,control:v,onChange:S,selectedFilters:j})=>e.jsx("div",{className:"space-y-2",children:Object.entries(f).map(([y,N],T)=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsxs("label",{htmlFor:y,className:"md:w-1/4 text-black",children:[w(y)," *"]}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md border border-gray-300 border-gray-500 ${N.length<=1?"bg-gray-200 text-gray-500":""}`,children:e.jsx(Xe,{name:`modalAnakPegawai.${y}_id`,control:v,rules:{required:!0},defaultValue:j[y]||"",render:({field:C})=>e.jsx("select",{...C,id:y,required:!0,disabled:N.length<=1,className:`w-full py-1.5 pr-3 pl-1 text-base focus:outline-none sm:text-sm ${N.length<=1?"text-gray-500":""}`,onChange:P=>{C.onChange(P),S({[y]:P.target.value})},children:N.map((P,F)=>e.jsx("option",{value:P.value,children:P.label},F))})})})})]},`${y}-${T}`))});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"kewarganegaraan",className:"md:w-1/4 text-black",children:"Kewarganegaraan *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"kewarganegaraan",value:"wni",className:"w-4 h-4",...a("modalAnakPegawai.kewarganegaraan",{required:!0}),checked:m==="wni",onChange:c,required:!0}),e.jsx("span",{children:"WNI"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"kewarganegaraan",value:"wna",className:"w-4 h-4",...a("modalAnakPegawai.kewarganegaraan",{required:!0}),checked:m==="wna",onChange:c,required:!0}),e.jsx("span",{children:"WNA"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"passport",className:"md:w-1/4 text-black",children:"No Passport *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-500 ${m==="wna"?"bg-white border-gray-300 ":"bg-gray-300 border-gray-200"}`,children:e.jsx("input",{id:"no_passport",name:"no_passport",type:"text",maxLength:20,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},disabled:m!=="wna",placeholder:"Masukkan No Passport",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.no_passport",{required:m==="wna"}),required:m==="wna"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nokk",className:"md:w-1/4 text-black",children:"Nomor KK *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-500 ${m==="wni"?"bg-white border-gray-300 ":"bg-gray-300 border-gray-200"}`,children:e.jsx("input",{id:"no_kk",name:"no_kk",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},disabled:m!=="wni",placeholder:"Masukkan No KK",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.no_kk",{required:m==="wni"}),required:m==="wni"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4 ",children:[e.jsx("label",{htmlFor:"nonik",className:"md:w-1/4 text-black",children:"NIK *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-500 ${m==="wni"?"bg-white border-gray-300 ":"bg-gray-300 border-gray-200"}`,children:e.jsx("input",{id:"nik",name:"nik",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"").slice(0,16)},disabled:m!=="wni",placeholder:"Masukkan NIK",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.nik",{required:m==="wni"}),required:m==="wni"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama",className:"md:w-1/4 text-black",children:"Nama Lengkap *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama",name:"nama",type:"text",placeholder:"Masukkan Nama Lengkap",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.nama",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jenisKelamin",className:"md:w-1/4 text-black",children:"Jenis Kelamin *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"jenisKelamin",value:"p",className:"w-4 h-4",...a("modalAnakPegawai.jenis_kelamin",{required:!0}),required:!0}),e.jsx("span",{children:"Perempuan"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"jenisKelamin",value:"l",className:"w-4 h-4",...a("modalAnakPegawai.jenis_kelamin",{required:!0}),required:!0}),e.jsx("span",{children:"Laki-Laki"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tempatLahir",className:"md:w-1/4 text-black",children:"Tempat Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tempatLahir",name:"tempatLahir",type:"text",placeholder:"Masukkan Tempat Lahir",...a("modalAnakPegawai.tempat_lahir",{required:!0}),required:!0,className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_lahir",className:"md:w-1/4 text-black",children:"Tanggal Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_lahir",name:"tanggal_lahir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.tanggal_lahir",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"anak_keberapa",className:"md:w-1/4 text-black",children:"Anak Ke *"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"anak_keberapa",name:"anak_keberapa",type:"number",min:"1",className:"w-13 py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.anak_keberapa")})}),e.jsx("span",{children:"Dari"}),e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"dari_saudara",name:"dari_saudara",type:"number",min:"1",className:"w-13 py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.dari_saudara")})})]})]}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tinggal_bersama",className:"md:w-1/4 text-black",children:"Tinggal Bersama"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tinggal_bersama",name:"tinggal_bersama",type:"text",placeholder:"Masukkan Tinggal Bersama",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.tinggal_bersama")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jenjang_pendidikan_terakhir",className:"md:w-1/4 text-black",children:"Jenjang Pendidikan Terakhir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsxs("select",{id:"jenjang_pendidikan_terakhir",name:"jenjang_pendidikan_terakhir",...a("modalAnakPegawai.jenjang_pendidikan_terakhir"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"paud",children:"Paud"}),e.jsx("option",{value:"sd/mi",children:"SD/MI"}),e.jsx("option",{value:"smp/mts",children:"SMP/MTS"}),e.jsx("option",{value:"sma/smk/ma",children:"SMA/SMK/MA"}),e.jsx("option",{value:"d3",children:"D3"}),e.jsx("option",{value:"d4",children:"D4"}),e.jsx("option",{value:"s1",children:"S1"}),e.jsx("option",{value:"s2",children:"S2"})]})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama_pendidikan_terakhir",className:"md:w-1/4 text-black",children:"Nama Pendidikan Terakhir"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama_pendidikan_terakhir",name:"nama_pendidikan_terakhir",type:"text",placeholder:"Masukkan Nama Pendidikan Terakhir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.nama_pendidikan_terakhir")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon",className:"md:w-1/4 text-black",children:"Nomor Telepon 1"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon",name:"no_telepon",type:"tel",maxLength:20,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.no_telepon",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon_2",className:"md:w-1/4 text-black",children:"Nomor Telepon 2"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon_2",name:"no_telepon_2",type:"tel",maxLength:20,inputMode:"numeric",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.no_telepon_2")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"email",className:"md:w-1/4 text-black",children:"E-Mail"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"email",name:"email",type:"email",maxLength:100,placeholder:"Masukkan E-Mail",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.email",{required:!0}),required:!0})})})]}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsx(_,{filterOptions:u,onChange:i,selectedFilters:b,control:r}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jalan",className:"md:w-1/4 text-black",children:"Jalan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"jalan",name:"jalan",type:"text",maxLength:255,placeholder:"Masukkan Nama Jalan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.jalan",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"kodepos",className:"md:w-1/4 text-black",children:"Kode Pos *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"kodepos",name:"kodepos",type:"text",maxLength:10,pattern:"\\d*",onInput:f=>{f.target.value=f.target.value.replace(/[^0-9]/g,"")},inputMode:"numeric",placeholder:"Masukkan Kode Pos",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.kode_pos",{required:!0}),required:!0})})})]})]})})},On=({register:a,errors:s})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-bold text-xl",children:"Data Ayah"}),e.jsx("hr",{className:"border-t border-gray-500 mb-4 mt-2"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nik_ayah",className:"md:w-1/4 text-black",children:"NIK Ayah *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsxs("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:[e.jsx("input",{id:"nik_ayah",name:"nik_ayah",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:l=>{l.target.value=l.target.value.replace(/[^0-9]/g,"").slice(0,16)},placeholder:"Masukkan NIK Ayah",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.nik_ayah",{required:!0}),required:!0}),s.no_kk&&e.jsx("span",{children:"KK wajib diisi"})]})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama_ayah",className:"md:w-1/4 text-black",children:"Nama Ayah *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama_ayah",name:"nama_ayah",type:"text",placeholder:"Masukkan Nama Ayah",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.nama_ayah",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tempat_lahir_ayah",className:"md:w-1/4 text-black",children:"Tempat Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tempat_lahir_ayah",name:"tempat_lahir_ayah",type:"text",placeholder:"Masukkan Tempat Lahir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.tempat_lahir_ayah",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_lahir_ayah",className:"md:w-1/4 text-black",children:"Tanggal Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_lahir_ayah",name:"tanggal_lahir_ayah",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.tanggal_lahir_ayah",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon_ayah",className:"md:w-1/4 text-black",children:"Nomor Telepon Ayah *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon_ayah",name:"no_telepon_ayah",type:"number",placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.no_telepon_ayah",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"pendidikan_terakhir_ayah",className:"md:w-1/4 text-black",children:"Jenjang Pendidikan Terakhir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsxs("select",{id:"pendidikan_terakhir_ayah",name:"pendidikan_terakhir_ayah",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",...a("modalAnakPegawai.pendidikan_terakhir_ayah",{required:!0}),required:!0,children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"paud",children:"Paud"}),e.jsx("option",{value:"sd/mi",children:"SD/MI"}),e.jsx("option",{value:"smp/mts",children:"SMP/MTS"}),e.jsx("option",{value:"sma/smk/ma",children:"SMA/SMK/MA"}),e.jsx("option",{value:"d3",children:"D3"}),e.jsx("option",{value:"d4",children:"D4"}),e.jsx("option",{value:"s1",children:"S1"}),e.jsx("option",{value:"s2",children:"S2"})]})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"pekerjaan_ayah",className:"md:w-1/4 text-black",children:"Pekerjaan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"pekerjaan_ayah",name:"pekerjaan_ayah",type:"text",placeholder:"Masukkan Pekerjaan Ayah",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.pekerjaan_ayah",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"penghasilan_ayah",className:"md:w-1/4 text-black",children:"Penghasilan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"penghasilan_ayah",name:"penghasilan_ayah",type:"number",placeholder:"1.000.000",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.penghasilan_ayah",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"wafat_ayah",className:"md:w-1/4 text-black",children:"Wafat *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"wafat_ayah",value:"0",className:"w-4 h-4",...a("modalAnakPegawai.wafat_ayah",{required:!0}),required:!0}),e.jsx("span",{children:"Tidak"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"wafat_ayah",value:"1",className:"w-4 h-4",...a("modalAnakPegawai.wafat_ayah",{required:!0}),required:!0}),e.jsx("span",{children:"Ya"})]})]}),e.jsx("hr",{className:"border-t border-gray-500 mb-2 mt-8"}),e.jsx("p",{className:"font-bold text-xl",children:"Data Ibu"}),e.jsx("hr",{className:"border-t border-gray-500 mb-4 mt-2"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nik_ibu",className:"md:w-1/4 text-black",children:"NIK Ibu *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nik_ibu",name:"nik_ibu",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:l=>{l.target.value=l.target.value.replace(/[^0-9]/g,"").slice(0,16)},placeholder:"Masukkan NIK Ibu",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.nik_ibu",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama_ibu",className:"md:w-1/4 text-black",children:"Nama Ibu *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama_ibu",name:"nama_ibu",type:"text",placeholder:"Masukkan Nama Ibu",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.nama_ibu",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tempat_lahir_ibu",className:"md:w-1/4 text-black",children:"Tempat Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tempat_lahir_ibu",name:"tempat_lahir_ibu",type:"text",placeholder:"Masukkan Tempat Lahir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.tempat_lahir_ibu",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_lahir_ibu",className:"md:w-1/4 text-black",children:"Tanggal Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_lahir_ibu",name:"tanggal_lahir_ibu",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.tanggal_lahir_ibu",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon_ibu",className:"md:w-1/4 text-black",children:"Nomor Telepon Ibu *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon_ibu",name:"no_telepon_ibu",type:"number",placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.no_telepon_ibu",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"pendidikan_terakhir_ibu",className:"md:w-1/4 text-black",children:"Jenjang Pendidikan Terakhir"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsxs("select",{id:"pendidikan_terakhir_ibu",name:"pendidikan_terakhir_ibu",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",...a("modalAnakPegawai.pendidikan_terakhir_ibu",{required:!0}),required:!0,children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"paud",children:"Paud"}),e.jsx("option",{value:"sd/mi",children:"SD/MI"}),e.jsx("option",{value:"smp/mts",children:"SMP/MTS"}),e.jsx("option",{value:"sma/smk/ma",children:"SMA/SMK/MA"}),e.jsx("option",{value:"d3",children:"D3"}),e.jsx("option",{value:"d4",children:"D4"}),e.jsx("option",{value:"s1",children:"S1"}),e.jsx("option",{value:"s2",children:"S2"})]})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"pekerjaan_ibu",className:"md:w-1/4 text-black",children:"Pekerjaan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"pekerjaan_ibu",name:"pekerjaan_ibu",type:"text",placeholder:"Masukkan Pekerjaan Ibu",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.pekerjaan_ibu",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"penghasilan_ibu",className:"md:w-1/4 text-black",children:"Penghasilan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"penghasilan_ibu",name:"penghasilan_ibu",type:"number",placeholder:"1.000.000",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.penghasilan_ibu",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"wafat_ibu",className:"md:w-1/4 text-black",children:"Wafat *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"wafat_ibu",value:"0",className:"w-4 h-4",...a("modalAnakPegawai.wafat_ibu",{required:!0}),required:!0}),e.jsx("span",{children:"Tidak"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"wafat_ibu",value:"1",className:"w-4 h-4",...a("modalAnakPegawai.wafat_ibu",{required:!0}),required:!0}),e.jsx("span",{children:"Ya"})]})]}),e.jsx("hr",{className:"border-t border-gray-500 mb-2 mt-8"}),e.jsx("p",{className:"font-bold text-xl",children:"Data Wali"}),e.jsx("hr",{className:"border-t border-gray-500 mb-4 mt-2"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nik_wali",className:"md:w-1/4 text-black",children:"NIK Wali *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nik_wali",name:"nik_wali",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:l=>{l.target.value=l.target.value.replace(/[^0-9]/g,"").slice(0,16)},placeholder:"Masukkan NIK Wali",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.nik_wali",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama_wali",className:"md:w-1/4 text-black",children:"Nama Wali *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama_wali",name:"nama_wali",type:"text",placeholder:"Masukkan Nama Wali",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.nama_wali",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tempat_lahir_wali",className:"md:w-1/4 text-black",children:"Tempat Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tempat_lahir_wali",name:"tempat_lahir_wali",type:"text",placeholder:"Masukkan Tempat Lahir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.tempat_lahir_wali",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_lahir_wali",className:"md:w-1/4 text-black",children:"Tanggal Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_lahir_wali",name:"tanggal_lahir_wali",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.tanggal_lahir_wali",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon_wali",className:"md:w-1/4 text-black",children:"Nomor Telepon Wali *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon_wali",name:"no_telepon_wali",type:"number",placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.no_telepon_wali",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"pendidikan_terakhir_wali",className:"md:w-1/4 text-black",children:"Jenjang Pendidikan Terakhir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsxs("select",{id:"pendidikan_terakhir_wali",name:"pendidikan_terakhir_wali",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",...a("modalAnakPegawai.pendidikan_terakhir_wali",{required:!0}),required:!0,children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"paud",children:"Paud"}),e.jsx("option",{value:"sd/mi",children:"SD/MI"}),e.jsx("option",{value:"smp/mts",children:"SMP/MTS"}),e.jsx("option",{value:"sma/smk/ma",children:"SMA/SMK/MA"}),e.jsx("option",{value:"d3",children:"D3"}),e.jsx("option",{value:"d4",children:"D4"}),e.jsx("option",{value:"s1",children:"S1"}),e.jsx("option",{value:"s2",children:"S2"})]})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"pekerjaan_wali",className:"md:w-1/4 text-black",children:"Pekerjaan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"pekerjaan_wali",name:"pekerjaan_wali",type:"text",placeholder:"Masukkan Pekerjaan Wali",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.pekerjaan_wali",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"penghasilan_wali",className:"md:w-1/4 text-black",children:"Penghasilan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"penghasilan_wali",name:"penghasilan_wali",type:"number",placeholder:"1.000.000",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.penghasilan_wali",{required:!0}),required:!0})})})]})]})}),Rn=({register:a,control:s,watch:l,activeTab:r,setValue:n})=>{const x=l("modalAnakPegawai.lembaga_id"),b=l("modalAnakPegawai.jurusan_id"),i=l("modalAnakPegawai.kelas_id"),m=l("modalAnakPegawai.rombel_id"),d=l("modalAnakPegawai.wilayah_id"),p=l("modalAnakPegawai.blok_id"),g=l("modalAnakPegawai.kamar_id"),h=l("modalAnakPegawai.mondok"),c=h==="0",{filterLembaga:o,selectedLembaga:u,handleFilterChangeLembaga:w}=Te(),{menuAngkatanPelajar:_,menuAngkatanSantri:f}=da(),{filterWilayah:v,selectedWilayah:S,handleFilterChangeWilayah:j}=Be();t.useEffect(()=>{h==="0"&&(n("modalAnakPegawai.wilayah_id",""),n("modalAnakPegawai.blok_id",""),n("modalAnakPegawai.kamar_id",""),n("modalAnakPegawai.tanggal_masuk_domisili",""))},[h,n]),t.useEffect(()=>{r===2&&(x&&o.lembaga.length>=1&&w({lembaga:x}),b&&o.jurusan.length>=1&&w({jurusan:b}),i&&o.kelas.length>=1&&w({kelas:i}),m&&o.rombel.length>=1&&w({rombel:m}),d&&v.wilayah.length>=1&&j({wilayah:d}),p&&v.blok.length>=1&&j({blok:p}),g&&v.kamar.length>=1&&j({kamar:g}))},[r,o.lembaga,o.lembaga.length,v.wilayah,v,v.wilayah.length]);const y=T=>T.charAt(0).toUpperCase()+T.slice(1),N=({filterOptions:T,control:C,onChange:P,selectedFilters:F,disabled:M=!1})=>{const L=l("modalAnakPegawai.wilayah_id");return e.jsx("div",{className:"space-y-2",children:Object.entries(T).map(([I,D],Q)=>{const E=I==="blok"||I==="kamar",B=D.length<=1||M||E&&!L;return e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsxs("label",{htmlFor:I,className:"md:w-1/4 text-black",children:[y(I)," *"]}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md border border-gray-300 border-gray-500 ${B?"bg-gray-200 text-gray-500":""}`,children:e.jsx(Xe,{name:`modalAnakPegawai.${I}_id`,control:C,rules:{required:!0},defaultValue:F[I]||"",render:({field:V})=>e.jsx("select",{...V,id:I,required:!0,disabled:B,className:`w-full py-1.5 pr-3 pl-1 text-base focus:outline-none sm:text-sm ${B?"text-gray-500":""}`,onChange:ne=>{V.onChange(ne),P({[I]:ne.target.value})},children:D.map((ne,te)=>e.jsx("option",{value:ne.value,children:ne.label},te))})})})})]},`${I}-${Q}`)})})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-bold text-xl",children:"Mondok "}),e.jsx("hr",{className:"border-t border-gray-500 mb-4 mt-2"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"mondok",className:"md:w-1/4 text-black",children:"Mondok"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"mondok",value:"1",className:"w-4 h-4",...a("modalAnakPegawai.mondok",{required:!0}),required:!0}),e.jsx("span",{children:"Ya"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"mondok",value:"0",className:"w-4 h-4",...a("modalAnakPegawai.mondok",{required:!0}),required:!0}),e.jsx("span",{children:"Tidak"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nis",className:"md:w-1/4 text-black",children:"NIS"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nis",name:"nis",type:"text",inputMode:"numeric",onInput:T=>{T.target.value=T.target.value.replace(/[^0-9]/g,"")},placeholder:"Masukkan NIS",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.nis",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"angkatan_santri_id",className:"md:w-1/4 text-black",children:"Angkatan Santri *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("select",{id:"angkatan_santri_id",name:"angkatan_santri_id",...a("modalAnakPegawai.angkatan_santri_id"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",children:f.map((T,C)=>e.jsx("option",{value:T.value,children:T.label},C))})})})]}),e.jsx("hr",{className:"border-t border-gray-500 mb-2 mt-8"}),e.jsx("p",{className:"font-bold text-xl",children:"Domisili"}),e.jsx("hr",{className:"border-t border-gray-500 mt-2"}),e.jsx("p",{className:"text-sm text-red-500 italic mt-1 mb-4",children:"* Bagian domisili ini boleh dikosongi"}),e.jsx(N,{filterOptions:v,onChange:j,selectedFilters:S,control:s}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_masuk_domisili",className:"md:w-1/4 text-black",children:"Tanggal Masuk Domisili *"}),e.jsx("div",{className:`md:w-full md:max-w-md max-w-none ${c?"bg-gray-200 text-gray-500":""}`,children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_masuk_domisili",name:"tanggal_masuk_domisili",disabled:c,className:`w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm ${c?"bg-gray-200 text-gray-500":""}`,...a("modalAnakPegawai.tanggal_masuk_domisili",{required:!0}),required:!0})})})]}),e.jsx("hr",{className:"border-t border-gray-500 mb-2 mt-8"}),e.jsx("p",{className:"font-bold text-xl",children:"Pendidikan"}),e.jsx("hr",{className:"border-t border-gray-500 mt-2"}),e.jsx("p",{className:"text-sm text-red-500 italic mt-1 mb-4",children:"* Bagian Pendidikan ini boleh dikosongi"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_induk",className:"md:w-1/4 text-black",children:"No. Induk *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_induk",name:"no_induk",type:"text",placeholder:"Masukkan No. Induk",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.no_induk",{required:!0}),required:!0})})})]}),e.jsx(N,{filterOptions:o,onChange:w,selectedFilters:u,control:s}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"angkatan_pelajar_id",className:"md:w-1/4 text-black",children:"Angkatan Pelajar *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("select",{id:"angkatan_pelajar_id",name:"angkatan_pelajar_id",...a("modalAnakPegawai.angkatan_pelajar_id"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",required:!0,children:_.map((T,C)=>e.jsx("option",{value:T.value,children:T.label},C))})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_masuk_pendidikan",className:"md:w-1/4 text-black",children:"Tanggal Masuk Pendidikan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_masuk_pendidikan",name:"tanggal_masuk_pendidikan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalAnakPegawai.tanggal_masuk_pendidikan",{required:!0}),required:!0})})})]})]})})},En=({control:a,setValue:s,jenisBerkasList:l})=>{const[r,n]=t.useState([]),x=Ra({control:a,name:l.map(({id:i})=>`modalAnakPegawai.file_${i}`)});t.useEffect(()=>{if(!x)return;const i=l.map(({id:m},d)=>{const p=x[d];return p?{jenis_berkas_id:m,file_path:p,preview:URL.createObjectURL(p)}:null}).filter(Boolean);return n(i),()=>{i.forEach(m=>URL.revokeObjectURL(m.preview))}},[JSON.stringify(x)]);const b=i=>{n(m=>m.filter(d=>d.jenis_berkas_id!==i)),s(`modalAnakPegawai.file_${i}`,null)};return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.map(({id:i,label:m,required:d})=>{const p=r.find(g=>g.jenis_berkas_id===i);return e.jsx(Ga,{id:i,label:m,required:d,selected:p,onRemove:b,onFileChange:g=>{const h=r.filter(c=>c.jenis_berkas_id!==i);h.push({jenis_berkas_id:i,file_path:g,preview:URL.createObjectURL(g)}),n(h)},control:a,nameModal:"modalAnakPegawai"},i)})})};function Un({isOpen:a,onClose:s,formState:l}){var f;const{register:r,handleSubmit:n,control:x,setValue:b,resetData:i,watch:m,errors:d,activeTab:p,unlockedTabs:g,setActiveTab:h,nextStep:c,prevStep:o,onValidSubmit:u,onInvalidSubmit:w}=l,_=[{id:0,label:"Biodata",content:e.jsx(Ln,{register:r,watch:m,setValue:b,control:x,activeTab:p})},{id:1,label:"Keluarga",content:e.jsx(On,{register:r,errors:d})},{id:2,label:"Domisili & Pendidikan",content:e.jsx(Rn,{register:r,control:x,watch:m,activeTab:p,setValue:b})},{id:3,label:"Berkas",content:e.jsx(En,{errors:d,control:x,setValue:b,jenisBerkasList:ta})}];return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 overflow-y-auto",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"bg-white p-6 rounded-lg shadow-xl max-w-3xl w-full h-full relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx("div",{className:"pb-4",children:e.jsx(re.Title,{className:"text-lg font-semibold text-gray-900",children:"Tambah Data Anak Pegawai"})}),e.jsxs("form",{onSubmit:n(u,w),className:"flex-1 overflow-y-auto p-2",children:[e.jsx("ul",{className:"flex flex-wrap text-sm font-medium text-center text-gray-500 border-b border-gray-500",children:_.map(v=>e.jsx("li",{children:e.jsx("button",{type:"button",onClick:S=>{S.stopPropagation(),g.includes(v.id)&&h(v.id)},className:`inline-block p-3 rounded-t-lg border-b-2 ${p===v.id?"text-blue-600 border-blue-600 bg-gray-200":g.includes(v.id)?"border-transparent hover:text-gray-600 hover:bg-gray-50":"border-transparent text-gray-300 cursor-not-allowed"}`,disabled:!g.includes(v.id),children:v.label})},v.id))}),e.jsx("div",{className:"pt-4",children:(f=_.find(v=>v.id===p))==null?void 0:f.content})]}),e.jsxs("div",{className:"mt-4 pt-4 flex justify-between",children:[p>0&&e.jsxs("button",{onClick:o,className:"inline-flex items-center gap-2 rounded-md bg-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-400",children:[e.jsx(ya,{}),"Sebelumnya"]}),e.jsxs("div",{className:"ml-auto space-x-2",children:[p<_.length&&e.jsxs("button",{type:"button",onClick:i,className:"inline-flex items-center gap-2 rounded-md bg-red-500 px-4 py-2 text-sm font-medium text-white hover:bg-red-600",children:[e.jsx(wa,{}),"Reset"]}),p<_.length-1?e.jsxs("button",{type:"button",onClick:c,className:"inline-flex items-center gap-2 rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700",children:["Selanjutnya",e.jsx(va,{})]}):e.jsxs("button",{type:"button",onClick:n(u,w),className:"inline-flex items-center gap-2 rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white hover:bg-green-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-green-500 focus-visible:ring-offset-2",children:[e.jsx(Na,{}),"Simpan"]})]})]})]})})})]})})}function qn(a,s,l){const[r,n]=t.useState(0),[x,b]=t.useState([0]),{clearAuthData:i}=ke(),m=je(),{register:d,handleSubmit:p,trigger:g,watch:h,setValue:c,reset:o,control:u,formState:{errors:w}}=ma(),_=h();t.useEffect(()=>{console.log("Data inputan berubah:",_)},[_]);const f=async()=>{const T=document.querySelector("form");if(T&&!T.reportValidity()||!await g(S(r)))return;const P=r+1;x.includes(P)||b([...x,P]),n(P)},v=()=>{const T=r-1;T>=0&&n(T)},S=T=>{switch(T){case 0:return[];case 1:return[];case 2:return[];case 3:return[];default:return[]}};return{register:d,handleSubmit:p,control:u,setValue:c,resetData:()=>{const T=h("modalAnakPegawai")||{},C={...Object.fromEntries(Object.keys(T).map(P=>[P,""])),...Object.fromEntries(Array.from({length:18},(P,F)=>[`file_${F+1}`,null]))};o({modalAnakPegawai:C}),n(0),b([0])},watch:h,errors:w,activeTab:r,unlockedTabs:x,setActiveTab:n,nextStep:f,prevStep:v,onValidSubmit:async T=>{const C=s.filter(F=>F.required).filter(F=>{var M;return!((M=T.modalAnakPegawai)!=null&&M[`file_${F.id}`])});if(C.length>0){k.fire({icon:"warning",title:"Berkas wajib diunggah",html:C.map(F=>`- ${F.label}`).join("<br>")});return}try{if(!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)return;k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const M=new FormData;T.modalAnakPegawai&&Object.entries(T.modalAnakPegawai).forEach(([B,V])=>{B.startsWith("file_")||M.append(B,V)});const L=[];for(let B=1;B<=18;B++){const V=`file_${B}`;T.modalAnakPegawai[V]&&L.push({file:T.modalAnakPegawai[V],jenis_berkas_id:B.toString()})}L.forEach((B,V)=>{console.log(`berkas[${V}][jenis_berkas_id]:`,B.jenis_berkas_id),console.log(`berkas[${V}][file_path]:`,B.file)}),L.forEach((B,V)=>{M.append(`berkas[${V}][jenis_berkas_id]`,B.jenis_berkas_id),M.append(`berkas[${V}][file_path]`,B.file)});for(var P of M.entries())console.log(P[0]+":",P[1]);const I=xe("token")||sessionStorage.getItem("token"),D=await fetch(`${G}crud/anakpegawai`,{method:"POST",headers:{Authorization:`Bearer ${I}`},body:M});k.close();const Q=await D.json();if(console.log(Q),D.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),i(),m("/login");return}if(!D.ok){const B=Q.errors?Object.entries(Q.errors).map(([V,ne])=>`- ${V.replace(/_/g," ")}: ${ne.join(", ")}`):[`${Q.message??""} ${Q.error??""}`.trim()||"Gagal mengirim data"];throw await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${B.join("<br>")}</div>`}),new Error(Q.message)}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."});const E={...Object.fromEntries(Object.keys(T.modalAnakPegawai||{}).map(B=>[B,""])),...Object.fromEntries(Array.from({length:18},(B,V)=>[`file_${V+1}`,null]))};o({modalAnakPegawai:E}),n(0),b([0]),l==null||l(!0),a==null||a()}catch(F){console.error("Terjadi kesalahan:",F)}},onInvalidSubmit:T=>{console.log(T);const C=Object.keys(T).filter(P=>P.startsWith("file_")).map(P=>{const F=parseInt(P.split("_")[1],10),M=s.find(L=>L.id===F);return`- ${(M==null?void 0:M.label)||`Berkas ${F}`} wajib diisi`});C.length>0&&k.fire({icon:"warning",title:"Berkas wajib diunggah",html:`<pre style="text-align: left;">${C.join("<br>")}</pre>`})}}}const zn=()=>{var ee,ie,ce,fe,H,ve,Pe,$,we,Re,qe;const[a,s]=t.useState(null),[l,r]=t.useState(!1),[n,x]=t.useState(!1),b=J=>{s(J),r(!0)},i=()=>{s(null),r(!1)},[m,d]=t.useState({phoneNumber:"",wargaPesantren:"",status:"",jenisKelamin:"",smartcard:"",pemberkasan:"",urutBerdasarkan:"",urutSecara:"",negara:"",provinsi:"",kabupaten:"",kecamatan:"",wilayah:"",blok:"",kamar:"",angkatanPelajar:"",angkatanSantri:""}),{filterNegara:p,selectedNegara:g,handleFilterChangeNegara:h}=Ae(),{filterWilayah:c,selectedWilayah:o,handleFilterChangeWilayah:u}=Be(),{filterLembaga:w,selectedLembaga:_,handleFilterChangeLembaga:f}=Te(),v=((ee=p.negara.find(J=>J.value==g.negara))==null?void 0:ee.label)||"",S=((ie=p.provinsi.find(J=>J.value==g.provinsi))==null?void 0:ie.label)||"",j=((ce=p.kabupaten.find(J=>J.value==g.kabupaten))==null?void 0:ce.label)||"",y=((fe=p.kecamatan.find(J=>J.value==g.kecamatan))==null?void 0:fe.label)||"",N=((H=c.wilayah.find(J=>J.value==o.wilayah))==null?void 0:H.label)||"",T=((ve=c.blok.find(J=>J.value==o.blok))==null?void 0:ve.label)||"",C=((Pe=c.kamar.find(J=>J.value==o.kamar))==null?void 0:Pe.label)||"",P=(($=w.lembaga.find(J=>J.value==_.lembaga))==null?void 0:$.label)||"",F=((we=w.jurusan.find(J=>J.value==_.jurusan))==null?void 0:we.label)||"",M=((Re=w.kelas.find(J=>J.value==_.kelas))==null?void 0:Re.label)||"",L=((qe=w.rombel.find(J=>J.value==_.rombel))==null?void 0:qe.label)||"",I=t.useMemo(()=>({...m,negara:v,provinsi:S,kabupaten:j,kecamatan:y,wilayah:N,blok:T,kamar:C,lembaga:P,jurusan:F,kelas:M,rombel:L}),[T,m,F,j,C,y,M,P,v,S,L,N]),{anakPegawai:D,loadingAnakPegawai:Q,searchTerm:E,setSearchTerm:B,error:V,limit:ne,setLimit:te,totalDataAnakPegawai:R,totalPages:Z,currentPage:z,setCurrentPage:me,fetchData:he}=Dn(I),[U,q]=t.useState(!1),[se,Y]=t.useState("");t.useEffect(()=>{const J=sessionStorage.getItem("viewMode");J&&Y(J)},[]);const de=J=>{J>=1&&J<=Z&&me(J)},oe={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],status:[{label:"Semua Status",value:""},{label:"Santri",value:"santri"},{label:"Santri Non Pelajar",value:"santri non pelajar"},{label:"Pelajar",value:"pelajar"},{label:"Pelajar Non Santri",value:"pelajar non santri"},{label:"Santri-Pelajar/Pelajar-Santri",value:"santri-pelajar"}],angkatanPelajar:We({placeholder:"Semua Angkatan Pelajar",labelTemplate:"Masuk Tahun {year}"}),angkatanSantri:We({placeholder:"Semua Angkatan Santri",labelTemplate:"Masuk Tahun {year}"})},W={wargaPesantren:[{label:"Warga Pesantren",value:""},{label:"Memiliki NIUP",value:"memiliki niup"},{label:"Tanpa NIUP",value:"tanpa niup"}],pemberkasan:[{label:"Pemberkasan",value:""},{label:"Tidak Ada Berkas",value:"tidak ada berkas"},{label:"Tidak Ada Foto Diri",value:"tidak ada foto diri"},{label:"Memiliki Foto Diri",value:"memiliki foto diri"},{label:"Tidak Ada KK",value:"tidak ada kk"},{label:"Tidak Ada Akta Kelahiran",value:"tidak ada akta kelahiran"},{label:"Tidak Ada Ijazah",value:"tidak ada ijazah"}],urutBerdasarkan:[{label:"Urut Berdasarkan",value:""},{label:"Nama",value:"nama"},{label:"NIUP",value:"niup"},{label:"Jenis Kelamin",value:"jenis_kelamin"}],urutSecara:[{label:"Urut Secara",value:""},{label:"A-Z / 0-9 (Ascending)",value:"asc"},{label:"Z-A / 9-0 (Descending)",value:"desc"}]},X={smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]},ae=[{label:"No. KK",value:"no_kk"},{label:"NIK",value:"nik"},{label:"NIUP",value:"niup"},{label:"Anak ke",value:"anak_ke"},{label:"Jumlah Saudara",value:"jumlah_saudara"},{label:"Alamat",value:"alamat"},{label:"Domisili Santri",value:"domisili_santri"},{label:"Angkatan Santri",value:"angkatan_santri"},{label:"Angkatan Pelajar",value:"angkatan_pelajar"},{label:"Status",value:"status"},{label:"Ibu Kandung",value:"ibu_kandung"}],[O,K]=t.useState(!1),A=qn(()=>K(!1),ta,he);return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Anak Pegawai"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>K(!0),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer flex items-center gap-2",children:[e.jsx(Ee,{}),"Tambah"]})}),e.jsxs("button",{onClick:()=>x(!0),className:"px-4 py-2 rounded flex items-center gap-2 text-white cursor-pointer bg-blue-500 hover:bg-blue-700",children:[e.jsx(Je,{}),e.jsx("span",{children:"Export"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${U?"mb-4":""}`,children:[e.jsx(ue,{showFilters:U,filterOptions:p,onChange:h,selectedFilters:g}),e.jsx(ue,{showFilters:U,filterOptions:c,onChange:u,selectedFilters:o}),e.jsx(ue,{showFilters:U,filterOptions:w,onChange:f,selectedFilters:_}),e.jsx(ue,{showFilters:U,filterOptions:oe,onChange:J=>d(Se=>({...Se,...J})),selectedFilters:m}),e.jsx(ue,{showFilters:U,filterOptions:W,onChange:J=>d(Se=>({...Se,...J})),selectedFilters:m}),e.jsx(ue,{showFilters:U,filterOptions:X,onChange:J=>d(Se=>({...Se,...J})),selectedFilters:m})]}),e.jsx(Ce,{searchTerm:E,setSearchTerm:B,totalData:R,toggleFilters:()=>q(!U),toggleView:Y,limit:ne,toggleLimit:J=>te(Number(J.target.value))}),V?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):se==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:Q?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):D.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):D.map((J,Se)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex items-center space-x-4 cursor-pointer",onClick:()=>b(J),children:[e.jsx("img",{alt:J.nama||"-",className:"w-20 h-24 object-cover",src:J.foto_profil,onError:Ge=>{Ge.target.onerror=null,Ge.target.src=Me}}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold",children:J.nama||"-"}),e.jsxs("p",{className:"text-gray-600",children:["NIUP: ",J.niup||"-"]}),e.jsx("p",{className:"text-gray-600",children:J.lembaga||"-"})]})]},J.id||Se))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIUP"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIS"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIK / No. Passport"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Lembaga"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jurusan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kelas"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Wilayah"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Blok"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kamar"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kota Asal"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Orang Tua"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update Khadam"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input Khadam"})]})}),e.jsx("tbody",{className:"text-gray-800",children:Q?e.jsx("tr",{children:e.jsx("td",{colSpan:"15",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):D.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"15",className:"text-center py-6",children:"Tidak ada data"})}):D.map((J,Se)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center hover:cursor-pointer",onClick:()=>b(J),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(z-1)*ne+Se+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.niup||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.nis||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.nik_or_passport||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.lembaga||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.jurusan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.kelas||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.wilayah||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.blok||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.kamar||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.kota_asal||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.nama_ortu||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:J.tgl_input||"-"})]},J.id||Se))})]})}),e.jsx(ea,{isOpen:n,onClose:()=>x(!1),filters:I,searchTerm:E,limit:ne,currentPage:z,fields:ae,endpoint:"export/anakpegawai"}),l&&e.jsx(De,{title:"Anak Pegawai",menu:22,item:a,onClose:i}),e.jsx(Un,{isOpen:O,onClose:()=>K(!1),formState:A}),Z>1&&e.jsx(Fe,{currentPage:z,totalPages:Z,handlePageChange:de})]})]})},Nt=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},400);return()=>clearTimeout(j)},[c]);const S=t.useCallback(async(j=!1)=>{let y=`${G}data-pokok/pegawai?limit=${i}`;if(u>1&&(y+=`&page=${u}`),_&&(y+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(y+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(y+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(y+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(y+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(y+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&(y+=`&jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&(y+=`&kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&(y+=`&rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.jenisKelamin&&(y+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.wargaPesantren&&(y+=`&warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.entitas&&(y+=`&entitas=${encodeURIComponent(a.entitas)}`),a!=null&&a.pemberkasan&&(y+=`&pemberkasan=${encodeURIComponent(a.pemberkasan)}`),a!=null&&a.phoneNumber&&(y+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),a!=null&&a.smartcard&&(y+=`&smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.umur&&(y+=`&umur=${encodeURIComponent(a.umur)}`),!j&&v.current===y){console.log("Skip Fetch: URL sama");return}v.current=y,console.log("Fetching data from:",y),n(!0),b(null);try{const N=await fetch(y);if(!N.ok)throw new Error(`Fetch error: ${N.status}`);const T=await N.json();l(Array.isArray(T.data)?T.data:[]),p(T.total_data||0),h(T.total_pages||1)}catch(N){console.error("Fetch error:",N),b(N.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{pegawai:s,loadingPegawai:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataPegawai:d,totalPages:g,currentPage:u,setCurrentPage:w,fetchData:S}},Wn=({register:a,watch:s,setValue:l,control:r,activeTab:n,exposeHandler:x})=>{const{filterNegara:b,selectedNegara:i,handleFilterChangeNegara:m}=Ae();t.useEffect(()=>{x&&x({handleFilterChangeNegara:m})},[]);const d=s("modalPegawai.kewarganegaraan"),p=s("modalPegawai.negara_id"),g=s("modalPegawai.provinsi_id"),h=s("modalPegawai.kabupaten_id"),c=s("modalPegawai.kecamatan_id"),o=v=>{const S=v.target.value;l("modalPegawai.kewarganegaraan",S),S==="wna"?(l("modalPegawai.no_kk",""),l("modalPegawai.nik","")):S==="wni"&&l("modalPegawai.no_passport","")};t.useEffect(()=>{n===0&&(p&&m({negara:p}),g&&m({provinsi:g}),h&&m({kabupaten:h}),c&&m({kecamatan:c}))},[n]);const u=(v,S)=>v.length>0?[{...v[0],label:S},...v.slice(1)]:v,w={negara:u(b.negara,"Pilih Negara"),provinsi:u(b.provinsi,"Pilih Provinsi"),kabupaten:u(b.kabupaten,"Pilih Kabupaten"),kecamatan:u(b.kecamatan,"Pilih Kecamatan")},_=v=>v.charAt(0).toUpperCase()+v.slice(1),f=({filterOptions:v,control:S,onChange:j,selectedFilters:y})=>e.jsx("div",{className:"space-y-2",children:Object.entries(v).map(([N,T],C)=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsxs("label",{htmlFor:N,className:"md:w-1/4 text-black",children:[_(N)," *"]}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md border border-gray-300 border-gray-500 ${T.length<=1?"bg-gray-200 text-gray-500":""}`,children:e.jsx(Xe,{name:`modalPegawai.${N}_id`,control:S,rules:{required:!0},defaultValue:y[N]||"",render:({field:P})=>e.jsx("select",{...P,id:N,required:!0,disabled:T.length<=1,className:`w-full py-1.5 pr-3 pl-1 text-base focus:outline-none sm:text-sm ${T.length<=1?"text-gray-500":""}`,onChange:F=>{P.onChange(F),j({[N]:F.target.value})},children:T.map((F,M)=>e.jsx("option",{value:F.value,children:F.label},M))})})})})]},`${N}-${C}`))});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"kewarganegaraan",className:"md:w-1/4 text-black",children:"Kewarganegaraan *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"kewarganegaraan",value:"wni",className:"w-4 h-4",...a("modalPegawai.kewarganegaraan",{required:!0}),checked:d==="wni",onChange:o,required:!0}),e.jsx("span",{children:"WNI"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"kewarganegaraan",value:"wna",className:"w-4 h-4",...a("modalPegawai.kewarganegaraan",{required:!0}),checked:d==="wna",onChange:o,required:!0}),e.jsx("span",{children:"WNA"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"passport",className:"md:w-1/4 text-black",children:"No Passport *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-500 ${d==="wna"?"bg-white border-gray-300 ":"bg-gray-300 border-gray-200"}`,children:e.jsx("input",{id:"no_passport",name:"no_passport",type:"text",maxLength:20,inputMode:"numeric",onInput:v=>{v.target.value=v.target.value.replace(/[^0-9]/g,"")},disabled:d!=="wna",placeholder:"Masukkan No Passport",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.no_passport",{required:d==="wna"}),required:d==="wna"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nokk",className:"md:w-1/4 text-black",children:"Nomor KK *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-500 ${d==="wni"?"bg-white border-gray-300 ":"bg-gray-300 border-gray-200"}`,children:e.jsx("input",{id:"no_kk",name:"no_kk",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:v=>{v.target.value=v.target.value.replace(/[^0-9]/g,"").slice(0,16)},disabled:d!=="wni",placeholder:"Masukkan No KK",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.no_kk",{required:d==="wni"}),required:d==="wni"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4 ",children:[e.jsx("label",{htmlFor:"nonik",className:"md:w-1/4 text-black",children:"NIK *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-500 ${d==="wni"?"bg-white border-gray-300 ":"bg-gray-300 border-gray-200"}`,children:e.jsx("input",{id:"nik",name:"nik",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:v=>{v.target.value=v.target.value.replace(/[^0-9]/g,"").slice(0,16)},disabled:d!=="wni",placeholder:"Masukkan NIK",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.nik",{required:d==="wni"}),required:d==="wni"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4 ",children:[e.jsx("label",{htmlFor:"niup",className:"md:w-1/4 text-black",children:"NIUP *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md pl-1 border border-gray-500 bg-white border-gray-300",children:e.jsx("input",{id:"niup",name:"niup",type:"text",minLength:16,maxLength:16,inputMode:"numeric",onInput:v=>{v.target.value=v.target.value.replace(/[^0-9]/g,"")},placeholder:"Masukkan NIUP",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.niup",{required:d==="wni"}),required:d==="wni"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama",className:"md:w-1/4 text-black",children:"Nama Lengkap *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama",name:"nama",type:"text",placeholder:"Masukkan Nama Lengkap",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.nama",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jenisKelamin",className:"md:w-1/4 text-black",children:"Jenis Kelamin *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"jenisKelamin",value:"p",className:"w-4 h-4",...a("modalPegawai.jenis_kelamin",{required:!0}),required:!0}),e.jsx("span",{children:"Perempuan"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"jenisKelamin",value:"l",className:"w-4 h-4",...a("modalPegawai.jenis_kelamin",{required:!0}),required:!0}),e.jsx("span",{children:"Laki-Laki"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tempatLahir",className:"md:w-1/4 text-black",children:"Tempat Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tempatLahir",name:"tempatLahir",type:"text",placeholder:"Masukkan Tempat Lahir",...a("modalPegawai.tempat_lahir",{required:!0}),required:!0,className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_lahir",className:"md:w-1/4 text-black",children:"Tanggal Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_lahir",name:"tanggal_lahir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.tanggal_lahir",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"anak_keberapa",className:"md:w-1/4 text-black",children:"Anak Ke *"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"anak_keberapa",name:"anak_keberapa",type:"number",min:"1",className:"w-13 py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.anak_keberapa")})}),e.jsx("span",{children:"Dari"}),e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"dari_saudara",name:"dari_saudara",type:"number",min:"1",className:"w-13 py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.dari_saudara")})})]})]}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tinggal_bersama",className:"md:w-1/4 text-black",children:"Tinggal Bersama"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tinggal_bersama",name:"tinggal_bersama",type:"text",placeholder:"Masukkan Tinggal Bersama",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.tinggal_bersama")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jenjang_pendidikan_terakhir",className:"md:w-1/4 text-black",children:"Jenjang Pendidikan Terakhir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsxs("select",{id:"jenjang_pendidikan_terakhir",name:"jenjang_pendidikan_terakhir",...a("modalPegawai.jenjang_pendidikan_terakhir"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"paud",children:"Paud"}),e.jsx("option",{value:"sd/mi",children:"SD/MI"}),e.jsx("option",{value:"smp/mts",children:"SMP/MTS"}),e.jsx("option",{value:"sma/smk/ma",children:"SMA/SMK/MA"}),e.jsx("option",{value:"d3",children:"D3"}),e.jsx("option",{value:"d4",children:"D4"}),e.jsx("option",{value:"s1",children:"S1"}),e.jsx("option",{value:"s2",children:"S2"}),e.jsx("option",{value:"s3",children:"S3"})]})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama_pendidikan_terakhir",className:"md:w-1/4 text-black",children:"Nama Pendidikan Terakhir"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama_pendidikan_terakhir",name:"nama_pendidikan_terakhir",type:"text",placeholder:"Masukkan Nama Pendidikan Terakhir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.nama_pendidikan_terakhir")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon",className:"md:w-1/4 text-black",children:"Nomor Telepon 1"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon",name:"no_telepon",type:"tel",maxLength:20,inputMode:"numeric",onInput:v=>{v.target.value=v.target.value.replace(/[^0-9]/g,"")},placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.no_telepon",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon_2",className:"md:w-1/4 text-black",children:"Nomor Telepon 2"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon_2",name:"no_telepon_2",type:"tel",maxLength:20,inputMode:"numeric",onInput:v=>{v.target.value=v.target.value.replace(/[^0-9]/g,"")},placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.no_telepon_2")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"email",className:"md:w-1/4 text-black",children:"E-Mail"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"email",name:"email",type:"email",maxLength:100,placeholder:"Masukkan E-Mail",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.email",{required:!0}),required:!0})})})]}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsx(f,{filterOptions:w,onChange:m,selectedFilters:i,control:r}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jalan",className:"md:w-1/4 text-black",children:"Jalan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"jalan",name:"jalan",type:"text",maxLength:255,placeholder:"Masukkan Nama Jalan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.jalan",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"kodepos",className:"md:w-1/4 text-black",children:"Kode Pos *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"kodepos",name:"kodepos",type:"text",maxLength:10,pattern:"\\d*",onInput:v=>{v.target.value=v.target.value.replace(/[^0-9]/g,"")},inputMode:"numeric",placeholder:"Masukkan Kode Pos",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.kode_pos",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"smartcard",className:"md:w-1/4 text-black",children:"Smartcard *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"smartcard",name:"smartcard",type:"text",maxLength:10,pattern:"\\d*",onInput:v=>{v.target.value=v.target.value.replace(/[^0-9]/g,"")},inputMode:"numeric",placeholder:"Masukkan Smartcard",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.smartcard",{required:!0}),required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"wafat",className:"md:w-1/4 text-black",children:"Wafat *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"wafat",value:"0",className:"w-4 h-4",...a("modalPegawai.wafat",{required:!0}),required:!0}),e.jsx("span",{children:"Tidak"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"wafat",value:"1",className:"w-4 h-4",...a("modalPegawai.wafat",{required:!0}),required:!0}),e.jsx("span",{children:"Ya"})]})]})]})})},Jn=({register:a,watch:s,setValue:l,activeTab:r})=>{var m,d;const n=s("modalPegawai.golongan_jabatan_id_karyawan"),{filterLembaga:x}=Te(),{menuGolonganJabatan:b}=aa(),i=s("modalPegawai.lembaga_id_karyawan");return t.useEffect(()=>{n&&n!==""?l("modalPegawai.karyawan","1"):l("modalPegawai.karyawan","0")},[n,l]),t.useEffect(()=>{r===1&&(i&&x.lembaga.length>=1&&l("modalPegawai.lembaga_id_karyawan",i),n&&b.length>=1&&l("modalPegawai.golongan_jabatan_id_karyawan",n))},[r,x.lembaga,b]),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-red-500 italic font-semibold",children:"* Silahkan isi form ini jika seorang karyawan"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4 mt-4",children:[e.jsx("label",{htmlFor:"golongan_jabatan_id_karyawan",className:"md:w-1/4 text-black",children:"Golongan Jabatan"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-300 border-gray-500  ${(b==null?void 0:b.length)<=1?"bg-gray-200 text-gray-500":""}`,children:e.jsx("select",{className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",disabled:(b==null?void 0:b.length)<=1,...a("modalPegawai.golongan_jabatan_id_karyawan"),children:b==null?void 0:b.map((p,g)=>e.jsx("option",{value:p.id,children:p.label},g))})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"lembaga_id_karyawan",className:"md:w-1/4 text-black",children:"Lembaga"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("select",{...a("modalPegawai.lembaga_id_karyawan"),className:`w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm ${((m=x==null?void 0:x.lembaga)==null?void 0:m.length)<=1?"bg-gray-200 text-gray-500":""}`,disabled:((d=x==null?void 0:x.lembaga)==null?void 0:d.length)<=1,children:x==null?void 0:x.lembaga.map((p,g)=>e.jsx("option",{value:p.value,children:p.label},g))})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jabatan_karyawan",className:"md:w-1/4 text-black",children:"Jabatan"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("select",{id:"jabatan_karyawan",...a("modalPegawai.jabatan_karyawan"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm bg-transparent",children:$a.map((p,g)=>e.jsx("option",{value:p.value,children:p.label},g))})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"keterangan_jabatan_karyawan",className:"md:w-1/4 text-black",children:"Keterangan Jabatan"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("textarea",{placeholder:"Masukkan Keterangan Jabatan",...a("modalPegawai.keterangan_jabatan_karyawan"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",rows:3,maxLength:255})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_mulai_karyawan",className:"md:w-1/4 text-black",children:"Tanggal Mulai"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_mulai_karyawan",name:"tanggal_mulai_karyawan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.tanggal_mulai_karyawan")})})})]})]})},Gn=({register:a,watch:s,setValue:l,activeTab:r})=>{var _,f;const n=s("modalPegawai.golongan_id_pengajar"),{filterLembaga:x}=Te(),{allGolonganList:b}=pa(),i=s("modalPegawai.lembaga_id_pengajar"),m=s("modalPegawai.materi_ajar"),d=b.map(v=>({value:v.id,label:v.GolonganNama}));t.useEffect(()=>{n&&n!==""?l("modalPegawai.pengajar","1"):l("modalPegawai.pengajar","0")},[n,l]);const[p,g]=t.useState([]),[h,c]=t.useState({nama:"",menit:""}),o=v=>{c({...h,[v.target.name]:v.target.value})},u=()=>{!h.nama||!h.menit||(g([...p,{nama:h.nama,menit:parseInt(h.menit)}]),c({nama:"",menit:""}))},w=v=>{const S=p.filter((j,y)=>y!==v);g(S)};return t.useEffect(()=>{l("modalPegawai.materi_ajar",p.map(v=>({nama_materi:v.nama,jumlah_menit:v.menit})))},[p,l]),t.useEffect(()=>{if(console.log("handle",r),r===2&&(console.log("handle change",r),i&&x.lembaga.length>=1&&l("modalPegawai.lembaga_id_pengajar",i),n&&b.length>=1&&(console.log("golongan handle ",n),l("modalPegawai.golongan_id_pengajar",n)),m&&m.length>0&&p.length===0)){const v=m.map(S=>({nama:S.nama_materi,menit:S.jumlah_menit}));g(v)}},[r,x.lembaga,b.length,p.length,i,n,m,l]),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-red-500 italic font-semibold",children:"* Silahkan isi form ini jika seorang Pengajar"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4 mt-4",children:[e.jsx("label",{htmlFor:"golongan_id_pengajar",className:"md:w-1/4 text-black",children:"Golongan"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-300 border-gray-500  ${(d==null?void 0:d.length)<=1?"bg-gray-200 text-gray-500":""}`,children:e.jsx("select",{className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",disabled:(d==null?void 0:d.length)<=1,...a("modalPegawai.golongan_id_pengajar"),children:d==null?void 0:d.map((v,S)=>e.jsx("option",{value:v.value,children:v.label},S))})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"lembaga_id_pengajar",className:"md:w-1/4 text-black",children:"Lembaga"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("select",{className:`w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm ${((_=x==null?void 0:x.lembaga)==null?void 0:_.length)<=1?"bg-gray-200 text-gray-500":""}`,disabled:((f=x==null?void 0:x.lembaga)==null?void 0:f.length)<=1,...a("modalPegawai.lembaga_id_pengajar"),children:x==null?void 0:x.lembaga.map((v,S)=>e.jsx("option",{value:v.value,children:v.label},S))})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jabatan_pengajar",className:"md:w-1/4 text-black",children:"Jabatan"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("select",{id:"jabatan_pengajar",...a("modalPegawai.jabatan_pengajar"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm bg-transparent",children:$a.map((v,S)=>e.jsx("option",{value:v.value,children:v.label},S))})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_mulai_pengajar",className:"md:w-1/4 text-black",children:"Tanggal Mulai"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_mulai_pengajar",name:"tanggal_mulai_pengajar",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.tanggal_mulai_pengajar")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4 mb-6",children:[e.jsx("label",{htmlFor:"tanggal_mulai_materi",className:"md:w-1/4 text-black",children:"Tanggal Mulai Materi"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_mulai_materi",name:"tanggal_mulai_materi",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.tanggal_mulai_materi")})})})]}),e.jsx("label",{className:"md:w-1/4 text-black font-bold",children:"Materi Ajar"}),e.jsxs("div",{className:"flex flex-row gap-2 mb-4 items-center mt-2",children:[e.jsx("div",{className:"w-full max-w-md",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"text",name:"nama",placeholder:"Masukkan Nama Materi",value:h.nama,onChange:o,className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",maxLength:100})})}),e.jsx("div",{className:"w-full max-w-md",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"number",name:"menit",placeholder:"Jumlah Menit",value:h.menit,onChange:o,className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",maxLength:4})})}),e.jsx("button",{type:"button",onClick:u,className:"bg-blue-500 text-white px-4 py-2 rounded",children:e.jsx(Ee,{})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"No"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama Materi"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jumlah Menit"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Aksi"})]})}),e.jsxs("tbody",{className:"text-gray-800",children:[p.map((v,S)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:S+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:v.nama}),e.jsx("td",{className:"px-3 py-2 border-b",children:v.menit}),e.jsx("td",{className:"px-3 py-2 border-b",children:e.jsx("button",{onClick:()=>w(S),className:"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600",children:e.jsx(ge,{icon:Wa})})})]},S)),p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-6",children:"Belum Ada Materi"})})]})]})})]})},Yn=({register:a,watch:s,setValue:l,activeTab:r})=>{const n=s("modalPegawai.golongan_jabatan_id_pengurus"),x=s("modalPegawai.satuan_kerja_pengurus"),{menuGolonganJabatan:b}=aa(),{menuSatuanKerja:i}=Pa();return t.useEffect(()=>{n&&n!==""?l("modalPegawai.pengurus","1"):l("modalPegawai.pengurus","0")},[n,l]),t.useEffect(()=>{console.log("handle",r),r===3&&(console.log("handle change",r),n&&b.length>=1&&l("modalPegawai.golongan_jabatan_id_pengurus",n),x&&i.length>=1&&l("modalPegawai.satuan_kerja_pengurus",x))},[r,n,b.length,i.length,x,l]),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-red-500 italic font-semibold",children:"* Silahkan isi form ini jika seorang Pengurus"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4 mt-4",children:[e.jsx("label",{htmlFor:"golongan_jabatan_id_pengurus",className:"md:w-1/4 text-black",children:"Golongan Jabatan"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md pl-1 border border-gray-300 border-gray-500  ${(b==null?void 0:b.length)<=1?"bg-gray-200 text-gray-500":""}`,children:e.jsx("select",{className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",disabled:(b==null?void 0:b.length)<=1,...a("modalPegawai.golongan_jabatan_id_pengurus"),children:b==null?void 0:b.map((m,d)=>e.jsx("option",{value:m.id,children:m.label},d))})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jabatan_pengurus",className:"md:w-1/4 text-black",children:"Jabatan"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("select",{id:"jabatan_pengurus",...a("modalPegawai.jabatan_pengurus"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm bg-transparent",children:$a.map((m,d)=>e.jsx("option",{value:m.value,children:m.label},d))})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"keterangan_jabatan_pengurus",className:"md:w-1/4 text-black",children:"Keterangan Jabatan"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("textarea",{placeholder:"Masukkan Keterangan Jabatan",...a("modalPegawai.keterangan_jabatan_pengurus"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",rows:3,maxLength:255})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"satuan_kerja_pengurus",className:"md:w-1/4 text-black",children:"Satuan Kerja"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"text",id:"satuan_kerja_pengurus",placeholder:"Masukkan Satuan Kerja",className:"w-full py-1.5 px-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.satuan_kerja_pengurus")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_mulai_pengurus",className:"md:w-1/4 text-black",children:"Tanggal Mulai"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_mulai_pengurus",name:"tanggal_mulai_pengurus",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.tanggal_mulai_pengurus")})})})]})]})},Vn=({register:a,watch:s,setValue:l,control:r,activeTab:n})=>{const x=s("modalPegawai.lembaga"),b=s("modalPegawai.jurusan"),i=s("modalPegawai.kelas"),m=s("modalPegawai.rombel"),{filterLembaga:d,handleFilterChangeLembaga:p,selectedLembaga:g}=Te();t.useEffect(()=>{x&&x!==""?l("modalPegawai.karyawan","1"):l("modalPegawai.karyawan","0")},[x,l]),t.useEffect(()=>{n===4&&(x&&d.lembaga.length>=1&&p({lembaga:x}),b&&d.jurusan.length>=1&&p({jurusan:b}),i&&d.kelas.length>=1&&p({kelas:i}),m&&d.rombel.length>=1&&p({rombel:m}))},[n,d.lembaga,d.lembaga.length]);const h=o=>o.charAt(0).toUpperCase()+o.slice(1),c=({filterOptions:o,control:u,onChange:w,selectedFilters:_})=>e.jsx("div",{className:"space-y-2 mt-4",children:Object.entries(o).map(([f,v],S)=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsxs("label",{htmlFor:f,className:"md:w-1/4 text-black",children:[h(f)," *"]}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md border border-gray-300 border-gray-500 ${v.length<=1?"bg-gray-200 text-gray-500":""}`,children:e.jsx(Xe,{name:`modalPegawai.${f}`,control:u,defaultValue:_[f]||"",render:({field:j})=>e.jsx("select",{...j,id:f,disabled:v.length<=1,className:`w-full py-1.5 pr-3 pl-1 text-base focus:outline-none sm:text-sm ${v.length<=1?"text-gray-500":""}`,onChange:y=>{j.onChange(y),w({[f]:y.target.value})},children:v.map((y,N)=>e.jsx("option",{value:y.value,children:y.label},N))})})})})]},`${f}-${S}`))});return e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-red-500 italic font-semibold",children:"* Silahkan isi form ini jika seorang Wali Kelas"}),e.jsx(c,{filterOptions:d,onChange:p,selectedFilters:g,control:r}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jumlah_murid_wali",className:"md:w-1/4 text-black",children:"Jumlah Murid Wali"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"jumlah_murid_wali",name:"jumlah_murid_wali",type:"text",maxLength:20,inputMode:"numeric",onInput:o=>{o.target.value=o.target.value.replace(/[^0-9]/g,"")},placeholder:"Masukkan jumlah murid wali",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.jumlah_murid_wali")})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_mulperiode_awal_waliai_karyawan",className:"md:w-1/4 text-black",children:"Periode Awal"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"periode_awal_wali",name:"periode_awal_wali",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",...a("modalPegawai.periode_awal_wali")})})})]})]})},Hn=({control:a,setValue:s,jenisBerkasList:l})=>{const[r,n]=t.useState([]),x=Ra({control:a,name:l.map(({id:i})=>`modalPegawai.file_${i}`)});t.useEffect(()=>{if(!x)return;const i=l.map(({id:m},d)=>{const p=x[d];return p?{jenis_berkas_id:m,file_path:p,preview:URL.createObjectURL(p)}:null}).filter(Boolean);return n(i),()=>{i.forEach(m=>URL.revokeObjectURL(m.preview))}},[JSON.stringify(x)]);const b=i=>{n(m=>m.filter(d=>d.jenis_berkas_id!==i)),s(`modalPegawai.file_${i}`,null)};return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.map(({id:i,label:m,required:d})=>{const p=r.find(g=>g.jenis_berkas_id===i);return e.jsx(Ga,{id:i,label:m,required:d,selected:p,onRemove:b,onFileChange:g=>{const h=r.filter(c=>c.jenis_berkas_id!==i);h.push({jenis_berkas_id:i,file_path:g,preview:URL.createObjectURL(g)}),n(h)},control:a,nameModal:"modalPegawai"},i)})})},Qn=({isOpen:a,onClose:s,formState:l})=>{var j;const{activeTab:r,control:n,errors:x,handleSubmit:b,nextStep:i,prevStep:m,register:d,setActiveTab:p,setValue:g,resetData:h,unlockedTabs:c,watch:o,onValidSubmit:u,onInvalidSubmit:w}=l,[_,f]=t.useState({}),v=()=>{h(),r===0&&(_!=null&&_.handleFilterChangeNegara)&&_.handleFilterChangeNegara({negara:null,provinsi:null,kabupaten:null,kecamatan:null})},S=[{id:0,label:"Biodata",content:e.jsx(Wn,{register:d,watch:o,setValue:g,control:n,activeTab:r,exposeHandler:y=>f(y)})},{id:1,label:"Karyawan",content:e.jsx(Jn,{register:d,watch:o,setValue:g,activeTab:r})},{id:2,label:"Pengajar",content:e.jsx(Gn,{register:d,watch:o,setValue:g,activeTab:r})},{id:3,label:"Pengurus",content:e.jsx(Yn,{register:d,watch:o,setValue:g,activeTab:r})},{id:4,label:"Wali Kelas",content:e.jsx(Vn,{register:d,watch:o,setValue:g,control:n,activeTab:r})},{id:5,label:"Berkas",content:e.jsx(Hn,{errors:x,control:n,setValue:g,jenisBerkasList:ta})}];return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 overflow-y-auto",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"bg-white p-6 rounded-lg shadow-xl max-w-3xl w-full h-full relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx("div",{className:"pb-4",children:e.jsx(re.Title,{className:"text-lg font-semibold text-gray-900",children:"Tambah Data Pegawai"})}),e.jsxs("form",{onSubmit:b(u,w),className:"flex-1 overflow-y-auto p-2",children:[e.jsx("ul",{className:"flex flex-wrap text-sm font-medium text-center text-gray-500 border-b border-gray-500",children:S.map(y=>e.jsx("li",{children:e.jsx("button",{type:"button",onClick:N=>{N.stopPropagation(),c.includes(y.id)&&p(y.id)},className:`inline-block p-3 rounded-t-lg border-b-2 ${r===y.id?"text-blue-600 border-blue-600 bg-gray-200":c.includes(y.id)?"border-transparent hover:text-gray-600 hover:bg-gray-50":"border-transparent text-gray-300 cursor-not-allowed"}`,disabled:!c.includes(y.id),children:y.label})},y.id))}),e.jsx("div",{className:"pt-4",children:(j=S.find(y=>y.id===r))==null?void 0:j.content})]}),e.jsxs("div",{className:"mt-4 pt-4 flex justify-between",children:[r>0&&e.jsxs("button",{onClick:m,className:"inline-flex items-center gap-2 rounded-md bg-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-400",children:[e.jsx(ya,{}),"Sebelumnya"]}),e.jsxs("div",{className:"ml-auto space-x-2",children:[r<S.length&&e.jsxs("button",{type:"button",onClick:v,className:"inline-flex items-center gap-2 rounded-md bg-red-500 px-4 py-2 text-sm font-medium text-white hover:bg-red-600",children:[e.jsx(wa,{}),"Reset"]}),r<S.length-1?e.jsxs("button",{onClick:i,className:"inline-flex items-center gap-2 rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700",children:["Selanjutnya",e.jsx(va,{})]}):e.jsxs("button",{type:"submit",onClick:b(u,w),className:"inline-flex items-center gap-2 rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white hover:bg-green-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-green-500 focus-visible:ring-offset-2",children:[e.jsx(Na,{}),"Simpan"]})]})]})]})})})]})})},Zn=({onClose:a,refetchData:s})=>{const[l,r]=t.useState(0),[n,x]=t.useState([0]),{clearAuthData:b}=ke(),i=je(),{register:m,handleSubmit:d,trigger:p,watch:g,setValue:h,reset:c,control:o,formState:{errors:u}}=ma(),w=g();t.useEffect(()=>{console.log("Data inputan berubah:",w)},[w]);const _=async()=>{const N=document.querySelector("form");if(N&&!N.reportValidity()||!await p(f(l)))return;const C=l+1;n.includes(C)||x([...n,C]),r(C)},f=N=>{switch(N){case 0:return[];case 1:return[];case 2:return[];case 3:return[];default:return[]}};return{register:m,handleSubmit:d,control:o,setValue:h,resetData:()=>{const N=g("modalPegawai")||{},T={...Object.fromEntries(Object.keys(N).map(C=>[C,""])),...Object.fromEntries(Array.from({length:18},(C,P)=>[`file_${P+1}`,null]))};c({modalPegawai:T}),r(0),x([0])},watch:g,errors:u,activeTab:l,unlockedTabs:n,setActiveTab:r,nextStep:_,prevStep:()=>{const N=l-1;N>=0&&r(N)},onValidSubmit:async N=>{try{if(!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)return;k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const C=new FormData;N.modalPegawai&&Object.entries(N.modalPegawai).forEach(([D,Q])=>{Q!=null&&C.append(D,Q)});const P=[];for(let D=1;D<=18;D++){const Q=`file_${D}`;N.modalPegawai[Q]&&P.push({file:N.modalPegawai[Q],jenis_berkas_id:D.toString()})}P.forEach((D,Q)=>{C.append(`berkas[${Q}][jenis_berkas_id]`,D.jenis_berkas_id),C.append(`berkas[${Q}][file_path]`,D.file)});const F=xe("token")||sessionStorage.getItem("token"),M=await fetch(`${G}crud/pegawai`,{method:"POST",headers:{Authorization:`Bearer ${F}`},body:C}),L=await M.json();if(console.log(L),k.close(),M.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),b(),i("/login");return}if(!M.ok){const D=L.errors?Object.entries(L.errors).map(([Q,E])=>`- ${Q.replace(/_/g," ")}: ${E.join(", ")}`):[L.message||"Gagal mengirim data"];throw await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${D.join("<br>")}</div>`}),new Error(L.message)}await k.fire({icon:"success",title:"Berhasil!",text:L.message});const I={...Object.fromEntries(Object.keys(N.modalPegawai||{}).map(D=>[D,""])),...Object.fromEntries(Array.from({length:18},(D,Q)=>[`file_${Q+1}`,null]))};c({modalPegawai:I}),r(0),x([0]),s==null||s(!0),a==null||a()}catch(T){console.error("Terjadi kesalahan:",T)}},onInvalidSubmit:N=>{const T=Object.keys(N).filter(C=>C.startsWith("file_")).map(C=>{const P=parseInt(C.split("_")[1],10),F=ta.find(M=>M.id===P);return`- ${(F==null?void 0:F.label)||`Berkas ${P}`} wajib diisi`});T.length>0&&k.fire({icon:"warning",title:"Berkas wajib diunggah",html:`<pre style="text-align: left;">${T.join("<br>")}</pre>`})}}},Xn=()=>{var oe,W,X,ae,O,K,A,ee;const[a,s]=t.useState(!1),[l,r]=t.useState(null),[n,x]=t.useState(!1),b=ie=>{r(ie),x(!0)},i=()=>{r(null),x(!1)},[m,d]=t.useState({phoneNumber:"",wafathidup:"",status:"",jenisKelamin:"",negara:"",provinsi:"",kabupaten:"",kecamatan:"",angkatanPelajar:"",angkatanSantri:"",lembaga:"",jurusan:"",kelas:"",rombel:""}),{filterNegara:p,selectedNegara:g,handleFilterChangeNegara:h}=Ae(),{filterLembaga:c,selectedLembaga:o,handleFilterChangeLembaga:u}=Te(),w=((oe=p.negara.find(ie=>ie.value==g.negara))==null?void 0:oe.label)||"",_=((W=p.provinsi.find(ie=>ie.value==g.provinsi))==null?void 0:W.label)||"",f=((X=p.kabupaten.find(ie=>ie.value==g.kabupaten))==null?void 0:X.label)||"",v=((ae=p.kecamatan.find(ie=>ie.value==g.kecamatan))==null?void 0:ae.label)||"",S=((O=c.lembaga.find(ie=>ie.value==o.lembaga))==null?void 0:O.label)||"",j=((K=c.jurusan.find(ie=>ie.value==o.jurusan))==null?void 0:K.label)||"",y=((A=c.kelas.find(ie=>ie.value==o.kelas))==null?void 0:A.label)||"",N=((ee=c.rombel.find(ie=>ie.value==o.rombel))==null?void 0:ee.label)||"",T=t.useMemo(()=>({...m,negara:w,provinsi:_,kabupaten:f,kecamatan:v,lembaga:S,jurusan:j,kelas:y,rombel:N}),[m,j,f,v,y,S,w,_,N]),{pegawai:C,loadingPegawai:P,searchTerm:F,setSearchTerm:M,error:L,limit:I,setLimit:D,totalDataPegawai:Q,totalPages:E,currentPage:B,setCurrentPage:V}=Nt(T),[ne,te]=t.useState(!1),[R,Z]=t.useState("");t.useEffect(()=>{const ie=sessionStorage.getItem("viewMode");ie&&Z(ie)},[]);const z=ie=>{ie>=1&&ie<=E&&V(ie)},me={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],entitas:[{label:"Semua Entitas",value:""},{label:"Pengurus",value:"pengurus"},{label:"Karyawan",value:"karyawan"},{label:"Pengajar",value:"pengajar"},{label:"Pengajar-Pengurus",value:"pengajar pengurus"},{label:"Pengajar-Karyawan",value:"pengajar karyawan"},{label:"Pengurus-Karyawan",value:"pengurus karyawan"},{label:"Pengajar-Pengurus-Karyawan",value:"pengajar pengurus karyawan"}]},he={wargaPesantren:[{label:"Warga Pesantren",value:""},{label:"Memiliki NIUP",value:"memiliki niup"},{label:"Tanpa NIUP",value:"tanpa niup"}],pemberkasan:[{label:"Pemberkasan",value:""},{label:"Tidak Ada Berkas",value:"tidak ada berkas"},{label:"Tidak Ada Foto Diri",value:"tidak ada foto diri"},{label:"Memiliki Foto Diri",value:"memiliki foto diri"},{label:"Tidak Ada KK",value:"tidak ada kk"},{label:"Tidak Ada Akta Kelahiran",value:"tidak ada akta kelahiran"},{label:"Tidak Ada Ijazah",value:"tidak ada ijazah"}],umur:[{label:"Semua Umur",value:""},{label:"< 20 Tahun",value:"0-20"},{label:"20-29 Tahun",value:"20-29"},{label:"30-39 Tahun",value:"30-39"},{label:"40-49 Tahun",value:"40-49"},{label:"50-59 Tahun",value:"50-49"},{label:"60-65 Tahun",value:"60-65"},{label:"> 65 Tahun",value:"65-200"}]},U={smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]},q=ie=>ie===!0?e.jsx(ge,{icon:qa,className:"text-green-600"}):ie===!1?e.jsx(ge,{icon:Ne,className:"text-red-600"}):"-",[se,Y]=t.useState(!1),de=Zn(()=>Y(!1));return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Pegawai"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>Y(!0),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer flex items-center gap-2",children:[e.jsx(Ee,{}),"Tambah"]})}),e.jsx("button",{onClick:()=>ga(`${G}export/pegawai`,s),disabled:a,className:`px-4 py-2 rounded flex items-center gap-2 text-white cursor-pointer ${a?"bg-blue-300 cursor-not-allowed":"bg-blue-500 hover:bg-blue-700"}`,children:a?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-white"}),e.jsx("span",{children:"Loading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{}),e.jsx("span",{children:"Export"})]})})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${ne?"mb-4":""}`,children:[e.jsx(ue,{showFilters:ne,filterOptions:p,onChange:h,selectedFilters:g}),e.jsx(ue,{showFilters:ne,filterOptions:c,onChange:u,selectedFilters:o}),e.jsx(ue,{showFilters:ne,filterOptions:me,onChange:ie=>d(ce=>({...ce,...ie})),selectedFilters:m}),e.jsx(ue,{showFilters:ne,filterOptions:he,onChange:ie=>d(ce=>({...ce,...ie})),selectedFilters:m}),e.jsx(ue,{showFilters:ne,filterOptions:U,onChange:ie=>d(ce=>({...ce,...ie})),selectedFilters:m})]}),e.jsx(Ce,{searchTerm:F,setSearchTerm:M,totalData:Q,toggleFilters:()=>te(!ne),toggleView:Z,limit:I,toggleLimit:ie=>D(Number(ie.target.value))}),L?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):R==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:P?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):C.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):C.map((ie,ce)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex items-center space-x-4 cursor-pointer",onClick:()=>b(ie),children:[e.jsx("img",{alt:ie.nama||"-",className:"w-20 h-24 object-cover",src:ie.foto_profil,onError:fe=>{fe.target.onerror=null,fe.target.src=Me}}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold",children:ie.nama||"-"}),e.jsx("p",{className:"text-gray-600",children:ie.status||"-"})]})]},ie.id||ce))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIUP"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Umur"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Pengurus"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Karyawan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Pengajar"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Pendidikan Terakhir"})]})}),e.jsx("tbody",{className:"text-gray-800",children:P?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):C.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-6",children:"Tidak ada data"})}):C.map((ie,ce)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center cursor-pointer text-left",onClick:()=>b(ie),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(B-1)*I+ce+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ie.niup||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ie.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:ie.umur===0?0:ie.umur||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:q(ie.pengurus)}),e.jsx("td",{className:"px-3 py-2 border-b",children:q(ie.karyawan)}),e.jsx("td",{className:"px-3 py-2 border-b",children:q(ie.pengajar)}),e.jsx("td",{className:"px-3 py-2 border-b",children:ie.pendidikanTerkahir||"-"})]},ie.id||ce))})]})}),n&&e.jsx(De,{title:"Pegawai",menu:21,item:l,onClose:i}),se&&e.jsx(Qn,{isOpen:se,onClose:()=>Y(!1),formState:de}),E>1&&e.jsx(Fe,{currentPage:B,totalPages:E,handlePageChange:z})]})]})},el=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},400);return()=>clearTimeout(j)},[c]);const S=t.useCallback(async()=>{let j=`${G}data-pokok/anakasuh?limit=${i}`;if(u>1&&(j+=`&page=${u}`),_&&(j+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(j+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(j+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(j+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(j+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&(j+=`&wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&(j+=`&blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&(j+=`&kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(j+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&(j+=`&jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&(j+=`&kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&(j+=`&rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.jenisKelamin&&(j+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.status&&(j+=`&status=${encodeURIComponent(a.status)}`),a!=null&&a.angkatan&&(j+=`&angkatan_santri=${encodeURIComponent(a.angkatan)}`),a!=null&&a.wargaPesantren&&(j+=`&warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.urutBerdasarkan&&(j+=`&sort_by=${encodeURIComponent(a.urutBerdasarkan)}`),a!=null&&a.urutSecara&&(j+=`&sort_order=${encodeURIComponent(a.urutSecara)}`),a!=null&&a.smartcard&&(j+=`&smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.phoneNumber&&(j+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),v.current===j){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=j,console.log("Fetching data from:",j),n(!0),b(null);try{const y=await fetch(j);if(!y.ok)throw new Error(`Fetch error: ${y.status}`);const N=await y.json();console.log("Data Anak Asuh dari API:",N),l(Array.isArray(N.data)?N.data:[]),p(N.total_data||0),h(N.total_pages||1)}catch(y){console.error("Fetch error:",y),b(y.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{anakAsuh:s,loadingAnakAsuh:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataAnakAsuh:d,totalPages:g,currentPage:u,setCurrentPage:w}},al=()=>{var oe,W,X,ae,O,K,A,ee,ie,ce,fe;const[a,s]=t.useState(null),[l,r]=t.useState(!1),n=H=>{s(H),r(!0)},x=()=>{s(null),r(!1)},[b,i]=t.useState({phoneNumber:"",wafathidup:"",status:"",jenisKelamin:"",negara:"",provinsi:"",kabupaten:"",kecamatan:"",angkatanPelajar:"",angkatanSantri:"",lembaga:"",jurusan:"",kelas:"",rombel:""}),{filterNegara:m,selectedNegara:d,handleFilterChangeNegara:p}=Ae(),{filterLembaga:g,selectedLembaga:h,handleFilterChangeLembaga:c}=Te(),{filterWilayah:o,selectedWilayah:u,handleFilterChangeWilayah:w}=Be(),_=((oe=m.negara.find(H=>H.value==d.negara))==null?void 0:oe.label)||"",f=((W=m.provinsi.find(H=>H.value==d.provinsi))==null?void 0:W.label)||"",v=((X=m.kabupaten.find(H=>H.value==d.kabupaten))==null?void 0:X.label)||"",S=((ae=m.kecamatan.find(H=>H.value==d.kecamatan))==null?void 0:ae.label)||"",j=((O=o.wilayah.find(H=>H.value==u.wilayah))==null?void 0:O.label)||"",y=((K=o.blok.find(H=>H.value==u.blok))==null?void 0:K.label)||"",N=((A=o.kamar.find(H=>H.value==u.kamar))==null?void 0:A.label)||"",T=((ee=g.lembaga.find(H=>H.value==h.lembaga))==null?void 0:ee.label)||"",C=((ie=g.jurusan.find(H=>H.value==h.jurusan))==null?void 0:ie.label)||"",P=((ce=g.kelas.find(H=>H.value==h.kelas))==null?void 0:ce.label)||"",F=((fe=g.rombel.find(H=>H.value==h.rombel))==null?void 0:fe.label)||"",M=t.useMemo(()=>({...b,negara:_,provinsi:f,kabupaten:v,kecamatan:S,wilayah:j,blok:y,kamar:N,lembaga:T,jurusan:C,kelas:P,rombel:F}),[b,_,f,v,S,j,y,N,T,C,P,F]),{anakAsuh:L,loadingAnakAsuh:I,searchTerm:D,setSearchTerm:Q,error:E,limit:B,setLimit:V,totalDataAnakAsuh:ne,totalPages:te,currentPage:R,setCurrentPage:Z}=el(M),[z,me]=t.useState(!1),[he,U]=t.useState("");t.useEffect(()=>{const H=sessionStorage.getItem("viewMode");H&&U(H)},[]);const q=H=>{H>=1&&H<=te&&Z(H)},se={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],status:[{label:"Semua Status",value:""},{label:"Santri",value:"santri"},{label:"Santri Non Pelajar",value:"santri non pelajar"},{label:"Pelajar",value:"pelajar"},{label:"Pelajar Non Santri",value:"pelajar non santri"},{label:"Santri-Pelajar/Pelajar-Santri",value:"santri-pelajar"}],angkatan:We({placeholder:"Semua Angkatan",labelTemplate:"Tahun {year}"})},Y={wargaPesantren:[{label:"Warga Pesantren",value:""},{label:"Memiliki NIUP",value:"memiliki niup"},{label:"Tanpa NIUP",value:"tanpa niup"}],urutBerdasarkan:[{label:"Urut Berdasarkan",value:""},{label:"Nama",value:"nama"},{label:"NIUP",value:"niup"},{label:"Jenis Kelamin",value:"jenis_kelamin"}],urutSecara:[{label:"Urut Secara",value:""},{label:"A-Z / 0-9 (Ascending)",value:"asc"},{label:"Z-A / 9-0 (Descending)",value:"desc"}]},de={smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]};return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Data Anak Asuh"})}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${z?"mb-4":""}`,children:[e.jsx(ue,{showFilters:z,filterOptions:m,onChange:p,selectedFilters:d}),e.jsx(ue,{showFilters:z,filterOptions:o,onChange:w,selectedFilters:u}),e.jsx(ue,{showFilters:z,filterOptions:g,onChange:c,selectedFilters:h}),e.jsx(ue,{showFilters:z,filterOptions:se,onChange:H=>i(ve=>({...ve,...H})),selectedFilters:b}),e.jsx(ue,{showFilters:z,filterOptions:Y,onChange:H=>i(ve=>({...ve,...H})),selectedFilters:b}),e.jsx(ue,{showFilters:z,filterOptions:de,onChange:H=>i(ve=>({...ve,...H})),selectedFilters:b})]}),e.jsx(Ce,{searchTerm:D,setSearchTerm:Q,totalData:ne,toggleFilters:()=>me(!z),toggleView:U,limit:B,toggleLimit:H=>V(Number(H.target.value))}),E?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):he==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:I?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small"})}):L.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):L.map((H,ve)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex items-center space-x-4 cursor-pointer",onClick:()=>n(H),children:[e.jsx("img",{alt:H.nama||"-",className:"w-20 h-24 object-cover",src:H.foto_profil,onError:Pe=>{Pe.target.onerror=null,Pe.target.src=Me}}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl",children:H.nama||"-"}),e.jsxs("p",{className:"text-gray-600",children:["NIS : ",H.nis||"-"]}),e.jsxs("p",{className:"text-gray-600",children:["Angkatan:"," ",H.angkatan&&H.angkatan!=="-"&&H.kota_asal&&H.kota_asal!=="-"?e.jsxs(e.Fragment,{children:[H.angkatan," - ",H.kota_asal]}):H.angkatan&&H.angkatan!=="-"?H.angkatan:H.kota_asal&&H.kota_asal!=="-"?H.kota_asal:"-"]})]})]},H.id||ve))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"No. Induk Santri"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kamar"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Group Wali Asuh"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kota Asal"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Angkatan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update Bio"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input Bio"})]})}),e.jsx("tbody",{className:"text-gray-800 text-center",children:I?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small"})})}):L.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"py-6",children:"Tidak ada data"})}):L.map((H,ve)=>e.jsxs("tr",{className:"hover:bg-gray-50 text-left cursor-pointer",onClick:()=>n(H),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(R-1)*B+ve+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:H.nis||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:H.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:H.kamar||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:H.Group_Waliasuh||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:H.kota_asal||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:H.angkatan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:H.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:H.tgl_input||"-"})]},H.id||ve))})]})}),l&&e.jsx(De,{title:"Anak Asuh",menu:16,item:a,onClose:x}),te>1&&e.jsx(Fe,{currentPage:R,totalPages:te,handlePageChange:q})]})]})},tl=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},400);return()=>{clearTimeout(j)}},[c]);const S=t.useCallback(async()=>{let j=`${G}data-pokok/kewaliasuhan/grup?limit=${i}`;if(u>1&&(j+=`&page=${u}`),_&&(j+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&(j+=`&wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.jenisKelamin&&(j+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.jenisGroup&&(j+=`&grup_wali_asuh=${encodeURIComponent(a.jenisGroup)}`),v.current===j){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=j,console.log("Fetching Group Kewaliasuhan from:",j),n(!0),b(null);try{const y=await fetch(j);if(!y.ok)throw new Error(`Fetch error: ${y.status}`);const N=await y.json();console.log("Data Group Kewaliasuhan dari API:",N),l(Array.isArray(N.data)?N.data:[]),p(N.total_data||0),h(N.total_pages||1),w(N.current_page||1)}catch(y){console.error("Fetch error:",y),b(y.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{groupKewaliasuhan:s,loadingGroupKewaliasuhan:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalData:d,totalPages:g,currentPage:u,setCurrentPage:w}},sl=()=>{var j;const[a,s]=t.useState({wilayah:"",jenisKelamin:"",jenisGroup:""}),{filterWilayah:l}=Be(),r=((j=l.wilayah.find(y=>y.value==a.wilayah))==null?void 0:j.label)||"",n=t.useMemo(()=>({...a,wilayah:r}),[a,r]),{groupKewaliasuhan:x,loadingGroupKewaliasuhan:b,searchTerm:i,setSearchTerm:m,error:d,limit:p,setLimit:g,totalData:h,totalPages:c,currentPage:o,setCurrentPage:u}=tl(n),[w,_]=t.useState(!1),f=y=>{y>=1&&y<=c&&u(y)},v={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}]},S={jenisGroup:[{label:"Semua Jenis Group",value:""},{label:"Tidak Ada Wali dan Anak",value:"tidak_ada_wali_dan_anak"},{label:"Tidak Ada Wali",value:"tidak_ada_wali"},{label:"Tidak Ada Anak",value:"tidak_ada_anak"},{label:"Wali Ada Tapi Tidak Ada Anak",value:"wali_ada_tapi_tidak_ada_anak"},{label:"Anak Ada Tapi Tidak Ada Wali",value:"anak_ada_tapi_tidak_ada_wali"}]};return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Group Kewaliasuhan"})}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${w?"mb-4":""}`,children:[e.jsx(ue,{showFilters:w,filterOptions:{wilayah:l.wilayah},onChange:y=>s(N=>({...N,...y})),selectedFilters:a}),e.jsx(ue,{showFilters:w,filterOptions:v,onChange:y=>s(N=>({...N,...y})),selectedFilters:a}),e.jsx(ue,{showFilters:w,filterOptions:S,onChange:y=>s(N=>({...N,...y})),selectedFilters:a})]}),e.jsx(Ce,{searchTerm:i,setSearchTerm:m,totalData:h,toggleFilters:()=>_(!w),limit:p,toggleLimit:y=>g(Number(y.target.value)),showViewButtons:!1}),d?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Group"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIS Wali Asuh"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama Wali Asuh"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Wilayah"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jum. Anak Asuh"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update Group"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input Group"})]})}),e.jsx("tbody",{className:"text-gray-800 text-center",children:b?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small"})})}):x.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"py-6",children:"Tidak ada data"})}):x.map((y,N)=>e.jsxs("tr",{className:"hover:bg-gray-50 text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(o-1)*p+N+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:y.group||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:y.nis_wali_asuh||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:y.nama_wali_asuh||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:y.wilayah||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:y.jumlah_anak_asuh||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:y.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:y.tgl_input||"-"})]},`${y.id}-${N}`))})]})}),c>1&&e.jsx(Fe,{currentPage:o,totalPages:c,handlePageChange:f})]})]})},_t=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(""),[u,w]=t.useState(1),[_,f]=t.useState(c),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(c)},400);return()=>{clearTimeout(j)}},[c]);const S=t.useCallback(async()=>{let j=`${G}data-pokok/waliasuh?limit=${i}`;if(u>1&&(j+=`&page=${u}`),_&&(j+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(j+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(j+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(j+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(j+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&(j+=`&wilayah=${encodeURIComponent(a.wilayah)}`),a!=null&&a.blok&&a.blok!=="Semua Blok"&&(j+=`&blok=${encodeURIComponent(a.blok)}`),a!=null&&a.kamar&&a.kamar!=="Semua Kamar"&&(j+=`&kamar=${encodeURIComponent(a.kamar)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&(j+=`&lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&(j+=`&jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&(j+=`&kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&(j+=`&rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.jenisKelamin&&(j+=`&jenis_kelamin=${encodeURIComponent(a.jenisKelamin)}`),a!=null&&a.status&&(j+=`&status=${encodeURIComponent(a.status)}`),a!=null&&a.angkatan&&(j+=`&angkatan_santri=${encodeURIComponent(a.angkatan)}`),a!=null&&a.wargaPesantren&&(j+=`&warga_pesantren=${encodeURIComponent(a.wargaPesantren)}`),a!=null&&a.urutBerdasarkan&&(j+=`&sort_by=${encodeURIComponent(a.urutBerdasarkan)}`),a!=null&&a.urutSecara&&(j+=`&sort_order=${encodeURIComponent(a.urutSecara)}`),a!=null&&a.smartcard&&(j+=`&smartcard=${encodeURIComponent(a.smartcard)}`),a!=null&&a.phoneNumber&&(j+=`&phone_number=${encodeURIComponent(a.phoneNumber)}`),a!=null&&a.jenisWaliAsuh&&(j+=`&jenis_wali_asuh=${encodeURIComponent(a.jenisWaliAsuh)}`),v.current===j){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=j,console.log("Fetching Wali Asuh from:",j),n(!0),b(null);try{const y=await fetch(j);if(!y.ok)throw new Error(`Fetch error: ${y.status}`);const N=await y.json();console.log("Data Wali Asuh dari API:",N),l(Array.isArray(N.data)?N.data:[]),p(N.total_data||0),h(N.total_pages||1),w(N.current_page||1)}catch(y){console.error("Fetch error:",y),b(y.message),l([])}finally{n(!1)}},[u,a,i,_]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{w(1)},[i]),{waliAsuh:s,loadingWaliAsuh:r,searchTerm:c,setSearchTerm:o,error:x,limit:i,setLimit:m,totalDataWaliAsuh:d,totalPages:g,currentPage:u,setCurrentPage:w}},nl=()=>{var ae,O,K,A,ee,ie,ce,fe,H,ve,Pe;const[a,s]=t.useState(null),[l,r]=t.useState(!1),n=$=>{s($),r(!0)},x=()=>{s(null),r(!1)},[b,i]=t.useState({phoneNumber:"",smartcard:"",jenisKelamin:"",negara:"",provinsi:"",kabupaten:"",kecamatan:"",angkatan:"",lembaga:"",jurusan:"",kelas:"",rombel:"",wilayah:"",blok:"",kamar:"",jenisWaliAsuh:""}),{filterNegara:m,selectedNegara:d,handleFilterChangeNegara:p}=Ae(),{filterLembaga:g,selectedLembaga:h,handleFilterChangeLembaga:c}=Te(),{filterWilayah:o,selectedWilayah:u,handleFilterChangeWilayah:w}=Be(),_=((ae=m.negara.find($=>$.value==d.negara))==null?void 0:ae.label)||"",f=((O=m.provinsi.find($=>$.value==d.provinsi))==null?void 0:O.label)||"",v=((K=m.kabupaten.find($=>$.value==d.kabupaten))==null?void 0:K.label)||"",S=((A=m.kecamatan.find($=>$.value==d.kecamatan))==null?void 0:A.label)||"",j=((ee=o.wilayah.find($=>$.value==u.wilayah))==null?void 0:ee.label)||"",y=((ie=o.blok.find($=>$.value==u.blok))==null?void 0:ie.label)||"",N=((ce=o.kamar.find($=>$.value==u.kamar))==null?void 0:ce.label)||"",T=((fe=g.lembaga.find($=>$.value==h.lembaga))==null?void 0:fe.label)||"",C=((H=g.jurusan.find($=>$.value==h.jurusan))==null?void 0:H.label)||"",P=((ve=g.kelas.find($=>$.value==h.kelas))==null?void 0:ve.label)||"",F=((Pe=g.rombel.find($=>$.value==h.rombel))==null?void 0:Pe.label)||"",M={...o,jenisWaliAsuh:[{value:"",label:"Semua Jenis Wali Asuh"},{value:"dengan_grup",label:"Memiliki group"},{value:"tanpa_grup",label:"Tanpa group"}]},L={...u,jenisWaliAsuh:u.jenisWaliAsuh||""},I=$=>{w($),"jenisWaliAsuh"in $&&i(we=>({...we,jenisWaliAsuh:$.jenisWaliAsuh}))},D=t.useMemo(()=>({...b,negara:_,provinsi:f,kabupaten:v,kecamatan:S,wilayah:j,blok:y,kamar:N,lembaga:T,jurusan:C,kelas:P,rombel:F}),[b,_,f,v,S,j,y,N,T,C,P,F]),{waliAsuh:Q,loadingWaliAsuh:E,searchTerm:B,setSearchTerm:V,error:ne,limit:te,setLimit:R,totalDataWaliAsuh:Z,totalPages:z,currentPage:me,setCurrentPage:he}=_t(D),[U,q]=t.useState(!1),[se,Y]=t.useState("");t.useEffect(()=>{const $=sessionStorage.getItem("viewMode");$&&Y($)},[]);const de=$=>{$>=1&&$<=z&&he($)},oe={jenisKelamin:[{label:"Pilih Jenis Kelamin",value:""},{label:"Laki-laki",value:"laki-laki"},{label:"Perempuan",value:"perempuan"}],status:[{label:"Semua Status",value:""},{label:"Santri",value:"santri"},{label:"Santri Non Pelajar",value:"santri non pelajar"},{label:"Pelajar",value:"pelajar"},{label:"Pelajar Non Santri",value:"pelajar non santri"},{label:"Santri-Pelajar/Pelajar-Santri",value:"santri-pelajar"}],angkatan:We({placeholder:"Semua Angkatan",labelTemplate:"Tahun {year}"})},W={wargaPesantren:[{label:"Warga Pesantren",value:""},{label:"Memiliki NIUP",value:"memiliki niup"},{label:"Tanpa NIUP",value:"tanpa niup"}],urutBerdasarkan:[{label:"Urut Berdasarkan",value:""},{label:"Nama",value:"nama"},{label:"NIUP",value:"niup"},{label:"Jenis Kelamin",value:"jenis_kelamin"}],urutSecara:[{label:"Urut Secara",value:""},{label:"A-Z / 0-9 (Ascending)",value:"asc"},{label:"Z-A / 9-0 (Descending)",value:"desc"}]},X={smartcard:[{label:"Smartcard",value:""},{label:"Memiliki Smartcard",value:"memiliki smartcard"},{label:"Tidak Ada Smartcard",value:"tanpa smartcard"}],phoneNumber:[{label:"Phone Number",value:""},{label:"Memiliki Phone Number",value:"memiliki phone number"},{label:"Tidak Ada Phone Number",value:"tidak ada phone number"}]};return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Data Wali Asuh"})}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${U?"mb-4":""}`,children:[e.jsx(ue,{showFilters:U,filterOptions:m,onChange:p,selectedFilters:d}),e.jsx(ue,{showFilters:U,filterOptions:M,onChange:I,selectedFilters:L}),e.jsx(ue,{showFilters:U,filterOptions:g,onChange:c,selectedFilters:h}),e.jsx(ue,{showFilters:U,filterOptions:oe,onChange:$=>i(we=>({...we,...$})),selectedFilters:b}),e.jsx(ue,{showFilters:U,filterOptions:W,onChange:$=>i(we=>({...we,...$})),selectedFilters:b}),e.jsx(ue,{showFilters:U,filterOptions:X,onChange:$=>i(we=>({...we,...$})),selectedFilters:b})]}),e.jsx(Ce,{searchTerm:B,setSearchTerm:V,totalData:Z,toggleFilters:()=>q(!U),toggleView:Y,limit:te,toggleLimit:$=>R(Number($.target.value))}),ne?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):se==="list"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:E?e.jsx("div",{className:"col-span-3 flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):Q.length===0?e.jsx("p",{className:"text-center col-span-3",children:"Tidak ada data"}):Q.map(($,we)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex items-center space-x-4 cursor-pointer",onClick:()=>n($),children:[e.jsx("img",{alt:$.nama||"-",className:"w-20 h-24 object-cover",src:$.foto_profil,onError:Re=>{Re.target.onerror=null,Re.target.src=Me}}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl",children:$.nama||"-"}),e.jsxs("p",{className:"text-gray-600",children:["NIS : ",$.nis||"-"]}),e.jsxs("p",{className:"text-gray-600",children:["Angkatan:"," ",$.angkatan&&$.angkatan!=="-"&&$.kota_asal&&$.kota_asal!=="-"?e.jsxs(e.Fragment,{children:[$.angkatan," - ",$.kota_asal]}):$.angkatan&&$.angkatan!=="-"?$.angkatan:$.kota_asal&&$.kota_asal!=="-"?$.kota_asal:"-"]})]})]},$.id||we))}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"No. Induk Santri"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kamar"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Blok"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Wilayah"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kota Asal"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Angkatan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Update WA"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tgl Input WA"})]})}),e.jsx("tbody",{className:"text-gray-800 text-center",children:E?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):Q.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"py-6",children:"Tidak ada data"})}):Q.map(($,we)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-left cursor-pointer",onClick:()=>n($),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(me-1)*te+we+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.nis||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.nama||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.kamar||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.blok||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.wilayah||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.kota_asal||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.angkatan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.tgl_update||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:$.tgl_input||"-"})]},$.id||we))})]})}),l&&e.jsx(De,{title:"Wali Asuh",menu:14,item:a,onClose:x}),z>1&&e.jsx(Fe,{currentPage:me,totalPages:z,handlePageChange:de})]})]})},ll=a=>{const[s,l]=t.useState([]),[r,n]=t.useState(!0),[x,b]=t.useState(null),[i,m]=t.useState(25),[d,p]=t.useState(0),[g,h]=t.useState(1),[c,o]=t.useState(1),[u,w]=t.useState(""),[_,f]=t.useState(u),v=t.useRef("");t.useEffect(()=>{const j=setTimeout(()=>{f(u)},400);return()=>clearTimeout(j)},[u]);const S=t.useCallback(async(j=!1)=>{let y=`${G}data-pokok/pengunjung?limit=${i}`;if(c>1&&(y+=`&page=${c}`),_&&(y+=`&nama=${encodeURIComponent(_)}`),a!=null&&a.negara&&a.negara!=="Semua Negara"&&(y+=`&negara=${encodeURIComponent(a.negara)}`),a!=null&&a.provinsi&&a.provinsi!=="Semua Provinsi"&&(y+=`&provinsi=${encodeURIComponent(a.provinsi)}`),a!=null&&a.kabupaten&&a.kabupaten!=="Semua Kabupaten"&&(y+=`&kabupaten=${encodeURIComponent(a.kabupaten)}`),a!=null&&a.kecamatan&&a.kecamatan!=="Semua Kecamatan"&&(y+=`&kecamatan=${encodeURIComponent(a.kecamatan)}`),a!=null&&a.wilayah&&a.wilayah!=="Semua Wilayah"&&(y+=`&wilayah=${encodeURIComponent(a.wilayah)}`),!j&&v.current===y){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}v.current=y,console.log("Fetching Pengunjung from:",y),n(!0),b(null);try{const N=await fetch(y);if(!N.ok)throw new Error(`Fetch error: ${N.status}`);const T=await N.json();console.log("Data Pengunjung dari API:",T),l(Array.isArray(T.data)?T.data:[]),p(T.total_data||0),h(T.total_pages||1),o(T.current_page||1)}catch(N){console.error("Fetch error:",N),b(N.message),l([])}finally{n(!1)}},[c,i,_,a]);return t.useEffect(()=>{S()},[S]),t.useEffect(()=>{o(1)},[i]),{pengunjung:s,loading:r,error:x,searchTerm:u,setSearchTerm:w,limit:i,setLimit:m,totalData:d,totalPages:g,currentPage:c,setCurrentPage:o,fetchData:S}},rl=()=>{const[a,s]=t.useState([]);return t.useEffect(()=>{const l=sessionStorage.getItem("menuHubungan");if(l){const r=JSON.parse(l);s([{label:"Pilih Hubungan",value:""},...r.map(n=>({value:n.id,label:n.nama_status}))])}else fetch(`${G}dropdown/hubungan`).then(r=>r.json()).then(r=>{sessionStorage.setItem("menuHubungan",JSON.stringify(r)),s([{label:"Pilih Hubungan",value:""},...r.map(n=>({value:n.id,label:n.nama_status}))])}).catch(r=>{console.error("Error fetching hubungan:",r),s([{label:"Pilih Hubungan",value:""}])})},[]),{menuHubungan:a}},il=({isOpen:a,onClose:s,refetchData:l,feature:r,id:n})=>{const{menuSantri:x}=Sa(),{menuHubungan:b}=rl(),{clearAuthData:i}=ke(),m=je(),[d,p]=t.useState(!1),[g,h]=t.useState(""),[c,o]=t.useState({nik:"",nama:"",tempat_lahir:"",tanggal_lahir:"",jenis_kelamin:"",santri_id:"",hubungan_id:"",jumlah_rombongan:"",tanggal_kunjungan:"",status:""});t.useEffect(()=>{h(""),a&&r==1&&o({nik:"",nama:"",tempat_lahir:"",tanggal_lahir:"",jenis_kelamin:"",santri_id:"",hubungan_id:"",jumlah_rombongan:"",tanggal_kunjungan:"",status:""})},[r,a]),t.useEffect(()=>{if(a&&r===2&&c.santri_id&&x.length>0){const w=x.find(_=>_.id==c.santri_id);w&&h(w)}},[a,r,c.santri_id,x]),t.useEffect(()=>{const w=async()=>{try{const _=sessionStorage.getItem("token")||xe("token"),f=await fetch(`${G}crud/${n}/pengunjung/show`,{headers:{Authorization:`Bearer ${_}`}});if(!f.ok)throw new Error("Gagal mengambil data");const v=await f.json();console.log("pengunujung show :",v),v.data&&o({nik:v.data.nik??"",nama:v.data.nama??"",tempat_lahir:v.data.tempat_lahir??"",tanggal_lahir:v.data.tanggal_lahir??"",jenis_kelamin:v.data.jenis_kelamin??"",santri_id:v.data.santri_id??"",hubungan_id:v.data.hubungan_id??"",jumlah_rombongan:v.data.jumlah_rombongan??"",tanggal_kunjungan:v.data.tanggal_kunjungan??"",status:v.data.status??""})}catch(_){console.error("Gagal mengambil data perizinan:",_),k.fire("Error","Gagal mengambil data pengunjung","error")}};a&&r===2&&(h(""),o({nik:"",nama:"",tempat_lahir:"",tanggal_lahir:"",jenis_kelamin:"",santri_id:"",hubungan_id:"",jumlah_rombongan:"",tanggal_kunjungan:"",status:""}),w())},[r,n,a]);const u=async w=>{if(w.preventDefault(),c.nik.length<16){await k.fire({title:"Oops!",text:"NIK minimal 16 karakter",icon:"warning",confirmButtonText:"OK"});return}const _=r==1,f=_?"POST":"PUT",v=_?"pengunjung":`pengunjung/${n}`;if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),console.log("Payload yang dikirim ke API:",JSON.stringify(c,null,2));const j=sessionStorage.getItem("token")||xe("token"),y=await fetch(`${G}crud/${v}`,{method:f,headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`},body:JSON.stringify(c)});console.log(`Mengirim ke: ${G}crud/${v}`);const N=await y.json();if(console.log(N),k.close(),y.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),i(),m("/login");return}if(!y.ok)throw new Error(N.message||"Terjadi kesalahan pada server.");if(!("data"in N)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${N.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),l==null||l(!0),s==null||s()}catch(j){console.error("Terjadi kesalahan:",j),await k.fire({icon:"error",title:"Oops!",text:`Terjadi kesalahan saat mengirim data. ${j}`})}};return t.useEffect(()=>{a&&r===1&&(g!=null&&g.id)&&c.santri_id!==g.id&&(console.log("data santri berubah"),o(w=>({...w,santri_id:g.id})))},[g,a,r]),console.log(r==2||g),console.log(r),e.jsxs(le,{appear:!0,show:a,as:t.Fragment,children:[e.jsxs(re,{as:"div",className:"fixed inset-0 z-50",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"w-full max-w-2xl bg-white rounded-lg shadow-xl relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mt-6",children:r===2?"Edit Data":g&&r===1?"Tambah Data Baru":null}),e.jsxs("form",{className:"w-full",onSubmit:u,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4 overflow-y-auto max-h-[70vh]",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[r===1&&!g&&e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsxs("div",{className:"w-full max-w-2xl text-center",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Pilih Data Santri Terlebih Dahulu"}),e.jsx("button",{type:"button",onClick:()=>p(!0),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Pilih Santri"})]})}),e.jsx(ol,{santri:g,setShowSelectSantri:p,feature:r}),(g||r===2)&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nik",className:"block text-gray-700",children:"NIK *"}),e.jsx("input",{type:"number",name:"nik",value:c.nik,onChange:w=>o({...c,nik:w.target.value}),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm",placeholder:"Masukkan NIK",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nama",className:"block text-gray-700",children:"Nama Pengunjung *"}),e.jsx("input",{type:"text",name:"nama",value:c.nama,onChange:w=>o({...c,nama:w.target.value}),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm",placeholder:"Masukkan Nama",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tempat_lahir",className:"block text-gray-700",children:"Tempat Lahir *"}),e.jsx("input",{type:"text",name:"tempat_lahir",value:c.tempat_lahir,onChange:w=>o({...c,tempat_lahir:w.target.value}),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm",placeholder:"Masukkan tempat lahir",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_lahir",className:"block text-gray-700",children:"Tanggal Lahir *"}),e.jsx("input",{type:"date",name:"tanggal_lahir",value:c.tanggal_lahir,onChange:w=>o({...c,tanggal_lahir:w.target.value}),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-1",children:"Jenis Kelamin *"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"jenis_kelamin",value:"l",checked:c.jenis_kelamin==="l",onChange:w=>o({...c,jenis_kelamin:w.target.value}),className:"form-radio text-indigo-600"}),e.jsx("span",{className:"ml-2",children:"Laki-laki"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"jenis_kelamin",value:"p",checked:c.jenis_kelamin==="p",onChange:w=>o({...c,jenis_kelamin:w.target.value}),className:"form-radio text-indigo-600"}),e.jsx("span",{className:"ml-2",children:"Perempuan"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"hubungan_id",className:"block text-gray-700",children:"Hubungan *"}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 capitalize ${b.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:w=>o({...c,hubungan_id:w.target.value}),value:c.hubungan_id,disabled:b.length<=1,required:!0,children:b.map((w,_)=>e.jsx("option",{value:w.value,className:"capitalize",children:w.label},_))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"jumlah_rombongan",className:"block text-gray-700",children:"Jumlah Rombongan *"}),e.jsx("input",{type:"number",name:"jumlah_rombongan",value:c.jumlah_rombongan,onChange:w=>o({...c,jumlah_rombongan:w.target.value}),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm",placeholder:"Masukkan Jumlah Rombongan",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_kunjungan",className:"block text-gray-700",children:"Tanggal Kunjungan *"}),e.jsx("input",{type:"datetime-local",name:"tanggal_kunjungan",value:c.tanggal_kunjungan,onChange:w=>o({...c,tanggal_kunjungan:w.target.value}),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-gray-700",children:"Status *"}),e.jsxs("select",{name:"status",value:c.status,onChange:w=>o({...c,status:w.target.value}),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm",required:!0,children:[e.jsx("option",{value:"",children:"Pilih Status"}),e.jsx("option",{value:"menunggu",children:"Menunggu"}),e.jsx("option",{value:"berlangsung",children:"Berlangsung"}),e.jsx("option",{value:"selesai",children:"Selesai"}),e.jsx("option",{value:"ditolak",children:"Ditolak"})]})]})]})]})})}),e.jsxs("div",{className:"bg-gray-100 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse rounded-b-lg",children:[(g||r==2)&&e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm cursor-pointer",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]}),e.jsx(ha,{isOpen:d,onClose:()=>p(!1),onSantriSelected:w=>h(w)})]})},ol=({santri:a,setShowSelectSantri:s,feature:l})=>!a&&l!==2?null:e.jsxs("div",{className:"relative p-4 pr-12 rounded-md bg-gray-50 shadow-sm mb-6 border border-blue-200",children:[e.jsx("div",{className:"absolute -top-3 left-3 bg-blue-500 text-white text-xs font-semibold px-2 py-1 rounded shadow",children:"Data Santri yang Dikunjungi"}),e.jsx("button",{type:"button",onClick:()=>s(!0),className:"absolute top-3 right-3 px-2 py-1 rounded hover:bg-blue-700 text-gray-700 bg-blue-500 text-white","aria-label":"Ganti Santri",children:e.jsx("i",{className:"fas fa-exchange-alt"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:space-x-6 space-y-4 sm:space-y-0",children:[e.jsx("div",{className:"flex justify-center sm:justify-start",children:e.jsx("img",{src:a.foto_profil,alt:a.value,className:"w-32 h-40 object-cover rounded",onError:r=>{r.target.onerror=null,r.target.src=Me}})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-2 text-sm flex-1",children:[e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-1",children:[e.jsx("span",{className:"font-semibold",children:"Nama"})," ",e.jsxs("span",{children:[": ",a.value]}),e.jsx("span",{className:"font-semibold",children:"NIS"})," ",e.jsxs("span",{children:[": ",a.nis]}),e.jsx("span",{className:"font-semibold",children:"NIUP"})," ",e.jsxs("span",{children:[": ",a.niup]}),e.jsx("span",{className:"font-semibold",children:"Angkatan"})," ",e.jsxs("span",{children:[": ",a.angkatan]}),e.jsx("span",{className:"font-semibold",children:"Kota Asal"})," ",e.jsxs("span",{children:[": ",a.kota_asal]})]}),e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-1",children:[e.jsx("span",{className:"font-semibold",children:"Lembaga"})," ",e.jsxs("span",{children:[": ",a.lembaga]}),e.jsx("span",{className:"font-semibold",children:"Wilayah"})," ",e.jsxs("span",{children:[": ",a.wilayah]}),e.jsx("span",{className:"font-semibold",children:"Blok"})," ",e.jsxs("span",{children:[": ",a.blok]}),e.jsx("span",{className:"font-semibold",children:"Kamar"})," ",e.jsxs("span",{children:[": ",a.kamar]})]})]})]})]}),dl=()=>{var Z,z,me,he,U;const[a,s]=t.useState(null),[l,r]=t.useState(null),[n,x]=t.useState(!1),[b,i]=t.useState(null),m=q=>{s(q),x(!0)},d=()=>{s(null),x(!1)},[p,g]=t.useState({wilayah:"",jenisKelamin:"",jenisGroup:""}),{filterWilayah:h}=Be(),{filterNegara:c,selectedNegara:o,handleFilterChangeNegara:u}=Ae(),w=((Z=c.negara.find(q=>q.value==o.negara))==null?void 0:Z.label)||"",_=((z=c.provinsi.find(q=>q.value==o.provinsi))==null?void 0:z.label)||"",f=((me=c.kabupaten.find(q=>q.value==o.kabupaten))==null?void 0:me.label)||"",v=((he=c.kecamatan.find(q=>q.value==o.kecamatan))==null?void 0:he.label)||"",S=((U=h.wilayah.find(q=>q.value==p.wilayah))==null?void 0:U.label)||"",j=t.useMemo(()=>({...p,negara:w,provinsi:_,kabupaten:f,kecamatan:v,wilayah:S}),[p,f,v,w,_,S]),{pengunjung:y,loading:N,searchTerm:T,setSearchTerm:C,error:P,limit:F,setLimit:M,totalData:L,totalPages:I,currentPage:D,setCurrentPage:Q,fetchData:E}=ll(j),[B,V]=t.useState(!1),ne=q=>{q>=1&&q<=I&&Q(q)},[te,R]=t.useState(!1);return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Data Pengunjung"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>{i(1),R(!0)},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer flex items-center gap-2",children:[e.jsx(Ee,{}),"Tambah"]})})})]}),e.jsx(il,{isOpen:te,onClose:()=>R(!1),refetchData:E,feature:b,id:l}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 w-full ${B?"mb-4":""}`,children:[e.jsx(ue,{showFilters:B,filterOptions:c,onChange:u,selectedFilters:o}),e.jsx(ue,{showFilters:B,filterOptions:{wilayah:h.wilayah},onChange:q=>g(se=>({...se,...q})),selectedFilters:p})]}),e.jsx(Ce,{searchTerm:T,setSearchTerm:C,totalData:L,toggleFilters:()=>V(!B),limit:F,toggleLimit:q=>M(Number(q.target.value)),showViewButtons:!1}),P?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Wilayah Mahrom"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama Pengunjung"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Santri Dikunjungi"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jumlah Rombongan"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Kunjungan"}),e.jsx(ye,{action:"edit",children:e.jsx("th",{className:"px-3 py-2 border-b",children:"Aksi"})})]})}),e.jsx("tbody",{className:"text-gray-800 text-center",children:N?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small"})})}):y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"py-6",children:"Tidak ada data"})}):y.map((q,se)=>e.jsxs("tr",{className:"hover:bg-gray-50 text-left hover:cursor-pointer",onClick:()=>m(q),children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(D-1)*F+se+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:q.wilayah||"-"}),e.jsxs("td",{className:"px-3 py-2 border-b",children:[e.jsx("div",{children:q.nama_pengunjung||"-"}),e.jsxs("div",{className:"text-gray-500 text-sm italic",children:["(",q.status||"-",")"]})]}),e.jsxs("td",{className:"px-3 py-2 border-b",children:[e.jsx("div",{children:q.santri_dikunjungi}),e.jsxs("div",{className:"text-gray-500 text-sm italic",children:[q.kamar," - ",q.blok," - ",q.wilayah," -",q.lembaga,", ",q.jurusan]})]}),e.jsx("td",{className:"px-3 py-2 border-b",children:q.jumlah_rombongan||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:q.tanggal_kunjungan||"-"}),e.jsx(ye,{action:"edit",children:e.jsx("td",{className:"px-3 py-2 border-b text-center space-x-2",children:e.jsx("button",{onClick:Y=>{Y.stopPropagation(),r(q.id),i(2),R(!0)},className:"p-2 text-sm text-white bg-blue-500 hover:bg-blue-600 rounded cursor-pointer",children:e.jsx(ua,{})})})})]},`${q.id}-${se}`))})]})}),n&&e.jsx(De,{title:"Pengunjung",menu:23,item:a,onClose:d}),I>1&&e.jsx(Fe,{currentPage:D,totalPages:I,handlePageChange:ne})]})]})};function cl(a){const[s,l]=t.useState([]),[r,n]=t.useState(!1),[x,b]=t.useState(null),i=sessionStorage.getItem("token")||xe("token");async function m(){n(!0),b(null);try{const h=await fetch(`${G}formulir/${a}/berkas`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`}});if(!h.ok)throw new Error("Gagal memuat data berkas");const c=await h.json();console.log(c),l(c.data)}catch(h){b(h.message)}finally{n(!1)}}async function d(h){const c=await fetch(`${G}formulir/${h}/berkas/show`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`}});if(!c.ok)throw new Error("Gagal memuat detail berkas");return await c.json()}async function p(h,c){console.log("Payload yang dikirim ke API:",JSON.stringify(c,null,2));const o=await fetch(`${G}formulir/${h}/berkas`,{method:"POST",headers:{Authorization:`Bearer ${i}`},body:c});if(!o.ok){const u=await o.text();throw console.error("Error response:",u),new Error("Gagal menambah berkas")}return await o.json()}async function g(h,c){c.append("_method","PUT");for(const w of c.entries())console.log(`${w[0]}:`,w[1]);const o=await fetch(`${G}formulir/${h}/berkas`,{method:"POST",headers:{Authorization:`Bearer ${i}`},body:c}),u=await o.json();if(console.log(u),!o.ok)throw new Error("Gagal mengupdate berkas");return u}return{berkasList:s,loading:r,error:x,fetchBerkas:m,fetchBerkasDetail:d,createBerkas:p,updateBerkas:g}}function ml({isOpen:a,onClose:s,onSubmit:l,initialData:r}){var p;const[n,x]=t.useState(null),[b,i]=t.useState("");t.useEffect(()=>{a&&(i(""),x(null))},[a]),t.useEffect(()=>{r?(i(r.jenis_berkas_id||""),x(null)):(i(""),x(null))},[r]);const m=g=>{const h=g.target.files[0];if(h&&h.size>2*1024*1024){alert("Ukuran file maksimal 2MB");return}x(h)},d=g=>{if(g.preventDefault(),!n&&!r){alert("File wajib diunggah.");return}const h=new FormData;h.append("jenis_berkas_id",b),n&&h.append("file_path",n);for(const c of h.entries())console.log(`${c[0]}:`,c[1]);l({formData:h,id:(r==null?void 0:r.id)||null})};return e.jsx(le,{show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"relative z-50",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsx(le.Child,{as:t.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-150",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(re.Panel,{className:"bg-white rounded-lg shadow-lg w-full max-w-md p-6 relative",children:[e.jsx("button",{onClick:s,className:"absolute top-3 right-3 text-gray-600 hover:text-gray-900","aria-label":"Close modal",children:e.jsx(ge,{icon:Ne,size:"lg"})}),e.jsx(re.Title,{className:"text-xl font-semibold mb-4",children:r?"Edit Berkas":"Tambah Berkas"}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"jenis_berkas_id",className:"block text-gray-700",children:"Jenis Berkas *"}),e.jsxs("select",{id:"jenis_berkas_id",className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",onChange:g=>i(g.target.value),value:b,required:!0,children:[e.jsx("option",{value:"",children:"Pilih Jenis Berkas"}),ta.map((g,h)=>e.jsx("option",{value:g.id,children:g.label},h))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"File *"}),e.jsx("div",{className:"p-2 rounded-xl border border-gray-300 bg-white",children:e.jsxs("label",{htmlFor:"file_path",className:`relative flex flex-col items-center justify-center w-full aspect-[4/3] min-h-[150px] cursor-pointer ${n?"":"bg-gray-50 hover:bg-gray-100 border-2 border-gray-300 border-dashed rounded-lg"}`,children:[n?typeof n=="object"&&((p=n.type)!=null&&p.startsWith("image"))?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:URL.createObjectURL(n),alt:"preview",className:"h-full object-contain w-full"}),e.jsx("button",{type:"button",onClick:()=>x(null),className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded hover:bg-red-600",children:"×"})]}):typeof n=="string"?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:n,alt:"preview",className:"h-full object-contain w-full",onError:()=>x(null)}),e.jsx("button",{type:"button",onClick:()=>x(null),className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded hover:bg-red-600",children:"×"})]}):e.jsxs("div",{className:"text-center p-4",children:[e.jsxs("p",{className:"text-sm font-semibold",children:["File ",n.name," telah diunggah"]}),e.jsx("p",{className:"text-blue-600 underline",children:"Klik untuk ganti"})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx("svg",{className:"w-8 h-8 mb-4 text-gray-500",fill:"none",viewBox:"0 0 20 16",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})}),e.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[e.jsx("span",{className:"font-semibold",children:"Klik untuk upload"})," atau drag & drop"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PDF, JPG, PNG (max 2MB)"})]}),e.jsx("input",{type:"file",id:"file_path",accept:".pdf,image/jpeg,image/jpg,image/png",onChange:m,className:"hidden"})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 rounded border border-gray-300 hover:bg-gray-100",children:"Batal"}),e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center",children:[e.jsx(ge,{icon:Ht,className:"mr-2"}),r?"Update":"Upload"]})]})]})]})})})]})})}function ul(){const{biodata_id:a}=Ue(),s=a,{berkasList:l,loading:r,error:n,fetchBerkas:x,createBerkas:b,updateBerkas:i}=cl(s),[m,d]=t.useState(!1),[p,g]=t.useState(null),[h,c]=t.useState({});t.useEffect(()=>{x()},[s]);function o(S=""){return/\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(S)}function u(S=""){return S.match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i)?Xt:S.match(/\.pdf$/i)?es:as}const w=()=>{g(null),d(!0)},_=()=>{d(!1)},f=S=>{g({id:S.id,jenis_berkas_id:S.jenis_berkas_id||"",file_path:S.file_path||""}),d(!0)},v=async({formData:S,id:j})=>{if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{if(k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),j){for(const N of S.entries())console.log(`${N[0]}:`,N[1]);await i(j,S),await k.fire({icon:"success",title:"Berhasil",text:"Berkas berhasil diperbarui"})}else console.log("Isi formData sebelum submit:",S),await b(s,S),await k.fire({icon:"success",title:"Berhasil",text:"Berkas berhasil ditambahkan"});k.close(),d(!1),x()}catch(N){console.log(N.message),await k.fire({icon:"error",title:"Gagal",text:N.message||"Terjadi kesalahan"})}};return e.jsxs("div",{className:"px-2 sm:px-4 w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Berkas"}),e.jsx("button",{onClick:w,className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:"Tambah Berkas"})]}),r&&e.jsx("div",{className:"flex justify-center items-center mt-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}),n&&e.jsx("p",{className:"text-red-500",children:n}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[(l??[]).length===0&&!r&&e.jsx("p",{className:"col-span-full text-center",children:"Tidak ada berkas."}),(l??[]).map(S=>{var j;return e.jsxs("div",{className:"relative bg-white shadow rounded-lg overflow-hidden border group",children:[e.jsx("button",{onClick:()=>f(S),className:"absolute top-2 right-10 z-10 text-yellow-500 hover:text-yellow-600",title:"Edit berkas",children:e.jsx(ge,{icon:Qt})}),e.jsx("a",{href:S.file_path,target:"_blank",rel:"noopener noreferrer",className:"absolute top-2 right-2 z-10 text-gray-600 hover:text-blue-600",title:"Download",children:e.jsx(ge,{icon:Zt})}),e.jsx("div",{className:"absolute top-2 left-2 bg-purple-200 text-purple-700 text-xs px-2 py-1 rounded shadow",children:"Berkas"}),e.jsx("div",{className:"h-48 bg-gray-100 flex items-center justify-center overflow-hidden",children:S.file_path&&o(S.file_path)&&!h[S.file_path]?e.jsx("img",{src:S.file_path,alt:S.nama_jenis_berkas||"berkas",className:"object-cover h-full w-full",onError:()=>c(y=>({...y,[S.file_path]:!0}))}):e.jsx(ge,{icon:u(S.file_path),size:"3x",className:"text-gray-400"})}),e.jsx("div",{className:"p-3 text-center",children:e.jsx("p",{className:"text-sm font-medium text-gray-700",children:((j=ta.find(y=>y.id===S.jenis_berkas_id))==null?void 0:j.label)||e.jsx("span",{className:"italic text-gray-400",children:"*tanpa deskripsi"})})})]},S.id)})]}),e.jsx(ml,{isOpen:m,onClose:_,onSubmit:v,initialData:p})]})}const hl=et({kewarganegaraan:Ie().optional(),no_passport:Ie().optional(),nomor_kk:Ie().optional().test("len","No.KK harus 16 digit",a=>!a||a.length===16),nik:Ie().nullable().test("len","NIK harus 16 digit",a=>!a||a.length===16),nama:Ie().required("Nama wajib diisi"),jenis_kelamin:Ie().required("Jenis Kelamin harus dipilih").oneOf(["p","l"],"Pilihan jenis kelamin tidak valid"),tempat_lahir:Ie().required("Tempat Lahir wajib diisi"),tanggal_lahir:et({tahun:Ie().required("Tahun lahir wajib diisi"),bulan:Ie().required("Bulan lahir wajib diisi"),tanggal:Ie().required("Tanggal lahir wajib diisi")}),anak_keberapa:at().optional(),dari_saudara:at().optional(),tinggal_bersama:Ie().optional(),jenjang_pendidikan:Ie().optional(),nama_pendidikan:Ie().optional(),telepon1:Ie().required("Nomor Telepon 1 wajib diisi"),telepon2:Ie().optional(),email:Ie().email("Format email tidak valid"),pekerjaan:Ie().optional(),penghasilan:Ie().optional(),negara:Ie().required("Negara wajib diisi"),provinsi:Ie().optional(),kabupaten:Ie().optional(),kecamatan:Ie().optional(),jalan:Ie().optional(),kode_pos:Ie().optional(),wafat:Ie().required("Status wafat harus dipilih")}),xl=()=>{const{biodata_id:a}=Ue(),{clearAuthData:s}=ke(),l=je(),[r,n]=t.useState(!1),[x,b]=t.useState(!1),[i,m]=t.useState(null),[d,p]=t.useState(null),[g,h]=t.useState(null),[c]=t.useState([{value:"01",label:"Januari"},{value:"02",label:"Februari"},{value:"03",label:"Maret"},{value:"04",label:"April"},{value:"05",label:"Mei"},{value:"06",label:"Juni"},{value:"07",label:"Juli"},{value:"08",label:"Agustus"},{value:"09",label:"September"},{value:"10",label:"Oktober"},{value:"11",label:"November"},{value:"12",label:"Desember"}]);t.useEffect(()=>{console.log("Current biodata_id from URL:",a);const P=a&&a.trim()!=="";console.log("Is valid ID:",P)},[a]);const{filterNegara:o,selectedNegara:u,handleFilterChangeNegara:w}=Ae(),{register:_,handleSubmit:f,formState:{errors:v},setValue:S,reset:j}=ma({resolver:Gt(hl),defaultValues:{kewarganegaraan:"wni",wafat:"Tidak",jenis_kelamin:"",tanggal_lahir:{tahun:"",bulan:"",tanggal:""}}}),y=(P,F)=>{const{value:M}=P.target;S(F,M),w({[F]:M})},N=t.useCallback(async P=>{if(!P||P.trim()===""){console.warn("ID tidak valid"),b(!1);return}n(!0);try{const F=sessionStorage.getItem("token")||xe("token"),M=await fetch(`${G}formulir/${P}/biodata/show`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${F}`}});if(M.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}if(!M.ok)throw new Error(`HTTP error! status: ${M.status}`);const L=await M.json();if(console.log("Response dari API:",L),!L||!L.data){console.warn("Data tidak ditemukan dalam response"),b(!1);return}const I=L.data,D={nama:I.nama||"",no_passport:I.no_passport||"",nik:I.nik||"",nomor_kk:I.no_kk||"",jenis_kelamin:I.jenis_kelamin==="l"?"l":"p",tanggal_lahir:{tahun:"",bulan:"",tanggal:""},tempat_lahir:I.tempat_lahir||"",anak_keberapa:I.anak_keberapa||"",dari_saudara:I.dari_saudara||"",telepon1:I.no_telepon||"",telepon2:I.no_telepon_2||"",email:I.email||"",jenjang_pendidikan:I.jenjang_pendidikan_terakhir||"",nama_pendidikan:I.nama_pendidikan_terakhir||"",jalan:I.jalan||"",kode_pos:I.kode_pos||"",wafat:I.wafat===!1?"0":"1",negara:I.negara_id||"",provinsi:I.provinsi_id||"",kabupaten:I.kabupaten_id||"",kecamatan:I.kecamatan_id||""};if(I.tanggal_lahir){const[B,V,ne]=I.tanggal_lahir.split("-");D.tanggal_lahir={tahun:B,bulan:V,tanggal:ne}}Object.entries(D).forEach(([B,V])=>{B==="tanggal_lahir"?(S("tanggal_lahir.tahun",V.tahun),S("tanggal_lahir.bulan",V.bulan),S("tanggal_lahir.tanggal",V.tanggal)):S(B,V)});const Q=!!D.nik&&D.nik.trim()!=="",E=!!D.no_passport&&D.no_passport.trim()!=="";Q?S("kewarganegaraan","wni"):E&&S("kewarganegaraan","wna"),D.tanggal_lahir.tahun&&C(D.tanggal_lahir.tahun,D.tanggal_lahir.bulan),I.negara_id&&w({negara:I.negara_id.toString()}),I.provinsi_id&&w({provinsi:I.provinsi_id.toString()}),I.kabupaten_id&&w({kabupaten:I.kabupaten_id.toString()}),I.kecamatan_id&&w({kecamatan:I.kecamatan_id.toString()}),I.pas_foto_url&&p(I.pas_foto_url),b(!0)}catch(F){console.error("Error loading data:",F),b(!1),alert("Gagal memuat data peserta")}finally{n(!1)}},[]);t.useEffect(()=>{a&&a.trim()!==""?(console.log("Entering update mode with ID:",a),N(a)):(console.log("No valid biodata_id found, staying in create mode"),b(!1))},[a,N]);const T=async P=>{if((await k.fire({title:"Yakin ingin menyimpan data?",text:"Pastikan semua data sudah diisi dengan benar.",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, simpan",cancelButtonText:"Batal"})).isConfirmed){k.fire({title:"Mohon tunggu...",html:"Sedang menyimpan data.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),n(!0);try{const M=`${P.tanggal_lahir.tahun}-${P.tanggal_lahir.bulan}-${P.tanggal_lahir.tanggal}`,L=new FormData;L.append("tanggal_lahir",M),L.append("no_kk",P.nomor_kk),L.append("nama",P.nama),L.append("no_telepon",P.telepon1),P.telepon2&&L.append("no_telepon_2",P.telepon2),L.append("negara_id",P.negara),L.append("provinsi_id",P.provinsi),L.append("kabupaten_id",P.kabupaten),L.append("kecamatan_id",P.kecamatan),L.append("jenjang_pendidikan_terakhir",P.jenjang_pendidikan),L.append("nama_pendidikan_terakhir",P.nama_pendidikan),["tempat_lahir","no_passport","nik","anak_keberapa","dari_saudara","tinggal_bersama","email","jenis_kelamin","wafat","pekerjaan","jalan","kode_pos"].forEach(B=>{P[B]&&L.append(B,P[B])}),Object.keys(P).forEach(B=>{B!=="tanggal_lahir"&&L.append(B,P[B])}),L.append("tanggal_lahir",M);for(let B of L.entries())console.log(B[0]+":",B[1]);i&&L.append("photo",i);const I=sessionStorage.getItem("token")||xe("token");let D;const Q={method:"POST",headers:{Authorization:`Bearer ${I}`},body:L};x&&a&&a.trim()!==""?(console.log(`Updating record with ID: ${a}`),D=await fetch(`${G}formulir/${a}/biodata?_method=PUT`,Q)):(console.log("Creating new record"),D=await fetch(`${G}formulir/biodata?_method=POST`,Q));const E=await D.json();if(k.close(),D.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}if(!D.ok||E.errors){const B=E.message||"Terjadi kesalahan pada server.";await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align:center">${B}</div>`});return}await k.fire({icon:"success",title:"Berhasil",text:x?"Data berhasil diupdate!":"Data berhasil disimpan!"}),a&&a.trim()!==""&&N(a),x||(j(),m(null),p(null))}catch(M){if(k.close(),console.error("Error saving data:",M),M.response&&M.response.data&&M.response.data.errors){const L=M.response.data.errors,I=Object.keys(L).map(D=>`<li><strong>${D}</strong>: ${L[D][0]}</li>`).join("");await k.fire({icon:"error",title:"Validasi Gagal",html:`<ul style="text-align: left;">${I}</ul>`})}else await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data. Silakan coba lagi."})}finally{n(!1)}}};if(r&&x)return e.jsx("div",{className:"text-center p-5",children:"Loading data..."});const C=(P,F)=>{if(!P)return;const M=new Date,L=M.getFullYear(),I=M.getMonth()+1;let D=L-P;F&&parseInt(F)>I&&D--,h(D)};return e.jsx("div",{className:"relative p-2 bg-white ",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-8",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:d,alt:"Foto Profil",className:"w-46 h-54 object-cover rounded border border-gray-500 p-1",onError:P=>{P.target.onerror=null,P.target.src=Me}})}),e.jsxs("form",{onSubmit:f(T),className:"md:col-span-2 space-y-4 w-full",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"kewarganegaraan",className:"lg:w-1/4 text-black",children:"Kewarganegaraan *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"kewarganegaraan",value:"wni",..._("kewarganegaraan"),className:"w-4 h-4",disabled:!0}),e.jsx("span",{children:"WNI"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"kewarganegaraan",value:"wna",..._("kewarganegaraan"),className:"w-4 h-4",disabled:!0}),e.jsx("span",{children:"WNA"})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"passport",className:"lg:w-1/4 text-black",children:"No Passport *"}),e.jsx("div",{className:"lg:w-3/4 max-w-md",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsx("input",{id:"no_passport",name:"no_passport",type:"text",placeholder:"Masukkan No Passport",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",..._("no_passport")})})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"nomor_kk",className:"lg:w-1/4 text-black",children:"Nomor KK"}),e.jsxs("div",{className:"lg:w-3/4 max-w-md",children:[e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsx("input",{id:"nomor_kk",type:"text",placeholder:"Masukkan No KK",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",..._("nomor_kk")})}),v.nomor_kk&&e.jsx("p",{className:"text-end text-red-500 text-sm",children:v.nomor_kk.message})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"nik",className:"lg:w-1/4 text-black",children:"NIK *"}),e.jsxs("div",{className:"lg:w-3/4 max-w-md",children:[e.jsx("div",{className:"flex flex-col rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsx("input",{id:"nik",type:"text",placeholder:"Masukkan NIK",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",..._("nik")})}),v.nik&&e.jsx("p",{className:"text-end text-red-500 text-sm",children:v.nik.message})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4 mb-4",children:[e.jsx("label",{htmlFor:"nama",className:"lg:w-1/4 text-black",children:"Nama Lengkap *"}),e.jsxs("div",{className:"lg:w-3/4 max-w-md",children:[e.jsx("div",{className:"flex flex-col rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsx("input",{id:"nama",type:"text",placeholder:"Masukkan Nama Lengkap",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",..._("nama")})}),v.nama&&e.jsx("p",{className:"text-end text-red-500 text-sm mt-1",children:v.nama.message})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{className:"lg:w-1/4 text-black",children:"Jenis Kelamin *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",value:"p",..._("jenis_kelamin"),className:"w-4 h-4"}),e.jsx("span",{children:"Perempuan"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",value:"l",..._("jenis_kelamin"),className:"w-4 h-4"}),e.jsx("span",{children:"Laki-Laki"})]}),v.jenis_kelamin&&e.jsx("p",{className:"text-end text-red-500 text-sm",children:v.jenis_kelamin.message})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"tempat_lahir",className:"lg:w-1/4 text-black",children:"Tempat Lahir *"}),e.jsxs("div",{className:"lg:w-3/4 max-w-md",children:[e.jsx("div",{className:"flex flex-col rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsx("input",{id:"tempat_lahir",type:"text",placeholder:"Masukkan Tempat Lahir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",..._("tempat_lahir")})}),v.tempat_lahir&&e.jsx("p",{className:"text-end text-red-500 text-sm mt-1",children:v.tempat_lahir.message})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"tanggalLahir",className:"lg:w-1/4 text-black",children:"Tanggal Lahir *"}),e.jsxs("div",{className:"flex flex-col min-[833px]:flex-row space-y-2 min-[833px]:space-y-0",children:[e.jsxs("div",{className:"flex space-x-1 mr-2",children:[e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-2 border border-gray-300 focus-within:border-gray-500",children:e.jsxs("select",{..._("tanggal_lahir.tahun"),className:"w-full py-1.5 pr-1 text-base text-gray-900 focus:outline-none sm:text-sm",onChange:P=>C(parseInt(P.target.value),document.querySelector('[name="tanggal_lahir.bulan"]').value),children:[e.jsx("option",{value:"",children:"Tahun"}),Array.from({length:100},(P,F)=>new Date().getFullYear()-F).map(P=>e.jsx("option",{value:P,children:P},P))]})}),e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-2 border border-gray-300 focus-within:border-gray-500",children:e.jsxs("select",{..._("tanggal_lahir.bulan"),className:"w-full py-1.5 pr-1 text-base text-gray-900 focus:outline-none sm:text-sm",onChange:P=>C(parseInt(document.querySelector('[name="tanggal_lahir.tahun"]').value),P.target.value),children:[e.jsx("option",{value:"",children:"Bulan"}),c.map(P=>e.jsx("option",{value:P.value,children:P.label},P.value))]})}),e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-2 border border-gray-300 focus-within:border-gray-500",children:e.jsxs("select",{..._("tanggal_lahir.tanggal"),className:"w-full py-1.5 pr-1 text-base text-gray-900 focus:outline-none sm:text-sm",children:[e.jsx("option",{value:"",children:"Tanggal"}),Array.from({length:31},(P,F)=>F+1).map(P=>e.jsx("option",{value:P<10?`0${P}`:P,children:P<10?`0${P}`:P},P))]})})]}),e.jsx("span",{className:"w-fit h-8 bg-blue-200 text-blue-800 px-2 py-1 rounded-md text-sm",children:g!==null?`Umur ${g} tahun`:""})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{className:"lg:w-1/4 text-black",children:"Anak Ke *"}),e.jsxs("div",{className:"flex space-x-4 items-center",children:[e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsx("input",{type:"number",min:"1",className:"w-20 py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",..._("anak_keberapa")})}),e.jsx("span",{children:"Dari"}),e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsx("input",{type:"number",min:"1",className:"w-20 py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",..._("dari_saudara")})})]})]}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"tinggal_bersama",className:"lg:w-1/4 text-black",children:"Tinggal Bersama"}),e.jsx("div",{className:"lg:w-3/4 max-w-md",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsx("input",{id:"tinggal_bersama",type:"text",placeholder:"Masukkan Tinggal Bersama",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",..._("tinggal_bersama")})})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"jenjang_pendidikan",className:"lg:w-1/4 text-black",children:"Jenjang Pendidikan Terakhir"}),e.jsx("div",{className:"lg:w-3/4 max-w-md",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsxs("select",{id:"jenjang_pendidikan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",..._("jenjang_pendidikan"),children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"paud",children:"PAUD"}),e.jsx("option",{value:"sd/mi",children:"SD/MI"}),e.jsx("option",{value:"smp/mts",children:"SMP/MTs"}),e.jsx("option",{value:"sma/smk/ma",children:"SMA Sederajat"}),e.jsx("option",{value:"d3",children:"D3"}),e.jsx("option",{value:"d4",children:"D4"}),e.jsx("option",{value:"s1",children:"S1"}),e.jsx("option",{value:"s2",children:"S2"}),e.jsx("option",{value:"s3",children:"S3"})]})})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"nama_pendidikan",className:"lg:w-1/4 text-black",children:"Nama Pendidikan Terakhir"}),e.jsx("div",{className:"lg:w-3/4 max-w-md",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsx("input",{id:"nama_pendidikan",type:"text",placeholder:"Masukkan Nama Pendidikan Terakhir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",..._("nama_pendidikan")})})})]}),e.jsx("br",{}),e.jsxs("p",{className:"text-red-500 text-bold timesnewroman",children:["Untuk nomor telepon milik orang tua/wali jangan diinputkan pada data peserta didik!",e.jsx("span",{className:"text-red-500 text-sm italic",children:"Karena manajemen nomor telepon Pedatren untuk sending bulk sms ortu, akan melihat nomor telepon pada entitas ortu/wali dengan priority urutan dimulai dari ayah kandung, ibu kandung kemudian yang dijadikan sebagai wali (jika tidak ada ayah & ibu kandung)"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"telepon1",className:"lg:w-1/4 text-black",children:"Nomor Telepon 1 *"}),e.jsxs("div",{className:"lg:w-3/4 max-w-md",children:[e.jsx("div",{className:"flex flex-col rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsx("input",{id:"telepon1",type:"text",placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",..._("telepon1")})}),v.telepon1&&e.jsx("p",{className:"text-end text-red-500 text-sm mt-1",children:v.telepon1.message})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"telepon2",className:"lg:w-1/4 text-black",children:"Nomor Telepon 2"}),e.jsx("div",{className:"lg:w-3/4 max-w-md",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsx("input",{id:"telepon2",type:"text",placeholder:"+62",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",..._("telepon2")})})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"email",className:"lg:w-1/4 text-black",children:"E-Mail"}),e.jsxs("div",{className:"lg:w-3/4 max-w-md",children:[e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsx("input",{id:"email",type:"email",placeholder:"Masukkan E-Mail",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",..._("email")})}),v.email&&e.jsx("p",{className:"text-end text-red-500 text-sm",children:v.email.message})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"pekerjaan",className:"lg:w-1/4 text-black",children:"Pekerjaan"}),e.jsx("div",{className:"lg:w-3/4 max-w-md",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsxs("select",{id:"pekerjaan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",..._("pekerjaan"),children:[e.jsx("option",{value:"",children:"Pilih Pekerjaan"}),e.jsx("option",{children:"Petani"}),e.jsx("option",{children:"Pegawai Negeri"}),e.jsx("option",{children:"Karyawan Swasta"}),e.jsx("option",{children:"Wiraswasta"}),e.jsx("option",{children:"Lainnya"})]})})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"penghasilan",className:"lg:w-1/4 text-black",children:"Penghasilan"}),e.jsx("div",{className:"lg:w-3/4 max-w-md",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsxs("select",{id:"penghasilan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",..._("penghasilan"),children:[e.jsx("option",{value:"",children:"Pilih Penghasilan"}),e.jsx("option",{children:"< 1 Juta"}),e.jsx("option",{children:"1 - 3 Juta"}),e.jsx("option",{children:"3 - 5 Juta"}),e.jsx("option",{children:"> 5 Juta"}),e.jsx("option",{children:"Lainnya"})]})})})]}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"negara",className:"lg:w-1/4 text-black",children:"Negara *"}),e.jsxs("div",{className:"lg:w-3/4 max-w-md",children:[e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsxs("select",{..._("negara"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",onChange:P=>y(P,"negara"),value:u.negara,children:[e.jsx("option",{value:"",children:"Pilih Negara"}),o.negara.map(P=>e.jsx("option",{value:P.value,children:P.label},P.value))]})}),v.negara&&e.jsx("p",{className:"text-end text-red-500 text-sm",children:v.negara.message})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"Provinsi",className:"lg:w-1/4 text-black",children:"Provinsi *"}),e.jsx("div",{className:"lg:w-3/4 max-w-md",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsxs("select",{..._("provinsi"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",onChange:P=>y(P,"provinsi"),value:u.provinsi,disabled:!u.negara,children:[e.jsx("option",{value:"",children:"Pilih Provinsi"}),o.provinsi.map(P=>e.jsx("option",{value:P.value,children:P.label},P.value))]})})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"Kabupaten",className:"lg:w-1/4 text-black",children:"Kabupaten *"}),e.jsx("div",{className:"lg:w-3/4 max-w-md",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsxs("select",{..._("kabupaten"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",onChange:P=>y(P,"kabupaten"),value:u.kabupaten,disabled:!u.provinsi,children:[e.jsx("option",{value:"",children:"Pilih Kabupaten"}),o.kabupaten.map(P=>e.jsx("option",{value:P.value,children:P.label},P.value))]})})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"Provinsi",className:"lg:w-1/4 text-black",children:"Kecamatan *"}),e.jsx("div",{className:"lg:w-3/4 max-w-md",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsxs("select",{..._("kecamatan"),className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",onChange:P=>y(P,"kecamatan"),value:u.kecamatan,disabled:!u.kabupaten,children:[e.jsx("option",{value:"",children:"Pilih Kecamatan"}),o.kecamatan.map(P=>e.jsx("option",{value:P.value,children:P.label},P.value))]})})})]}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"jalan",className:"lg:w-1/4 text-black",children:"Jalan *"}),e.jsx("div",{className:"lg:w-3/4 max-w-md",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsx("input",{id:"jalan",type:"text",placeholder:"Masukkan Nama Jalan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",..._("jalan")})})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{htmlFor:"kode_pos",className:"lg:w-1/4 text-black",children:"Kode Pos *"}),e.jsx("div",{className:"lg:w-3/4 max-w-md",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-3 border border-gray-300 focus-within:border-gray-500",children:e.jsx("input",{id:"kode_pos",type:"text",placeholder:"Masukkan Kode Pos",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",..._("kode_pos")})})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-4",children:[e.jsx("label",{className:"lg:w-1/4 text-black",children:"Wafat *"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",value:"0",..._("wafat"),className:"w-4 h-4"}),e.jsx("span",{children:"Tidak"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",value:"1",..._("wafat"),className:"w-4 h-4"}),e.jsx("span",{children:"Ya"})]}),v.wafat&&e.jsx("p",{className:"text-red-500 text-sm",children:v.wafat.message})]}),e.jsx("br",{}),e.jsx(ye,{action:"edit",children:e.jsx("div",{className:"mt-4",children:e.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-800 focus:outline-none focus:ring-2 focus:ring-blue-400",disabled:r,children:r?"Menyimpan...":"Simpan"})})})]})]})})},gl=({filterOptions:a,onChange:s,selectedFilters:l})=>{const r=n=>n.charAt(0).toUpperCase()+n.slice(1);return e.jsx("div",{className:"flex flex-col gap-4 w-full",children:Object.entries(a).map(([n,x],b)=>e.jsxs("div",{children:[e.jsxs("label",{htmlFor:n,className:"block text-gray-700",children:[r(n)," ",n==="wilayah"?"*":""]}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:i=>s({[n]:i.target.value}),value:l[n]||"",disabled:x.length<=1,children:x.map((i,m)=>e.jsx("option",{value:i.value,children:i.label},m))})]},`${n}-${b}`))})},pl=({isOpen:a,onClose:s,biodataId:l,cardId:r,refetchData:n,feature:x})=>{const{clearAuthData:b}=ke(),i=je(),{filterWilayah:m,handleFilterChangeWilayah:d,selectedWilayah:p}=Be(),g=(S,j)=>S.length>0?[{...S[0],label:j},...S.slice(1)]:S,h={wilayah:g(m.wilayah,"Pilih Wilayah"),blok:g(m.blok,"Pilih Blok"),kamar:g(m.kamar,"Pilih Kamar")},c=x==1,o=c?"domisili":"domisili/pindah",u=c?"POST":"PUT",w=c?l:r,[_,f]=t.useState({wilayah_id:"",blok_id:"",kamar_id:"",tanggal_masuk:""});t.useEffect(()=>{f(S=>({...S,wilayah_id:p.wilayah||"",blok_id:p.blok||"",kamar_id:p.kamar||""}))},[p]),t.useEffect(()=>{a&&(f({wilayah_id:"",blok_id:"",kamar_id:"",tanggal_masuk:""}),d({wilayah:"",blok:"",kamar:""}))},[a]),t.useEffect(()=>{console.log(_)},[_]);const v=async S=>{if(S.preventDefault(),!_.wilayah_id||!_.tanggal_masuk){await k.fire({icon:"error",title:"Data tidak lengkap",text:"Wilayah dan Tanggal Mulai wajib diisi"});return}if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const y=sessionStorage.getItem("token")||xe("token"),N=await fetch(`${G}formulir/${w}/${o}`,{method:u,headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify(_)});if(k.close(),N.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),b(),i("/login");return}const T=await N.json();if(console.log(T),!N.ok)throw new Error(T.message||"Terjadi kesalahan pada server.");if(!("data"in T)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: center;">${T.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data domisili berhasil disimpan."}),n==null||n(),s==null||s()}catch(y){console.error("Terjadi kesalahan:",y),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:v,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:c?"Tambah Data Domisili":"Pindah Domisili"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(gl,{filterOptions:h,onChange:d,selectedFilters:p}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_masuk",className:"block text-gray-700",children:"Tanggal Mulai *"}),e.jsx("input",{type:"datetime-local",id:"tanggal_masuk",name:"tanggal_masuk",value:_.tanggal_masuk,onChange:S=>f({..._,tanggal_masuk:S.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Batal"})]})]})]})})})]})})},bl=({isOpen:a,onClose:s,id:l,refetchData:r})=>{const{clearAuthData:n}=ke(),x=je(),[b,i]=t.useState({tanggal_keluar:""}),m=async d=>{if(d.preventDefault(),!b.tanggal_keluar){await k.fire({icon:"error",title:"Data tidak lengkap",text:"Tanggal keluar wajib diisi"});return}if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const g=sessionStorage.getItem("token")||xe("token"),h=await fetch(`${G}formulir/${l}/domisili/keluar`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify(b)});if(k.close(),h.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}const c=await h.json();if(console.log(c),!h.ok)throw new Error(c.message||"Terjadi kesalahan pada server.");if(c.message&&c.message.toLowerCase().includes("tidak boleh")){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${c.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data domisili berhasil diperbarui."}),i({tanggal_keluar:""}),r==null||r(),s==null||s()}catch(g){console.error("Terjadi kesalahan:",g),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:m,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Masukkan Tanggal Keluar"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_keluar",className:"block text-gray-700",children:"Tanggal Keluar *"}),e.jsx("input",{type:"datetime-local",id:"tanggal_keluar",name:"tanggal_keluar",value:b.tanggal_keluar,onChange:d=>i({...b,tanggal_keluar:d.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Batal"})]})]})]})})})]})})},jl=()=>{const{biodata_id:a}=Ue(),s=Ke("edit"),l=Ke("pindah"),r=Ke("keluar"),{clearAuthData:n}=ke(),x=je(),[b,i]=t.useState(!1),[m,d]=t.useState(!1),[p,g]=t.useState([]),[h,c]=t.useState(null),[o,u]=t.useState(null),[w,_]=t.useState(""),[f,v]=t.useState(""),[S,j]=t.useState(null),[y,N]=t.useState(!0),[T,C]=t.useState(null),[P,F]=t.useState(!1),M=se=>{if(!se)return"";const Y={year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"};return new Date(se).toLocaleDateString("id-ID",Y).replace(" pukul",",")},{filterWilayah:L,handleFilterChangeWilayah:I,selectedWilayah:D}=Be(),Q=(se,Y)=>se.length>0?[{...se[0],label:Y},...se.slice(1)]:se,E={wilayah:Q(L.wilayah,"Pilih Wilayah"),blok:Q(L.blok,"Pilih Blok"),kamar:Q(L.kamar,"Pilih Kamar")},B=t.useCallback(async()=>{const se=sessionStorage.getItem("token")||xe("token");if(!(!a||!se))try{N(!0);const Y=await fetch(`${G}formulir/${a}/domisili`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${se}`}});if(Y.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}if(!Y.ok)throw new Error(`Gagal fetch: ${Y.status}`);const de=await Y.json();g(de.data||[])}catch(Y){console.error("Gagal mengambil data Domisili:",Y)}finally{N(!1)}},[a]);t.useEffect(()=>{B()},[B]);const V=async se=>{try{v(null),C(se);const Y=sessionStorage.getItem("token")||xe("token"),de=await fetch(`${G}formulir/${se}/domisili/show`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Y}`}});if(de.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}const oe=await de.json();c(se),u(oe.data),console.log(o);const W=X=>{if(!X||X==="-"||X==="null")return"";const ae=new Date(X);if(isNaN(ae.getTime()))return"";const O=fe=>fe.toString().padStart(2,"0"),K=ae.getFullYear(),A=O(ae.getMonth()+1),ee=O(ae.getDate()),ie=O(ae.getHours()),ce=O(ae.getMinutes());return`${K}-${A}-${ee}T${ie}:${ce}`};_(W(oe.data.tanggal_masuk)),v(W(oe.data.tanggal_keluar))}catch(Y){console.error("Gagal mengambil detail Domisili:",Y)}finally{C(null)}};t.useEffect(()=>{o&&(o.nama_wilayah&&I({wilayah:o.nama_wilayah}),o.nama_blok&&I({blok:o.nama_blok}),o.nama_kamar&&I({kamar:o.nama_kamar}))},[o]);const ne=async()=>{if(!o)return;const{wilayah:se,blok:Y,kamar:de}=D||{};if(!se||!w){await k.fire({icon:"warning",title:"Validasi",text:"Wilayah dan Tanggal Mulai wajib diisi",confirmButtonText:"OK"});return}if(!(await k.fire({title:"Konfirmasi",text:"Apakah Anda yakin ingin memperbarui data domisili?",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, update",cancelButtonText:"Batal"})).isConfirmed)return;const W={wilayah_id:se,blok_id:Y||null,kamar_id:de||null,tanggal_masuk:w,tanggal_keluar:f||null};console.log(W);try{k.fire({title:"Memperbarui data...",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),F(!0);const X=sessionStorage.getItem("token")||xe("token"),ae=await fetch(`${G}formulir/${h}/domisili`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${X}`},body:JSON.stringify(W)});if(ae.status===401){k.close(),await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}k.close();const O=await ae.json();if(console.log(O),ae.ok&&O.message&&O.message.toLowerCase().includes("tidak boleh")){await k.fire({icon:"error",title:"Validasi Gagal",text:O.message});return}if(!ae.ok)throw new Error(O.message||"Gagal update");await k.fire({icon:"success",title:"Berhasil",text:"Data domisili berhasil diperbarui!"}),c(null),u(null),_(""),v(""),setTimeout(()=>{B()},300)}catch(X){console.error("Error saat update:",X),await k.fire({icon:"error",title:"Error",text:X.message||"Terjadi kesalahan saat update"})}finally{F(!1)}},te=()=>{i(!1)},R=()=>{i(!0)},Z=()=>{d(!1)},z=se=>{c(se),d(!0)},me=(o==null?void 0:o.tanggal_keluar)&&(o==null?void 0:o.tanggal_keluar)!=="-",he=({filterOptions:se,onChange:Y,selectedFilters:de})=>e.jsx("div",{className:"flex flex-col gap-4 w-full",children:Object.entries(se).map(([oe,W],X)=>e.jsxs("div",{children:[e.jsxs("label",{htmlFor:oe,className:"block text-sm font-medium text-gray-700",children:[U(oe)," ",oe==="wilayah"?"*":""]}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${W.length<=1||!s||me?"bg-gray-200 text-gray-500":""}`,onChange:ae=>Y({[oe]:ae.target.value}),value:de[oe]||"",disabled:W.length<=1||!s||me,children:W.map((ae,O)=>e.jsx("option",{value:ae.value,children:ae.label},O))})]},`${oe}-${X}`))}),U=se=>se.charAt(0).toUpperCase()+se.slice(1),q=async(se,Y)=>{try{c(se),j(Y),i(!0)}catch(de){console.error("Gagal mengambil detail Khadam:",de)}};return e.jsxs("div",{className:"block",id:"Domisili",children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center justify-between",children:["Domisili Santri",e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>{j(1),R()},type:"button",className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Tambah"})]})})]}),e.jsx(pl,{isOpen:b,onClose:te,biodataId:a,cardId:h,refetchData:B,feature:S}),e.jsx(bl,{isOpen:m,onClose:Z,id:h,refetchData:B}),e.jsx("div",{className:"mt-5 space-y-6",children:y?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):p.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"Tidak ada data"}):p.map(se=>e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white shadow-md drop-shadow rounded-lg p-6 cursor-pointer w-full flex flex-col items-start gap-2",onClick:()=>V(se.id),children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"text-lg font-bold",children:["Wilayah ",se.nama_wilayah," - ",se.nama_kamar]}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Sejak ",M(se.tanggal_masuk),se.tanggal_keluar?` s/d ${M(se.tanggal_keluar)}`:" - Sekarang"]})]}),e.jsx("span",{className:`text-sm font-semibold capitalize px-3 py-1 rounded-full ${se.tanggal_keluar?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:se.status})]}),!se.tanggal_keluar&&e.jsxs("div",{className:`flex flex-wrap gap-2 gap-x-4 ${l||r?"":"mt-2"}`,children:[e.jsx(ye,{action:"pindah",children:e.jsxs("button",{type:"button",onClick:Y=>{Y.stopPropagation(),q(se.id,2)},className:"text-blue-600 hover:text-blue-800 flex items-center gap-1 cursor-pointer",title:"Pindah Domisili",children:[e.jsx(ge,{icon:na}),"Pindah"]})}),e.jsx(ye,{action:"keluar",children:e.jsxs("button",{type:"button",onClick:Y=>{Y.stopPropagation(),z(se.id)},className:"justify-end text-yellow-600 hover:text-yellow-800 flex items-center gap-1 cursor-pointer",title:"Keluar Domisili",children:[e.jsx(ge,{icon:Ve}),"Keluar"]})})]})]}),T===se.id?e.jsx("div",{className:"flex justify-center items-center mt-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):h===se.id&&o&&e.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx(he,{filterOptions:E,onChange:I,selectedFilters:D})}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Masuk *"}),e.jsx("input",{type:"datetime-local",id:"startDate",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!s||me?"bg-gray-200 text-gray-500":""}`,disabled:!s||me,value:w,onChange:Y=>_(Y.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Keluar"}),e.jsx("input",{type:"datetime-local",id:"endDate",className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-gray-200 text-gray-500",value:f,onChange:Y=>v(Y.target.value),disabled:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:" "}),e.jsxs("div",{className:"flex space-x-2 mt-1",children:[((o==null?void 0:o.tanggal_keluar)==null||(o==null?void 0:o.tanggal_keluar)=="-"||!(o!=null&&o.tanggal_keluar))&&e.jsx(ye,{action:"edit",children:e.jsx("button",{type:"button",disabled:P,className:`px-4 py-2 text-white rounded-lg hover:bg-blue-700 focus:outline-none ${P?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 cursor-pointer"}`,onClick:ne,children:P?e.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-white w-13"}):"Update"})}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none cursor-pointer",onClick:()=>{c(null),u(null),_(""),v("")},children:"Batal"})]})]})]})]},se.id))})]})},kl=({isOpen:a,onClose:s,biodataId:l,refetchData:r,feature:n,karyawanIdToPindah:x})=>{const{clearAuthData:b}=ke(),i=je(),{menuGolonganJabatan:m}=aa(),{filterLembaga:d}=Te(),g={lembaga:((v,S)=>v.length>0?[{...v[0],label:S},...v.slice(1)]:v)(d.lembaga,"Pilih Lembaga")},h=n===1,c=h?"karyawan":"karyawan/pindah",o=h?"POST":"PUT",u=h?l:x,[w,_]=t.useState({lembaga_id:"",golongan_jabatan_id:"",keterangan_jabatan:"",jabatan:"",tanggal_mulai:""}),f=async v=>{if(v.preventDefault(),!w.lembaga_id||!w.golongan_jabatan_id||!w.keterangan_jabatan||!w.tanggal_mulai){await k.fire({icon:"error",title:"Data tidak lengkap",text:"Semua field bertanda * wajib diisi"});return}if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),console.log("ID:",u),console.log("Data:",w);const j=sessionStorage.getItem("token")||xe("token"),y=await fetch(`${G}formulir/${u}/${c}`,{method:o,headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`},body:JSON.stringify(w)});if(k.close(),console.log("token:",j),console.log("formData:",w),console.log("response:",y),y.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),b(),i("/login");return}const N=await y.json();if(!y.ok||!N.data)throw new Error(N.message||"Terjadi kesalahan pada server.");await k.fire({icon:"success",title:"Berhasil!",text:"Data karyawan berhasil disimpan."}),r==null||r(),s==null||s()}catch(j){console.error("Terjadi kesalahan:",j),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:f,children:[e.jsxs("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:h?"Tambah Data Karyawan":"Pindah Lembaga Karyawan"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700",children:"Lembaga *"}),e.jsx("select",{className:"w-full mt-1 border border-gray-300 rounded-md p-2",value:w.lembaga_id,onChange:v=>_({...w,lembaga_id:v.target.value}),required:!0,children:g.lembaga.map(v=>e.jsx("option",{value:v.value,children:v.label},v.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700",children:"Keterangan Jabatan *"}),e.jsx("input",{type:"text",className:"w-full mt-1 border border-gray-300 rounded-md p-2",value:w.keterangan_jabatan,onChange:v=>_({...w,keterangan_jabatan:v.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700",children:"Golongan Jabatan *"}),e.jsx("select",{className:"w-full mt-1 border border-gray-300 rounded-md p-2",value:w.golongan_jabatan_id,onChange:v=>_({...w,golongan_jabatan_id:v.target.value}),required:!0,children:m.map(v=>e.jsx("option",{value:v.id,children:v.label},v.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700",children:"Jenis Kontrak"}),e.jsxs("select",{className:"w-full mt-1 border border-gray-300 rounded-md p-2",value:w.jabatan,onChange:v=>_({...w,jabatan:v.target.value}),children:[e.jsx("option",{value:"",children:"Pilih Jenis Kontrak"}),e.jsx("option",{value:"kultural",children:"kultural"}),e.jsx("option",{value:"tetap",children:"Tetap"}),e.jsx("option",{value:"kontrak",children:"Kontrak"}),e.jsx("option",{value:"pengkaderan",children:"Pengkaderan"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700",children:"Tanggal Mulai *"}),e.jsx("input",{type:"date",className:"w-full mt-1 border border-gray-300 rounded-md p-2",value:w.tanggal_mulai,onChange:v=>_({...w,tanggal_mulai:v.target.value}),required:!0})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 sm:mt-0 sm:w-auto sm:text-sm",children:"Batal"})]})]})]})})})]})})},fl=({isOpen:a,onClose:s,id:l,refetchData:r})=>{const{clearAuthData:n}=ke(),x=je(),[b,i]=t.useState({tanggal_selesai:""}),m=async d=>{if(d.preventDefault(),!b.tanggal_selesai){await k.fire({icon:"error",title:"Data tidak lengkap",text:"Tanggal keluar wajib diisi."});return}if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan data tanggal keluar sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const g=sessionStorage.getItem("token")||xe("token"),h=await fetch(`${G}formulir/${l}/karyawan/keluar`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify(b)});if(k.close(),h.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}const c=await h.json();if(!h.ok||!c.data)throw new Error(c.message||"Terjadi kesalahan pada server.");await k.fire({icon:"success",title:"Berhasil!",text:"Data karyawan berhasil diperbarui dengan tanggal keluar."}),r==null||r(),s==null||s()}catch(g){console.error("Terjadi kesalahan:",g),await k.fire({icon:"error",title:"Oops!",text:g.message||"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:m,children:[e.jsxs("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Masukkan Tanggal Keluar Karyawan"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_selesai",className:"block text-gray-700",children:"Tanggal Keluar *"}),e.jsx("input",{type:"date",id:"tanggal_selesai",name:"tanggal_selesai",value:b.tanggal_selesai,onChange:d=>i({...b,tanggal_selesai:d.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 sm:mt-0 sm:w-auto sm:text-sm",children:"Batal"})]})]})]})})})]})})},yl=()=>{const[a,s]=t.useState([]);return t.useEffect(()=>{const l=sessionStorage.getItem("menuLembaga");if(l)try{const r=JSON.parse(l),n=[{label:"Pilih Lembaga",value:""},...r.lembaga.map(x=>({value:x.id,label:x.nama_lembaga}))];s(n)}catch(r){console.error("Gagal parsing data lembaga dari sessionStorage:",r),sessionStorage.removeItem("menuLembaga")}else fetch(`${G}dropdown/lembaga`).then(r=>r.json()).then(r=>{const n=[{label:"Pilih Lembaga",value:""},...r.lembaga.map(x=>({value:x.id,label:x.nama_lembaga}))];sessionStorage.setItem("menuLembaga",JSON.stringify(r)),s(n),console.log("Data lembaga berhasil diambil:",n)}).catch(r=>{console.error("Gagal mengambil data lembaga:",r),s([{label:"Pilih Lembaga",value:""}])})},[]),{menuLembaga:a}},wl=()=>{const{biodata_id:a}=Ue(),{clearAuthData:s}=ke(),l=je(),r=Ke("edit"),n=Ke("pindah"),x=Ke("keluar"),[b,i]=t.useState(!1),[m,d]=t.useState(!1),[p,g]=t.useState([]),[h,c]=t.useState(null),[o,u]=t.useState(null),[w,_]=t.useState(""),[f,v]=t.useState(""),[S,j]=t.useState(""),[y,N]=t.useState(""),[T,C]=t.useState(""),[P,F]=t.useState(null),[M,L]=t.useState(!0),[I,D]=t.useState(null),[Q,E]=t.useState(!1),[B,V]=t.useState(""),[ne,te]=t.useState(""),{menuLembaga:R}=yl(),{menuGolonganJabatan:Z}=aa(),z=t.useCallback(async()=>{const W=sessionStorage.getItem("token")||xe("token");if(!a||!W){L(!1);return}try{L(!0);const X=await fetch(`${G}formulir/${a}/karyawan`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${W}`}});if(X.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}if(!X.ok)throw new Error(`Gagal fetch: ${X.status}`);const ae=await X.json();g(ae.data||[])}catch(X){console.error("Gagal mengambil data Karyawan:",X),g([])}finally{L(!1)}},[a]);t.useEffect(()=>{z()},[z]);const me=async W=>{try{D(W);const X=sessionStorage.getItem("token")||xe("token"),ae=await fetch(`${G}formulir/${W}/karyawan/show`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${X}`}});if(ae.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}const K=(await ae.json()).data;c(W),u(K),_(K.keterangan_jabatan||""),v(K.tanggal_keluar||""),j(K.tanggal_masuk||""),N(K.status||""),C(K.jabatan_kontrak||""),V(String(K.lembaga_id||"")),te(K.golongan_jabatan_id||"")}catch(X){console.error("Gagal mengambil detail Karyawan:",X)}finally{D(null)}};t.useEffect(()=>{if(R.length>0&&(o!=null&&o.lembaga_id)){const W=R.some(X=>String(X.value)===String(o.lembaga_id));V(W?String(o.lembaga_id):"")}},[R,o==null?void 0:o.lembaga_id]);const he=async()=>{if(!o)return;const W={lembaga_id:B,golongan_jabatan_id:ne,keterangan_jabatan:w,jabatan:T,tanggal_mulai:S,tanggal_akhir:f||null};if(!W.lembaga_id||!W.golongan_jabatan_id||!w||!S){alert("Lembaga, Golongan Jabatan, Keterangan Jabatan, dan Tanggal Mulai wajib diisi!");return}try{E(!0);const X=sessionStorage.getItem("token")||xe("token"),ae=await fetch(`${G}formulir/${h}/karyawan`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${X}`},body:JSON.stringify(W)});if(ae.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}const O=await ae.json();ae.ok?(alert("Data karyawan berhasil diperbarui!"),z()):alert("Gagal update: "+(O.message||"Terjadi kesalahan"))}catch(X){console.error("Error saat update:",X),alert("Terjadi kesalahan saat update data.")}finally{E(!1)}},U=W=>{if(!W)return"";const X={year:"numeric",month:"short",day:"2-digit"};return new Date(W).toLocaleDateString("id-ID",X)},q=()=>i(!1),se=(W=null)=>{c(W),i(!0)},Y=()=>d(!1),de=W=>{c(W),F(2),se(W),console.log("handlePindahJabatan called with karyawanId:",W)},oe=W=>{c(W),d(!0)};return e.jsxs("div",{className:"block",id:"Karyawan",children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center justify-between",children:["Karyawan",e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>{F(1),se()},type:"button",className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Tambah"})]})})]}),e.jsx(kl,{isOpen:b,onClose:q,biodataId:a,refetchData:z,feature:P,karyawanIdToPindah:h}),e.jsx(fl,{isOpen:m,onClose:Y,id:h,refetchData:z}),e.jsx("div",{className:"mt-5 space-y-6",children:M?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):p.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"Tidak ada data"}):p.map(W=>{var X,ae,O,K;return e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6 cursor-pointer w-full flex flex-col items-start gap-2",onClick:()=>me(W.id),children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-bold",children:W.keterangan_jabatan}),e.jsxs("p",{className:"text-gray-600 text-sm",children:[((X=W.lembaga)==null?void 0:X.nama)||((ae=R.find(A=>A.id===String(W.lembaga_id)))==null?void 0:ae.label)||"-"," | "," ",((O=W.golongan_jabatan)==null?void 0:O.nama)||((K=Z.find(A=>A.id===String(W.golongan_jabatan_id)))==null?void 0:K.label)||"-"]}),e.jsx("p",{className:"text-gray-600 text-sm",children:W.jabatan_kontrak||"-"}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Sejak: ",U(W.tanggal_masuk),W.tanggal_keluar?` s/d ${U(W.tanggal_keluar)}`:" - Sekarang"]})]}),e.jsx("span",{className:`text-sm font-semibold capitallize px-3 py-1 rounded-full ${W.status==="aktif"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:W.status})]}),!W.tanggal_keluar&&W.status==="aktif"&&e.jsxs("div",{className:`flex flex-wrap gap-2 gap-x-4 ${n||x?"":"mt-2"}`,children:[e.jsx(ye,{action:"pindah",children:e.jsxs("button",{type:"button",onClick:A=>{A.stopPropagation(),de(W.id)},className:"text-blue-600 hover:text-blue-800 flex items-center gap-1 cursor-pointer",title:"Pindah Jabatan",children:[e.jsx(ge,{icon:na})," Pindah"]})}),e.jsx(ye,{action:"keluar",children:e.jsxs("button",{type:"button",onClick:A=>{A.stopPropagation(),oe(W.id)},className:"text-yellow-600 hover:text-yellow-800 flex items-center gap-1 cursor-pointer",title:"Keluar Jabatan",children:[e.jsx(ge,{icon:Ve})," Keluar"]})})]})]}),I===W.id?e.jsx("div",{className:"flex justify-center items-center mt-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):h===W.id&&o&&e.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 p-4 border border-gray-200 rounded-md bg-gray-50",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Lembaga *"}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||(o==null?void 0:o.status)!=="aktif"?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,value:B,onChange:A=>V(A.target.value),disabled:!r||(o==null?void 0:o.status)!=="aktif",children:R.map(A=>e.jsxs("option",{value:A.value,children:[" ",A.label]},A.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Golongan Jabatan *"}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||(o==null?void 0:o.status)!=="aktif"?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,value:ne,onChange:A=>te(A.target.value),disabled:!r||(o==null?void 0:o.status)!=="aktif",children:Z.map(A=>e.jsxs("option",{value:A.id,children:[" ",A.label]},A.id))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"keteranganJabatan",className:"block text-sm font-medium text-gray-700",children:"Keterangan Jabatan *"}),e.jsx("input",{type:"text",id:"keteranganJabatan",value:w,onChange:A=>_(A.target.value),className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||(o==null?void 0:o.status)!=="aktif"?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,disabled:!r||(o==null?void 0:o.status)!=="aktif"})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"jabatanKontrak",className:"block text-sm font-medium text-gray-700",children:"Jenis Kontrak"}),e.jsxs("select",{id:"jabatanKontrak",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||(o==null?void 0:o.status)!=="aktif"?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,value:T,onChange:A=>C(A.target.value),disabled:!r||(o==null?void 0:o.status)!=="aktif",children:[e.jsx("option",{value:"",children:"Pilih Jenis Kontrak"}),e.jsx("option",{value:"kultural",children:"Kultural"}),e.jsx("option",{value:"tetap",children:"Tetap"}),e.jsx("option",{value:"kontrak",children:"Kontrak"}),e.jsx("option",{value:"pengkaderan",children:"Pengkaderan"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Mulai *"}),e.jsx("input",{type:"date",id:"startDate",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||(o==null?void 0:o.status)!=="aktif"?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,disabled:!r||(o==null?void 0:o.status)!=="aktif",value:S,onChange:A=>j(A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Akhir"}),e.jsx("input",{type:"date",id:"endDate",className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-gray-200 text-gray-500 cursor-not-allowed",value:f,onChange:A=>v(A.target.value),disabled:!0})]})]}),e.jsx("div",{className:"col-span-full",children:e.jsxs("div",{className:"flex space-x-2 mt-2",children:[(o==null?void 0:o.status)==="aktif"&&e.jsx(ye,{action:"edit",children:e.jsx("button",{type:"button",disabled:Q,className:`px-4 py-2 text-white rounded-lg ${Q?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 cursor-pointer"}`,onClick:he,children:Q?e.jsx("i",{className:"fas fa-spinner fa-spin text-white"}):"Update"})}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none cursor-pointer",onClick:()=>{c(null),u(null),_(""),j(""),v(""),N(""),C(""),V(""),te("")},children:"Batal"})]})})]})]},W.id)})})]})},vl=({biodata_id:a,setShowAddModal:s,setFeature:l})=>{const{clearAuthData:r}=ke(),[n,x]=t.useState([]),[b,i]=t.useState([]),[m,d]=t.useState([]),[p,g]=t.useState(!1),[h,c]=t.useState(null),[o,u]=t.useState(null),[w,_]=t.useState(""),[f,v]=t.useState(""),[S,j]=t.useState(""),[y,N]=t.useState(""),[T,C]=t.useState(!1),P=sessionStorage.getItem("token")||xe("token"),F=t.useCallback(async()=>{try{g(!0),C(!1);const I=await fetch(`${G}formulir/${a}/keluarga`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P}`}});if(I.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r();return}if(!I.ok)throw new Error(`HTTP error! status: ${I.status}`);const D=await I.json();x(D.data.no_kk||[]),i(D.data.relasi_keluarga||[]),d(D.data.relasi_keluarga[0].id_keluarga||[])}catch(I){console.error("Gagal memuat data keluarga:",I),C(!0),k.fire({icon:"error",title:"Error",text:"Gagal memuat data keluarga"})}finally{g(!1)}},[a,P]);t.useEffect(()=>{F()},[F]);const M=t.useCallback(async I=>{c(I);try{const D=await fetch(`${G}formulir/${I}/keluarga/show`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P}`}});if(D.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r();return}const Q=await D.json();u(I),_(Q.data),v(Q.data.biodata_id),j(Q.data.no_kk),N(Q.data.hubungan)}catch(D){console.error("Gagal memuat detail keluarga:",D),C(!0),k.fire({icon:"error",title:"Error",text:"Gagal memuat detail keluarga"})}finally{c(null)}},[P]),L=t.useCallback(async()=>{if(!w||!o){k.fire({icon:"warning",title:"Peringatan",text:"Data keluarga tidak valid atau belum dipilih"});return}k.fire({title:"Mohon tunggu...",html:"Sedang memperbarui data keluarga.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});try{const I={biodata_id:f,nama:w.nama,no_kk:S,hubungan:y},D=await fetch(`${G}formulir/${o}/keluarga`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P}`},body:JSON.stringify(I)});if(D.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r();return}const Q=await D.json();if(k.close(),D.ok&&Q.success)k.fire({icon:"success",title:"Berhasil",text:"Data keluarga berhasil diperbarui!",timer:2e3,showConfirmButton:!1}),F();else throw new Error(Q.message||"Gagal memperbarui data keluarga")}catch(I){console.error("Gagal memperbarui data keluarga:",I),k.fire({icon:"error",title:"Error",text:I.message||"Terjadi kesalahan saat memperbarui data keluarga"})}},[w,o,f,S,y,P,F]);return{error:T,nokk:n,keluargaList:b,id1:m,loadingKeluarga:p,selectedKeluargaId:o,selectedKeluargaDetail:w,loadingDetailKeluargaId:h,biodataKeluargaId:f,nomorkk:S,hubungan:y,setNokk:x,setSelectedKeluargaId:u,setSelectedKeluargaDetail:_,setBiodataKeluargaId:v,setNomorkk:j,setHubungan:N,fetchKeluargaList:F,handleCardClick:M,handleUpdate:L,setShowAddModal:s,setFeature:l}},La={negara:"",provinsi:"",kabupaten:"",kecamatan:"",jalan:"",kode_pos:"",nama:"",no_passport:"",tanggal_lahir:"",jenis_kelamin:"",tempat_lahir:"",nik:"",no_telepon:"",no_telepon_2:"",email:"",jenjang_pendidikan_terakhir:"",nama_pendidikan_terakhir:"",anak_keberapa:"",dari_saudara:"",wafat:"0",no_kk:"",id_hubungan_keluarga:"",wali:!1,pekerjaan:"",penghasilan:""},Nl=({isOpen:a,onClose:s,refetchData:l})=>{const{clearAuthData:r}=ke(),{filterNegara:n,selectedNegara:x,handleFilterChangeNegara:b}=Ae(),[i,m]=t.useState(La),[d,p]=t.useState([]);t.useEffect(()=>{a&&(async()=>{try{const f=sessionStorage.getItem("token")||xe("token"),v=await fetch(`${G}dropdown/hubungan`,{headers:{Authorization:`Bearer ${f}`}});if(v.status===401){r();return}if(v.ok){const S=await v.json();p(S.map(j=>({value:j.id,label:j.nama_status})))}}catch(f){console.error("Failed to fetch hubungan keluarga:",f)}})()},[a]),t.useEffect(()=>{a&&m(_=>({..._,negara:x.negara||"",provinsi:x.provinsi||"",kabupaten:x.kabupaten||"",kecamatan:x.kecamatan||""}))},[x,a]);const g=_=>{const{name:f,value:v,type:S,checked:j}=_.target;m(y=>({...y,[f]:S==="checkbox"?j:v}))},h=async _=>{if(_.preventDefault(),["negara","jalan","nama","tanggal_lahir","jenis_kelamin","tempat_lahir","email","id_hubungan_keluarga","wafat"].some(y=>!i[y])){await k.fire({icon:"error",title:"Data tidak lengkap",text:"Harap isi semua field yang wajib diisi."});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email)){await k.fire({icon:"error",title:"Email tidak valid",text:"Harap masukkan email yang valid."});return}if((await k.fire({title:"Yakin ingin menambahkan data orangtua?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, Tambah",cancelButtonText:"Batal"})).isConfirmed)try{const y=sessionStorage.getItem("token")||xe("token"),N=await fetch(`${G}formulir/orangtua`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify(i)});if(console.log("Response status:",N.status),console.log("Response headers:",N.headers),console.log("payload:",JSON.stringify(i,null,2)),console.log("formdata:",i),N.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r();return}const T=await N.json();if(!N.ok)throw new Error(T.message||"Terjadi kesalahan pada server.");await k.fire({icon:"success",title:"Berhasil!",text:"Data orangtua berhasil ditambahkan."}),m(La),b({negara:"",provinsi:"",kabupaten:"",kecamatan:""}),l==null||l(),s==null||s()}catch(y){console.error("Terjadi kesalahan:",y),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}},c=()=>{m(La),b({negara:"",provinsi:"",kabupaten:"",kecamatan:""}),s&&s()},o=(_,f)=>_.length>0?[{..._[0],label:f},..._.slice(1)]:_,u={negara:o(n.negara,"Pilih Negara"),provinsi:o(n.provinsi,"Pilih Provinsi"),kabupaten:o(n.kabupaten,"Pilih Kabupaten"),kecamatan:o(n.kecamatan,"Pilih Kecamatan")},w=({filterOptions:_,onChange:f,selectedFilters:v})=>{const S=j=>j.charAt(0).toUpperCase()+j.slice(1);return e.jsx("div",{className:"space-y-2",children:Object.entries(_).map(([j,y],N)=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsxs("label",{htmlFor:j,className:"md:w-1/4 text-black",children:[S(j)," *"]}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:`flex items-center rounded-md shadow-md border border-gray-300 border-gray-500 ${y.length<=1?"bg-gray-200 text-gray-500":""}`,children:e.jsx("select",{id:j,name:j,required:!0,disabled:y.length<=1,className:`w-full py-1.5 pr-3 pl-1 text-base focus:outline-none sm:text-sm ${y.length<=1?"text-gray-500":""}`,value:v[j]||"",onChange:T=>f({[j]:T.target.value}),children:y.map((T,C)=>e.jsx("option",{value:T.value,children:T.label},C))})})})]},`${j}-${N}`))})};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:c,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-2xl sm:align-middle max-h-[90vh]",children:[e.jsx("button",{onClick:c,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:h,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Tambah Data Orangtua"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold mb-2",children:"Biodata Orangtua"}),e.jsxs("div",{className:"space-y-4 pl-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_passport",className:"md:w-1/4 text-black",children:"Nomor Passport"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_passport",name:"no_passport",type:"text",value:i.no_passport,onChange:g,maxLength:16,placeholder:"Masukkan No.Passport",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_kk",className:"md:w-1/4 text-black",children:"Nomor KK"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_kk",name:"no_kk",type:"text",value:i.no_kk,onChange:g,maxLength:16,placeholder:"Masukkan No.KK",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nik",className:"md:w-1/4 text-black",children:"NIK"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nik",name:"nik",type:"text",value:i.nik,onChange:g,maxLength:16,placeholder:"Masukkan NIK",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama",className:"md:w-1/4 text-black",children:"Nama Lengkap *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama",name:"nama",type:"text",value:i.nama,onChange:g,placeholder:"Masukkan Nama Lengkap",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{className:"md:w-1/4 text-black",children:"Jenis Kelamin *"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"jenis_kelamin",value:"l",checked:i.jenis_kelamin==="l",onChange:g,className:"w-4 h-4",required:!0}),e.jsx("span",{children:"Laki-laki"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"jenis_kelamin",value:"p",checked:i.jenis_kelamin==="p",onChange:g,className:"w-4 h-4",required:!0}),e.jsx("span",{children:"Perempuan"})]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tempat_lahir",className:"md:w-1/4 text-black",children:"Tempat Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"tempat_lahir",name:"tempat_lahir",type:"text",value:i.tempat_lahir,onChange:g,placeholder:"Masukkan Tempat Lahir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"tanggal_lahir",className:"md:w-1/4 text-black",children:"Tanggal Lahir *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{type:"date",id:"tanggal_lahir",name:"tanggal_lahir",value:i.tanggal_lahir,onChange:g,className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"anak_keberapa",className:"md:w-1/4 text-black",children:"Anak Ke *"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"anak_keberapa",name:"anak_keberapa",type:"number",min:"1",value:i.anak_keberapa,onChange:g,className:"w-13 py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",required:!0})}),e.jsx("span",{children:"Dari"}),e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"dari_saudara",name:"dari_saudara",type:"number",min:"1",value:i.dari_saudara,onChange:g,className:"w-13 py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",required:!0})})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"email",className:"md:w-1/4 text-black",children:"Email *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"email",name:"email",type:"email",value:i.email,onChange:g,placeholder:"Masukkan Email",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon",className:"md:w-1/4 text-black",children:"No Telepon 1"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon",name:"no_telepon",type:"tel",value:i.no_telepon,onChange:g,maxLength:20,placeholder:"Masukkan No Telepon",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"no_telepon_2",className:"md:w-1/4 text-black",children:"No Telepon 2"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"no_telepon_2",name:"no_telepon_2",type:"tel",value:i.no_telepon_2,onChange:g,maxLength:20,placeholder:"Masukkan No Telepon 2",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jenjang_pendidikan_terakhir",className:"md:w-1/4 text-black",children:"Jenjang Pendidikan Terakhir"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsxs("select",{id:"jenjang_pendidikan_terakhir",name:"jenjang_pendidikan_terakhir",value:i.jenjang_pendidikan_terakhir,onChange:g,className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"paud",children:"Paud"}),e.jsx("option",{value:"sd/mi",children:"SD/MI"}),e.jsx("option",{value:"smp/mts",children:"SMP/MTS"}),e.jsx("option",{value:"sma/smk/ma",children:"SMA/SMK/MA"}),e.jsx("option",{value:"d3",children:"D3"}),e.jsx("option",{value:"d4",children:"D4"}),e.jsx("option",{value:"s1",children:"S1"}),e.jsx("option",{value:"s2",children:"S2"})]})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"nama_pendidikan_terakhir",className:"md:w-1/4 text-black",children:"Nama Pendidikan Terakhir"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"nama_pendidikan_terakhir",name:"nama_pendidikan_terakhir",type:"text",value:i.nama_pendidikan_terakhir,onChange:g,placeholder:"Masukkan Nama Pendidikan Terakhir",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm"})})})]})]})]}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold mb-2",children:"Data Orangtua"}),e.jsxs("div",{className:"space-y-4 pl-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"id_hubungan_keluarga",className:"md:w-1/4 text-black",children:"Hubungan Keluarga *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsxs("select",{id:"id_hubungan_keluarga",name:"id_hubungan_keluarga",value:i.id_hubungan_keluarga,onChange:g,className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 focus:outline-none sm:text-sm",children:[e.jsx("option",{value:"",children:"Pilih Hubungan"}),d.map((_,f)=>e.jsx("option",{value:_.value,children:_.label},f))]})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"wali",className:"md:w-1/4 text-black",children:"Wali"}),e.jsx("div",{className:"flex items-center",children:e.jsx("input",{id:"wali",name:"wali",type:"checkbox",checked:i.wali,onChange:g,className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"pekerjaan",className:"md:w-1/4 text-black",children:"Pekerjaan"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"pekerjaan",name:"pekerjaan",type:"text",value:i.pekerjaan,onChange:g,placeholder:"Masukkan Pekerjaan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"penghasilan",className:"md:w-1/4 text-black",children:"Penghasilan"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"penghasilan",name:"penghasilan",type:"text",value:i.penghasilan,onChange:g,placeholder:"Masukkan Penghasilan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm"})})})]})]})]}),e.jsx("hr",{className:"border-t border-gray-300 my-4"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold mb-2",children:"Alamat"}),e.jsxs("div",{className:"space-y-4 pl-4",children:[e.jsx(w,{filterOptions:u,onChange:b,selectedFilters:x}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"jalan",className:"md:w-1/4 text-black",children:"Jalan *"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"jalan",name:"jalan",type:"text",value:i.jalan,onChange:g,placeholder:"Masukkan Nama Jalan",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm",required:!0})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{htmlFor:"kode_pos",className:"md:w-1/4 text-black",children:"Kode Pos"}),e.jsx("div",{className:"md:w-full md:max-w-md max-w-none",children:e.jsx("div",{className:"flex items-center rounded-md shadow-md bg-white pl-1 border border-gray-300 border-gray-500",children:e.jsx("input",{id:"kode_pos",name:"kode_pos",type:"text",value:i.kode_pos,onChange:g,maxLength:10,placeholder:"Masukkan Kode Pos",className:"w-full py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm"})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("label",{className:"md:w-1/4 text-black",children:"Wafat *"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"wafat",value:"0",checked:i.wafat==="0",onChange:g,className:"w-4 h-4",required:!0}),e.jsx("span",{children:"Tidak"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"wafat",value:"1",checked:i.wafat==="1",onChange:g,className:"w-4 h-4",required:!0}),e.jsx("span",{children:"Ya"})]})]})]})]})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Tambah Data"}),e.jsx("button",{type:"button",onClick:c,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Batal"})]})]})]})})})]})})},_l=({isOpen:a,onClose:s,id:l,refetchData:r})=>{const{clearAuthData:n}=ke(),[x,b]=t.useState({no_kk:""}),i=d=>/^\d{16}$/.test(d),m=async d=>{if(d.preventDefault(),!i(x.no_kk)){await k.fire({icon:"error",title:"Format KK Tidak Valid",text:"Nomor KK harus terdiri dari 16 digit angka"});return}if(!(!(await k.fire({title:"Anda yakin dengan nomor KK baru?",text:`Nomor KK baru: ${x.no_kk}`,icon:"question",showCancelButton:!0,confirmButtonText:"Ya, lanjutkan",cancelButtonText:"Periksa kembali"})).isConfirmed||!(await k.fire({title:"Konfirmasi Terakhir",html:`<div style="text-align: left;">
                     <p>Anda akan memindahkan keluarga ke KK baru:</p>
                     <p><strong>${x.no_kk}</strong></p>
                     <p>Pastikan data sudah benar!</p>
                   </div>`,icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, saya yakin",cancelButtonText:"Batal"})).isConfirmed))try{k.fire({title:"Mohon tunggu...",html:"Sedang memproses pemindahan keluarga.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const h=sessionStorage.getItem("token")||xe("token"),c=await fetch(`${G}formulir/${l}/keluarga/pindah`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify(x)});if(c.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n();return}const o=await c.json();if(k.close(),!c.ok)throw new Error(o.message||"Terjadi kesalahan pada server.");if(!("data"in o)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${o.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:`Keluarga berhasil dipindahkan ke KK ${x.no_kk}`}),r==null||r(),s==null||s(),b({no_kk:""})}catch(h){console.error("Terjadi kesalahan:",h),await k.fire({icon:"error",title:"Oops!",text:`Terjadi kesalahan saat memproses data. ${h.message}`})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:m,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Pindah Keluarga ke KK Baru"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"no_kk",className:"block text-gray-700",children:"Nomor KK Baru *"}),e.jsx("input",{type:"text",id:"no_kk",name:"no_kk",value:x.no_kk,onChange:d=>b({...x,no_kk:d.target.value}),required:!0,placeholder:"Masukkan 16 digit nomor KK",maxLength:16,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Harus terdiri dari 16 digit angka"})]})})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Proses Pemindahan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Batal"})]})]})]})})})]})})},Sl=()=>{const{biodata_id:a}=Ue(),s=Ke("edit"),[l,r]=t.useState(!1),[n,x]=t.useState(!1),{error:b,nokk:i,keluargaList:m,id1:d,loadingKeluarga:p,selectedKeluargaId:g,setSelectedKeluargaId:h,selectedKeluargaDetail:c,setSelectedKeluargaDetail:o,loadingDetailKeluargaId:u,hubungan:w,setHubungan:_,fetchKeluargaList:f,handleCardClick:v}=vl({biodata_id:a}),S=()=>{r(!0)};return e.jsxs("div",{className:"block",id:"keluarga",children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center justify-between",children:["Relasi Keluarga",e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:S,type:"button",className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Tambah"})]})})]}),e.jsx(Nl,{isOpen:l,onClose:()=>r(!1),refetchData:f}),e.jsx(_l,{isOpen:n,onClose:()=>x(!1),id:d,refetchData:f}),e.jsx("br",{}),e.jsx("div",{className:"mt-5 space-y-6",children:p?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):b?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:f,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Coba Lagi"})]}):m.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"Tidak ada data keluarga"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white shadow-md drop-shadow rounded-lg p-4 w-fit flex justify-between items-center gap-2",children:e.jsxs("h2",{className:"text-md font-bold",children:["No.KK ",i||"-"]})}),m.filter(j=>!j.is_selected).map(j=>e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white shadow-lg drop-shadow rounded-lg p-6 cursor-pointer w-full flex justify-between items-center",onClick:()=>v(j.id_keluarga),children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-bold",children:j.nama}),e.jsxs("p",{className:"text-gray-600 text-sm",children:[j.nik," - ",j.status_keluarga]})]}),e.jsx("span",{className:`text-sm font-semibold px-3 py-1 rounded-full ${j.sebagai_wali===1?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:j.sebagai_wali===1?"Sebagai Wali":""})]}),u===j.id_keluarga?e.jsx("div",{className:"flex justify-center items-center mt-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):g===j.id_keluarga&&c&&e.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 bg-white shadow-md rounded-lg p-6",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"nama",className:"block text-sm font-medium text-gray-700",children:"Nama"}),e.jsx("input",{type:"text",id:"nama",className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-gray-200 text-gray-500",value:c.nama,disabled:!0})]}),e.jsxs("div",{className:"w-xs",children:[e.jsx("label",{htmlFor:"hubungan",className:"block text-sm font-medium text-gray-700",children:"Hubungan"}),e.jsx("input",{type:"text",id:"hubungan",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${s?"":"bg-gray-200 text-gray-500"}`,value:w??"Saudara",onChange:y=>_(y.target.value),disabled:!0})]})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex space-x-2 mt-1",children:[e.jsx(Ye,{to:`/formulir/${c.biodata_id}/biodata`,children:e.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 cursor-pointer",children:"Buka di Formulir"})}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none cursor-pointer",onClick:()=>{h(null),o(null)},children:"Batal"})]})})]})]},j.id_keluarga))]})})]})},Tl=({isOpen:a,onClose:s,biodataId:l,dataId:r,feature:n,refetchData:x})=>{const{clearAuthData:b}=ke(),i=je(),m=n==1,d=m?"khadam":"khadam/pindah",p=m?"POST":"PUT",g=m?l:r,[h,c]=t.useState({keterangan:"",tanggal_mulai:""}),o=async u=>{if(u.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const _=sessionStorage.getItem("token")||xe("token"),f=await fetch(`${G}formulir/${g}/${d}`,{method:p,headers:{"Content-Type":"application/json",Authorization:`Bearer ${_}`},body:JSON.stringify(h)});if(k.close(),f.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),b(),i("/login");return}const v=await f.json();if(!f.ok)throw new Error(v.message||"Terjadi kesalahan pada server.");if(!("data"in v)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${v.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),x==null||x(),s==null||s()}catch(_){console.error("Terjadi kesalahan:",_),await k.fire({icon:"error",title:"Oops!",text:`Terjadi kesalahan saat mengirim data. ${_}`})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:o,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:n==1?"Tambah Data Baru":"Pindah"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"keterangan",className:"block text-gray-700",children:"Keterangan *"}),e.jsx("input",{type:"text",id:"nis",name:"nis",value:h.keterangan,onChange:u=>c({...h,keterangan:u.target.value}),maxLength:255,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Masukkan Keterangan"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_mulai",className:"block text-gray-700",children:"Tanggal Mulai *"}),e.jsx("input",{type:"date",id:"tanggal_mulai",name:"tanggal_mulai",value:h.tanggal_mulai,onChange:u=>c({...h,tanggal_mulai:u.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},Pl=({isOpen:a,onClose:s,id:l,refetchData:r})=>{const{clearAuthData:n}=ke(),x=je(),[b,i]=t.useState({tanggal_akhir:""}),m=async d=>{if(d.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const g=sessionStorage.getItem("token")||xe("token"),h=await fetch(`${G}formulir/${l}/khadam/keluar`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify(b)}),c=await h.json();if(k.close(),h.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}if(!h.ok)throw new Error(c.message||"Terjadi kesalahan pada server.");if(!("data"in c)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${c.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),r==null||r(),s==null||s()}catch(g){console.error("Terjadi kesalahan:",g),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:m,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Masukkan Tanggal"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_akhir",className:"block text-gray-700",children:"Tanggal Akhir *"}),e.jsx("input",{type:"datetime-local",id:"tanggal_akhir",name:"tanggal_akhir",value:b.tanggal_akhir,onChange:d=>i({...b,tanggal_akhir:d.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},Cl=({biodata_id:a,setShowAddModal:s,setFeature:l})=>{const{clearAuthData:r}=ke(),n=je(),[x,b]=t.useState([]),[i,m]=t.useState(!1),[d,p]=t.useState(null),[g,h]=t.useState(null),[c,o]=t.useState(null),[u,w]=t.useState(""),[_,f]=t.useState(""),[v,S]=t.useState(""),[j,y]=t.useState(null),N=sessionStorage.getItem("token")||xe("token"),T=t.useCallback(async()=>{if(!(!a||!N))try{y(null),m(!0);const M=await fetch(`${G}formulir/${a}/khadam`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`}});if(M.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r(),n("/login");return}if(M.status===403)throw new Error("403");if(!M.ok)throw new Error(`Gagal fetch: ${M.status}`);const L=await M.json();b(L.data||[]),y(null)}catch(M){M.message==403?y("Akses ditolak: Anda tidak memiliki izin untuk melihat data ini."):y("Terjadi kesalahan saat mengambil data."),console.error("Gagal mengambil data Khadam:",j)}finally{m(!1)}},[a,N]);return t.useEffect(()=>{T()},[T]),{error:j,khadamList:x,loadingKhadam:i,fetchKhadam:T,handleCardClick:async M=>{try{p(M);const L=await fetch(`${G}formulir/${M}/khadam/show`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`}});if(L.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r(),n("/login");return}const I=await L.json();h(M),o(I.data),f(I.data.tanggal_akhir||""),w(I.data.tanggal_mulai||""),S(I.data.keterangan||"")}catch(L){console.error("Gagal mengambil detail Khadam:",L)}finally{p(null)}},loadingDetailKhadamId:d,selectedKhadamDetail:c,setSelectedKhadamDetail:o,selectedKhadamId:g,setSelectedKhadamId:h,startDate:u,endDate:_,keterangan:v,setStartDate:w,setEndDate:f,setKeterangan:S,handleUpdate:async()=>{if(!c)return;const M={keterangan:v||null,tanggal_mulai:u};try{k.fire({title:"Mohon tunggu...",html:"Sedang memperbarui data khadam.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const L=await fetch(`${G}formulir/${g}/khadam`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},body:JSON.stringify(M)});if(L.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r(),n("/login");return}const I=await L.json();k.close(),L.ok?(k.fire({icon:"success",title:"Berhasil",text:"Data berhasil diperbarui!",timer:2e3,showConfirmButton:!1}),o(I.data||M),T()):k.fire({icon:"error",title:"Gagal update",text:I.message||"Terjadi kesalahan saat memperbarui data"})}catch(L){console.error("Error saat update:",L),k.fire({icon:"error",title:"Error",text:"Terjadi kesalahan saat mengirim permintaan"})}},handleOpenAddModalWithDetail:async(M,L)=>{try{h(M),l(L),s(!0)}catch(I){console.error("Gagal mengambil detail Khadam:",I)}}}},Fl=()=>{const{biodata_id:a}=Ue(),s=Ke("edit"),l=Ke("pindah"),r=Ke("keluar"),[n,x]=t.useState(!1),[b,i]=t.useState(!1),[m,d]=t.useState(null),{error:p,khadamList:g,loadingKhadam:h,fetchKhadam:c,handleCardClick:o,loadingDetailKhadamId:u,selectedKhadamDetail:w,setSelectedKhadamDetail:_,selectedKhadamId:f,setSelectedKhadamId:v,startDate:S,endDate:j,keterangan:y,setStartDate:N,setEndDate:T,setKeterangan:C,handleUpdate:P,handleOpenAddModalWithDetail:F}=Cl({biodata_id:a,setShowAddModal:x,setFeature:d}),M=()=>{x(!1)},L=()=>{x(!0)},I=()=>{i(!1)},D=E=>{v(E),i(!0)},Q=E=>{const B={year:"numeric",month:"short",day:"2-digit"};return new Date(E).toLocaleDateString("id-ID",B)};return e.jsxs("div",{className:"block",id:"khadam",children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center justify-between",children:["Status Khadam",e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>{d(1),L()},type:"button",className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Tambah"})]})})]}),e.jsx(Tl,{isOpen:n,onClose:M,biodataId:a,feature:m,dataId:f,refetchData:c}),e.jsx(Pl,{isOpen:b,onClose:I,id:f,refetchData:c}),e.jsx("div",{className:"mt-5 space-y-6",children:h?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):p?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:p}),p.includes("Akses ditolak")?null:e.jsx("button",{onClick:c,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Coba Lagi"})]}):g.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"Tidak ada data"}):g.map(E=>e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white shadow-lg drop-shadow rounded-lg p-6 cursor-pointer w-full flex flex-col items-start gap-2",onClick:()=>{o(E.id)},children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-bold",children:E.keterangan}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Sejak ",Q(E.tanggal_mulai)," ","Sampai ",E.tanggal_akhir?Q(E.tanggal_akhir):"Sekarang"]})]}),e.jsx("span",{className:`text-sm font-semibold capitalize px-3 py-1 rounded-full ${E.status===1?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:E.status||"-"})]}),!E.tanggal_akhir&&e.jsxs("div",{className:`flex flex-wrap gap-2 gap-x-4 ${l||r?"":"mt-2"}`,children:[e.jsx(ye,{action:"pindah",children:e.jsxs("button",{type:"button",onClick:B=>{B.stopPropagation(),F(E.id,2)},className:"text-blue-600 hover:text-blue-800 flex items-center gap-1 cursor-pointer",title:"Pindah Khadam",children:[e.jsx(ge,{icon:na}),"Pindah"]})}),e.jsx(ye,{action:"keluar",children:e.jsxs("button",{type:"button",onClick:B=>{B.stopPropagation(),D(E.id)},className:"justify-end text-yellow-600 hover:text-yellow-800 flex items-center gap-1 cursor-pointer",title:"Keluar Khadam",children:[e.jsx(ge,{icon:Ve}),"Keluar"]})})]})]}),u===E.id?e.jsx("div",{className:"flex justify-center items-center mt-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):f===E.id&&w&&e.jsxs("form",{className:"grid grid-cols-1 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"keterangan",className:"block text-sm font-medium text-gray-700",children:"Keterangan"}),e.jsx("input",{type:"text",id:"keterangan",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!s||w.status===0?"bg-gray-200 text-gray-500":""}`,value:y,maxLength:255,onChange:B=>C(B.target.value),disabled:!s||(w==null?void 0:w.status)===0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Mulai"}),e.jsx("input",{type:"date",id:"startDate",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!s||w.status===0?"bg-gray-200 text-gray-500":""}`,value:S,onChange:B=>N(B.target.value),disabled:!s||(w==null?void 0:w.status)===0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Akhir"}),e.jsx("input",{type:"date",id:"endDate",className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-gray-200 text-gray-500",value:j,onChange:B=>T(B.target.value),disabled:!0})]})]}),e.jsxs("div",{className:"flex space-x-2 mt-1",children:[E.status===1&&e.jsx(ye,{action:"edit",children:e.jsx("button",{type:"button",className:"px-4 py-2 text-white rounded-lg hover:bg-blue-700 focus:outline-none bg-blue-600 hover:bg-blue-700 cursor-pointer",onClick:P,children:"Update"})}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none cursor-pointer",onClick:()=>{v(null),_(null),N(""),T("")},children:"Batal"})]})]})]},E.id))})]})},$l=({filterOptions:a,onChange:s,selectedFilters:l})=>{const r=n=>n.charAt(0).toUpperCase()+n.slice(1);return e.jsx("div",{className:"flex flex-col gap-4 w-full",children:Object.entries(a).map(([n,x],b)=>e.jsxs("div",{children:[e.jsxs("label",{htmlFor:n,className:"block text-gray-700",children:[r(n)," ",n==="lembaga"?"*":""]}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:i=>s({[n]:i.target.value}),value:l[n]||"",disabled:x.length<=1,children:x.map((i,m)=>e.jsx("option",{value:i.value,children:i.label},m))})]},`${n}-${b}`))})},Al=({isOpen:a,onClose:s,biodataId:l,cardId:r,refetchData:n,feature:x})=>{const{menuAngkatanPelajar:b}=da(),{clearAuthData:i}=ke(),m=je(),{filterLembaga:d,handleFilterChangeLembaga:p,selectedLembaga:g}=Te(),h=(j,y)=>j.length>0?[{...j[0],label:y},...j.slice(1)]:j,c={lembaga:h(d.lembaga,"Pilih Lembaga"),jurusan:h(d.jurusan,"Pilih Jurusan"),kelas:h(d.kelas,"Pilih Kelas"),rombel:h(d.rombel,"Pilih Rombel")},o=x==1,u=o?"pendidikan":"pendidikan/pindah",w=o?"POST":"PUT",_=o?l:r,[f,v]=t.useState({lembaga_id:"",jurusan_id:"",kelas_id:"",rombel_id:"",no_induk:"",angkatan_id:"",tanggal_masuk:""});t.useEffect(()=>{a&&(v({lembaga_id:"",jurusan_id:"",kelas_id:"",rombel_id:"",no_induk:"",angkatan_id:"",tanggal_masuk:""}),p({lembaga:"",jurusan:"",kelas:"",rombel:""}))},[a]),t.useEffect(()=>{v(j=>({...j,lembaga_id:g.lembaga||"",jurusan_id:g.jurusan||"",kelas_id:g.kelas||"",rombel_id:g.rombel||""}))},[g]);const S=async j=>{var N,T;if(j.preventDefault(),!f.lembaga_id||!f.no_induk||!f.tanggal_masuk){await k.fire({icon:"error",title:"Data tidak lengkap",text:"Lembaga, Nomor Induk, dan Tanggal Mulai wajib diisi"});return}if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),console.log("formData:",f),console.log("id:",_);const C=sessionStorage.getItem("token")||xe("token"),P=await fetch(`${G}formulir/${_}/${u}`,{method:w,headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},body:JSON.stringify(f)});if(k.close(),P.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),i(),m("/login");return}const F=await P.json();if(!P.ok){if((T=(N=F==null?void 0:F.errors)==null?void 0:N.no_induk)!=null&&T.includes("validation.unique")){await k.fire({icon:"error",title:"Nomor Induk Duplikat",text:"Nomor Induk sudah digunakan. Silakan gunakan nomor lain."});return}throw new Error(F.message||"Terjadi kesalahan pada server.")}if(!("data"in F)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: center;">${F.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data pendidikan berhasil disimpan."}),n==null||n(),s==null||s()}catch(C){console.error("Terjadi kesalahan:",C),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:S,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:o?"Tambah Data Pendidikan":"Pindah Pendidikan"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx($l,{filterOptions:c,onChange:p,selectedFilters:g}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"no_induk",className:"block text-gray-700",children:"Nomor Induk *"}),e.jsx("input",{type:"text",id:"no_induk",name:"no_induk",value:f.no_induk,onChange:j=>v({...f,no_induk:j.target.value}),maxLength:50,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Masukkan Nomor Induk"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"angkatan_id",className:"block text-gray-700",children:"Angkatan *"}),e.jsx("select",{className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",onChange:j=>v({...f,angkatan_id:j.target.value}),value:f.angkatan_id,required:!0,children:b.map((j,y)=>e.jsx("option",{value:j.value,children:j.label},y))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_masuk",className:"block text-gray-700",children:"Tanggal Mulai *"}),e.jsx("input",{type:"date",id:"tanggal_masuk",name:"tanggal_masuk",value:f.tanggal_masuk,onChange:j=>v({...f,tanggal_masuk:j.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Batal"})]})]})]})})})]})})},Kl=({isOpen:a,onClose:s,id:l,refetchData:r})=>{const{clearAuthData:n}=ke(),x=je(),[b,i]=t.useState({tanggal_keluar:"",status:""}),m=async d=>{var g;if(d.preventDefault(),!b.tanggal_keluar||!b.status){await k.fire({icon:"error",title:"Data tidak lengkap",text:"Tanggal keluar dan status wajib diisi"});return}if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),console.log("formData:",b);const h=sessionStorage.getItem("token")||xe("token"),c=await fetch(`${G}formulir/${l}/pendidikan/keluar`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify(b)});if(k.close(),c.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}const o=await c.json();if(console.log(o),!c.ok)throw new Error(o.message||"Terjadi kesalahan pada server.");if(o.message&&o.message.toLowerCase().includes("tidak boleh")){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${o.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data pendidikan berhasil diperbarui."}),r==null||r(),s==null||s()}catch(h){console.error("Terjadi kesalahan:",((g=h.response)==null?void 0:g.data)||h.message),console.error("Terjadi kesalahan:",h),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:m,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Masukkan Tanggal Keluar"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_keluar",className:"block text-gray-700",children:"Tanggal Keluar *"}),e.jsx("input",{type:"date",id:"tanggal_keluar",name:"tanggal_keluar",value:b.tanggal_keluar,onChange:d=>i({...b,tanggal_keluar:d.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-gray-700",children:"Status *"}),e.jsxs("select",{id:"status",name:"status",value:b.status,onChange:d=>i({...b,status:d.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Pilih Status"}),e.jsx("option",{value:"do",children:"DropOut"}),e.jsx("option",{value:"berhenti",children:"Berhenti"}),e.jsx("option",{value:"lulus",children:"Lulus"}),e.jsx("option",{value:"nonaktif",children:"Non Aktif"}),e.jsx("option",{value:"selesai",children:"Selesai"})]})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Batal"})]})]})]})})})]})})},Il=()=>{const{biodata_id:a}=Ue(),{clearAuthData:s}=ke(),l=je(),r=Ke("edit"),n=Ke("pindah"),x=Ke("keluar"),[b,i]=t.useState(!1),[m,d]=t.useState(!1),[p,g]=t.useState([]),[h,c]=t.useState(null),[o,u]=t.useState(null),[w,_]=t.useState(""),[f,v]=t.useState(null),[S,j]=t.useState(""),[y,N]=t.useState(""),[T,C]=t.useState(""),[P,F]=t.useState(null),[M,L]=t.useState(!0),[I,D]=t.useState(null),[Q,E]=t.useState(!1),{filterLembaga:B,handleFilterChangeLembaga:V,selectedLembaga:ne}=Te(),{menuAngkatanPelajar:te}=da(),R=(W,X)=>W.length>0?[{...W[0],label:X},...W.slice(1)]:W,Z={lembaga:R(B.lembaga,"Pilih Lembaga"),jurusan:R(B.jurusan,"Pilih Jurusan"),kelas:R(B.kelas,"Pilih Kelas"),rombel:R(B.rombel,"Pilih Rombel")},z=t.useCallback(async()=>{const W=sessionStorage.getItem("token")||xe("token");if(!(!a||!W))try{L(!0);const X=await fetch(`${G}formulir/${a}/pendidikan`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${W}`}});if(X.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}if(!X.ok)throw new Error(`Gagal fetch: ${X.status}`);const ae=await X.json();g(ae.data||[])}catch(X){console.error("Gagal mengambil data Pendidikan:",X)}finally{L(!1)}},[a]);t.useEffect(()=>{z()},[z]);const me=async W=>{try{D(W);const X=sessionStorage.getItem("token")||xe("token"),ae=await fetch(`${G}formulir/${W}/pendidikan/show`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${X}`}});if(ae.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}const O=await ae.json();c(W),u(O.data),_(O.data.no_induk||""),v(O.data.tanggal_keluar==="-"?null:O.data.tanggal_keluar),j(O.data.tanggal_masuk||""),C(O.data.status||""),N(O.data.nama_angkatan||""),console.log("Data from API:",O.data)}catch(X){console.error("Gagal mengambil detail Pendidikan:",X)}finally{D(null)}};t.useEffect(()=>{o&&(o.nama_lembaga&&V({lembaga:o.nama_lembaga}),o.nama_jurusan&&V({jurusan:o.nama_jurusan}),o.nama_kelas&&V({kelas:o.nama_kelas}),o.nama_rombel&&V({rombel:o.nama_rombel}))},[o]);const he=async()=>{if(!o)return;const{lembaga:W,jurusan:X,kelas:ae,rombel:O}=ne;if(!W||!w||!S){await k.fire({icon:"warning",title:"Peringatan",text:"Lembaga, Nomor Induk, dan Tanggal Mulai wajib diisi"});return}if(!(await k.fire({title:"Konfirmasi",text:"Apakah Anda yakin ingin memperbarui data pendidikan ini?",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, update!",cancelButtonText:"Batal"})).isConfirmed)return;const A={lembaga_id:W,jurusan_id:X||null,kelas_id:ae||null,rombel_id:O||null,no_induk:w,angkatan_id:y,tanggal_masuk:S,tanggal_keluar:f,status:T};console.log("Payload:",A);try{k.fire({title:"Mohon tunggu...",html:"Sedang proses update data pendidikan.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),E(!0);const ee=sessionStorage.getItem("token")||xe("token"),ie=await fetch(`${G}formulir/${h}/pendidikan`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ee}`},body:JSON.stringify(A)});if(ie.status===401){k.close(),await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}const ce=await ie.json();if(console.log(ce),ie.ok)["Tanggal keluar tidak boleh diisi jika status santri masih aktif"].some(ve=>{var Pe;return(Pe=ce.message)==null?void 0:Pe.toLowerCase().includes(ve.toLowerCase())})?(await k.fire({icon:"error",title:"Validasi gagal",text:ce.message}),v(null)):(await k.fire({icon:"success",title:"Berhasil",text:ce.message||"Data pendidikan berhasil diperbarui!"}),u(ce.data||A),z()),u(ce.data||A),z();else if(ce.errors){let fe="";Object.entries(ce.errors).forEach(([H,ve])=>{fe+=`${H}: ${ve.join(", ")}
`}),await k.fire({icon:"error",title:"Gagal update",text:fe})}else await k.fire({icon:"error",title:"Gagal update",text:ce.message||"Terjadi kesalahan"})}catch(ee){k.close(),console.error("Error saat update:",ee),await k.fire({icon:"error",title:"Error",text:"Terjadi kesalahan saat mengupdate data. Silakan coba lagi."})}finally{E(!1)}},U=async(W,X)=>{try{c(W),F(X),i(!0)}catch(ae){console.error("Gagal mengambil detail Khadam:",ae)}},q=()=>{i(!1)},se=()=>{i(!0)},Y=()=>{d(!1)},de=W=>{c(W),d(!0)};console.log("selectedPendidikanId:",h);const oe=({filterOptions:W,onChange:X,selectedFilters:ae})=>e.jsx("div",{className:"flex flex-col gap-4 w-full",children:Object.entries(W).map(([O,K],A)=>e.jsxs("div",{children:[e.jsxs("label",{htmlFor:O,className:"block text-sm font-medium text-gray-700",children:[Ml(O)," ",O==="lembaga"?"*":""]}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${K.length<=1||!r||!["aktif","cuti"].includes(o==null?void 0:o.status)?"bg-gray-200 text-gray-500":""}`,onChange:ee=>X({[O]:ee.target.value}),value:ae[O]||"",disabled:K.length<=1||!r||!["aktif","cuti"].includes(o==null?void 0:o.status),children:K.map((ee,ie)=>e.jsx("option",{value:ee.value,children:ee.label},ie))})]},`${O}-${A}`))});return e.jsxs("div",{className:"block",id:"Pendidikan",children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center justify-between",children:["Pendidikan",e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>{F(1),se()},type:"button",className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Tambah"})]})})]}),e.jsx(Al,{isOpen:b,onClose:q,biodataId:a,cardId:h,refetchData:z,feature:P}),e.jsx(Kl,{isOpen:m,onClose:Y,id:h,refetchData:z}),e.jsx("div",{className:"mt-5 space-y-6",children:M?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):p.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"Tidak ada data"}):p.map(W=>e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white shadow-md drop-shadow rounded-lg p-6 cursor-pointer w-full flex flex-col items-start gap-2",onClick:()=>me(W.id),children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"text-lg font-bold",children:[W.nama_lembaga," - ",W.nama_jurusan]}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["No. Induk : ",W.no_induk]}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Sejak : ",nt(W.tanggal_masuk),W.tanggal_keluar?` s/d ${nt(W.tanggal_keluar)}`:" - Sekarang"]})]}),e.jsx("span",{className:`text-sm font-semibold px-3 py-1 rounded-full ${W.status==="aktif"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:W.status&&W.status[0].toUpperCase()+W.status.slice(1)})]}),!W.tanggal_keluar&&e.jsxs("div",{className:`flex flex-wrap gap-2 gap-x-4 ${n||x?"":"mt-2"}`,children:[e.jsx(ye,{action:"pindah",children:e.jsxs("button",{type:"button",onClick:X=>{X.stopPropagation(),U(W.id,2)},className:"text-blue-600 hover:text-blue-800 flex items-center gap-1 cursor-pointer",title:"Pindah Pendidikan",children:[e.jsx(ge,{icon:na}),"Pindah"]})}),e.jsx(ye,{action:"keluar",children:e.jsxs("button",{type:"button",onClick:X=>{X.stopPropagation(),de(W.id)},className:"justify-end text-yellow-600 hover:text-yellow-800 flex items-center gap-1 cursor-pointer",title:"Keluar Pendidikan",children:[e.jsx(ge,{icon:Ve}),"Keluar"]})})]})]}),I===W.id?e.jsx("div",{className:"flex justify-center items-center mt-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):h===W.id&&o&&e.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(oe,{filterOptions:Z,onChange:V,selectedFilters:ne}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"angkatan_id",className:"block text-sm font-medium text-gray-700",children:"Angkatan *"}),e.jsx("select",{id:"angkatan_id",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||!["aktif","cuti"].includes(o==null?void 0:o.status)?"bg-gray-200 text-gray-500":""}`,onChange:X=>N(X.target.value),value:y,disabled:!r||!["aktif","cuti"].includes(o==null?void 0:o.status),required:!0,children:te.map((X,ae)=>e.jsx("option",{value:X.value,children:X.label},ae))})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"noInduk",className:"block text-sm font-medium text-gray-700",children:"Nomor Induk *"}),e.jsx("input",{type:"text",id:"noInduk",name:"noInduk",value:w,onChange:X=>_(X.target.value),maxLength:50,placeholder:"Masukkan Nomor Induk",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||!["aktif","cuti"].includes(o==null?void 0:o.status)?"bg-gray-200 text-gray-500":""}`,disabled:!r||!["aktif","cuti"].includes(o==null?void 0:o.status)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Mulai *"}),e.jsx("input",{type:"date",id:"startDate",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||!["aktif","cuti"].includes(o==null?void 0:o.status)?"bg-gray-200 text-gray-500":""}`,disabled:!r||!["aktif","cuti"].includes(o==null?void 0:o.status),value:S,onChange:X=>j(X.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Akhir"}),e.jsx("input",{type:"date",id:"endDate",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||!["aktif","cuti"].includes(o==null?void 0:o.status)?"bg-gray-200 text-gray-500":""}`,value:f,onChange:X=>v(X.target.value),disabled:!r||!["aktif","cuti"].includes(o==null?void 0:o.status)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{id:"status",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||!["aktif","cuti"].includes(o==null?void 0:o.status)?"bg-gray-200 text-gray-500":""}`,value:T,onChange:X=>C(X.target.value),disabled:!r||!["aktif","cuti"].includes(o==null?void 0:o.status),children:[e.jsx("option",{value:"",children:"Pilih Status"}),e.jsx("option",{value:"aktif",children:"Aktif"}),e.jsx("option",{value:"do",children:"Drop Out"}),e.jsx("option",{value:"berhenti",children:"Berhenti"}),e.jsx("option",{value:"lulus",children:"Lulus"}),e.jsx("option",{value:"pindah",children:"Pindah"}),e.jsx("option",{value:"cuti",children:"Cuti"}),e.jsx("option",{value:"naik_kelas",children:"Naik Kelas"}),e.jsx("option",{value:"nonaktif",children:"Non Aktif"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:" "}),e.jsxs("div",{className:"flex space-x-2 mt-1",children:[W.status==="aktif"&&e.jsx(ye,{action:"edit",children:e.jsx("button",{type:"button",disabled:Q,className:`px-4 py-2 text-white rounded-lg hover:bg-blue-700 focus:outline-none ${Q?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 cursor-pointer"}`,onClick:he,children:Q?e.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-white w-13"}):"Update"})}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none cursor-pointer",onClick:()=>{c(null),u(null),_(""),j(""),v(""),C("")},children:"Batal"})]})]})]})]},W.id))})]})},nt=a=>{const s={year:"numeric",month:"short",day:"2-digit"};return new Date(a).toLocaleDateString("id-ID",s)},Ml=a=>a.charAt(0).toUpperCase()+a.slice(1),Bl=({filterOptions:a,onChange:s,selectedFilters:l})=>{const r=n=>n.charAt(0).toUpperCase()+n.slice(1);return e.jsx("div",{className:"flex flex-col gap-4 w-full",children:Object.entries(a).map(([n,x],b)=>e.jsxs("div",{children:[e.jsxs("label",{htmlFor:n,className:"block text-gray-700",children:[r(n)," *"]}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:i=>s({[n]:i.target.value}),value:l[n]||"",disabled:x.length<=1,required:!0,children:x.map((i,m)=>e.jsx("option",{value:i.value,children:i.label},m))})]},`${n}-${b}`))})},Dl=({isOpen:a,onClose:s,biodataId:l,cardId:r,refetchData:n,feature:x,handleAddAPI:b})=>{const{clearAuthData:i}=ke(),m=je(),{filterLembaga:d,handleFilterChangeLembaga:p,selectedLembaga:g}=Te(),{allGolonganList:h}=pa(),o={lembaga:((E,B)=>E.length>0?[{...E[0],label:B},...E.slice(1)]:E)(d.lembaga,"Pilih Lembaga")},u=x==1,w=u?"pengajar":"pengajar/pindah",_=u?"POST":"PUT",f=u?l:r,[v,S]=t.useState({lembaga_id:"",golongan_id:"",jabatan:"",tahun_masuk:""}),[j,y]=t.useState([]),[N,T]=t.useState({nama:"",menit:"",tahun_masuk:"",tahun_akhir:""}),[C,P]=t.useState(),F=E=>{T({...N,[E.target.name]:E.target.value})},M=()=>{!N.nama||!N.menit||(y([...j,{nama:N.nama,menit:parseInt(N.menit),tahun_masuk:N.tahun_masuk,tahun_akhir:N.tahun_akhir}]),T({nama:"",menit:"",tahun_masuk:"",tahun_akhir:""}),D())},L=E=>{const B=j.filter((V,ne)=>ne!==E);y(B)};t.useEffect(()=>{S(E=>({...E,lembaga_id:g.lembaga||""}))},[g]);const I=async E=>{if(E.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed){if(x===3){await b(v,j);return}try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const V=sessionStorage.getItem("token")||xe("token");console.log("token :",V);let ne={...v};x==1?ne={...v,nama_materi:j.map(Z=>Z.nama),jumlah_menit:j.map(Z=>parseInt(Z.menit)),tahun_masuk_materi_ajar:j.map(Z=>Z.tahun_masuk||null),tahun_akhir_materi_ajar:j.map(Z=>Z.tahun_akhir||null)}:x==2&&(ne={...v,materi_ajar:j.map(Z=>({nama_materi:Z.nama||null,jumlah_menit:Z.menit?parseInt(Z.menit):null}))}),console.log("Payload yang dikirim ke API:",JSON.stringify(ne,null,2));const te=await fetch(`${G}formulir/${f}/${w}`,{method:_,headers:{"Content-Type":"application/json",Authorization:`Bearer ${V}`},body:JSON.stringify(ne)}),R=await te.json();if(k.close(),te.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),i(),m("/login");return}if(!te.ok)throw new Error(R.message||"Terjadi kesalahan pada server.");if(!("data"in R)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: center;">${R.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),n==null||n(),s==null||s()}catch(V){console.error("Terjadi kesalahan:",V),await k.fire({icon:"error",title:"Oops!",html:`<div style="text-align: center;">${V.message}</div>`})}}},D=()=>{P(!1)},Q=()=>{P(!0)};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:`inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm ${x==1?"sm:max-w-xl":"sm:max-w-lg"} sm:align-middle`,children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:I,children:[e.jsxs("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:x===1?"Tambah Data Baru":x==2?"Pindah":"Tambah Materi"}),C&&e.jsx(Ol,{isOpen:C,onClose:D,handleAdd:M,form:N,handleChange:F,feature:x}),e.jsxs("div",{className:"space-y-4",children:[x!=3&&e.jsxs(e.Fragment,{children:[e.jsx(Bl,{filterOptions:o,onChange:p,selectedFilters:g}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"golongan",className:"block text-gray-700",children:"Golongan *"}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${h.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:E=>S({...v,golongan_id:E.target.value}),value:v.golongan_id,disabled:h.length<=1,required:!0,children:h.map((E,B)=>e.jsx("option",{value:E.id,children:E.GolonganNama},B))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"golongan",className:"block text-gray-700",children:"Jenis Jabatan *"}),e.jsx("select",{className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",onChange:E=>S({...v,jabatan:E.target.value}),value:v.jabatan,required:!0,children:$a.map((E,B)=>e.jsx("option",{value:E.value,children:E.label},B))})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tahun_masuk",className:"block text-gray-700",children:"Tanggal Masuk *"}),e.jsx("input",{type:"date",id:"tahun_masuk",name:"tahun_masuk",value:v.tahun_masuk,onChange:E=>S({...v,tahun_masuk:E.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})]})}),e.jsxs("h1",{className:"text-black font-bold flex items-center justify-between w-full mb-2 mt-4",children:["Materi Ajar",e.jsx("button",{type:"button",onClick:()=>{Q(),console.log("add")},className:"bg-blue-500 text-white px-4 py-2 rounded w-12 hover:bg-blue-800 cursor-pointer",children:e.jsx(Ee,{})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"No"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama Materi"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jumlah Menit"}),x==1&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Masuk"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Akhir"})]}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Aksi"})]})}),e.jsxs("tbody",{className:"text-gray-800",children:[j.map((E,B)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:B+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:E.nama}),e.jsx("td",{className:"px-3 py-2 border-b",children:E.menit}),x==1&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-3 py-2 border-b",children:E.tahun_masuk}),e.jsx("td",{className:"px-3 py-2 border-b",children:E.tahun_akhir})]}),e.jsx("td",{className:"px-3 py-2 border-b",children:e.jsx("button",{onClick:()=>L(B),className:"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600",children:e.jsx(ge,{icon:Wa})})})]},B)),j.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-6",children:"Belum Ada Materi"})})]})]})})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},Ll=({isOpen:a,onClose:s,id:l,refetchData:r})=>{const{clearAuthData:n}=ke(),x=je(),[b,i]=t.useState({tahun_akhir:""}),m=async d=>{if(d.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const g=sessionStorage.getItem("token")||xe("token"),h=await fetch(`${G}formulir/${l}/pengajar/keluar`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify(b)}),c=await h.json();if(k.close(),h.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}if(!h.ok)throw new Error(c.message||"Terjadi kesalahan pada server.");if(!("data"in c)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${c.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),r==null||r(),s==null||s()}catch(g){console.error("Terjadi kesalahan:",g),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:m,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Masukkan Tanggal"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tahun_akhir",className:"block text-gray-700",children:"Tanggal Keluar *"}),e.jsx("input",{type:"date",id:"tahun_akhir",name:"tahun_akhir",value:b.tahun_akhir,onChange:d=>i({...b,tahun_akhir:d.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},Ol=({isOpen:a,onClose:s,handleAdd:l,form:r,handleChange:n,feature:x})=>(console.log(x),e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Tambah Materi Ajar"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nama",className:"block text-gray-700",children:"Nama Materi *"}),e.jsx("input",{type:"text",name:"nama",placeholder:"Masukkan Nama Materi",value:r.nama,onChange:n,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"menit",className:"block text-gray-700",children:"Jumlah Menit *"}),e.jsx("input",{type:"number",name:"menit",placeholder:"Jumlah Menit",value:r.menit,onChange:n,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),x===1&&e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"periode_akhir",className:"block text-gray-700",children:"Tahun Masuk Materi Ajar *"}),e.jsx("input",{type:"date",name:"tahun_masuk",placeholder:"Tahun Masuk Materi Ajar",value:r.tahun_masuk,onChange:n,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",onClick:b=>{b.stopPropagation(),l()},className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})})})]})})),Rl=()=>{const{biodata_id:a}=Ue(),{clearAuthData:s}=ke(),l=je(),r=Ke("edit"),n=Ke("pindah"),x=Ke("keluar"),[b,i]=t.useState(!1),[m,d]=t.useState(!1),[p,g]=t.useState([]),[h,c]=t.useState(null),[o,u]=t.useState(null),[w,_]=t.useState(""),[f,v]=t.useState(""),[S,j]=t.useState(""),[y,N]=t.useState(null),[T,C]=t.useState(""),[P,F]=t.useState(null),[M,L]=t.useState(!0),[I,D]=t.useState(null),{filterLembaga:Q,handleFilterChangeLembaga:E,selectedLembaga:B}=Te(),{allGolonganList:V}=pa(),te={lembaga:((O,K)=>O.length>0?[{...O[0],label:K},...O.slice(1)]:O)(Q.lembaga,"Pilih Lembaga")},R=t.useCallback(async()=>{const O=sessionStorage.getItem("token")||xe("token");if(!(!a||!O))try{F(null),L(!0);const K=await fetch(`${G}formulir/${a}/pengajar`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${O}`}});if(K.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}if(K.status===403)throw new Error("403");if(!K.ok)throw new Error(`Gagal fetch: ${K.status}`);const A=await K.json();console.log(A),g(A.data||[]),F(null)}catch(K){K.message==403?F("Akses ditolak: Anda tidak memiliki izin untuk melihat data ini."):F("Terjadi kesalahan saat mengambil data."),console.error("Gagal mengambil data Pengajar:",P)}finally{L(!1)}},[a]);t.useEffect(()=>{R()},[R]),t.useEffect(()=>{o&&o.lembaga_id&&E({lembaga:o.lembaga_id})},[o]),t.useEffect(()=>{h&&Z(h)},[p]);const Z=async O=>{try{D(O);const K=sessionStorage.getItem("token")||xe("token"),A=await fetch(`${G}formulir/${O}/pengajar/show`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${K}`}});if(A.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}const ee=await A.json();console.log(ee),c(O),u(ee.data),C(ee.data.golongan_id||""),_(ee.data.jabatan_kontrak||""),v(ee.data.tanggal_keluar||""),j(ee.data.tanggal_masuk||"");const ie=ee.data.materi.map(ce=>({id:ce.id||"-",nama:ce.nama_materi||"-",menit:ce.jumlah_menit||"-",tahun_masuk:ce.tahun_masuk||"-",tahun_akhir:ce.tahun_akhir||"-",status:ce.status_aktif||"-"}));he(ie||[])}catch(K){console.error("Gagal mengambil detail Pengajar:",K)}finally{D(null)}},z=async()=>{if(!o)return;const{lembaga:O}=B;if(!O){await k.fire({icon:"warning",title:"Lembaga Belum Dipilih",text:"Dropdown Lembaga harus dipilih."});return}if(me.length===0){await k.fire({icon:"warning",title:"Materi Kosong",text:"Minimal satu materi harus ditambahkan."});return}const K={lembaga_id:O,golongan_id:T,jabatan:w,tahun_masuk:S};console.log("Payload yang dikirim ke API:",JSON.stringify(K,null,2));try{k.fire({title:"Mohon tunggu...",html:"Sedang memperbarui data pengajar.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const A=sessionStorage.getItem("token")||xe("token"),ee=await fetch(`${G}formulir/${h}/pengajar`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A}`},body:JSON.stringify(K)});if(ee.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}console.log(`${G}formulir/${h}/pengajar`);const ie=await ee.json();console.log(ie),k.close(),ee.ok?(await k.fire({icon:"success",title:"Berhasil!",text:ie.message||"Data berhasil diperbarui."}),u(ie.data||K),R()):await k.fire({icon:"error",title:"Gagal Memperbarui",text:ie.message||"Terjadi kesalahan saat memperbarui data."})}catch(A){console.error("Error saat update:",A),await k.fire({icon:"error",title:"Terjadi Kesalahan",text:"Gagal menghubungi server. Silakan coba lagi."})}},[me,he]=t.useState([]),U=async(O,K)=>{try{k.fire({title:"Mohon tunggu...",html:"Sedang menonaktifkan materi.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const A=sessionStorage.getItem("token")||xe("token"),ee=h,ie={...O,materi_ajar:K.map(H=>({nama_materi:H.nama||null,jumlah_menit:H.menit?parseInt(H.menit):null}))};console.log("Payload yang dikirim ke API:",JSON.stringify(ie,null,2));const ce=await fetch(`${G}formulir/${ee}/pengajar/materi`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A}`},body:JSON.stringify(ie)});if(ce.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}const fe=await ce.json();if(console.log(fe),k.close(),!ce.ok||!("data"in fe)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: center;">${fe.message||"Gagal menambahkan materi."}</div>`});return}R(),await k.fire({icon:"success",title:"Berhasil",text:"Materi berhasil ditambahkan"}),Y()}catch(A){console.error("Gagal menambahkan materi:",A),await k.fire({icon:"error",title:"Terjadi Kesalahan",text:"Gagal mengirim data ke server. Silakan coba lagi."})}},q=async(O,K)=>{K.preventDefault();const A=me[O],ee=h,ie=A.id;try{k.fire({title:"Mohon tunggu...",html:"Sedang menonaktifkan materi.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const ce=sessionStorage.getItem("token")||xe("token");console.log(ce),console.log(`${G}formulir/${ee}/pengajar/materi/${ie}/nonaktifkan`);const fe=await fetch(`${G}formulir/${ee}/pengajar/materi/${ie}/nonaktifkan`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ce}`}});if(fe.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}const H=await fe.json();if(console.log(H),k.close(),!fe.ok)throw console.log("gagal"),new Error("Gagal menonaktifkan materi");if(!("data"in H)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: center;">${H.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil",html:"Materi berhasil dinonaktifkan",timer:1500,showConfirmButton:!1}),R()}catch(ce){k.close(),console.error("Error saat menonaktifkan materi:",ce),k.fire({icon:"error",title:"Terjadi kesalahan",text:"Gagal menonaktifkan materi. Silakan coba lagi."})}},se=async(O,K)=>{try{c(O),N(K),i(!0)}catch(A){console.error("Gagal mengambil detail Pengajar:",A)}},Y=()=>{i(!1)},de=()=>{i(!0)},oe=()=>{d(!1)},W=O=>{c(O),d(!0)},X=[{label:"Pilih Jenis jabatan",value:""},{label:"Kultural",value:"kultural"},{label:"Tetap",value:"tetap"},{label:"Kontrak",value:"kontrak"},{label:"Pengkaderan",value:"pengkaderan"}],ae=me.every(O=>O.status==="tidak aktif");return e.jsxs("div",{className:"block",id:"Pengajar",children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center justify-between",children:["Pengajar",e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>{N(1),de()},type:"button",className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Tambah"})]})})]}),e.jsx(Dl,{isOpen:b,onClose:Y,biodataId:a,cardId:h,refetchData:R,feature:y,handleAddAPI:U}),e.jsx(Ll,{isOpen:m,onClose:oe,id:h,refetchData:R}),e.jsx("div",{className:"mt-5 space-y-6",children:M?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):P?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:P}),P.includes("Akses ditolak")?null:e.jsx("button",{onClick:R,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Coba Lagi"})]}):p.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"Tidak ada data"}):p.map(O=>e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white shadow-lg drop-shadow rounded-lg p-6 cursor-pointer w-full flex flex-col items-start gap-2",onClick:()=>Z(O.id),children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-bold",children:O.nama_lembaga}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Sejak ",lt(O.tanggal_masuk)," ","Sampai ",O.tanggal_keluar?lt(O.tanggal_keluar):"Sekarang"]})]}),e.jsx("span",{className:`text-sm font-semibold capitalize px-3 py-1 rounded-full ${O.status==="aktif"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:O.status||"-"})]}),!O.tanggal_keluar&&e.jsxs("div",{className:`flex flex-wrap gap-2 gap-x-4 ${n||x?"":"mt-2"}`,children:[e.jsx(ye,{action:"pindah",children:e.jsxs("button",{type:"button",onClick:K=>{K.stopPropagation(),se(O.id,2)},className:"text-blue-600 hover:text-blue-800 flex items-center gap-1 cursor-pointer",title:"Pindah Khadam",children:[e.jsx(ge,{icon:na}),"Pindah"]})}),e.jsx(ye,{action:"keluar",children:e.jsxs("button",{type:"button",onClick:K=>{K.stopPropagation(),W(O.id)},className:"justify-end text-yellow-600 hover:text-yellow-800 flex items-center gap-1 cursor-pointer",title:"Keluar Khadam",children:[e.jsx(ge,{icon:Ve}),"Keluar"]})})]})]}),I===O.id?e.jsx("div",{className:"flex justify-center items-center mt-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):h===O.id&&o&&e.jsxs("form",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 mb-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lembaga_id",className:"block text-sm font-medium text-gray-700",children:"Lembaga"}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${te.lembaga.length<=1||!r||o.status_aktif==="tidak aktif"?"bg-gray-200 text-gray-500":""}`,onChange:K=>E({lembaga:K.target.value}),value:B.lembaga||"",disabled:te.lembaga.length<=1||!r||o.status==="tidak aktif",children:te.lembaga.map((K,A)=>e.jsx("option",{value:K.value,children:K.label},A))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"golongan_id",className:"block text-sm font-medium text-gray-700",children:"Golongan"}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${V.length<=1||!r||o.status_aktif==="tidak aktif"?"bg-gray-200 text-gray-500":""}`,onChange:K=>C(K.target.value),value:T,disabled:V.length<=1||!r||o.status==="tidak aktif",children:V.map((K,A)=>e.jsx("option",{value:K.id,children:K.GolonganNama},A))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"jabatan",className:"block text-sm font-medium text-gray-700",children:"Jabatan"}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||o.status_aktif==="tidak aktif"?"bg-gray-200 text-gray-500":""}`,onChange:K=>_(K.target.value),value:w,disabled:!r||o.status==="tidak aktif",children:X.map((K,A)=>e.jsx("option",{value:K.value,children:K.label},A))})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Masuk"}),e.jsx("input",{type:"date",id:"startDate",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||o.status_aktif==="tidak aktif"?"bg-gray-200 text-gray-500":""}`,disabled:!r||(o==null?void 0:o.status)==="tidak aktif",value:S,onChange:K=>j(K.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Keluar"}),e.jsx("input",{type:"date",id:"endDate",className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500  bg-gray-200 text-gray-500",value:f,onChange:K=>v(K.target.value),disabled:!0})]})]})]}),e.jsxs("h1",{className:"text-black font-bold flex items-center justify-between w-full mb-2",children:["Materi Ajar",O.status==="aktif"&&e.jsx(ye,{action:"tambah",children:e.jsx("button",{type:"button",onClick:()=>{N(3),de(),console.log("add")},className:"bg-blue-500 text-white px-4 py-2 rounded w-12 hover:bg-blue-800 cursor-pointer",children:e.jsx(Ee,{})})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"No"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama Materi"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jumlah Menit"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Masuk"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Akhir"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Status"}),O.status==="aktif"&&!ae&&e.jsx(ye,{action:"delete",children:e.jsx("th",{className:"px-3 py-2 border-b",children:"Aksi"})})]})}),e.jsxs("tbody",{className:"text-gray-800",children:[me.map((K,A)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:A+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:K.nama}),e.jsx("td",{className:"px-3 py-2 border-b",children:K.menit}),e.jsx("td",{className:"px-3 py-2 border-b",children:K.tahun_masuk}),e.jsx("td",{className:"px-3 py-2 border-b",children:K.tahun_akhir}),e.jsx("td",{className:"px-3 py-2 border-b",children:e.jsx("span",{className:`text-sm font-semibold px-3 py-1 rounded-full ${K.status==="aktif"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:K.status==="aktif"?"Aktif":"Nonaktif"})}),O.status==="aktif"&&!ae&&e.jsx(ye,{action:"delete",children:e.jsx("td",{className:"px-3 py-2 border-b",children:K.status==="aktif"&&e.jsx("button",{onClick:ee=>q(A,ee),className:"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600",children:e.jsx(ge,{icon:Wa})})})})]},A)),me.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-6",children:"Belum Ada Materi"})})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:" "}),e.jsxs("div",{className:"flex space-x-2 mt-1",children:[O.status==="aktif"&&e.jsx(ye,{action:"edit",children:e.jsx("button",{type:"button",className:"px-4 py-2 text-white rounded-lg hover:bg-blue-700 focus:outline-none bg-blue-600 hover:bg-blue-700 cursor-pointer",onClick:z,children:"Update"})}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none cursor-pointer",onClick:()=>{c(null),u(null),j(""),v("")},children:"Batal"})]})]})]})]},O.id))})]})},lt=a=>{const s={year:"numeric",month:"short",day:"2-digit"};return new Date(a).toLocaleDateString("id-ID",s)},El=({isOpen:a,onClose:s,biodataId:l,cardId:r,refetchData:n,feature:x})=>{const{clearAuthData:b}=ke(),i=je(),{menuGolonganJabatan:m}=aa(),{menuSatuanKerja:d}=Pa(),p=x===1,g=p?"pengurus":"pengurus/pindah",h=p?"POST":"PUT",c=p?l:r,[o,u]=t.useState({satuan_kerja:"",golongan_jabatan_id:"",keterangan_jabatan:"",jabatan:"",tanggal_mulai:""}),w=async _=>{if(_.preventDefault(),!o.satuan_kerja||!o.golongan_jabatan_id||!o.keterangan_jabatan||!o.tanggal_mulai){await k.fire({icon:"error",title:"Data tidak lengkap",text:"Semua field bertanda * wajib diisi"});return}if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const v=sessionStorage.getItem("token")||xe("token"),S=await fetch(`${G}formulir/${c}/${g}`,{method:h,headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`},body:JSON.stringify(o)}),j=await S.json();if(k.close(),S.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),b(),i("/login");return}if(!S.ok||!j.data)throw new Error(j.message||"Terjadi kesalahan pada server.");await k.fire({icon:"success",title:"Berhasil!",text:"Data pengurus berhasil disimpan."}),n==null||n(),s==null||s()}catch(v){console.error("Terjadi kesalahan:",v),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:w,children:[e.jsxs("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:p?"Tambah Data Pengurus":"Pindah Jabatan Pengurus"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700",children:"Satuan Kerja *"}),e.jsxs("select",{className:"w-full mt-1 border border-gray-300 rounded-md p-2",value:o.satuan_kerja,onChange:_=>u({...o,satuan_kerja:_.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Pilih Satuan Kerja"}),d.map((_,f)=>e.jsx("option",{value:_.value,children:_.label},f))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700",children:"Keterangan Jabatan *"}),e.jsx("input",{type:"text",className:"w-full mt-1 border border-gray-300 rounded-md p-2",value:o.keterangan_jabatan,onChange:_=>u({...o,keterangan_jabatan:_.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700",children:"Golongan Jabatan *"}),e.jsxs("select",{className:"w-full mt-1 border border-gray-300 rounded-md p-2",value:o.golongan_jabatan_id,onChange:_=>u({...o,golongan_jabatan_id:_.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Pilih Golongan Jabatan"}),m.map((_,f)=>e.jsx("option",{value:_.id,children:_.label},f))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700",children:"Jenis Kontrak"}),e.jsxs("select",{className:"w-full mt-1 border border-gray-300 rounded-md p-2",value:o.jabatan,onChange:_=>u({...o,jabatan:_.target.value}),children:[e.jsx("option",{value:"",children:"Pilih Jenis Kontrak"}),e.jsx("option",{value:"kultural",children:"Kultural"}),e.jsx("option",{value:"tetap",children:"Tetap"}),e.jsx("option",{value:"kontrak",children:"Kontrak"}),e.jsx("option",{value:"pengkaderan",children:"Pengkaderan"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700",children:"Tanggal Mulai *"}),e.jsx("input",{type:"date",className:"w-full mt-1 border border-gray-300 rounded-md p-2",value:o.tanggal_mulai,onChange:_=>u({...o,tanggal_mulai:_.target.value}),required:!0})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 sm:mt-0 sm:w-auto sm:text-sm",children:"Batal"})]})]})]})})})]})})},Ul=({isOpen:a,onClose:s,id:l,refetchData:r})=>{const{clearAuthData:n}=ke(),x=je(),[b,i]=t.useState({tanggal_akhir:""}),m=async d=>{if(d.preventDefault(),!b.tanggal_akhir){await k.fire({icon:"error",title:"Data tidak lengkap",text:"Tanggal keluar wajib diisi."});return}if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan data tanggal keluar sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const g=sessionStorage.getItem("token")||xe("token"),h=await fetch(`${G}formulir/${l}/pengurus/keluar`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify(b)});if(k.close(),h.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}const c=await h.json();if(!h.ok)throw new Error(c.message||"Terjadi kesalahan pada server.");if(!("data"in c)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${c.message||"Gagal memperbarui data pengurus."}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data pengurus berhasil diperbarui dengan tanggal keluar."}),r==null||r(),s==null||s()}catch(g){console.error("Terjadi kesalahan:",g),await k.fire({icon:"error",title:"Oops!",text:g.message||"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:m,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Masukkan Tanggal Keluar Pengurus"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_akhir",className:"block text-gray-700",children:"Tanggal Keluar *"}),e.jsx("input",{type:"date",id:"tanggal_akhir",name:"tanggal_akhir",value:b.tanggal_akhir,onChange:d=>i({...b,tanggal_akhir:d.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Batal"})]})]})]})})})]})})},ql=()=>{const{biodata_id:a}=Ue(),{clearAuthData:s}=ke(),l=je(),r=Ke("edit"),n=Ke("pindah"),x=Ke("keluar"),[b,i]=t.useState(!1),[m,d]=t.useState(!1),[p,g]=t.useState([]),[h,c]=t.useState(null),[o,u]=t.useState(null),[w,_]=t.useState(""),[f,v]=t.useState(""),[S,j]=t.useState(""),[y,N]=t.useState(""),[T,C]=t.useState(""),[P,F]=t.useState(null),[M,L]=t.useState(!0),[I,D]=t.useState(null),[Q,E]=t.useState(!1),[B,V]=t.useState(""),[ne,te]=t.useState(""),{menuGolonganJabatan:R}=aa(),{menuSatuanKerja:Z}=Pa(),z=t.useCallback(async()=>{const de=sessionStorage.getItem("token")||xe("token");if(!(!a||!de))try{L(!0);const oe=await fetch(`${G}formulir/${a}/pengurus`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${de}`}});if(oe.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}if(!oe.ok)throw new Error(`Gagal fetch: ${oe.status}`);const W=await oe.json();g(W.data||[])}catch(oe){console.error("Gagal mengambil data Pengurus:",oe)}finally{L(!1)}},[a]);t.useEffect(()=>{z()},[z]);const me=async de=>{try{D(de);const oe=sessionStorage.getItem("token")||xe("token"),W=await fetch(`${G}formulir/${de}/pengurus/show`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${oe}`}});if(W.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}const X=await W.json();c(de),u(X.data),_(X.data.keterangan_jabatan||""),v(X.data.tanggal_keluar||""),j(X.data.tanggal_masuk||""),N(X.data.status||""),C(X.data.jabatan_kontrak||""),V(X.data.satuan_kerja||""),te(X.data.golongan_jabatan_id||""),console.log("Detail Pengurus:",X.data)}catch(oe){console.error("Gagal mengambil detail Pengurus:",oe)}finally{D(null)}},he=async()=>{if(!o)return;const de={keterangan_jabatan:w,satuan_kerja:B,golongan_jabatan_id:ne,jabatan:T,tanggal_mulai:S,tanggal_akhir:f||null,status:y||null};if(!de.satuan_kerja||!w||!S){alert("Satuan Kerja, Keterangan Jabatan, dan Tanggal Mulai wajib diisi");return}try{E(!0);const oe=sessionStorage.getItem("token")||xe("token"),W=await fetch(`${G}formulir/${h}/pengurus`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${oe}`},body:JSON.stringify(de)});if(W.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}const X=await W.json();W.ok?(alert("Data pengurus berhasil diperbarui!"),u(X.data||de),z()):alert("Gagal update: "+(X.message||"Terjadi kesalahan"))}catch(oe){console.error("Error saat update:",oe)}finally{E(!1)}},U=async(de,oe)=>{try{c(de),F(oe),i(!0)}catch(W){console.error("Gagal mengambil detail Khadam:",W)}},q=()=>i(!1),se=()=>i(!0),Y=()=>d(!1);return e.jsxs("div",{className:"block",id:"Pengurus",children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center justify-between",children:["Pengurus",e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>{F(1),se()},type:"button",className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Tambah"})]})})]}),e.jsx(El,{isOpen:b,onClose:q,biodataId:a,refetchData:z,feature:P,cardId:h}),e.jsx(Ul,{isOpen:m,onClose:Y,id:h,refetchData:z}),e.jsx("div",{className:"mt-5 space-y-6",children:M?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):p.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"Tidak ada data"}):p.map(de=>e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6 cursor-pointer w-full flex flex-col items-start gap-2",onClick:()=>me(de.id),children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"text-lg font-bold",children:[de.keterangan_jabatan," ",de.satuan_kerja]}),e.jsx("p",{className:"text-gray-600 text-sm",children:de.jabatan_kontrak&&de.golongan_jabatan?`${de.jabatan_kontrak} | ${de.golongan_jabatan}`:de.jabatan_kontrak||de.golongan_jabatan||"-"}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Periode: ",rt(de.tanggal_masuk),de.tanggal_keluar?` s/d ${rt(de.tanggal_keluar)}`:" - Sekarang"]})]}),e.jsx("span",{className:`text-sm font-semibold capitalize px-3 py-1 rounded-full ${de.status==="aktif"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:de.status||"-"})]}),!de.tanggal_keluar&&e.jsxs("div",{className:`flex flex-wrap gap-2 gap-x-4 ${n||x?"":"mt-2"}`,children:[e.jsx(ye,{action:"pindah",children:e.jsxs("button",{type:"button",onClick:oe=>{oe.stopPropagation(),U(de.id,2)},className:"text-blue-600 hover:text-blue-800 flex items-center gap-1 cursor-pointer",title:"Pindah Jabatan",children:[e.jsx(ge,{icon:na}),"Pindah"]})}),e.jsx(ye,{action:"keluar",children:e.jsxs("button",{type:"button",onClick:oe=>{oe.stopPropagation(),d(!0)},className:"justify-end text-yellow-600 hover:text-yellow-800 flex items-center gap-1 cursor-pointer",title:"Keluar Jabatan",children:[e.jsx(ge,{icon:Ve}),"Keluar"]})})]})]}),I===de.id?e.jsx("div",{className:"flex justify-center items-center mt-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):h===de.id&&o&&e.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Satuan Kerja *"}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||(o==null?void 0:o.status)!=="aktif"?"bg-gray-200 text-gray-500":""}`,value:B||"",onChange:oe=>V(oe.target.value),disabled:!r||(o==null?void 0:o.status)!=="aktif",children:Z.map((oe,W)=>e.jsx("option",{value:oe.value,children:oe.label},W))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"keteranganJabatan",className:"block text-sm font-medium text-gray-700",children:"Keterangan Jabatan *"}),e.jsx("input",{type:"text",id:"keteranganJabatan",value:w,onChange:oe=>_(oe.target.value),className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||(o==null?void 0:o.status)!=="aktif"?"bg-gray-200 text-gray-500":""}`,disabled:!r||(o==null?void 0:o.status)!=="aktif"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Golongan Jabatan *"}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||(o==null?void 0:o.status)!=="aktif"?"bg-gray-200 text-gray-500":""}`,value:ne||"",onChange:oe=>te(oe.target.value),disabled:!r||(o==null?void 0:o.status)!=="aktif",children:R.map((oe,W)=>e.jsx("option",{value:oe.id,children:oe.label},W))})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"jabatanKontrak",className:"block text-sm font-medium text-gray-700",children:"Jenis Kontrak"}),e.jsxs("select",{id:"jabatanKontrak",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||(o==null?void 0:o.status)!=="aktif"?"bg-gray-200 text-gray-500":""}`,value:T,onChange:oe=>C(oe.target.value),disabled:!r||(o==null?void 0:o.status)!=="aktif",children:[e.jsx("option",{value:"",children:"Pilih Jenis Kontrak"}),e.jsx("option",{value:"kultural",children:"Kultural"}),e.jsx("option",{value:"tetap",children:"Tetap"}),e.jsx("option",{value:"kontrak",children:"Kontrak"}),e.jsx("option",{value:"pengkaderan",children:"Pengkaderan"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Mulai *"}),e.jsx("input",{type:"date",id:"startDate",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||(o==null?void 0:o.status)!=="aktif"?"bg-gray-200 text-gray-500":""}`,disabled:!r||(o==null?void 0:o.status)!=="aktif",value:S,onChange:oe=>j(oe.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Akhir"}),e.jsx("input",{type:"date",id:"endDate",className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-gray-200 text-gray-500",value:f,onChange:oe=>v(oe.target.value),disabled:!0})]})]}),e.jsx("div",{className:"col-span-full",children:e.jsxs("div",{className:"flex space-x-2",children:[(o==null?void 0:o.status)==="aktif"&&e.jsx(ye,{action:"edit",children:e.jsx("button",{type:"button",disabled:Q,className:`px-4 py-2 text-white rounded-lg ${Q?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 cursor-pointer"}`,onClick:he,children:Q?e.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-white w-13"}):"Update"})}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none cursor-pointer",onClick:()=>{c(null),u(null),_(""),j(""),v(""),N("")},children:"Batal"})]})})]})]},de.id))})]})},rt=a=>{const s={year:"numeric",month:"short",day:"2-digit"};return new Date(a).toLocaleDateString("id-ID",s)},zl=({isOpen:a,onClose:s,biodataId:l,refetchData:r})=>{const{clearAuthData:n}=ke(),x=je(),{menuWaliAsuh:b}=la(),[i,m]=t.useState(!1),[d,p]=t.useState(""),g=["A","B","C","D","E"],[h,c]=t.useState({id_wali_asuh:"",kepedulian_nilai:"",kepedulian_tindak_lanjut:"",kebersihan_nilai:"",kebersihan_tindak_lanjut:"",akhlak_nilai:"",akhlak_tindak_lanjut:"",tanggal_buat:""});t.useEffect(()=>{p(""),a&&c({id_wali_asuh:"",kepedulian_nilai:"",kepedulian_tindak_lanjut:"",kebersihan_nilai:"",kebersihan_tindak_lanjut:"",akhlak_nilai:"",akhlak_tindak_lanjut:"",tanggal_buat:""})},[a]),t.useEffect(()=>{a&&(d!=null&&d.id)&&h.id_wali_asuh!==d.id&&c(u=>({...u,id_wali_asuh:d.id}))},[d,a]);const o=async u=>{if(u.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),console.log("Payload yang dikirim ke API:",JSON.stringify(h,null,2));const _=sessionStorage.getItem("token")||xe("token"),f=await fetch(`${G}formulir/${l}/catatan-afektif`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${_}`},body:JSON.stringify(h)});console.log(`Mengirim ke: ${G}formulir/${l}/catatan-afektif`);const v=await f.json();if(k.close(),f.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}if(!f.ok)throw new Error(v.message||"Terjadi kesalahan pada server.");if(!("data"in v)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${v.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),r==null||r("afektif"),s==null||s()}catch(_){console.error("Terjadi kesalahan:",_),await k.fire({icon:"error",title:"Oops!",text:`Terjadi kesalahan saat mengirim data. ${_}`})}};return e.jsxs(le,{appear:!0,show:a,as:t.Fragment,children:[e.jsxs(re,{as:"div",className:"fixed inset-0 z-50",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"w-full max-w-2xl bg-white rounded-lg shadow-xl relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mt-6",children:d&&"Tambah Data Baru"}),e.jsxs("form",{className:"w-full",onSubmit:o,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4 overflow-y-auto max-h-[70vh]",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[!d&&e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsxs("div",{className:"w-full max-w-2xl text-center",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Pilih Data Wali Asuh Terlebih Dahulu"}),e.jsx("button",{type:"button",onClick:()=>m(!0),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Pilih Wali Asuh"})]})}),e.jsx(Ta,{waliAsuh:d,setShowSelectWaliAsuh:m}),d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kepedulian_nilai",className:"block text-gray-700",children:"Nilai Kepedulian *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${b.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:u=>c({...h,kepedulian_nilai:u.target.value}),value:h.kepedulian_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),g.map(u=>e.jsx("option",{value:u,children:u},u))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kepedulian_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Kepedulian *"}),e.jsx("textarea",{name:"kepedulian_tindak_lanjut",onChange:u=>c({...h,kepedulian_tindak_lanjut:u.target.value}),value:h.kepedulian_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kebersihan_nilai",className:"block text-gray-700",children:"Nilai Kebersihan *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${b.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:u=>c({...h,kebersihan_nilai:u.target.value}),value:h.kebersihan_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),g.map(u=>e.jsx("option",{value:u,children:u},u))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kebersihan_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Kebersihan *"}),e.jsx("textarea",{name:"kebersihan_tindak_lanjut",onChange:u=>c({...h,kebersihan_tindak_lanjut:u.target.value}),value:h.kebersihan_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"akhlak_nilai",className:"block text-gray-700",children:"Nilai Akhlak *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${b.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:u=>c({...h,akhlak_nilai:u.target.value}),value:h.akhlak_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),g.map(u=>e.jsx("option",{value:u,children:u},u))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"akhlak_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Akhlak *"}),e.jsx("textarea",{name:"akhlak_tindak_lanjut",onChange:u=>c({...h,akhlak_tindak_lanjut:u.target.value}),value:h.akhlak_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_buat",className:"block text-gray-700",children:"Tanggal Buat *"}),e.jsx("input",{type:"date",id:"tanggal_buat",name:"tanggal_buat",value:h.tanggal_buat,onChange:u=>c({...h,tanggal_buat:u.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})]})})}),e.jsxs("div",{className:"bg-gray-100 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse rounded-b-lg",children:[d&&e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm cursor-pointer",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]}),e.jsx(xa,{isOpen:i,onClose:()=>m(!1),onWaliAsuhSelected:u=>p(u)})]})},Wl=({isOpen:a,onClose:s,biodataId:l,refetchData:r})=>{const{clearAuthData:n}=ke(),x=je(),{menuWaliAsuh:b}=la(),[i,m]=t.useState(!1),[d,p]=t.useState(""),g=["A","B","C","D","E"],[h,c]=t.useState({id_wali_asuh:"",kebahasaan_nilai:"",kebahasaan_tindak_lanjut:"",baca_kitab_kuning_nilai:"",baca_kitab_kuning_tindak_lanjut:"",hafalan_tahfidz_nilai:"",hafalan_tahfidz_tindak_lanjut:"",furudul_ainiyah_nilai:"",furudul_ainiyah_tindak_lanjut:"",tulis_alquran_nilai:"",tulis_alquran_tindak_lanjut:"",baca_alquran_nilai:"",baca_alquran_tindak_lanjut:"",tanggal_buat:""});t.useEffect(()=>{a&&(d!=null&&d.id)&&h.id_wali_asuh!==d.id&&c(u=>({...u,id_wali_asuh:d.id}))},[d,a]),t.useEffect(()=>{p(""),a&&c({id_wali_asuh:"",kebahasaan_nilai:"",kebahasaan_tindak_lanjut:"",baca_kitab_kuning_nilai:"",baca_kitab_kuning_tindak_lanjut:"",hafalan_tahfidz_nilai:"",hafalan_tahfidz_tindak_lanjut:"",furudul_ainiyah_nilai:"",furudul_ainiyah_tindak_lanjut:"",tulis_alquran_nilai:"",tulis_alquran_tindak_lanjut:"",baca_alquran_nilai:"",baca_alquran_tindak_lanjut:"",tanggal_buat:""})},[a]);const o=async u=>{if(u.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),console.log("Payload yang dikirim ke API:",JSON.stringify(h,null,2));const _=sessionStorage.getItem("token")||xe("token"),f=await fetch(`${G}formulir/${l}/catatan-kognitif`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${_}`},body:JSON.stringify(h)});console.log(`Mengirim ke: ${G}formulir/${l}/catatan-kognitif`);const v=await f.json();if(k.close(),f.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}if(!f.ok)throw new Error(v.message||"Terjadi kesalahan pada server.");if(!("data"in v)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${v.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),r==null||r("kognitif"),s==null||s()}catch(_){console.error("Terjadi kesalahan:",_),await k.fire({icon:"error",title:"Oops!",text:`Terjadi kesalahan saat mengirim data. ${_}`})}};return e.jsxs(le,{appear:!0,show:a,as:t.Fragment,children:[e.jsxs(re,{as:"div",className:"fixed inset-0 z-50",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"w-full max-w-2xl bg-white rounded-lg shadow-xl relative max-h-[90vh] flex flex-col",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mt-6",children:d&&"Tambah Data Baru"}),e.jsxs("form",{className:"w-full",onSubmit:o,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4 overflow-y-auto max-h-[70vh]",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[!d&&e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsxs("div",{className:"w-full max-w-2xl text-center",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Pilih Data Wali Asuh Terlebih Dahulu"}),e.jsx("button",{type:"button",onClick:()=>m(!0),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Pilih Wali Asuh"})]})}),e.jsx(Ta,{waliAsuh:d,setShowSelectWaliAsuh:m}),d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kebahasaan_nilai",className:"block text-gray-700",children:"Nilai Kebahasaan *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${b.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:u=>c({...h,kebahasaan_nilai:u.target.value}),value:h.kebahasaan_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),g.map(u=>e.jsx("option",{value:u,children:u},u))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kebahasaan_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Kebahasaan *"}),e.jsx("textarea",{name:"kebahasaan_tindak_lanjut",onChange:u=>c({...h,kebahasaan_tindak_lanjut:u.target.value}),value:h.kebahasaan_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"baca_kitab_kuning_nilai",className:"block text-gray-700",children:"Nilai Baca Kitab Kuning *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${b.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:u=>c({...h,baca_kitab_kuning_nilai:u.target.value}),value:h.baca_kitab_kuning_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),g.map(u=>e.jsx("option",{value:u,children:u},u))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"baca_kitab_kuning_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Baca Kitab Kuning *"}),e.jsx("textarea",{name:"baca_kitab_kuning_tindak_lanjut",onChange:u=>c({...h,baca_kitab_kuning_tindak_lanjut:u.target.value}),value:h.baca_kitab_kuning_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"hafalan_tahfidz_nilai",className:"block text-gray-700",children:"Nilai Hafalan Tahfidz *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${b.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:u=>c({...h,hafalan_tahfidz_nilai:u.target.value}),value:h.hafalan_tahfidz_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),g.map(u=>e.jsx("option",{value:u,children:u},u))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"hafalan_tahfidz_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Hafalan Tahfidz *"}),e.jsx("textarea",{name:"hafalan_tahfidz_tindak_lanjut",onChange:u=>c({...h,hafalan_tahfidz_tindak_lanjut:u.target.value}),value:h.hafalan_tahfidz_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"furudul_ainiyah_nilai",className:"block text-gray-700",children:"Nilai Furudul Ainiyah *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${b.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:u=>c({...h,furudul_ainiyah_nilai:u.target.value}),value:h.furudul_ainiyah_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),g.map(u=>e.jsx("option",{value:u,children:u},u))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"furudul_ainiyah_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Furudul Ainiyah *"}),e.jsx("textarea",{name:"furudul_ainiyah_tindak_lanjut",onChange:u=>c({...h,furudul_ainiyah_tindak_lanjut:u.target.value}),value:h.furudul_ainiyah_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tulis_alquran_nilai",className:"block text-gray-700",children:"Nilai Tulis Al-Quran *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${b.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:u=>c({...h,tulis_alquran_nilai:u.target.value}),value:h.tulis_alquran_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),g.map(u=>e.jsx("option",{value:u,children:u},u))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tulis_alquran_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Tulis Al-Quran *"}),e.jsx("textarea",{name:"tulis_alquran_tindak_lanjut",onChange:u=>c({...h,tulis_alquran_tindak_lanjut:u.target.value}),value:h.tulis_alquran_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"baca_alquran_nilai",className:"block text-gray-700",children:"Nilai Baca Al-Quran *"}),e.jsxs("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${b.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:u=>c({...h,baca_alquran_nilai:u.target.value}),value:h.baca_alquran_nilai,required:!0,children:[e.jsx("option",{value:"",children:" Pilih Nilai"}),g.map(u=>e.jsx("option",{value:u,children:u},u))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"baca_alquran_tindak_lanjut",className:"block text-gray-700",children:"Tindak Lanjut Baca Al-Quran *"}),e.jsx("textarea",{name:"baca_alquran_tindak_lanjut",onChange:u=>c({...h,baca_alquran_tindak_lanjut:u.target.value}),value:h.baca_alquran_tindak_lanjut,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan catatan atau tindak lanjut",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_buat",className:"block text-gray-700",children:"Tanggal Buat *"}),e.jsx("input",{type:"date",id:"tanggal_buat",name:"tanggal_buat",value:h.tanggal_buat,onChange:u=>c({...h,tanggal_buat:u.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})]})})}),e.jsxs("div",{className:"bg-gray-100 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse rounded-b-lg",children:[d&&e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm cursor-pointer",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]}),e.jsx(xa,{isOpen:i,onClose:()=>m(!1),onWaliAsuhSelected:u=>p(u)})]})},Jl=({isOpen:a,onClose:s,id:l,refetchData:r,endpoint:n})=>{const{clearAuthData:x}=ke(),b=je(),[i,m]=t.useState({tanggal_selesai:""}),d=async p=>{if(p.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const h=sessionStorage.getItem("token")||xe("token"),c=await fetch(`${G}formulir/${l}/catatan-${n}/keluar`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify(i)}),o=await c.json();if(k.close(),c.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),x(),b("/login");return}if(!c.ok)throw new Error(o.message||"Terjadi kesalahan pada server.");if(!("data"in o)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${o.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),r==null||r(n),s==null||s()}catch(h){console.error("Terjadi kesalahan:",h),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:d,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Masukkan Tanggal"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_selesai",className:"block text-gray-700",children:"Tanggal Selesai *"}),e.jsx("input",{type:"date",id:"tanggal_selesai",name:"tanggal_selesai",value:i.tanggal_selesai,onChange:p=>m({...i,tanggal_selesai:p.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm cursor-pointer",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},Gl=()=>{var O;const{biodata_id:a}=Ue(),{clearAuthData:s}=ke(),l=je(),r=Ke("edit"),[n,x]=t.useState("afektif"),[b,i]=t.useState(!1),[m,d]=t.useState(!1),[p,g]=t.useState(!1),[h,c]=t.useState([]),[o,u]=t.useState(null),[w,_]=t.useState(null),[f,v]=t.useState(null),[S,j]=t.useState(""),[y,N]=t.useState(""),[T,C]=t.useState(null),[P,F]=t.useState(null),{menuWaliAsuh3:M}=la(),[L,I]=t.useState(!1),[D,Q]=t.useState(!0),[E,B]=t.useState(null),[V,ne]=t.useState({id_wali_asuh:"",kepedulian_nilai:"",kepedulian_tindak_lanjut:"",kebersihan_nilai:"",kebersihan_tindak_lanjut:"",akhlak_nilai:"",akhlak_tindak_lanjut:""}),[te,R]=t.useState({kebahasaan_nilai:"",kebahasaan_tindak_lanjut:"",baca_kitab_kuning_nilai:"",baca_kitab_kuning_tindak_lanjut:"",hafalan_tahfidz_nilai:"",hafalan_tahfidz_tindak_lanjut:"",furudul_ainiyah_nilai:"",furudul_ainiyah_tindak_lanjut:"",tulis_alquran_nilai:"",tulis_alquran_tindak_lanjut:"",baca_alquran_nilai:"",baca_alquran_tindak_lanjut:""}),Z=t.useCallback(async K=>{const A=sessionStorage.getItem("token")||xe("token");if(!(!a||!A))try{C(null),Q(!0);const ee=await fetch(`${G}formulir/${a}/catatan-${K}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A}`}});if(ee.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}if(ee.status===403)throw new Error("403");if(!ee.ok)throw new Error(`Gagal fetch: ${ee.status}`);const ie=await ee.json();console.log(ie),c(ie.data||[]),K=="afektif"?_(null):v(null),C(null)}catch(ee){ee.message==403?C("Akses ditolak: Anda tidak memiliki izin untuk melihat data ini."):C("Terjadi kesalahan saat mengambil data."),console.error("Gagal mengambil data Afektif:",T)}finally{Q(!1)}},[a]);t.useEffect(()=>{n&&Z(n)},[n,Z]);const z=async(K,A)=>{try{B(K);const ee=sessionStorage.getItem("token")||xe("token"),ie=await fetch(`${G}formulir/${K}/catatan-${A}/show`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ee}`}});if(ie.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}const ce=await ie.json();console.log(ce),u(K),A=="afektif"?(_(ce.data),ne({id_wali_asuh:ce.data.id_wali_asuh||"",kepedulian_nilai:ce.data.kepedulian_nilai||"",kepedulian_tindak_lanjut:ce.data.kepedulian_tindak_lanjut||"",kebersihan_nilai:ce.data.kebersihan_nilai||"",kebersihan_tindak_lanjut:ce.data.kebersihan_tindak_lanjut||"",akhlak_nilai:ce.data.akhlak_nilai||"",akhlak_tindak_lanjut:ce.data.akhlak_tindak_lanjut||""})):(v(ce.data),R({kebahasaan_nilai:ce.data.kebahasaan_nilai||"",kebahasaan_tindak_lanjut:ce.data.kebahasaan_tindak_lanjut||"",baca_kitab_kuning_nilai:ce.data.baca_kitab_kuning_nilai||"",baca_kitab_kuning_tindak_lanjut:ce.data.baca_kitab_kuning_tindak_lanjut||"",hafalan_tahfidz_nilai:ce.data.hafalan_tahfidz_nilai||"",hafalan_tahfidz_tindak_lanjut:ce.data.hafalan_tahfidz_tindak_lanjut||"",furudul_ainiyah_nilai:ce.data.furudul_ainiyah_nilai||"",furudul_ainiyah_tindak_lanjut:ce.data.furudul_ainiyah_tindak_lanjut||"",tulis_alquran_nilai:ce.data.tulis_alquran_nilai||"",tulis_alquran_tindak_lanjut:ce.data.tulis_alquran_tindak_lanjut||"",baca_alquran_nilai:ce.data.baca_alquran_nilai||"",baca_alquran_tindak_lanjut:ce.data.baca_alquran_tindak_lanjut||""})),j(ce.data.tanggal_selesai||""),N(ce.data.tanggal_buat||"")}catch(ee){console.error("Gagal mengambil detail Afektif:",ee)}finally{B(null)}},me=async K=>{if(!w&&K=="afektif"||!f&&K=="kognitif")return;const A={tanggal_buat:y,...K==="kognitif"?te:V};console.log("Payload yang dikirim ke API:",JSON.stringify(A,null,2));try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const ee=sessionStorage.getItem("token")||xe("token"),ie=await fetch(`${G}formulir/${o}/catatan-${K}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ee}`},body:JSON.stringify(A)});if(ie.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}console.log(`${G}formulir/${o}/catatan-${K}`);const ce=await ie.json();k.close(),ie.ok?(await k.fire({icon:"success",title:"Berhasil!",text:ce.message||"Data berhasil diperbarui."}),K==="afektif"?_(ce.data||A):K==="kognitif"&&v(ce.data||A),Z(K)):await k.fire({icon:"error",title:"Gagal Memperbarui",text:ce.message||"Terjadi kesalahan saat memperbarui data."})}catch(ee){console.error("Error saat update:",ee),await k.fire({icon:"error",title:"Terjadi Kesalahan",text:"Gagal menghubungi server. Silakan coba lagi."})}},he=()=>{i(!1)},U=()=>{i(!0)},q=()=>{d(!1)},se=()=>{d(!0)},Y=()=>{g(!1)},de=K=>{u(K),g(!0)},oe=K=>{const{name:A,value:ee,dataset:ie}=K.target,ce=ie.form;ce==="afektif"?ne(fe=>({...fe,[A]:ee})):ce==="kognitif"&&R(fe=>({...fe,[A]:ee}))};t.useEffect(()=>{if(V.id_wali_asuh&&M.length>0){const K=M.find(A=>(A.id===V.id_wali_asuh||A.id===te.id_wali_asuh)&&A.id!==null);K&&(F(K),n==="afektif"&&(console.log("[AFEK] Setting formAfektif"),ne(A=>({...A,id_wali_asuh:K.id}))),console.log("idwaliasuh afektif",V.id_wali_asuh))}},[n,V.id_wali_asuh,te.id_wali_asuh,M]),t.useEffect(()=>{P&&(console.log("datawaliasuh ",P.id),n==="afektif"&&(console.log("[AFEK] Setting formAfektif"),ne(K=>({...K,id_wali_asuh:P.id}))))},[n,P]);const W=({waliAsuh:K,setShowSelectWaliAsuh:A,showChange:ee})=>K?e.jsxs("div",{className:"relative p-4 pr-12 rounded-md bg-gray-50 shadow-sm mb-6 border border-blue-200",children:[e.jsx("div",{className:"absolute -top-3 left-3 bg-blue-500 text-white text-xs font-semibold px-2 py-1 rounded shadow",children:"Data Wali Asuh/Pencatat"}),ee&&e.jsx("button",{type:"button",onClick:()=>A(!0),className:"absolute top-3 right-3 px-2 py-1 rounded hover:bg-blue-700 text-gray-700 bg-blue-500 text-white","aria-label":"Ganti WaliAsuh",children:e.jsx("i",{className:"fas fa-exchange-alt"})}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:space-x-6 space-y-4 lg:space-y-0",children:[e.jsx("div",{className:"flex justify-center lg:justify-start",children:e.jsx("img",{src:K.foto_profil,alt:K.nama,className:"w-32 h-40 object-cover rounded",onError:ie=>{ie.target.onerror=null,ie.target.src=Me}})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-x-8 gap-y-2 text-sm flex-1",children:[e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-1",children:[e.jsx("span",{className:"font-semibold",children:"Nama"})," ",e.jsxs("span",{children:[": ",K.nama]}),e.jsx("span",{className:"font-semibold",children:"NIS"})," ",e.jsxs("span",{children:[": ",K.nis]}),e.jsx("span",{className:"font-semibold",children:"Angkatan"})," ",e.jsxs("span",{children:[": ",K.angkatan]}),e.jsx("span",{className:"font-semibold",children:"Kota Asal"})," ",e.jsxs("span",{children:[": ",K.kota_asal]})]}),e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-1",children:[e.jsx("span",{className:"font-semibold",children:"Wilayah"})," ",e.jsxs("span",{children:[": ",K.wilayah]}),e.jsx("span",{className:"font-semibold",children:"Blok"})," ",e.jsxs("span",{children:[": ",K.blok]}),e.jsx("span",{className:"font-semibold",children:"Kamar"})," ",e.jsxs("span",{children:[": ",K.kamar]})]})]})]})]}):null,X=["A","B","C","D","E"],ae=[{id:"afektif",label:"Afektif",content:e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center justify-between",children:["Catatan Afektif",e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>{U()},type:"button",className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Tambah"})]})})]}),e.jsx("div",{className:"mt-5 space-y-6",children:D?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):T?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:T}),T.includes("Akses ditolak")?null:e.jsx("button",{onClick:()=>{Z("afektif")},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Coba Lagi"})]}):h.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"Tidak ada data"}):h.map(K=>e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white shadow-lg drop-shadow rounded-lg p-6 cursor-pointer w-full flex flex-col gap-4 relative",onClick:()=>z(K.id,"afektif"),children:[e.jsx("span",{className:`absolute top-4 right-4 text-xs font-semibold px-3 py-1 rounded-full ${K.tanggal_selesai?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:K.tanggal_selesai?"Catatan Nonaktif":"Catatan Aktif"}),e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4 w-full",children:[e.jsx("img",{alt:K.nama||"-",className:"w-24 h-28 object-cover rounded-md shadow",src:K.foto_pencatat,onError:A=>{A.target.onerror=null,A.target.src=Me}}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-lg font-bold",children:"Pencatat"}),e.jsx("h5",{className:"text-md font-semibold",children:K.nama_pencatat}),e.jsxs("p",{className:"text-gray-500 text-sm",children:["Sebagai: ",K.status]}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Catatan dibuat ",ka(K.tanggal_buat),K.tanggal_selesai?` dan selesai ${ka(K.tanggal_selesai)}`:""]}),e.jsxs("div",{className:"flex gap-2 mt-2 text-sm",children:[e.jsxs("span",{className:"bg-blue-100 text-blue-700 px-2 py-1 rounded",children:["Kepedulian: ",K.kepedulian_nilai]}),e.jsxs("span",{className:"bg-green-100 text-green-700 px-2 py-1 rounded",children:["Kebersihan: ",K.kebersihan_nilai]}),e.jsxs("span",{className:"bg-red-100 text-red-700 px-2 py-1 rounded",children:["Akhlak: ",K.akhlak_nilai]})]})]}),!K.tanggal_selesai&&e.jsx("div",{className:"absolute bottom-5 right-5",children:e.jsx(ye,{action:"keluar",children:e.jsxs("button",{type:"button",onClick:A=>{A.stopPropagation(),de(K.id)},className:"text-yellow-600 hover:text-yellow-800 flex items-center gap-1 text-sm cursor-pointer",title:"Keluar Afektif",children:[e.jsx(ge,{icon:Ve})," Selesai"]})})})]}),e.jsx("div",{className:"text-xs text-gray-400 italic ",children:"📌 Klik kartu ini untuk melihat detail nilai"})]}),E===K.id?e.jsx("div",{className:"flex justify-center items-center mt-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):o===K.id&&w&&e.jsxs("div",{className:" bg-white shadow-md rounded-lg p-6",children:[e.jsx(W,{waliAsuh:P,setShowSelectWaliAsuh:I,showChange:r&&(!(w!=null&&w.tanggal_selesai)||(w==null?void 0:w.tanggal_selesai)==="-")}),e.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nilai Kepedulian"}),e.jsxs("select",{name:"kepedulian_nilai","data-form":"afektif",value:V.kepedulian_nilai,onChange:oe,disabled:!r||!!w.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||w.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,children:[e.jsx("option",{value:"",children:"Pilih Nilai"}),X.map(A=>e.jsx("option",{value:A,children:A},A))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tindak Lanjut Kepedulian"}),e.jsx("textarea",{name:"kepedulian_tindak_lanjut","data-form":"afektif",value:V.kepedulian_tindak_lanjut,onChange:oe,rows:3,disabled:!r||!!w.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||w.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,placeholder:"Masukkan catatan atau tindak lanjut"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nilai Kebersihan"}),e.jsxs("select",{name:"kebersihan_nilai","data-form":"afektif",value:V.kebersihan_nilai,onChange:oe,disabled:!r||!!w.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||w.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,children:[e.jsx("option",{value:"",children:"Pilih Nilai"}),X.map(A=>e.jsx("option",{value:A,children:A},A))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tindak Lanjut Kebersihan"}),e.jsx("textarea",{name:"kebersihan_tindak_lanjut","data-form":"afektif",value:V.kebersihan_tindak_lanjut,onChange:oe,rows:3,disabled:!r||!!w.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||w.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,placeholder:"Masukkan catatan atau tindak lanjut"})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nilai Akhlak"}),e.jsxs("select",{name:"akhlak_nilai","data-form":"afektif",value:V.akhlak_nilai,onChange:oe,disabled:!r||!!w.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||w.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,children:[e.jsx("option",{value:"",children:"Pilih Nilai"}),X.map(A=>e.jsx("option",{value:A,children:A},A))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tindak Lanjut Akhlak"}),e.jsx("textarea",{name:"akhlak_tindak_lanjut","data-form":"afektif",value:V.akhlak_tindak_lanjut,onChange:oe,rows:3,disabled:!r||!!w.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||w.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,placeholder:"Masukkan catatan atau tindak lanjut"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tanggal Dibuat"}),e.jsx("input",{type:"date",value:y,onChange:A=>N(A.target.value),disabled:!r||!!w.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||w.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tanggal Selesai"}),e.jsx("input",{type:"date",value:S||"",onChange:A=>j(A.target.value),disabled:!0,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-gray-200 text-gray-500 cursor-not-allowed"})]})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end gap-3 mt-4",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none cursor-pointer",onClick:()=>{u(null),_(null),N(""),j("")},children:"Batal"}),!K.tanggal_selesai&&e.jsx(ye,{action:"edit",children:e.jsx("button",{type:"button",onClick:()=>me("afektif"),className:"bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded-md shadow-sm cursor-pointer",children:"Update"})})]})]})]})]},K.id))})]})},{id:"kognitif",label:"Kognitif",content:e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center justify-between",children:["Catatan Kognitif",e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>{se()},type:"button",className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Tambah"})]})})]}),e.jsx("div",{className:"mt-5 space-y-6",children:D?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):T?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:T}),T.includes("Akses ditolak")?null:e.jsx("button",{onClick:()=>{Z("kognitif")},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Coba Lagi"})]}):h.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"Tidak ada data"}):h.map(K=>e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white shadow-lg drop-shadow rounded-lg p-6 cursor-pointer w-full flex flex-col gap-4 relative",onClick:()=>z(K.id,"kognitif"),children:[e.jsx("span",{className:`absolute top-4 right-4 text-xs font-semibold px-3 py-1 rounded-full ${K.tanggal_selesai?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:K.tanggal_selesai?"Catatan Nonaktif":"Catatan Aktif"}),e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4 w-full",children:[e.jsx("img",{alt:K.nama||"-",className:"w-24 h-28 object-cover rounded-md shadow",src:K.foto_pencatat,onError:A=>{A.target.onerror=null,A.target.src=Me}}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-lg font-bold",children:"Pencatat"}),e.jsx("h5",{className:"text-md font-semibold",children:K.nama_pencatat}),e.jsxs("p",{className:"text-gray-500 text-sm",children:["Sebagai: ",K.status]}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Catatan dibuat ",ka(K.tanggal_buat),K.tanggal_selesai?` dan selesai ${ka(K.tanggal_selesai)}`:""]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-sm",children:[e.jsxs("span",{className:"bg-blue-100 text-blue-700 px-2 py-1 rounded",children:["Kebahasaan: ",K.kebahasaan_nilai]}),e.jsxs("span",{className:"bg-yellow-100 text-yellow-700 px-2 py-1 rounded",children:["Kitab Kuning: ",K.baca_kitab_kuning_nilai]}),e.jsxs("span",{className:"bg-red-100 text-red-700 px-2 py-1 rounded",children:["Tahfidz: ",K.hafalan_tahfidz_nilai]}),e.jsxs("span",{className:"bg-purple-100 text-purple-700 px-2 py-1 rounded",children:["Furudul 'Ainiyah: ",K.furudul_ainiyah_nilai]}),e.jsxs("span",{className:"bg-green-100 text-green-700 px-2 py-1 rounded",children:["Tulis Al-Qur'an: ",K.tulis_alquran_nilai]}),e.jsxs("span",{className:"bg-pink-100 text-pink-700 px-2 py-1 rounded",children:["Baca Al-Qur'an: ",K.baca_alquran_nilai]})]})]}),!K.tanggal_selesai&&e.jsx("div",{className:"absolute bottom-5 right-5",children:e.jsx(ye,{action:"keluar",children:e.jsxs("button",{type:"button",onClick:A=>{A.stopPropagation(),de(K.id)},className:"text-yellow-600 hover:text-yellow-800 flex items-center gap-1 text-sm cursor-pointer",title:"Keluar Kognitif",children:[e.jsx(ge,{icon:Ve})," Selesai"]})})})]}),e.jsx("div",{className:"text-xs text-gray-400 italic ",children:"📌 Klik kartu ini untuk melihat detail nilai"})]}),E===K.id?e.jsx("div",{className:"flex justify-center items-center mt-4 bg-white shadow-md rounded-lg p-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):o===K.id&&f&&e.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 bg-white shadow-md rounded-lg p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nilai Kebahasaan"}),e.jsxs("select",{name:"kebahasaan_nilai","data-form":"kognitif",value:te.kebahasaan_nilai,onChange:oe,disabled:!r||!!f.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||f.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,children:[e.jsx("option",{value:"",children:"Pilih Nilai"}),X.map(A=>e.jsx("option",{value:A,children:A},A))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tindak Lanjut Kebahasaan"}),e.jsx("textarea",{name:"kebahasaan_tindak_lanjut","data-form":"kognitif",value:te.kebahasaan_tindak_lanjut,onChange:oe,rows:3,disabled:!r||!!f.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||f.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,placeholder:"Masukkan catatan atau tindak lanjut"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nilai Hafalan Tahfidz"}),e.jsxs("select",{name:"hafalan_tahfidz_nilai","data-form":"kognitif",value:te.hafalan_tahfidz_nilai,onChange:oe,disabled:!r||!!f.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||f.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,children:[e.jsx("option",{value:"",children:"Pilih Nilai"}),X.map(A=>e.jsx("option",{value:A,children:A},A))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tindak Lanjut Hafalan Tahfidz"}),e.jsx("textarea",{name:"hafalan_tahfidz_tindak_lanjut","data-form":"kognitif",value:te.hafalan_tahfidz_tindak_lanjut,onChange:oe,rows:3,disabled:!r||!!f.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||f.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,placeholder:"Masukkan catatan atau tindak lanjut"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nilai Tulis Al-Quran"}),e.jsxs("select",{name:"tulis_alquran_nilai","data-form":"kognitif",value:te.tulis_alquran_nilai,onChange:oe,disabled:!r||!!f.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||f.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,children:[e.jsx("option",{value:"",children:"Pilih Nilai"}),X.map(A=>e.jsx("option",{value:A,children:A},A))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tindak Lanjut Tulis Al-Quran"}),e.jsx("textarea",{name:"tulis_alquran_tindak_lanjut","data-form":"kognitif",value:te.tulis_alquran_tindak_lanjut,onChange:oe,rows:3,disabled:!r||!!f.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||f.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,placeholder:"Masukkan catatan atau tindak lanjut"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tanggal Dibuat"}),e.jsx("input",{type:"date",value:y,onChange:A=>N(A.target.value),disabled:!r||!!f.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||f.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tanggal Selesai"}),e.jsx("input",{type:"date",value:S||"",onChange:A=>j(A.target.value),disabled:!0,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-gray-200 text-gray-500 cursor-not-allowed"})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nilai Baca Kitab Kuning"}),e.jsxs("select",{name:"baca_kitab_kuning_nilai","data-form":"kognitif",value:te.baca_kitab_kuning_nilai,onChange:oe,disabled:!r||!!f.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||f.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,children:[e.jsx("option",{value:"",children:"Pilih Nilai"}),X.map(A=>e.jsx("option",{value:A,children:A},A))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tindak Lanjut Baca Kitab Kuning"}),e.jsx("textarea",{name:"baca_kitab_kuning_tindak_lanjut","data-form":"kognitif",value:te.baca_kitab_kuning_tindak_lanjut,onChange:oe,rows:3,disabled:!r||!!f.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||f.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,placeholder:"Masukkan catatan atau tindak lanjut"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nilai Furudul Ainiyah"}),e.jsxs("select",{name:"furudul_ainiyah_nilai","data-form":"kognitif",value:te.furudul_ainiyah_nilai,onChange:oe,disabled:!r||!!f.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||f.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,children:[e.jsx("option",{value:"",children:"Pilih Nilai"}),X.map(A=>e.jsx("option",{value:A,children:A},A))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tindak Lanjut Furudul Ainiyah"}),e.jsx("textarea",{name:"furudul_ainiyah_tindak_lanjut","data-form":"kognitif",value:te.furudul_ainiyah_tindak_lanjut,onChange:oe,rows:3,disabled:!r||!!f.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||f.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,placeholder:"Masukkan catatan atau tindak lanjut"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nilai Baca Al-Quran"}),e.jsxs("select",{name:"baca_alquran_nilai","data-form":"kognitif",value:te.baca_alquran_nilai,onChange:oe,disabled:!r||!!f.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||f.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,children:[e.jsx("option",{value:"",children:"Pilih Nilai"}),X.map(A=>e.jsx("option",{value:A,children:A},A))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tindak Lanjut Baca Al-Quran"}),e.jsx("textarea",{name:"baca_alquran_tindak_lanjut","data-form":"kognitif",value:te.baca_alquran_tindak_lanjut,onChange:oe,rows:3,disabled:!r||!!f.tanggal_selesai,className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||f.tanggal_selesai?"bg-gray-200 text-gray-500 cursor-not-allowed":""}`,placeholder:"Masukkan catatan atau tindak lanjut"})]})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end gap-3 mt-4",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none cursor-pointer",onClick:()=>{u(null),v(null),N(""),j("")},children:"Batal"}),!K.tanggal_selesai&&e.jsx(ye,{action:"edit",children:e.jsx("button",{type:"button",onClick:()=>{me("kognitif")},className:"bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded-md shadow-sm cursor-pointer",children:"Update"})})]})]})]},K.id))})]})}].filter(Boolean);return e.jsxs("div",{className:"block",id:"Catatan",children:[e.jsx(zl,{biodataId:a,isOpen:b,onClose:he,refetchData:Z}),e.jsx(Wl,{biodataId:a,isOpen:m,onClose:q,refetchData:Z}),e.jsx(Jl,{isOpen:p,onClose:Y,id:o,refetchData:Z,endpoint:n}),e.jsx(xa,{isOpen:L,onClose:()=>I(!1),onWaliAsuhSelected:K=>F(K)}),ae.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("ul",{className:"flex flex-wrap text-sm font-medium text-center text-gray-500 border-b border-gray-500 mt-4",children:ae.map(K=>e.jsx("li",{children:e.jsx("button",{onClick:()=>x(K.id),className:`cursor-pointer inline-block p-3 rounded-t-lg border-b-2 ${n===K.id?"text-blue-600 border-blue-600 bg-gray-200":"border-transparent hover:text-gray-600 hover:bg-gray-50"}`,children:K.label})},K.id))}),e.jsx("div",{className:"pt-4",children:(O=ae.find(K=>K.id===n))==null?void 0:O.content})]})]})},ka=a=>{const s={year:"numeric",month:"short",day:"2-digit"};return new Date(a).toLocaleDateString("id-ID",s)},Yl=({isOpen:a,onClose:s,biodataId:l,refetchData:r})=>{const{clearAuthData:n}=ke(),x=je(),{menuAngkatanSantri:b}=da(),[i,m]=t.useState({nis:"",angkatan_id:"",tanggal_masuk:""});t.useEffect(()=>{a&&m({nis:"",angkatan_id:"",tanggal_masuk:""})},[a]);const d=async p=>{if(p.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const h=sessionStorage.getItem("token")||xe("token"),c=await fetch(`${G}formulir/${l}/santri`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify(i)}),o=await c.json();if(console.log(o),k.close(),c.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}if(!c.ok){if(o.errors&&o.errors.nis){await k.fire({icon:"error",title:"Gagal",html:'<div style="text-align: center;">NIS sudah digunakan. Silakan masukkan NIS yang berbeda.</div>'});return}throw new Error(o.message||"Terjadi kesalahan pada server.")}if(!("data"in o)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: center;">${o.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),r==null||r(),s==null||s()}catch(h){console.error("Terjadi kesalahan:",h),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:d,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Tambah Data Baru"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nis",className:"block text-gray-700",children:"NIS *"}),e.jsx("input",{type:"text",inputMode:"numeric",onInput:p=>{p.target.value=p.target.value.replace(/[^0-9]/g,"")},id:"nis",name:"nis",value:i.nis,onChange:p=>m({...i,nis:p.target.value}),maxLength:50,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Masukkan NIS"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"angkatan_id",className:"block text-gray-700",children:"Angkatan *"}),e.jsx("select",{className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",onChange:p=>m({...i,angkatan_id:p.target.value}),value:i.angkatan_id,required:!0,children:b.map((p,g)=>e.jsx("option",{value:p.value,children:p.label},g))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_masuk",className:"block text-gray-700",children:"Tanggal Masuk *"}),e.jsx("input",{type:"date",id:"tanggal_masuk",name:"tanggal_masuk",value:i.tanggal_masuk,onChange:p=>m({...i,tanggal_masuk:p.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},Vl=a=>{const{clearAuthData:s}=ke(),l=je(),[r,n]=t.useState([]),[x,b]=t.useState(null),[i,m]=t.useState(null),[d,p]=t.useState(""),[g,h]=t.useState(""),[c,o]=t.useState(""),[u,w]=t.useState(""),[_,f]=t.useState(""),[v,S]=t.useState(null),[j,y]=t.useState(!0),[N,T]=t.useState(null),C=sessionStorage.getItem("token")||xe("token"),P=t.useCallback(async()=>{if(!(!a||!C))try{S(null),y(!0);const L=await fetch(`${G}formulir/${a}/santri`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`}});if(L.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}if(L.status===403)throw new Error("403");if(!L.ok)throw new Error(`Gagal fetch: ${L.status}`);const I=await L.json();n(I.data||[]),S(null)}catch(L){L.message==403?S("Akses ditolak: Anda tidak memiliki izin untuk melihat data ini."):S("Terjadi kesalahan saat mengambil data."),console.error("Gagal mengambil data santri:",v)}finally{y(!1)}},[a,C]);return t.useEffect(()=>{P()},[P]),{error:v,fetchSantri:P,santriList:r,selectedSantriId:x,selectedSantriDetail:i,angkatanId:d,endDate:g,startDate:u,status:_,loadingSantri:j,loadingDetailSantri:N,setAngkatanId:p,setEndDate:h,setStartDate:w,setStatus:f,setSelectedSantriDetail:m,setSelectedSantriId:b,handleCardClick:async L=>{try{T(L);const I=await fetch(`${G}formulir/${L}/santri/show`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`}});if(I.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}const D=await I.json();console.log(D),b(L),m(D.data),p(D.data.angkatan_id||""),h(D.data.tanggal_keluar||""),o(D.data.tanggal_keluar||""),w(D.data.tanggal_masuk||""),f(D.data.status||"")}catch(I){console.error("Gagal mengambil detail santri:",I)}finally{T(null)}},handleUpdate:async()=>{if(!i||g&&g!==c&&!(await k.fire({title:"Perhatian",text:"Pengisian Tanggal Keluar akan mengubah data domisili santri.",icon:"warning",showCancelButton:!0,confirmButtonText:"Lanjutkan",cancelButtonText:"Batal"})).isConfirmed||!(await k.fire({title:"Konfirmasi",text:"Apakah Anda yakin ingin memperbarui data santri?",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, perbarui",cancelButtonText:"Batal"})).isConfirmed)return;const I={angkatan_id:d,tanggal_masuk:u,tanggal_keluar:g||null,status:_||null};try{k.fire({title:"Mohon tunggu...",html:"Sedang memperbarui data santri.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const D=await fetch(`${G}formulir/${x}/santri`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},body:JSON.stringify(I)}),Q=await D.json();if(k.close(),D.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}if(!("data"in Q)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${Q.message||"Gagal memperbarui data pengurus."}</div>`});return}D.ok?(k.fire({icon:"success",title:"Berhasil",text:"Data berhasil diperbarui!",timer:2e3,showConfirmButton:!1}),m(Q.data||I),P()):k.fire({icon:"error",title:"Gagal update",text:Q.message||"Terjadi kesalahan saat memperbarui data"})}catch(D){console.error("Error saat update:",D),k.fire({icon:"error",title:"Error",text:"Terjadi kesalahan saat mengirim permintaan"})}}}},Hl=()=>{const{biodata_id:a}=Ue(),s=Ke("edit"),{menuAngkatanSantri:l}=da(),[r,n]=t.useState(!1),{error:x,fetchSantri:b,santriList:i,selectedSantriId:m,selectedSantriDetail:d,angkatanId:p,endDate:g,startDate:h,status:c,loadingSantri:o,loadingDetailSantri:u,setAngkatanId:w,setEndDate:_,setStartDate:f,setStatus:v,setSelectedSantriDetail:S,setSelectedSantriId:j,handleCardClick:y,handleUpdate:N}=Vl(a),T=()=>{n(!1)},C=()=>{n(!0)};return e.jsxs("div",{className:"block",id:"santri",children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center justify-between",children:["Status Santri",e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:C,type:"button",className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Tambah"})]})})]}),e.jsx(Yl,{isOpen:r,onClose:T,biodataId:a,refetchData:b}),e.jsx("div",{className:"mt-5 space-y-6",children:o?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):x?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:x}),x.includes("Akses ditolak")?null:e.jsx("button",{onClick:b,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Coba Lagi"})]}):i.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"Tidak ada data"}):i.map(P=>e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white shadow-lg drop-shadow rounded-lg p-6 cursor-pointer w-full flex justify-between items-center",onClick:()=>y(P.id),children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-bold",children:P.nis}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Sejak ",it(P.tanggal_masuk)," ","Sampai ",P.tanggal_keluar?it(P.tanggal_keluar):"Sekarang"]})]}),e.jsx("span",{className:`text-sm font-semibold px-3 py-1 rounded-full ${P.status==="aktif"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Ql(P.status)})]}),u===P.id?e.jsx("div",{className:"flex justify-center items-center mt-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):m===P.id&&d&&e.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 bg-white shadow-md rounded-lg p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nis",className:"block text-sm font-medium text-gray-700",children:"Nomor Induk Santri"}),e.jsx("input",{type:"text",id:"nis",className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-gray-200 text-gray-500",value:d.nis,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"angkatan_id",className:"block text-sm font-medium text-gray-700",children:"Angkatan *"}),e.jsx("select",{id:"angkatan_id",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!s||(d==null?void 0:d.status)!=="aktif"?"bg-gray-200 text-gray-500":""}`,onChange:F=>w(F.target.value),value:p,disabled:!s||(d==null?void 0:d.status)!=="aktif",required:!0,children:l.map((F,M)=>e.jsx("option",{value:F.value,children:F.label},M))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{id:"status",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!s||(d==null?void 0:d.status)!=="aktif"?"bg-gray-200 text-gray-500":""}`,value:c,onChange:F=>v(F.target.value),disabled:!s||(d==null?void 0:d.status)!=="aktif",children:[e.jsx("option",{value:"",children:"Pilih Status"}),e.jsx("option",{value:"aktif",children:"Aktif"}),e.jsx("option",{value:"do",children:"Drop Out"}),e.jsx("option",{value:"berhenti",children:"Berhenti"}),e.jsx("option",{value:"alumni",children:"Alumni"}),e.jsx("option",{value:"nonaktif",children:"Non Aktif"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Mulai"}),e.jsx("input",{type:"date",id:"startDate",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!s||(d==null?void 0:d.status)!=="aktif"?"bg-gray-200 text-gray-500":""}`,value:h,onChange:F=>f(F.target.value),disabled:!s||(d==null?void 0:d.status)!=="aktif"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Akhir"}),e.jsx("input",{type:"date",id:"endDate",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!s||(d==null?void 0:d.status)!=="aktif"?"bg-gray-200 text-gray-500":""}`,value:g,onChange:F=>_(F.target.value),disabled:!s||(d==null?void 0:d.status)!=="aktif"})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"flex space-x-2 mt-1",children:[e.jsx(ye,{action:"edit",children:s&&(d==null?void 0:d.status)==="aktif"&&e.jsx("button",{type:"button",className:"px-4 py-2 text-white rounded-lg hover:bg-blue-700 focus:outline-none bg-blue-600 hover:bg-blue-700 cursor-pointer",onClick:N,children:"Update"})}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none cursor-pointer",onClick:()=>{j(null),S(null),f(""),_("")},children:"Batal"})]})})]})]},P.id))})]})},it=a=>{const s={year:"numeric",month:"short",day:"2-digit"};return new Date(a).toLocaleDateString("id-ID",s)},Ql=a=>a.charAt(0).toUpperCase()+a.slice(1),Zl=({isOpen:a,onClose:s,santriId:l,biodataId:r,refetchData:n,grupWaliAsuhList:x})=>{const{clearAuthData:b}=ke(),[i,m]=t.useState({id_grup_wali_asuh:"",tanggal_mulai:""}),[d,p]=t.useState(""),[g,h]=t.useState(!1),[c,o]=t.useState([]);t.useEffect(()=>{x&&o(x.filter(_=>_.nama_grup.toLowerCase().includes(d.toLowerCase())))},[d,x]);const u=_=>{m({...i,id_grup_wali_asuh:_.id}),p(_.nama_grup),h(!1)},w=async _=>{if(_.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const v=sessionStorage.getItem("token")||xe("token"),S={...i,id_santri:l||null},j=await fetch(`${G}formulir/${r}/waliasuh`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`},body:JSON.stringify(S)});if(console.log("Response status:",j.status),console.log("response:",j),console.log("playload:",S),j.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),b();return}const y=await j.json();if(k.close(),!j.ok)throw new Error(y.message||"Terjadi kesalahan pada server.");if(!("data"in y)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${y.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data wali asuh berhasil ditambahkan."}),n==null||n(),s==null||s(),m({id_grup_wali_asuh:"",tanggal_mulai:""}),p("")}catch(v){console.error("Terjadi kesalahan:",v),await k.fire({icon:"error",title:"Oops!",text:`Terjadi kesalahan saat mengirim data. ${v.message}`})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:w,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Tambah Wali Asuh"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{htmlFor:"grupWaliAsuhId",className:"block text-sm font-medium text-gray-700",children:"Grup Wali Asuh *"}),e.jsx("input",{type:"text",placeholder:"Grup wali asuh",value:d,onChange:_=>{p(_.target.value),h(!0)},onFocus:()=>h(!0),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0}),g&&d&&c.length>0&&e.jsx("ul",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-sm max-h-48 overflow-y-auto",children:c.map(_=>e.jsx("li",{onClick:()=>u(_),className:"p-2 cursor-pointer hover:bg-gray-50",children:_.nama_grup},_.id))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_mulai",className:"block text-gray-700",children:"Tanggal Mulai *"}),e.jsx("input",{type:"date",id:"tanggal_mulai",name:"tanggal_mulai",value:i.tanggal_mulai,onChange:_=>m({...i,tanggal_mulai:_.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Batal"})]})]})]})})})]})})},Xl=({isOpen:a,onClose:s,id:l,refetchData:r})=>{const{clearAuthData:n}=ke(),[x,b]=t.useState({tanggal_berakhir:""}),i=async m=>{if(m.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const p=sessionStorage.getItem("token")||xe("token"),g=await fetch(`${G}formulir/${l}/waliasuh/keluar`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify(x)});if(console.log("formData:",x),console.log("Response status:",g.status),g.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n();return}const h=await g.json();if(k.close(),!g.ok)throw new Error(h.message||"Terjadi kesalahan pada server.");if(!("data"in h)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${h.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data keluar wali asuh berhasil disimpan."}),r==null||r(),s==null||s(),b({tanggal_berakhir:""})}catch(p){console.error("Terjadi kesalahan:",p),await k.fire({icon:"error",title:"Oops!",text:`Terjadi kesalahan saat mengirim data. ${p.message}`})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:i,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Keluar Wali Asuh"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tanggal_berakhir",className:"block text-gray-700",children:"Tanggal Keluar *"}),e.jsx("input",{type:"date",id:"tanggal_berakhir",name:"tanggal_berakhir",value:x.tanggal_berakhir,onChange:m=>b({...x,tanggal_berakhir:m.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Batal"})]})]})]})})})]})})},er=({biodata_id:a,setShowAddModal:s,setFeature:l})=>{const{clearAuthData:r}=ke(),n=je(),[x,b]=t.useState([]),[i,m]=t.useState(!1),[d,p]=t.useState(null),[g,h]=t.useState(null),[c,o]=t.useState(null),[u,w]=t.useState(null),[_,f]=t.useState(""),[v,S]=t.useState(""),[j,y]=t.useState(""),[N,T]=t.useState(""),[C,P]=t.useState(!1),[F,M]=t.useState([]),[L,I]=t.useState(!1),[D,Q]=t.useState(!1),E=sessionStorage.getItem("token")||xe("token"),B=t.useCallback(async()=>{try{I(!0),Q(!1);const z=await fetch(`${G}dropdown/grup`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`}});if(z.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r(),n("/login");return}const me=await z.json();M(me||[])}catch(z){console.error("Gagal memuat data grup kewaliasuhan:",z),Q(!0)}finally{I(!1)}},[E]),V=t.useCallback(async()=>{if(!(!a||!E))try{const z=await fetch(`${G}formulir/${a}/santri`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`}});if(z.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r(),n("/login");return}const me=await z.json();if(me.data&&me.data.length>0){const he=me.data.find(U=>U.status==="aktif");he&&h(he.id)}}catch(z){console.error("Gagal mengambil data Santri:",z)}},[a,E]),ne=t.useCallback(async()=>{if(!(!a||!E))try{P(!1),m(!0);const z=await fetch(`${G}formulir/${a}/waliasuh`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`}});if(z.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r(),n("/login");return}if(!z.ok)throw new Error(`Gagal fetch: ${z.status}`);const me=await z.json();b(me.data||[])}catch(z){console.error("Gagal mengambil data Wali Asuh:",z),P(!0)}finally{m(!1)}},[a,E]);return t.useEffect(()=>{V(),ne(),B()},[V,ne,B]),{error:C,waliAsuhList:x,loadingWaliAsuh:i,fetchWaliAsuh:ne,handleCardClick:async z=>{try{p(z);const me=await fetch(`${G}formulir/${z}/waliasuh/show`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`}});if(me.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r(),n("/login");return}const he=await me.json();o(z),w(he.data),S(he.data.tanggal_akhir||""),f(he.data.tanggal_mulai||""),y(he.data.grup||""),T(he.data.nis||"")}catch(me){console.error("Gagal mengambil detail Wali Asuh:",me)}finally{p(null)}},loadingDetailWaliAsuhId:d,selectedWaliAsuhDetail:u,setSelectedWaliAsuhDetail:w,selectedWaliAsuhId:c,setSelectedWaliAsuhId:o,startDate:_,endDate:v,grupWaliAsuhId:j,nis:N,setStartDate:f,setEndDate:S,setGrupWaliAsuhId:y,setNis:T,handleUpdate:async()=>{if(!u||!g)return;const z={id_santri:g,id_grup_wali_asuh:j,tanggal_mulai:_,nis:N||null};try{k.fire({title:"Mohon tunggu...",html:"Sedang memperbarui data wali asuh.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const me=await fetch(`${G}formulir/${c}/waliasuh`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`},body:JSON.stringify(z)});if(me.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r(),n("/login");return}const he=await me.json();k.close(),me.ok?(k.fire({icon:"success",title:"Berhasil",text:"Data berhasil diperbarui!",timer:2e3,showConfirmButton:!1}),w(he.data||z),ne()):k.fire({icon:"error",title:"Gagal update",text:he.message||"Terjadi kesalahan saat memperbarui data"})}catch(me){console.error("Error saat update:",me),k.fire({icon:"error",title:"Error",text:"Terjadi kesalahan saat mengirim permintaan"})}console.log("Payload untuk update:",z)},handleOpenAddModalWithDetail:async(z,me)=>{o(z),l(me),s(!0)},santriId:g,menuGrupWaliAsuh:F,loadingGrupWaliAsuh:L,errorGrupWaliAsuh:D,fetchDropdownGrup:B}},ar=()=>{const{biodata_id:a}=Ue(),[s,l]=t.useState(!1),[r,n]=t.useState(!1),[x,b]=t.useState(null),[i,m]=t.useState(""),[d,p]=t.useState(!1),{error:g,waliAsuhList:h,loadingWaliAsuh:c,fetchWaliAsuh:o,handleCardClick:u,loadingDetailWaliAsuhId:w,selectedWaliAsuhDetail:_,setSelectedWaliAsuhDetail:f,selectedWaliAsuhId:v,setSelectedWaliAsuhId:S,startDate:j,endDate:y,grupWaliAsuhId:N,nis:T,setStartDate:C,setGrupWaliAsuhId:P,handleUpdate:F,santriId:M,menuGrupWaliAsuh:L}=er({biodata_id:a,setShowAddModal:l,setFeature:b}),I=()=>{l(!1)},D=()=>{l(!0)},Q=()=>{n(!1)},E=te=>{S(te),n(!0)},B=te=>{const R={year:"numeric",month:"short",day:"2-digit"};return new Date(te).toLocaleDateString("id-ID",R)};t.useEffect(()=>{if(_!=null&&_.grup&&L.length>0){const te=L.find(R=>R.nama_grup===N);te&&m(te.nama_grup)}},[_,L]);const V=te=>{m(te.nama_grup),P(te.id),p(!1)},ne=L.filter(te=>te.nama_grup.toLowerCase().includes(i.toLowerCase()));return e.jsxs("div",{className:"block",id:"wali-asuh",children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center justify-between",children:["Wali Asuh",e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>{b(1),D()},type:"button",className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Tambah"})]})})]}),e.jsx(Zl,{isOpen:s,onClose:I,biodataId:a,feature:x,refetchData:o,santriId:M,grupWaliAsuhList:L}),e.jsx(Xl,{isOpen:r,onClose:Q,id:v,refetchData:o}),e.jsx("div",{className:"mt-5 space-y-6",children:c?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):g?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:o,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Coba Lagi"})]}):h.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"Tidak ada data"}):h.map(te=>e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white shadow-lg drop-shadow rounded-lg p-6 cursor-pointer w-full flex flex-col items-start gap-2",onClick:()=>{u(te.id)},children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"text-lg font-bold",children:["NIS: ",te.nis||"-"]}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Sejak ",B(te.tanggal_mulai)," ","Sampai ",te.tanggal_akhir?B(te.tanggal_akhir):"Sekarang"]})]}),e.jsx("span",{className:`text-sm font-semibold capitalize px-3 py-1 rounded-full ${te.status===1?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:te.status===1?"Aktif":"Non Aktif"})]}),!te.tanggal_akhir&&e.jsx("div",{className:"flex flex-wrap gap-2 gap-x-4 mt-2",children:e.jsx(ye,{action:"keluar",children:e.jsxs("button",{type:"button",onClick:R=>{R.stopPropagation(),E(te.id)},className:"justify-end text-yellow-600 hover:text-yellow-800 flex items-center gap-1 cursor-pointer",title:"Keluar Wali Asuh",children:[e.jsx(ge,{icon:Ve}),"Keluar"]})})})]}),w===te.id?e.jsx("div",{className:"flex justify-center items-center mt-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):v===te.id&&_&&e.jsxs("form",{className:"grid grid-cols-1 gap-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nis",className:"block text-sm font-medium text-gray-700",children:"NIS"}),e.jsx("input",{type:"text",id:"nis",className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-gray-200 text-gray-500",value:T||"-",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Mulai"}),e.jsx("input",{type:"date",id:"startDate",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${_.status===0?"bg-gray-200 text-gray-500":""}`,value:j,onChange:R=>C(R.target.value),disabled:(_==null?void 0:_.status)===0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{htmlFor:"grupWaliAsuhId",className:"block text-sm font-medium text-gray-700",children:"Grup Wali Asuh *"}),e.jsx("input",{type:"text",placeholder:"Grup wali asuh",value:i,onChange:R=>{m(R.target.value),p(!0)},onFocus:()=>p(!0),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),d&&i&&ne.length>0&&e.jsx("ul",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-sm max-h-48 overflow-y-auto",children:ne.map(R=>e.jsx("li",{onClick:()=>V(R),className:"p-2 cursor-pointer hover:bg-gray-50",children:R.nama_grup},R.id))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700",children:"Tanggal Akhir"}),e.jsx("input",{type:"date",id:"endDate",className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-gray-200 text-gray-500",value:y,disabled:!0})]})]}),e.jsxs("div",{className:"flex space-x-2 mt-1",children:[te.status===1&&e.jsx(ye,{action:"edit",children:e.jsx("button",{type:"button",className:"px-4 py-2 text-white rounded-lg hover:bg-blue-700 focus:outline-none bg-blue-600 hover:bg-blue-700 cursor-pointer",onClick:F,children:"Update"})}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none cursor-pointer",onClick:()=>{S(null),f(null),C(""),m(""),p(!1)},children:"Batal"})]})]})]},te.id))})]})},tr=({filterOptions:a,onChange:s,selectedFilters:l})=>{const r=n=>n.charAt(0).toUpperCase()+n.slice(1);return e.jsx("div",{className:"flex flex-col gap-4 w-full",children:Object.entries(a).map(([n,x],b)=>e.jsxs("div",{children:[e.jsxs("label",{htmlFor:n,className:"block text-gray-700",children:[r(n)," *"]}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:i=>s({[n]:i.target.value}),value:l[n]||"",disabled:x.length<=1,children:x.map((i,m)=>e.jsx("option",{value:i.value,children:i.label},m))})]},`${n}-${b}`))})},sr=({isOpen:a,onClose:s,biodataId:l,cardId:r,refetchData:n,feature:x})=>{const{clearAuthData:b}=ke(),i=je(),{filterLembaga:m,handleFilterChangeLembaga:d,selectedLembaga:p}=Te(),g=(S,j)=>S.length>0?[{...S[0],label:j},...S.slice(1)]:S,h={lembaga:g(m.lembaga,"Pilih Lembaga"),jurusan:g(m.jurusan,"Pilih Jurusan"),kelas:g(m.kelas,"Pilih Kelas"),rombel:g(m.rombel,"Pilih Rombel")},c=x==1,o=c?"walikelas":"walikelas/pindah",u=c?"POST":"PUT",w=c?l:r,[_,f]=t.useState({lembaga_id:"",jurusan_id:"",kelas_id:"",rombel_id:"",jumlah_murid:"",periode_awal:""});t.useEffect(()=>{f(S=>({...S,lembaga_id:p.lembaga||"",jurusan_id:p.jurusan||"",kelas_id:p.kelas||"",rombel_id:p.rombel||""}))},[p]);const v=async S=>{if(S.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const y=sessionStorage.getItem("token")||xe("token"),N=await fetch(`${G}formulir/${w}/${o}`,{method:u,headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify(_)}),T=await N.json();if(k.close(),N.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),b(),i("/login");return}if(!N.ok)throw new Error(T.message||"Terjadi kesalahan pada server.");if(!("data"in T)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: center;">${T.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),n==null||n(),s==null||s()}catch(y){console.error("Terjadi kesalahan:",y),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:v,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:x===1?"Tambah Data Baru":"Pindah"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(tr,{filterOptions:h,onChange:d,selectedFilters:p}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"jumlah_murid",className:"block text-gray-700",children:"Jumlah Murid *"}),e.jsx("input",{type:"text",inputMode:"numeric",onInput:S=>{S.target.value=S.target.value.replace(/[^0-9]/g,"")},id:"jumlah_murid",name:"jumlah_murid",value:_.jumlah_murid,onChange:S=>f({..._,jumlah_murid:S.target.value}),maxLength:50,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Masukkan Jumlah Murid"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"periode_awal",className:"block text-gray-700",children:"Periode Awal *"}),e.jsx("input",{type:"date",id:"periode_awal",name:"periode_awal",value:_.periode_awal,onChange:S=>f({..._,periode_awal:S.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},nr=({isOpen:a,onClose:s,id:l,refetchData:r})=>{const{clearAuthData:n}=ke(),x=je(),[b,i]=t.useState({periode_akhir:""}),m=async d=>{if(d.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const g=sessionStorage.getItem("token")||xe("token"),h=await fetch(`${G}formulir/${l}/walikelas/keluar`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify(b)}),c=await h.json();if(k.close(),h.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}if(!h.ok)throw new Error(c.message||"Terjadi kesalahan pada server.");if(!("data"in c)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${c.message}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),r==null||r(),s==null||s()}catch(g){console.error("Terjadi kesalahan:",g),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-300 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:m,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Masukkan Tanggal"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"periode_akhir",className:"block text-gray-700",children:"Periode Akhir *"}),e.jsx("input",{type:"date",id:"periode_akhir",name:"periode_akhir",value:b.periode_akhir,onChange:d=>i({...b,periode_akhir:d.target.value}),required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},lr=()=>{const{biodata_id:a}=Ue(),{clearAuthData:s}=ke(),l=je(),r=Ke("edit"),n=Ke("pindah"),x=Ke("keluar"),[b,i]=t.useState(!1),[m,d]=t.useState(!1),[p,g]=t.useState([]),[h,c]=t.useState(null),[o,u]=t.useState(null),[w,_]=t.useState(""),[f,v]=t.useState(""),[S,j]=t.useState(""),[y,N]=t.useState(null),[T,C]=t.useState(null),[P,F]=t.useState(!0),[M,L]=t.useState(null),{filterLembaga:I,handleFilterChangeLembaga:D,selectedLembaga:Q}=Te(),E=(U,q)=>U.length>0?[{...U[0],label:q},...U.slice(1)]:U,B={lembaga:E(I.lembaga,"Pilih Lembaga"),jurusan:E(I.jurusan,"Pilih Jurusan"),kelas:E(I.kelas,"Pilih Kelas"),rombel:E(I.rombel,"Pilih Rombel")},V=t.useCallback(async()=>{const U=sessionStorage.getItem("token")||xe("token");if(!(!a||!U))try{C(null),F(!0);const q=await fetch(`${G}formulir/${a}/walikelas`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${U}`}});if(q.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}if(q.status===403)throw new Error("403");if(!q.ok)throw new Error(`Gagal fetch: ${q.status}`);const se=await q.json();console.log(se),g(se.data||[]),C(null)}catch(q){q.message==403?C("Akses ditolak: Anda tidak memiliki izin untuk melihat data ini."):C("Terjadi kesalahan saat mengambil data."),console.error("Gagal mengambil data WaliKelas:",T)}finally{F(!1)}},[a]);t.useEffect(()=>{V()},[V]),t.useEffect(()=>{o&&(o.lembaga_id&&D({lembaga:o.lembaga_id}),o.jurusan_id&&D({jurusan:o.jurusan_id}),o.kelas_id&&D({kelas:o.kelas_id}),o.rombel_id&&D({rombel:o.rombel_id}))},[o]);const ne=async U=>{try{L(U);const q=sessionStorage.getItem("token")||xe("token"),se=await fetch(`${G}formulir/${U}/walikelas/show`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${q}`}});if(se.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}const Y=await se.json();console.log(Y),c(U),u(Y.data),_(Y.data.jumlah_murid||""),v(Y.data.periode_akhir||""),j(Y.data.periode_awal||"")}catch(q){console.error("Gagal mengambil detail WaliKelas:",q)}finally{L(null)}},te=async()=>{if(!o)return;const{lembaga:U,jurusan:q,kelas:se,rombel:Y}=Q;if(!U||!q||!se||!Y){alert("Semua dropdown (Lembaga, Jurusan, Kelas, Rombel) harus dipilih.");return}const de={lembaga_id:U,jurusan_id:q,kelas_id:se,rombel_id:Y,jumlah_murid:20,periode_awal:S};console.log("Payload yang dikirim ke API:",de);try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const oe=sessionStorage.getItem("token")||xe("token"),W=await fetch(`${G}formulir/${h}/walikelas`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${oe}`},body:JSON.stringify(de)});if(W.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}console.log(`${G}formulir/${h}/walikelas`);const X=await W.json();k.close(),W.ok?(alert(`Data berhasil diperbarui! ${X.message}-${X.data}`),u(X.data||de)):alert("Gagal update: "+(X.message||"Terjadi kesalahan"))}catch(oe){console.error("Error saat update:",oe)}},R=()=>{i(!1)},Z=()=>{i(!0)},z=()=>{d(!1)},me=U=>{c(U),d(!0)},he=({filterOptions:U,onChange:q,selectedFilters:se})=>e.jsx("div",{className:"flex flex-col gap-4 w-full",children:Object.entries(U).map(([Y,de],oe)=>e.jsxs("div",{children:[e.jsxs("label",{htmlFor:Y,className:"block text-sm font-medium text-gray-700",children:[rr(Y)," *"]}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${de.length<=1||!r||o.status_aktif==="tidak aktif"?"bg-gray-200 text-gray-500":""}`,onChange:W=>q({[Y]:W.target.value}),value:se[Y]||"",disabled:de.length<=1||!r||o.status_aktif==="tidak aktif",children:de.map((W,X)=>e.jsx("option",{value:W.value,children:W.label},X))})]},`${Y}-${oe}`))});return e.jsxs("div",{className:"block",id:"WaliKelas",children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center justify-between",children:["Wali Kelas",e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:()=>{N(1),Z()},type:"button",className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Tambah"})]})})]}),e.jsx(sr,{isOpen:b,onClose:R,biodataId:a,cardId:h,refetchData:V,feature:y}),e.jsx(nr,{isOpen:m,onClose:z,id:h,refetchData:V}),e.jsx("div",{className:"mt-5 space-y-6",children:P?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):T?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:T}),T.includes("Akses ditolak")?null:e.jsx("button",{onClick:V,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Coba Lagi"})]}):p.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"Tidak ada data"}):p.map(U=>e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white shadow-lg drop-shadow rounded-lg p-6 cursor-pointer w-full flex flex-col items-start gap-2",onClick:()=>ne(U.id),children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-bold",children:U.Lembaga}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Sejak ",ot(U.Periode_awal)," ","Sampai ",U.Periode_akhir?ot(U.Periode_akhir):"Sekarang"]})]}),e.jsx("span",{className:`text-sm font-semibold capitalize px-3 py-1 rounded-full ${U.status_aktif==="aktif"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:U.status_aktif||"-"})]}),!U.Periode_akhir&&e.jsxs("div",{className:`flex flex-wrap gap-2 gap-x-4 ${n||x?"":"mt-2"}`,children:[e.jsx(ye,{action:"pindah",children:e.jsxs("button",{type:"button",onClick:q=>{q.stopPropagation(),N(2),Z()},className:"text-blue-600 hover:text-blue-800 flex items-center gap-1 cursor-pointer",title:"Pindah Khadam",children:[e.jsx(ge,{icon:na}),"Pindah"]})}),e.jsx(ye,{action:"keluar",children:e.jsxs("button",{type:"button",onClick:q=>{q.stopPropagation(),me(U.id)},className:"justify-end text-yellow-600 hover:text-yellow-800 flex items-center gap-1 cursor-pointer",title:"Keluar Khadam",children:[e.jsx(ge,{icon:Ve}),"Keluar"]})})]})]}),M===U.id?e.jsx("div",{className:"flex justify-center items-center mt-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):h===U.id&&o&&e.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx(he,{filterOptions:B,onChange:D,selectedFilters:Q})}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700",children:"Jumlah Murid"}),e.jsx("input",{type:"text",inputMode:"numeric",onInput:q=>{q.target.value=q.target.value.replace(/[^0-9]/g,"")},id:"jumlah_murid",name:"jumlah_murid",value:w,onChange:q=>_(q.target.value),maxLength:50,placeholder:"Masukkan Jumlah Murid",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||o.status_aktif==="tidak aktif"?"bg-gray-200 text-gray-500":""}`,disabled:!r||(o==null?void 0:o.status_aktif)==="tidak aktif"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700",children:"Periode Awal"}),e.jsx("input",{type:"date",id:"startDate",className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${!r||o.status_aktif==="tidak aktif"?"bg-gray-200 text-gray-500":""}`,disabled:!r||(o==null?void 0:o.status_aktif)==="tidak aktif",value:S,onChange:q=>j(q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700",children:"Periode Akhir"}),e.jsx("input",{type:"date",id:"endDate",className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500  bg-gray-200 text-gray-500",value:f,onChange:q=>v(q.target.value),disabled:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:" "}),e.jsxs("div",{className:"flex space-x-2 mt-1",children:[U.status_aktif==="aktif"&&e.jsx(ye,{action:"edit",children:e.jsx("button",{type:"button",className:"px-4 py-2 text-white rounded-lg hover:bg-blue-700 focus:outline-none bg-blue-600 hover:bg-blue-700 cursor-pointer",onClick:te,children:"Update"})}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none cursor-pointer",onClick:()=>{c(null),u(null),j(""),v("")},children:"Batal"})]})]})]})]},U.id))})]})},ot=a=>{const s={year:"numeric",month:"short",day:"2-digit"};return new Date(a).toLocaleDateString("id-ID",s)},rr=a=>a.charAt(0).toUpperCase()+a.slice(1),ir=a=>{const{clearAuthData:s}=ke(),l=je(),[r,n]=t.useState([]),[x,b]=t.useState(null),[i,m]=t.useState(null),[d,p]=t.useState(null),[g,h]=t.useState(""),[c,o]=t.useState(""),[u,w]=t.useState(!0),[_,f]=t.useState(null),v=sessionStorage.getItem("token")||xe("token"),S=t.useCallback(async()=>{if(!(!a||!v))try{p(null),w(!0);const N=await fetch(`${G}formulir/${a}/wargapesantren`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`}});if(N.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}if(N.status===403)throw new Error("403");if(!N.ok)throw new Error(`Gagal fetch: ${N.status}`);const T=await N.json();n(T.data||[]),p(null)}catch(N){N.message==403?p("Akses ditolak: Anda tidak memiliki izin untuk melihat data ini."):p("Terjadi kesalahan saat mengambil data."),console.error("Gagal mengambil data warPes:",d)}finally{w(!1)}},[a,v]);return t.useEffect(()=>{S()},[S]),{error:d,fetchWarPes:S,niup:g,setNiup:h,aktif:c,setAktif:o,warPesList:r,selectedWarPesId:x,selectedWarPesDetail:i,loadingWarPes:u,loadingDetailWarPes:_,setSelectedWarPesDetail:m,setSelectedWarPesId:b,handleCardClick:async N=>{try{f(N);const T=await fetch(`${G}formulir/${N}/wargapesantren/show`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`}});if(T.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}const C=await T.json();b(N),m(C.data),h(C.data.niup),o(C.data.status)}catch(T){console.error("Gagal mengambil detail wargapesantren:",T)}finally{f(null)}},handleUpdate:async()=>{if(!i)return;const N={niup:g,status:c};try{k.fire({title:"Mohon tunggu...",html:"Sedang memperbarui data.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),console.log("Payload yang dikirim ke API:",JSON.stringify(N,null,2));const T=await fetch(`${G}formulir/${x}/wargapesantren`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`},body:JSON.stringify(N)});if(T.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),s(),l("/login");return}const C=await T.json();if(console.log(C),k.close(),!("data"in C)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${C.message||"Gagal memperbarui data pengurus."}</div>`});return}T.ok?(k.fire({icon:"success",title:"Berhasil",text:"Data berhasil diperbarui!",timer:2e3,showConfirmButton:!1}),m(C.data||N),S()):k.fire({icon:"error",title:"Gagal update",text:C.message||"Terjadi kesalahan saat memperbarui data"})}catch(T){console.error("Error saat update:",T),k.fire({icon:"error",title:"Error",text:"Terjadi kesalahan saat mengirim permintaan"})}}}},or=({isOpen:a,onClose:s,biodataId:l,refetchData:r})=>{const{clearAuthData:n}=ke(),x=je(),[b,i]=t.useState({niup:"",status:""}),m=async d=>{if(d.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const g=sessionStorage.getItem("token")||xe("token"),h=await fetch(`${G}formulir/${l}/wargapesantren`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify(b)}),c=await h.json();if(k.close(),h.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),n(),x("/login");return}if(!h.ok)throw new Error(c.message||"Terjadi kesalahan pada server.");if(!("data"in c)){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${c.message||"Gagal memperbarui data pengurus."}</div>`});return}await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),r==null||r(),s==null||s()}catch(g){console.error("Terjadi kesalahan:",g),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:m,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Tambah Data Baru"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"niup",className:"block text-gray-700",children:"NIUP *"}),e.jsx("input",{type:"text",inputMode:"numeric",onInput:d=>{d.target.value=d.target.value.replace(/[^0-9]/g,"")},id:"niup",name:"niup",value:b.niup,onChange:d=>i({...b,niup:d.target.value}),maxLength:50,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Masukkan NIUP"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700",children:"Status Aktif *"}),e.jsxs("div",{className:"flex space-x-4 mt-1",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"status",value:"YA",checked:b.status===!0,onChange:()=>i({...b,status:!0}),className:"form-radio text-blue-500 focus:ring-blue-500",required:!0}),e.jsx("span",{className:"ml-2 text-gray-700",children:"Ya"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"status",value:"TIDAK",checked:b.status===!1,onChange:()=>i({...b,status:!1}),className:"form-radio text-blue-500 focus:ring-blue-500",required:!0}),e.jsx("span",{className:"ml-2 text-gray-700",children:"Tidak"})]})]})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"cursor-pointer w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"cursor-pointer mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},dr=()=>{const{biodata_id:a}=Ue(),s=Ke("edit"),[l,r]=t.useState(!1),{error:n,fetchWarPes:x,niup:b,setNiup:i,aktif:m,setAktif:d,warPesList:p,selectedWarPesId:g,selectedWarPesDetail:h,loadingWarPes:c,loadingDetailWarPes:o,setEndDate:u,setStartDate:w,setSelectedWarPesDetail:_,setSelectedWarPesId:f,handleCardClick:v,handleUpdate:S}=ir(a),j=()=>{r(!1)},y=()=>{r(!0)};return e.jsxs("div",{className:"block",id:"warPes",children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center justify-between",children:["Warga Pesantren",e.jsx(ye,{action:"tambah",children:e.jsxs("button",{onClick:y,type:"button",className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm font-semibold flex items-center space-x-2 hover:bg-green-800 cursor-pointer",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Tambah"})]})})]}),e.jsx(or,{isOpen:l,onClose:j,biodataId:a,refetchData:x}),e.jsx("div",{className:"mt-5 space-y-6",children:c?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):n?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:n}),n.includes("Akses ditolak")?null:e.jsx("button",{onClick:x,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Coba Lagi"})]}):p.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"Tidak ada data"}):p.map(N=>e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white shadow-lg drop-shadow rounded-lg p-6 cursor-pointer w-full flex justify-between items-center",onClick:()=>v(N.id),children:[e.jsx("div",{children:e.jsx("h5",{className:"text-lg font-bold",children:N.niup})}),e.jsx("span",{className:`text-sm font-semibold capitalize px-3 py-1 rounded-full ${N.status?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:N.status||"-"})]}),o===N.id?e.jsx("div",{className:"flex justify-center items-center mt-4",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})}):g===N.id&&h&&e.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{className:"col-span-3 flex items-center",children:[e.jsx("label",{htmlFor:"niup",className:"w-1/8 text-sm font-medium text-gray-700",children:"NIUP"}),e.jsx("input",{type:"text",id:"niup",className:"w-1/3 p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-gray-200 text-gray-500",value:b,onChange:T=>i(T.target.value),disabled:!0})]}),e.jsxs("div",{className:"col-span-3 flex items-center",children:[e.jsx("label",{className:"w-1/8 text-sm font-medium text-gray-700",children:"Aktif"}),e.jsxs("div",{className:"w-1/3 flex space-x-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"aktif",value:"true",className:"form-radio text-blue-500 focus:ring-blue-500",checked:m===!0,onChange:()=>d(!0),disabled:!s}),e.jsx("span",{className:"ml-2 text-gray-700",children:"Ya"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"aktif",value:"false",checked:m===!1,onChange:()=>d(!1),className:"form-radio text-blue-500 focus:ring-blue-500",disabled:!s}),e.jsx("span",{className:"ml-2 text-gray-700",children:"Tidak"})]})]})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"w-2/3 flex space-x-2",children:[e.jsx(ye,{action:"edit",children:e.jsx("button",{type:"button",className:"px-4 py-2 text-white bg-blue-600 hover:bg-blue-700 rounded-lg focus:outline-none",onClick:S,children:"Update"})}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none",onClick:()=>{f(null),_(null),w(""),u("")},children:"Batal"})]})})]})]},N.id))})]})},cr=()=>{const a=t.useMemo(()=>({status:"sudah berada diluar pondok"}),[]),s=t.useMemo(()=>({status:"telat(belum kembali)"}),[]),{loadingPesertaDidik:l,totalDataPesertaDidik:r}=wt(),{loadingPengajar:n,totalDataPengajar:x}=ft(),{loadingSantri:b,totalDataSantri:i}=Fa(),{loadingPelajar:m,totalDataPelajar:d}=Ca(),{loadingKhadam:p,totalDataKhadam:g}=jt(),{loadingAlumni:h,totalDataAlumni:c}=pt(),{loadingOrangtua:o,totalDataOrangtua:u}=kt(),{loadingWaliAsuh:w,totalDataWaliAsuh:_}=_t(),{loadingPengurus:f,totalDataPengurus:v}=yt(),{loadingKaryawan:S,totalDataKaryawan:j}=bt(),{loadingPegawai:y,totalDataPegawai:N}=Nt(),{loadingWali:T,totalDataWali:C}=vt(),{loading:P,totalData:F}=Oa(a),{loading:M,totalData:L}=Oa(s),I=()=>e.jsx("div",{className:"col-span-3 flex justify-left items-left p-1",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-white"})}),D=[{label:"Total Peserta Didik",value:l?e.jsx(I,{}):r,color:"bg-green-500",icon:"📝",link:"/peserta-didik"},{label:"Total Santri",value:b?e.jsx(I,{}):i,color:"bg-yellow-500",icon:"👥",link:"/peserta-didik/santri"},{label:"Total Pelajar",value:m?e.jsx(I,{}):d,color:"bg-red-500",icon:"📚",link:"/peserta-didik/pelajar"},{label:"Total Wali Asuh",value:w?e.jsx(I,{}):_,color:"bg-blue-500",icon:"📖",link:"/wali-asuh"},{label:"Total Pengajar",value:n?e.jsx(I,{}):x,color:"bg-gray-500",icon:"👨‍🏫",link:"/pengajar"},{label:"Total Pengurus",value:f?e.jsx(I,{}):v,color:"bg-pink-500",icon:"✍️",link:"/pengurus"},{label:"Total Karyawan",value:S?e.jsx(I,{}):j,color:"bg-green-700",icon:"👨🏻‍💻",link:"/karyawan"},{label:"Total Pegawai",value:y?e.jsx(I,{}):N,color:"bg-yellow-700",icon:"👨‍💼",link:"/pegawai"},{label:"Total Khadam",value:p?e.jsx(I,{}):g,color:"bg-red-700",icon:"👳",link:"/khadam"},{label:"Total Alumni",value:h?e.jsx(I,{}):c,color:"bg-blue-700",icon:"🎓",link:"/alumni"},{label:"Total Orang Tua",value:o?e.jsx(I,{}):u,color:"bg-purple-500",icon:"👨‍👨‍👦",link:"/orang-tua"},{label:"Total Wali",value:T?e.jsx(I,{}):C,color:"bg-indigo-500",icon:"🔢",link:"/wali"},{label:"Dalam Masa Izin",value:P?e.jsx(I,{}):F,color:"bg-orange-500",icon:"⏳",link:"/perizinan"},{label:"Telat Belum Kembali",value:M?e.jsx(I,{}):L,color:"bg-red-400",icon:"🚨",link:"/pelanggaran"}],[Q,E]=t.useState([]);return t.useEffect(()=>{is.get("").then(B=>{const V=new Date().toISOString().split("T")[0],ne=B.data.filter(te=>te.birthday===V);E(ne)}).catch(B=>{console.error("Error fetching data:",B)})},[]),e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard"})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:e.jsx("div",{className:"flex flex-wrap items-center mb-4",children:e.jsxs("div",{className:"w-full min-h-screen",children:[e.jsx("div",{className:"grid grid-cols-1 [@media(min-width:714px)]:grid-cols-2 [@media(min-width:910px)]:grid-cols-3 grid-cols-custom gap-4",children:D.map((B,V)=>e.jsxs("div",{className:`p-4 rounded-lg shadow-lg text-white ${B.color}`,children:[e.jsx("div",{className:"text-4xl",children:B.icon}),e.jsx("h2",{className:"text-lg font-semibold",children:B.value}),e.jsx("p",{children:B.label}),e.jsxs(Ye,{to:B.link,className:"mt-3 flex justify-between items-center gap-2 bg-white text-gray-800 px-4 py-2 rounded-lg text-sm font-semibold hover:bg-gray-200 transition w-full cursor-pointer",children:[e.jsx("span",{children:"Selengkapnya"})," ",e.jsx(ge,{icon:ut})]})]},V))}),e.jsx("h2",{className:"text-2xl font-semibold mt-6",children:"Ulang Tahun Hari Ini"}),e.jsx("div",{className:"overflow-x-auto mt-6",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 whitespace-nowrap",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"NIK"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Jenis Kelamin"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal Lahir"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Alamat"})]})}),e.jsx("tbody",{className:"text-gray-800",children:Q.length>0?Q.map((B,V)=>e.jsxs("tr",{className:"hover:bg-gray-50 whitespace-nowrap text-center",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:V+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:B.nik}),e.jsx("td",{className:"px-3 py-2 border-b",children:B.name}),e.jsx("td",{className:"px-3 py-2 border-b",children:B.gender}),e.jsx("td",{className:"px-3 py-2 border-b",children:B.birthday}),e.jsx("td",{className:"px-3 py-2 border-b",children:B.location})]},V)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"p-2 text-center",children:"Tidak ada yang ulang tahun hari ini"})})})]})})]})})})]})},St=()=>{const{biodata_id:a}=Ue(),s=Ea(),l=je();return t.useEffect(()=>{if(a)sessionStorage.setItem("last_biodata_id",a);else{const r=sessionStorage.getItem("last_biodata_id"),n=s.pathname==="/formulir";r&&n&&l(`/formulir/${r}/${fa[0].link}`,{replace:!0})}},[a,l,s.pathname]),e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Formulir"})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:a?e.jsxs(e.Fragment,{children:[e.jsx("nav",{"aria-label":"Breadcrumb",children:e.jsx("ol",{className:"flex flex-wrap rounded border border-gray-300 bg-white text-sm text-gray-700",children:fa.map((r,n)=>{const x=`/formulir/${a}/${r.link}`,b=s.pathname===x,i=b?"bg-gray-500 text-white font-semibold":"bg-white",m=b?"bg-gray-500":"bg-white";return e.jsxs("li",{className:"flex",children:[e.jsx(Ye,{to:x,className:`block h-10 pr-4 pl-6 leading-10 transition-colors ${i}`,children:r.label}),n<fa.length&&e.jsx("div",{className:"relative flex items-center",children:e.jsx("span",{className:`absolute inset-y-0 -start-px h-10 w-4 ${m} [clip-path:_polygon(0_0,_0%_100%,_100%_50%)] rtl:rotate-180`})})]},r.id)})})}),e.jsx("div",{className:"p-4 relative",children:e.jsx(Ua,{})})]}):e.jsxs("div",{className:"text-center text-gray-600 py-12",children:[e.jsx("p",{className:"text-lg font-medium",children:"Belum ada data yang dipilih."}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Silakan pilih data terlebih dahulu untuk melihat formulir."})]})})]})},dt=({filterOptions:a,onChange:s,selectedFilters:l,vertical:r=!1})=>e.jsx(e.Fragment,{children:Object.entries(a).map(([n,x],b)=>e.jsxs("div",{className:`mb-4 ${r?"w-full":"w-full px-2 sm:w-1/2 md:w-1/3"}`,children:[r&&e.jsxs("label",{className:"block text-gray-700 mb-1 capitalize",children:[n," Tujuan"]}),e.jsx("select",{className:`w-full border border-gray-300 rounded p-2 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:i=>s({[n]:i.target.value}),value:l[n]||"",disabled:x.length<=1,required:r,children:x.map((i,m)=>e.jsx("option",{value:i.value,children:i.label},m))})]},`${n}-${b}`))}),mr=()=>{var te,R,Z;const{clearAuthData:a}=ke(),s=je(),[l,r]=t.useState([]),[n,x]=t.useState(!1),[b,i]=t.useState({wilayah:"",blok:"",kamar:""});t.useEffect(()=>{console.log(l)},[l]);const{filterWilayah:m,handleFilterChangeWilayah:d,selectedWilayah:p}=Be(),{filterWilayah:g,handleFilterChangeWilayah:h,selectedWilayah:c}=Be(),o=p.wilayah!=="",{santri:u,loadingSantri:w,error:_,setLimit:f,totalDataSantri:v,fetchData:S,fetchAllData:j,limit:y,searchTerm:N,setSearchTerm:T,totalPages:C,currentPage:P,setCurrentPage:F,allSantriIds:M}=Fa(b),L=(z,me)=>z.length>0?[{...z[0],label:me},...z.slice(1)]:z,I={wilayah:L(m.wilayah,"Pilih Wilayah"),blok:L(m.blok,"Pilih Blok"),kamar:L(m.kamar,"Pilih Kamar")},D={wilayah:L(g.wilayah,"-- Pilih Wilayah --"),blok:L(g.blok,"-- Pilih Blok --"),kamar:L(g.kamar,"-- Pilih Kamar --")},Q=((te=m.wilayah.find(z=>z.value==p.wilayah))==null?void 0:te.label)||"",E=((R=m.blok.find(z=>z.value==p.blok))==null?void 0:R.label)||"",B=((Z=m.kamar.find(z=>z.value==p.kamar))==null?void 0:Z.label)||"";t.useEffect(()=>{(Q||E||B)&&i({wilayah:Q,blok:E,kamar:B})},[Q,E,B]),t.useEffect(()=>{n&&M.length>0&&r(M)},[M]);const V=async z=>{if(z.preventDefault(),l.length===0){await k.fire({icon:"warning",title:"Peringatan",text:"Pilih minimal satu santri untuk dipindah."});return}if(!(await k.fire({title:"Yakin ingin memproses perpindahan?",text:"Pastikan data tujuan sudah sesuai.",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, proses",cancelButtonText:"Batal"})).isConfirmed)return;const he={santri_id:l,wilayah_id:c.wilayah,blok_id:c.blok,kamar_id:c.kamar};try{k.fire({title:"Mohon tunggu...",html:"Sedang memproses perpindahan.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const U=sessionStorage.getItem("token")||xe("token"),q=await fetch(`${G}fitur/pindah-kamar`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${U}`},body:JSON.stringify(he)}),se=await q.json();if(k.close(),q.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),a(),s("/login");return}if(!q.ok){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${se.message||"Terjadi kesalahan saat memproses perpindahan."}</div>`});return}await k.fire({icon:"success",title:"Berhasil",text:"Pindah kamar berhasil diproses!"}),r([]),S(!0)}catch(U){console.error("Terjadi kesalahan:",U),k.close(),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}},ne=z=>{z>=1&&z<=C&&F(z)};return e.jsxs("div",{className:"flex flex-col lg:flex-row items-start gap-6 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"w-full lg:w-2/3 bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Daftar Santri"}),e.jsx("div",{className:"flex flex-wrap w-full mb-4",children:e.jsx(dt,{filterOptions:I,onChange:d,selectedFilters:p})}),o?_?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{searchTerm:N,setSearchTerm:T,totalData:v,limit:y,toggleLimit:z=>f(Number(z.target.value)),showViewButtons:!1,showFilterButtons:!1}),e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b text-center w-10",children:e.jsx("input",{type:"checkbox",checked:n,onChange:async z=>{const me=z.target.checked;x(me),me?(await j(),r(M)):r([])}})}),e.jsx("th",{className:"px-3 py-2 border-b text-center w-10",children:"No"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"No. Induk Santri"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Kamar"})]})}),e.jsx("tbody",{className:"text-gray-800",children:w?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):u.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:"Tidak ada data"})}):u.map((z,me)=>e.jsxs("tr",{className:"hover:bg-gray-50 text-center",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:e.jsx("input",{type:"checkbox",checked:l.includes(z.id),onChange:he=>{const U=he.target.checked;r(U?q=>{const se=[...q,z.id];return se.length===u.length&&x(!0),se}:q=>{const se=q.filter(Y=>Y!==z.id);return x(!1),se})}})}),e.jsx("td",{className:"px-3 py-2 border-b",children:(P-1)*y+me+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:z.nis}),e.jsx("td",{className:"px-3 py-2 border-b text-left",children:z.nama}),e.jsx("td",{className:"px-3 py-2 border-b",children:z.kamar})]},z.id))})]})}),C>1&&e.jsx(Fe,{currentPage:P,totalPages:C,handlePageChange:ne})]}):e.jsx("div",{className:"text-center py-6 text-gray-500 italic",children:"Silakan pilih wilayah terlebih dahulu."})]}),e.jsxs("form",{onSubmit:V,className:"w-full lg:w-1/3 bg-white p-6 rounded-lg shadow-md flex flex-col justify-between self-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Pindahkan ke"}),e.jsx("div",{className:"flex flex-wrap w-full mb-4",children:e.jsx(dt,{filterOptions:D,onChange:h,selectedFilters:c,vertical:!0})})]}),e.jsx("button",{type:"submit",className:"bg-blue-600 cursor-pointer hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded transition duration-200",children:"Proses Pindah"})]})]})},ur=({filterOptions:a,onChange:s,selectedFilters:l,vertical:r=!1})=>e.jsx(e.Fragment,{children:e.jsx("div",{className:`w-full ${r?"space-y-4":"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"}`,children:Object.entries(a).map(([n,x],b)=>e.jsxs("div",{className:"w-full",children:[r&&e.jsxs("label",{className:"block text-gray-700 mb-1 capitalize",children:[n," Tujuan"]}),e.jsx("select",{className:`w-full border border-gray-300 rounded p-2 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:i=>s({[n]:i.target.value}),value:l[n]||"",disabled:x.length<=1,required:r,children:x.map((i,m)=>e.jsx("option",{value:i.value,children:i.label},m))})]},`${n}-${b}`))})}),hr=()=>{var ne,te,R;const{clearAuthData:a}=ke(),s=je(),[l,r]=t.useState([]),[n,x]=t.useState(null),[b,i]=t.useState(!1),[m,d]=t.useState({wilayah:"",blok:"",kamar:""});t.useEffect(()=>{console.log(l)},[l]);const{filterWilayah:p,handleFilterChangeWilayah:g,selectedWilayah:h}=Be(),c=(Z,z)=>Z.length>0?[{...Z[0],label:z},...Z.slice(1)]:Z,o={wilayah:c(p.wilayah,"Pilih Wilayah"),blok:c(p.blok,"Pilih Blok"),kamar:c(p.kamar,"Pilih Kamar")},u=((ne=p.wilayah.find(Z=>Z.value==h.wilayah))==null?void 0:ne.label)||"",w=((te=p.blok.find(Z=>Z.value==h.blok))==null?void 0:te.label)||"",_=((R=p.kamar.find(Z=>Z.value==h.kamar))==null?void 0:R.label)||"";t.useEffect(()=>{(u||w||_)&&d({wilayah:u,blok:w,kamar:_})},[u,w,_]);const{menuWaliAsuh2:f}=la(),v=h.wilayah!=="",{santri:S,loadingSantri:j,error:y,setLimit:N,totalDataSantri:T,fetchData:C,searchTerm:P,setSearchTerm:F,fetchAllData:M,limit:L,totalPages:I,currentPage:D,setCurrentPage:Q,allSantriIds:E}=Fa(m);t.useEffect(()=>{b&&E.length>0&&r(E)},[E]);const B=Z=>{Z>=1&&Z<=I&&Q(Z)},V=async Z=>{if(Z.preventDefault(),l.length===0){await k.fire({icon:"warning",title:"Peringatan",text:"Pilih minimal satu santri untuk dipindah."});return}if(!(await k.fire({title:"Yakin ingin memproses perpindahan?",text:"Pastikan data tujuan sudah sesuai.",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, proses",cancelButtonText:"Batal"})).isConfirmed)return;const me={id_wali_asuh:n,santri_id:l};try{k.fire({title:"Mohon tunggu...",html:"Sedang memproses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}}),console.log("Payload yang dikirim ke API:",JSON.stringify(me,null,2));const he=sessionStorage.getItem("token")||xe("token"),U=await fetch(`${G}fitur/anakasuh`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${he}`},body:JSON.stringify(me)}),q=await U.json();if(console.log(q),k.close(),U.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),a(),s("/login");return}if(!U.ok){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${q.message||"Terjadi kesalahan saat memproses perpindahan."}</div>`});return}await k.fire({icon:"success",title:"Berhasil",text:q.message||"Berhasil ditambahkan sebagai anak asuh dan dikaitkan dengan wali asuh."}),r([]),C(!0)}catch(he){console.error("Terjadi kesalahan:",he),k.close(),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsxs("div",{className:"flex flex-col lg:flex-row items-start gap-6 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"w-full lg:w-2/3 bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-4 gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Daftar Santri"}),e.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-sm",children:[e.jsx("input",{type:"text",placeholder:"Cari nama santri...",className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none transition-all",value:P,onChange:Z=>F(Z.target.value)}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:e.jsx("i",{className:"fas fa-search"})})]})]}),e.jsx("div",{className:"flex flex-wrap w-full mb-4",children:e.jsx(ur,{filterOptions:o,onChange:g,selectedFilters:h})}),v?y?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{totalData:T,limit:L,toggleLimit:Z=>N(Number(Z.target.value)),showViewButtons:!1,showFilterButtons:!1,showSearch:!1}),e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b text-center w-10",children:e.jsx("input",{type:"checkbox",checked:b,onChange:async Z=>{const z=Z.target.checked;i(z),z?(await M(),r(E)):r([])}})}),e.jsx("th",{className:"px-3 py-2 border-b text-center w-10",children:"No"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"No. Induk Santri"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Wilayah"})]})}),e.jsx("tbody",{className:"text-gray-800",children:j?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):S.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:"Tidak ada data"})}):S.map((Z,z)=>e.jsxs("tr",{className:"hover:bg-gray-50 text-center",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:e.jsx("input",{type:"checkbox",checked:l.includes(Z.id),onChange:me=>{const he=me.target.checked;r(he?U=>{const q=[...U,Z.id];return q.length===S.length&&i(!0),q}:U=>{const q=U.filter(se=>se!==Z.id);return i(!1),q})}})}),e.jsx("td",{className:"px-3 py-2 border-b",children:z+1}),e.jsx("td",{className:"px-3 py-2 border-b",children:Z.nis}),e.jsx("td",{className:"px-3 py-2 border-b text-left",children:Z.nama}),e.jsx("td",{className:"px-3 py-2 border-b text-left",children:Z.wilayah})]},Z.id))})]})}),I>1&&e.jsx(Fe,{currentPage:D,totalPages:I,handlePageChange:B})]}):e.jsx("div",{className:"text-center py-6 text-gray-500 italic",children:"Silakan pilih wilayah terlebih dahulu."})]}),e.jsxs("form",{onSubmit:V,className:"w-full lg:w-1/3 bg-white p-6 rounded-lg shadow-md flex flex-col justify-between self-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Tambahkan ke"}),e.jsx("div",{className:"flex flex-wrap w-full mb-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"id_wali_asuh",className:"block text-gray-700",children:"Wali Asuh *"}),e.jsx("select",{className:`mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${f.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:Z=>x(Z.target.value),value:n,disabled:f.length<=1,required:!0,children:f.map((Z,z)=>e.jsx("option",{value:Z.id,children:Z.label},z))})]})})]}),e.jsx("button",{type:"submit",className:"bg-blue-600 cursor-pointer hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded transition duration-200",children:"Proses"})]})]})},xr=a=>{const[s,l]=t.useState([]),{clearAuthData:r}=ke(),n=je(),[x,b]=t.useState(!0),[i,m]=t.useState(null),[d,p]=t.useState(25),[g,h]=t.useState(0),[c,o]=t.useState(1),[u,w]=t.useState(""),[_,f]=t.useState(1),[v,S]=t.useState(u),j=t.useRef("");t.useEffect(()=>{const T=setTimeout(()=>{S(u)},400);return()=>clearTimeout(T)},[u]);const y=t.useCallback(async(T=!1)=>{let C=`${G}fitur/list-lulus`;const P=[];if(d!==null&&P.push(`limit=${d}`),_>1&&P.push(`page=${_}`),v&&P.push(`nama=${encodeURIComponent(v)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&P.push(`lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&P.push(`jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&P.push(`kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&P.push(`rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.urutBerdasarkan&&P.push(`sort_by=${encodeURIComponent(a.urutBerdasarkan)}`),P.length>0&&(C+=`?${P.join("&")}`),!T&&j.current===C){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}j.current=C,console.log("Fetching from:",C),b(!0),m(null);try{const F=sessionStorage.getItem("token")||xe("token"),M=await fetch(C,{headers:{Authorization:`Bearer ${F}`}});if(M.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r(),n("/login");return}if(!M.ok)throw new Error(`${M.statusText}: ${M.status}`);const L=await M.json();console.log("Data dari API Lulus:",L),l(Array.isArray(L.data)?L.data:[]),h(L.total_data||0),o(L.total_pages)}catch(F){console.error("Fetch error:",F),m(F.message),l([])}finally{b(!1)}},[_,a,d,v]);t.useEffect(()=>{y()},[y]),t.useEffect(()=>{f(1)},[d]);const N=t.useCallback(async()=>{const T=sessionStorage.getItem("token")||xe("token");let C=`${G}fitur/list-lulus`;const P=[];v&&P.push(`nama=${encodeURIComponent(v)}`),a!=null&&a.lembaga&&a.lembaga!=="Semua Lembaga"&&P.push(`lembaga=${encodeURIComponent(a.lembaga)}`),a!=null&&a.jurusan&&a.jurusan!=="Semua Jurusan"&&P.push(`jurusan=${encodeURIComponent(a.jurusan)}`),a!=null&&a.kelas&&a.kelas!=="Semua Kelas"&&P.push(`kelas=${encodeURIComponent(a.kelas)}`),a!=null&&a.rombel&&a.rombel!=="Semua Rombel"&&P.push(`rombel=${encodeURIComponent(a.rombel)}`),a!=null&&a.urutBerdasarkan&&P.push(`sort_by=${encodeURIComponent(a.urutBerdasarkan)}`);const F=`${C}?${P.join("&")}`;try{const M=await fetch(F,{headers:{Authorization:`Bearer ${T}`}});if(!M.ok)throw new Error("Gagal fetch total data");const L=await M.json(),I=L.total_data||L.data.length||0;if(I===0)return[];const D=`${C}?${[...P,`limit=${I}`].join("&")}`,Q=await fetch(D,{headers:{Authorization:`Bearer ${T}`}});if(!Q.ok)throw new Error("Gagal fetch semua data");const E=await Q.json(),B=Array.isArray(E.data)?E.data.map(V=>V.biodata_id):[];return console.log("✅ Total ID diambil:",B.length),B}catch(M){return console.error("❌ fetchAllData error:",M),[]}},[a,v]);return{dataLulus:s,loadingLulus:x,error:i,searchTerm:u,setSearchTerm:w,limit:d,setLimit:p,totalDataLulus:g,fetchData:y,fetchAllData:N,totalPages:c,currentPage:_,setCurrentPage:f}},ct=({filterOptions:a,onChange:s,selectedFilters:l,vertical:r=!1})=>e.jsx(e.Fragment,{children:e.jsx("div",{className:`${r?"space-y-4":"grid grid-cols-1 md:grid-cols-2 gap-4"}`,children:Object.entries(a).map(([n,x],b)=>e.jsxs("div",{className:"w-full",children:[r&&e.jsxs("label",{className:"block text-gray-700 mb-1 capitalize",children:[n," Tujuan"]}),e.jsx("select",{className:`w-full border border-gray-300 rounded p-2 ${x.length<=1?"bg-gray-200 text-gray-500":""}`,onChange:i=>s({[n]:i.target.value}),value:l[n]||"",disabled:x.length<=1,required:r,children:x.map((i,m)=>e.jsx("option",{value:i.value,children:i.label},m))})]},`${n}-${b}`))})}),gr=()=>{var Se,Ge,_e,ra,Va,Ha,Qa,Za;const{clearAuthData:a}=ke(),s=je(),[l,r]=t.useState([]),[n,x]=t.useState([]),[b,i]=t.useState(!1),[m,d]=t.useState(!1),[p,g]=t.useState(null),[h,c]=t.useState({lembaga:"",jurusan:"",kelas:"",rombel:"",urutBerdasarkan:""}),[o,u]=t.useState({lembaga:"",jurusan:"",kelas:"",rombel:"",urutBerdasarkan:""}),w=[{label:"Urut Berdasarkan",value:""},{label:"Nama",value:"nama"},{label:"NIUP",value:"niup"},{label:"Jenis Kelamin",value:"jenis_kelamin"}];t.useEffect(()=>{console.log(l)},[l]),t.useEffect(()=>{console.log(n)},[n]);const{filterLembaga:_,handleFilterChangeLembaga:f,selectedLembaga:v}=Te(),{filterLembaga:S,handleFilterChangeLembaga:j,selectedLembaga:y}=Te(),N=v.lembaga!=="",{pelajar:T,loadingPelajar:C,error:P,setLimit:F,totalDataPelajar:M,fetchData:L,fetchAllData:I,searchTerm:D,setSearchTerm:Q,allPelajarIds:E,limit:B,setCurrentPage:V,currentPage:ne,totalPages:te}=Ca(h),{dataLulus:R,loadingLulus:Z,error:z,setLimit:me,totalDataLulus:he,fetchData:U,searchTerm:q,setSearchTerm:se,limit:Y,setCurrentPage:de,currentPage:oe,totalPages:W,fetchAllData:X}=xr(o),ae=(be,Le)=>be.length>0?[{...be[0],label:Le},...be.slice(1)]:be,O={lembaga:ae(_.lembaga,"Pilih Lembaga"),jurusan:ae(_.jurusan,"Pilih Jurusan"),kelas:ae(_.kelas,"Pilih Kelas"),rombel:ae(_.rombel,"Pilih rombel")},K={lembaga:ae(S.lembaga,"Pilih Lembaga"),jurusan:ae(S.jurusan,"Pilih Jurusan"),kelas:ae(S.kelas,"Pilih Kelas"),rombel:ae(S.rombel,"Pilih rombel")},A=((Se=_.lembaga.find(be=>be.value==v.lembaga))==null?void 0:Se.label)||"",ee=((Ge=_.jurusan.find(be=>be.value==v.jurusan))==null?void 0:Ge.label)||"",ie=((_e=_.kelas.find(be=>be.value==v.kelas))==null?void 0:_e.label)||"",ce=((ra=_.rombel.find(be=>be.value==v.rombel))==null?void 0:ra.label)||"",fe=((Va=S.lembaga.find(be=>be.value==y.lembaga))==null?void 0:Va.label)||"",H=((Ha=S.jurusan.find(be=>be.value==y.jurusan))==null?void 0:Ha.label)||"",ve=((Qa=S.kelas.find(be=>be.value==y.kelas))==null?void 0:Qa.label)||"",Pe=((Za=S.rombel.find(be=>be.value==y.rombel))==null?void 0:Za.label)||"";t.useEffect(()=>{(A||ee||ie||ce)&&c({lembaga:A,jurusan:ee,kelas:ie,rombel:ce}),(fe||H||ve||Pe)&&u({lembaga:fe,jurusan:H,kelas:ve,rombel:Pe})},[A,ee,ie,ce,fe,H,ve,Pe]),t.useEffect(()=>{b&&E.length>0&&r(E)},[E]);const $=be=>{be>=1&&be<=te&&V(be)},we=be=>{be>=1&&be<=W&&de(be)},Re=async be=>{var ia,Xa;be.preventDefault();const Le=p==="proses",Ze=Le?l:n;if(Ze.length===0){await k.fire({icon:"warning",title:"Peringatan",text:`Pilih minimal satu data ${Le?"pelajar":"alumni"} untuk diproses.`});return}const ca=Le?"proses-lulus":"batal-lulus",Qe={biodata_id:Ze};if((await k.fire({title:"Yakin ingin memproses data ini?",text:"Pastikan data sudah sesuai.",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, proses",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang memproses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const Ka=sessionStorage.getItem("token")||xe("token"),Ia=await fetch(`${G}fitur/${ca}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ka}`},body:JSON.stringify(Qe)});k.close();const oa=await Ia.json();if(console.log(oa),Ia.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),a(),s("/login");return}if(!Ia.ok){await k.fire({icon:"error",title:"Gagal",html:`<div style="text-align: left;">${oa.message||"Terjadi kesalahan saat memproses perpindahan."}</div>`});return}if(((Xa=(ia=oa.data)==null?void 0:ia.gagal)==null?void 0:Xa.length)>0){const Bt=oa.data.gagal.map((Dt,Lt)=>`<b>${Lt+1}. ${Dt.nama}</b>`).join("<br><br>");await k.fire({icon:"warning",title:"Sebagian Gagal Diproses",html:`
                    <div style="text-align: left;">
                        ${oa.message}<br><br>
                        <b>Daftar siswa yang gagal diproses:</b><br><br>
                        ${Bt}
                    </div>`})}else await k.fire({icon:"success",title:"Berhasil",text:oa.message||`${p} lulus berhasil diproses!`});d(!1),i(!1),r([]),x([]),L(!0),U(!0)}catch(Ka){console.error("Terjadi kesalahan:",Ka),k.close(),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}},[qe,J]=t.useState(!1);return t.useEffect(()=>{const be=()=>{J(window.innerWidth<1024)};return be(),window.addEventListener("resize",be),()=>window.removeEventListener("resize",be)},[]),e.jsxs("div",{className:"flex flex-col lg:flex-row items-start gap-6 pl-6 pt-6 pb-6",children:[e.jsxs("div",{className:"w-full lg:w-20/49 bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-4 gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Daftar Pelajar"}),e.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-sm",children:[e.jsx("input",{type:"text",placeholder:"Cari nama pelajar...",className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none transition-all",value:D,onChange:be=>Q(be.target.value)}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:e.jsx("i",{className:"fas fa-search"})})]})]}),e.jsx("div",{className:"w-full mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{className:"w-full",children:e.jsx(ct,{filterOptions:O,onChange:f,selectedFilters:v})}),e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx("div",{className:"w-full",children:e.jsx("select",{className:"block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 capitalize",value:h.urutBerdasarkan,onChange:be=>c({...h,urutBerdasarkan:be.target.value}),required:!0,children:w.map((be,Le)=>e.jsx("option",{value:be.value,children:be.label},Le))})})})})]})}),N?P?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{totalData:M,limit:B,toggleLimit:be=>F(Number(be.target.value)),showViewButtons:!1,showFilterButtons:!1,showSearch:!1}),e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b text-center w-10",children:e.jsx("input",{type:"checkbox",checked:b,onChange:async be=>{const Le=be.target.checked;i(Le),Le?(await I(),r(E)):r([])}})}),e.jsx("th",{className:"px-3 py-2 border-b text-center w-10",children:"No"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"No. Induk (Siswa/Mahasiswa)"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Status"})]})}),e.jsx("tbody",{className:"text-gray-800",children:C?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):T.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:"Tidak ada data"})}):T.map((be,Le)=>e.jsxs("tr",{className:"hover:bg-gray-50 text-center",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:e.jsx("input",{type:"checkbox",checked:l.includes(be.biodata_id),onChange:Ze=>{const ca=Ze.target.checked;r(ca?Qe=>{const He=[...Qe,be.biodata_id];return He.length===T.length&&i(!0),He}:Qe=>{const He=Qe.filter(ia=>ia!==be.biodata_id);return i(!1),He})}})}),e.jsx("td",{className:"px-3 py-2 border-b",children:(ne-1)*B+Le+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:be.no_induk}),e.jsx("td",{className:"px-3 py-2 border-b text-left",children:be.nama}),e.jsx("td",{className:"px-3 py-2 border-b",children:e.jsx("span",{className:`text-sm font-semibold px-3 py-1 rounded-full ${be.status==="aktif"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:be.status==="aktif"?"Aktif":"Nonaktif"})})]},be.biodata_id||Le))})]})}),te>1&&e.jsx(Fe,{currentPage:ne,totalPages:te,handlePageChange:$})]}):e.jsx("div",{className:"text-center py-6 text-gray-500 italic",children:"Silakan pilih lembaga terlebih dahulu."})]}),e.jsxs("form",{onSubmit:Re,className:"w-full lg:w-9/49 bg-white p-6 rounded-lg shadow-md flex flex-col justify-between gap-4 lg:sticky lg:top-1/2 self-start transform lg:-translate-y-1/2 z-10",children:[e.jsxs("button",{type:"submit",onClick:()=>g("proses"),className:"bg-blue-100 hover:bg-blue-200 text-blue-700 font-semibold px-6 py-3 rounded transition duration-200 cursor-pointer flex items-center justify-center gap-2",children:["Proses Lulus",e.jsx(ge,{icon:qe?ts:ut})]}),e.jsxs("button",{type:"submit",onClick:()=>g("batal"),className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded transition duration-200 cursor-pointer flex items-center justify-center gap-2",children:[e.jsx(ge,{icon:qe?ss:ns}),"Batal Lulus"]})]}),e.jsxs("div",{className:"w-full lg:w-20/49 bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-4 gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Alumni Pelajar"}),e.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-sm",children:[e.jsx("input",{type:"text",placeholder:"Cari nama alumni...",className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none transition-all",value:q,onChange:be=>se(be.target.value)}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:e.jsx("i",{className:"fas fa-search"})})]})]}),e.jsx("div",{className:"w-full mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{className:"w-full",children:e.jsx(ct,{filterOptions:K,onChange:j,selectedFilters:y})}),e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx("div",{className:"w-full",children:e.jsx("select",{className:"block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 capitalize",value:o.urutBerdasarkan,onChange:be=>u({...o,urutBerdasarkan:be.target.value}),required:!0,children:w.map((be,Le)=>e.jsx("option",{value:be.value,children:be.label},Le))})})})})]})}),z?e.jsxs("div",{className:"col-span-3 text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{totalData:he,limit:Y,toggleLimit:be=>me(Number(be.target.value)),showViewButtons:!1,showFilterButtons:!1,showSearch:!1}),e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b text-center w-10",children:e.jsx("input",{type:"checkbox",checked:m,onChange:async be=>{const Le=be.target.checked;if(d(Le),Le){const Ze=await X();x(Ze)}else x([])}})}),e.jsx("th",{className:"px-3 py-2 border-b text-center w-10",children:"No"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"No. Induk"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Status"})]})}),e.jsx("tbody",{className:"text-gray-800",children:Z?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small",text:"",textColor:""})})}):R.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-6",children:"Tidak ada data"})}):R.map((be,Le)=>e.jsxs("tr",{className:"hover:bg-gray-50 text-center",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:e.jsx("input",{type:"checkbox",checked:n.includes(be.biodata_id),onChange:Ze=>{const ca=Ze.target.checked;x(ca?Qe=>{const He=[...Qe,be.biodata_id];return He.length===T.length&&d(!0),He}:Qe=>{const He=Qe.filter(ia=>ia!==be.biodata_id);return d(!1),He})}})}),e.jsx("td",{className:"px-3 py-2 border-b",children:(oe-1)*Y+Le+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b text-left",children:be.no_induk}),e.jsx("td",{className:"px-3 py-2 border-b text-left",children:be.nama}),e.jsx("td",{className:"px-3 py-2 border-b",children:e.jsx("span",{className:`text-sm font-semibold px-3 py-1 rounded-full ${be.status==="lulus"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:be.status==="lulus"?"Lulus":"-"})})]},be.id))})]})}),W>1&&e.jsx(Fe,{currentPage:oe,totalPages:W,handlePageChange:we})]})]})]})},pr=a=>{const[s,l]=t.useState([]),{clearAuthData:r}=ke(),n=je(),[x,b]=t.useState(!0),[i,m]=t.useState(null),[d,p]=t.useState(25),[g,h]=t.useState(0),[c,o]=t.useState(1),[u,w]=t.useState(""),[_,f]=t.useState(1),[v,S]=t.useState(u),j=t.useRef("");t.useEffect(()=>{const N=setTimeout(()=>{S(u)},400);return()=>clearTimeout(N)},[u]);const y=t.useCallback(async(N=!1)=>{let T=`${G}fitur/presensi-santri`;const C=[];if(d!==null&&C.push(`limit=${d}`),_>1&&C.push(`page=${_}`),C.length>0&&(T+=`?${C.join("&")}`),!N&&j.current===T){console.log("Skip Fetch: URL sama dengan request sebelumnya");return}j.current=T,console.log("Fetching from:",T),b(!0),m(null);try{const P=sessionStorage.getItem("token")||xe("token"),F=await fetch(T,{headers:{Authorization:`Bearer ${P}`}});if(F.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),r(),n("/login");return}if(!F.ok)throw new Error(`${F.statusText}: ${F.status}`);const M=await F.json();console.log("Data Presensi:",M),l(Array.isArray(M.data)?M.data:[]),h(M.total_data||0),o(M.total_pages||1)}catch(P){console.error("Fetch error:",P),m(P.message),l([])}finally{b(!1)}},[_,a,d,v]);return t.useEffect(()=>{y()},[y]),t.useEffect(()=>{f(1)},[d]),{dataPresensi:s,loadingPresensi:x,error:i,searchTerm:u,setSearchTerm:w,limit:d,setLimit:p,totalDataPresensi:g,fetchData:y,totalPages:c,currentPage:_,setCurrentPage:f}},br=()=>{const{dataPresensi:a,loadingPresensi:s,error:l,searchTerm:r,setSearchTerm:n,limit:x,setLimit:b,totalDataPresensi:i,totalPages:m,currentPage:d,setCurrentPage:p}=pr(),g=h=>{h>=1&&h<=m&&p(h)};return e.jsxs("div",{className:"flex-1 pl-6 pt-6 pb-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Presensi Santri"})}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx(Ce,{searchTerm:r,setSearchTerm:n,totalData:i,limit:x,toggleLimit:h=>b(Number(h.target.value)),showViewButtons:!1}),l?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:"Terjadi kesalahan saat mengambil data."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Muat Ulang"})]}):e.jsx($e,{children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 border-b",children:"#"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama Santri"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Nama Presensi"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Tanggal"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Waktu Presensi"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Status"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Lokasi"}),e.jsx("th",{className:"px-3 py-2 border-b",children:"Metode"})]})}),e.jsx("tbody",{className:"text-gray-800 text-center",children:s?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"py-6",children:e.jsx(pe,{variant:"disc",color:"#2a6999",size:"small"})})}):a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"py-6",children:"Tidak ada data"})}):a.map((h,c)=>e.jsxs("tr",{className:"hover:bg-gray-50 text-left",children:[e.jsx("td",{className:"px-3 py-2 border-b",children:(d-1)*x+c+1||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:h.nama_santri||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:h.nama_presensi||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:h.tanggal||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:h.waktu_presensi||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:h.status||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:h.lokasi||"-"}),e.jsx("td",{className:"px-3 py-2 border-b",children:h.metode||"-"})]},`${h.id}-${c}`))})]})}),m>1&&e.jsx(Fe,{currentPage:d,totalPages:m,handlePageChange:g})]})]})},Tt=[{id:"dashboard",icon:"fas fa-tachometer-alt",text:"Dashboard",link:"/dashboard",content:e.jsx(cr,{})},{id:"formulir",icon:"fas fa-file-alt",text:"Formulir",link:"/formulir",content:e.jsx(St,{})}],Pt=[{id:"pesertadidik",icon:"fa-users",text:"Peserta Didik",link:"/peserta-didik",content:e.jsx(xn,{})},{id:"orangtua",icon:"fa-user",text:"Orang Tua",link:"/orang-tua",content:e.jsx(nn,{})},{id:"wali",icon:"fa-user-tie",text:"Wali",link:"/wali",content:e.jsx(yn,{})},{id:"pengajar",icon:"fa-chalkboard-teacher",text:"Pengajar",link:"/pengajar",content:e.jsx(ln,{})},{id:"pengurus",icon:"fa-user-cog",text:"Pengurus",link:"/pengurus",content:e.jsx(rn,{})},{id:"karyawan",icon:"fa-briefcase",text:"Karyawan",link:"/karyawan",content:e.jsx(Zs,{})},{id:"walikelas",icon:"fa-chalkboard",text:"Wali Kelas",link:"/wali-kelas",content:e.jsx(vn,{})},{id:"khadam",icon:"fa-hands-helping",text:"Khadam",link:"/khadam",content:e.jsx(sn,{})},{id:"alumni",icon:"fa-user-graduate",text:"Alumni",link:"/alumni",content:e.jsx(Qs,{})}],Ct=[{id:"waliasuh",icon:"fa-user-shield",text:"Wali Asuh",link:"/wali-asuh",content:e.jsx(nl,{})},{id:"groupkewaliasuhan",icon:"fa-book-open",text:"Group Kewaliasuhan",link:"/group-kewaliasuhan",content:e.jsx(sl,{})},{id:"anakasuh",icon:"fa-users",text:"Anak Asuh",link:"/anak-asuh",content:e.jsx(al,{})}],Ft=[{id:"perizinan",icon:"fa-id-card",text:"Perizinan",link:"/perizinan",content:e.jsx(Vs,{})},{id:"pelanggaran",icon:"fa-exclamation-triangle",text:"Pelanggaran",link:"/pelanggaran",content:e.jsx(Js,{})},{id:"catatanafektif",icon:"fa-hand-holding-heart",text:"Catatan Afektif",link:"/catatan-afektif",content:e.jsx(Us,{})},{id:"catatankognitif",icon:"fa-brain",text:"Catatan Kognitif",link:"/catatan-kognitif",content:e.jsx(zs,{})}],$t=[{id:"pegawai",icon:"fa-briefcase",text:"Pegawai",link:"/pegawai",content:e.jsx(Xn,{})},{id:"anakpegawai",icon:"fa-book",text:"Anak Pegawai",link:"/anak-pegawai",content:e.jsx(zn,{})}],At=[{id:"pengunjung",icon:"fa-hands-helping",text:"Pengunjung",link:"/pengunjung",content:e.jsx(dl,{})}],Kt=[{id:"lembaga",icon:"fa-building-columns",text:"Lembaga",link:"/lembaga",content:e.jsx(Bn,{})},{id:"kategorigolongan",icon:"fa-tags",text:"Kategori Golongan",link:"/kategori-golongan",content:e.jsx(Kn,{})},{id:"golongan",icon:"fa-layer-group",text:"Golongan",link:"/golongan",content:e.jsx(Sn,{})},{id:"golonganjabatan",icon:"fa-briefcase",text:"Golongan Jabatan",link:"/golongan-jabatan",content:e.jsx(Fn,{})}],It=[{id:"pindahkelas",icon:"fa-repeat",text:"Pindah/Naik Kelas",link:"/pindah-kelas",content:e.jsx(Tn,{})},{id:"pindahkamar",icon:"fa-right-left",text:"Pindah Kamar",link:"/pindah-kamar",content:e.jsx(mr,{})},{id:"hubungkanwaliasuh",icon:"fa-link",text:"Hubungkan Wali Asuh",link:"/hubungkan-wali-asuh",content:e.jsx(hr,{})},{id:"kelulusan",icon:"fa-graduation-cap",text:"Kelulusan",link:"/kelulusan",content:e.jsx(gr,{})},{id:"presensisantri",icon:"fa-calendar-check",text:"Presensi Santri",link:"/presensi-santri",content:e.jsx(br,{})}],fa=[{id:"biodata",label:"Biodata",link:"biodata",content:e.jsx(xl,{})},{id:"keluarga",label:"Keluarga",link:"keluarga",content:e.jsx(Sl,{})},{id:"santri",label:"Santri",link:"santri",content:e.jsx(Hl,{})},{id:"domisili",label:"Domisili Santri",link:"domisili-santri",content:e.jsx(jl,{})},{id:"waliasuh",label:"Wali Asuh",link:"wali-asuh",content:e.jsx(ar,{})},{id:"pendidikan",label:"Pendidikan",link:"pendidikan",content:e.jsx(Il,{})},{id:"pengajar",label:"Pengajar",link:"pengajar",content:e.jsx(Rl,{})},{id:"karyawan",label:"Karyawan",link:"karyawan",content:e.jsx(wl,{})},{id:"pengurus",label:"Pengurus",link:"pengurus",content:e.jsx(ql,{})},{id:"walikelas",label:"Wali Kelas",link:"wali-kelas",content:e.jsx(lr,{})},{id:"khadam",label:"Khadam",link:"khadam",content:e.jsx(Fl,{})},{id:"berkas",label:"Berkas",link:"berkas",content:e.jsx(ul,{})},{id:"warpes",label:"Warga Pesantren",link:"warga-pesantren",content:e.jsx(dr,{})},{id:"progress",label:"Progress Report",link:"progress-report",content:e.jsx(Gl,{})}],Ya=[{id:"santri",text:"Santri",link:"/peserta-didik/santri",content:e.jsx(jn,{})},{id:"santri-non-domisili",text:"Santri-Non-Domisili",link:"/peserta-didik/santri-non-domisili",content:e.jsx(fn,{})},{id:"pelajar",text:"Pelajar",link:"/peserta-didik/pelajar",content:e.jsx(bn,{})},{id:"bersaudara-kandung",text:"Bersaudara Kandung",link:"/peserta-didik/bersaudara-kandung",content:e.jsx(pn,{})}],ta=[{id:1,label:"Kartu Keluarga (KK)",required:!0},{id:2,label:"KTP/KIA",required:!1},{id:3,label:"Akte Kelahiran",required:!1},{id:4,label:"Pas Foto",required:!1},{id:5,label:"Ijazah Terakhir",required:!1},{id:6,label:"Fotokopi Rapor Terakhir",required:!1},{id:7,label:"Surat Keterangan Sehat",required:!1},{id:8,label:"BPJS / Kartu Asuransi Kesehatan",required:!1},{id:9,label:"Surat Pernyataan Kesanggupan",required:!1},{id:10,label:"Surat Izin Orang Tua",required:!1},{id:11,label:"Surat Pernyataan Tidak Merokok",required:!1},{id:12,label:"Surat Keterangan Pindah Sekolah",required:!1},{id:13,label:"Surat Keterangan Lulus (SKL)",required:!1},{id:14,label:"Surat Rekomendasi dari Ulama/Guru",required:!1},{id:15,label:"Surat Pernyataan Bebas Narkoba",required:!1},{id:16,label:"Surat Domisili (jika dari luar kota)",required:!1},{id:17,label:"Surat Keterangan Anak Yatim/Piatu",required:!1},{id:18,label:"Fotokopi Kartu Santri",required:!1}],$a=[{label:"Pilih Jenis jabatan",value:""},{label:"Kultural",value:"kultural"},{label:"Tetap",value:"tetap"},{label:"Kontrak",value:"kontrak"},{label:"Pengkaderan",value:"pengkaderan"}],jr=({submenuPesertaDidik:a,setSubmenuPesertaDidik:s,dropdownDataPokok:l,setDropdownDataPokok:r,dropdownDataKewaliasuhan:n,setDropdownKewaliasuhan:x,dropdownDataKepegawaian:b,setDropdownKepegawaian:i,dropdownDataKepesantrenan:m,setDropdownKepesantrenan:d,dropdownDataMahrom:p,setDropdownMahrom:g,dropdownDataKelembagaan:h,setDropdownDataKelembagaan:c,dropdownDataAkademik:o,setDropdownDataAkademik:u,isSidebarOpen:w,toggleDropdown:_})=>{const f=Ea(),v=({icon:N,text:T,link:C,onClick:P})=>{const F=f.pathname===C||f.pathname.startsWith(C+"/");return e.jsx("li",{className:"mb-1 ml-2",children:e.jsxs(Ye,{to:C,className:`flex items-center px-2.5 py-1.5 rounded-md text-sm transition-colors duration-200 ${F?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 font-medium hover:bg-gray-100"}`,onClick:P,children:[e.jsx("i",{className:`fas ${N} mr-2 text-sm`}),T]})})},S=({items:N})=>e.jsx("ul",{className:"mt-2 ml-2",children:N.map(T=>{const C=f.pathname===T.link||f.pathname.startsWith(T.link+"/");return e.jsxs("div",{children:[e.jsx(v,{icon:T.icon,text:T.text,link:T.link||`/${T.id}`,isActive:C,onClick:()=>{T.id==="pesertadidik"&&s(!a)}}),T.id==="pesertadidik"&&a&&e.jsx(j,{})]},T.id)})}),j=()=>e.jsx("ul",{className:"ml-6 mt-2",children:Ya.map(N=>{const T=f.pathname===N.link;return e.jsx("li",{className:"mb-1",children:e.jsxs(Ye,{to:N.link,className:`flex items-center px-3 py-1.5 rounded-md text-xs transition-colors duration-200 ${T?"text-cyan-600 font-semibold bg-cyan-50":"text-red-400 font-medium hover:bg-red-50"}`,children:[e.jsx("i",{className:"fas fa-chevron-right mr-2 text-xs text-gray-400"}),N.text]})},N.id)})}),y=({name:N,isOpen:T,onClick:C})=>e.jsxs("h2",{className:"text-gray-600 text-xs font-semibold uppercase tracking-wider flex items-center justify-between px-2.5 py-2 hover:bg-gray-100 rounded cursor-pointer transition-colors",onClick:C,children:[N,e.jsx("i",{className:`fas fa-chevron-${T?"up":"down"} ml-2`})]});return e.jsx("aside",{id:"logo-sidebar",className:`fixed top-0 left-0 z-40 w-56 h-screen pt-16 transition-transform duration-300 ${w?"translate-x-0":"-translate-x-full"} bg-white border-r border-gray-200 sm:translate-x-0 dark:bg-gray-800 dark:border-gray-700 shadow-lg`,"aria-label":"Sidebar",children:e.jsx("div",{className:"w-56 bg-white h-full flex flex-col text-sm",children:e.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar pb-10",children:[e.jsx("nav",{className:"mt-4 px-3",children:e.jsx("ul",{children:Tt.map(N=>{const T=f.pathname===N.link||f.pathname.startsWith(N.link+"/");return e.jsx("li",{className:"mb-1",children:e.jsxs(Ye,{to:N.link,className:`flex items-center px-2.5 py-1.5 rounded-md transition-colors duration-200 ${T?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 font-medium hover:bg-gray-100"}`,children:[e.jsx("i",{className:`${N.icon} mr-2 text-sm`}),N.text]})},N.id)})})}),e.jsxs("div",{className:"mt-4 px-3",children:[e.jsx(y,{name:"Data Pokok",isOpen:l,onClick:()=>_(r)}),l&&e.jsx(S,{items:Pt})]}),e.jsxs("div",{className:"mt-4 px-3",children:[e.jsx(y,{name:"Kewaliasuhan",isOpen:n,onClick:()=>_(x)}),n&&e.jsx(S,{items:Ct})]}),e.jsxs("div",{className:"mt-4 px-3",children:[e.jsx(y,{name:"Kepesantrenan",isOpen:m,onClick:()=>_(d)}),m&&e.jsx(S,{items:Ft})]}),e.jsxs("div",{className:"mt-4 px-3",children:[e.jsx(y,{name:"Kepegawaian",isOpen:b,onClick:()=>_(i)}),b&&e.jsx(S,{items:$t})]}),e.jsxs("div",{className:"mt-4 px-3",children:[e.jsx(y,{name:"Mahrom",isOpen:p,onClick:()=>_(g)}),p&&e.jsx(S,{items:At})]}),e.jsx(ye,{action:"kelembagaan",children:e.jsxs("div",{className:"mt-4 px-3",children:[e.jsx(y,{name:"Kelembagaan",isOpen:h,onClick:()=>_(c)}),h&&e.jsx(S,{items:Kt})]})}),e.jsx(ye,{action:"akademik",children:e.jsxs("div",{className:"mt-4 px-3",children:[e.jsx(y,{name:"Akademik",isOpen:o,onClick:()=>_(u)}),o&&e.jsx(S,{items:It})]})})]})})})},Aa="/assets/logo-DnwSfobD.png",kr=({isOpen:a,onClose:s})=>{const{clearAuthData:l}=ke(),r=je(),[n,x]=t.useState({name:"",email:""}),b=async i=>{if(i.preventDefault(),!!(await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const d=sessionStorage.getItem("token")||xe("token"),p={name:n.name,email:n.email};console.log("Payload yang dikirim ke API:",JSON.stringify(p,null,2));const g=await fetch(`${G}profile`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify(p)}),h=await g.json();if(k.close(),console.log(h),g.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),l(),r("/login");return}if(!g.ok)throw new Error(h.message||"Terjadi kesalahan pada server.");await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),s==null||s()}catch(d){console.error("Terjadi kesalahan:",d),await k.fire({icon:"error",title:"Oops!",text:"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:b,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Edit Data"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-gray-700",children:"Nama *"}),e.jsx("input",{type:"text",id:"name",name:"name",value:n.name,onChange:i=>x({...n,name:i.target.value}),maxLength:255,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Masukkan Nama Baru"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-700",children:"Email *"}),e.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:i=>x({...n,email:i.target.value}),maxLength:255,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Masukkan Email Baru"})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full cursor-pointer inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 cursor-pointer w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},fr=({isOpen:a,onClose:s})=>{const{clearAuthData:l}=ke(),r=je(),[n,x]=t.useState(!1),[b,i]=t.useState(!1),[m,d]=t.useState(!1),[p,g]=t.useState({current_password:"",new_password:"",confirm_password:""}),h=async c=>{if(c.preventDefault(),p.new_password.length<8){await k.fire({title:"Oops!",text:"Password baru minimal 8 karakter",icon:"warning",confirmButtonText:"OK"});return}else if(p.new_password!=p.confirm_password){await k.fire({title:"Oops!",text:"Password tidak sama",icon:"warning",confirmButtonText:"OK"});return}if((await k.fire({title:"Yakin ingin mengirim data?",text:"Pastikan semua data sudah benar!",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, kirim",cancelButtonText:"Batal"})).isConfirmed)try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const u=sessionStorage.getItem("token")||xe("token");console.log(u);const w={current_password:p.current_password,new_password:p.new_password,new_password_confirmation:p.confirm_password};console.log("Payload yang dikirim ke API:",JSON.stringify(w,null,2));const _=await fetch(`${G}password`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify(w)}),f=await _.json();if(k.close(),console.log(f),_.status===401){await k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),l(),r("/login");return}if(!_.ok)throw new Error(f.message||"Terjadi kesalahan pada server.");await k.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dikirim."}),s==null||s()}catch(u){console.error("Terjadi kesalahan:",u),await k.fire({icon:"error",title:"Oops!",text:u.message||"Terjadi kesalahan saat mengirim data."})}};return e.jsx(le,{appear:!0,show:a,as:t.Fragment,children:e.jsxs(re,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:s,children:[e.jsx(le.Child,{as:t.Fragment,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-8 text-center",children:e.jsx(le.Child,{as:t.Fragment,enter:"transition-transform duration-300 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition-transform duration-200 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",children:e.jsxs(re.Panel,{className:"inline-block overflow-y-auto align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all w-full max-w-sm sm:max-w-lg sm:align-middle",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(ge,{icon:Ne,className:"text-xl"})}),e.jsxs("form",{className:"w-full",onSubmit:h,children:[e.jsx("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-2 sm:mt-0 text-left w-full",children:[e.jsx(re.Title,{as:"h3",className:"text-lg leading-6 font-medium text-gray-900 text-center mb-8",children:"Edit Data"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"current_password",className:"block text-gray-700",children:"Password lama *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:n?"text":"password",id:"current_password",name:"current_password",value:p.current_password,onChange:c=>g({...p,current_password:c.target.value}),maxLength:255,required:!0,className:"mt-1 block w-full pr-10 border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Masukkan Password Lama"}),e.jsx("button",{type:"button",onClick:()=>x(!n),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-600 focus:outline-none cursor-pointer",children:e.jsx(ge,{icon:m?Ma:Ba})})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"new_password",className:"block text-gray-700",children:"Password baru *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:b?"text":"password",id:"new_password",name:"new_password",value:p.new_password,onChange:c=>g({...p,new_password:c.target.value}),maxLength:255,required:!0,className:"mt-1 block w-full pr-10 border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Masukkan Password Baru"}),e.jsx("button",{type:"button",onClick:()=>i(!b),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-600 focus:outline-none cursor-pointer",children:e.jsx(ge,{icon:m?Ma:Ba})})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirm_password",className:"block text-gray-700",children:"Konfirmasi password baru *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:m?"text":"password",id:"confirm_password",name:"confirm_password",value:p.confirm_password,onChange:c=>g({...p,confirm_password:c.target.value}),maxLength:255,required:!0,className:"mt-1 block w-full pr-10 border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Konfirmasi Password Baru"}),e.jsx("button",{type:"button",onClick:()=>d(!m),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-600 focus:outline-none cursor-pointer",children:e.jsx(ge,{icon:m?Ma:Ba})})]})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full cursor-pointer inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Simpan"}),e.jsx("button",{type:"button",onClick:s,className:"mt-3 cursor-pointer w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})},yr=({toggleSidebar:a,toggleDropdownProfil:s,isOpen:l,profilRef:r,toggleButtonRef:n})=>{const x=je(),{logout:b,isLoggingOut:i}=ke(),[m,d]=t.useState(!1),[p,g]=t.useState(!1),h=localStorage.getItem("name")||sessionStorage.getItem("name"),c=async()=>{try{await b(),x("/login")}catch(o){console.error("Logout gagal:",o.message)}};return e.jsx("nav",{className:"fixed top-0 z-50 w-full bg-gray-800 border-b border-gray-700",children:e.jsx("div",{className:"px-3 py-3 lg:px-5 lg:pl-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center justify-start rtl:justify-end",children:[e.jsx("button",{ref:n,onClick:o=>{o.preventDefault(),o.stopPropagation(),a()},className:"sm:hidden text-gray-400 hover:bg-gray-700 p-2 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{clipRule:"evenodd",fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10z"})})}),e.jsxs("a",{href:"/",className:"flex ms-2 md:me-24",children:[e.jsx("img",{height:"32",width:"32",src:Aa,className:"h-8 me-3",alt:"Pedatren Logo"}),e.jsx("span",{className:"text-white text-xl font-semibold sm:text-2xl",children:"PEDATREN"})]})]}),e.jsxs("div",{ref:r,className:"relative",children:[e.jsxs("button",{type:"button",className:"flex text-sm bg-gray-800 rounded-full focus:ring-4 focus:ring-gray-600 cursor-pointer",onClick:s,children:[e.jsx("span",{className:"sr-only",children:"Open user menu"}),e.jsx("img",{height:"40",width:"40",className:"w-10 h-10 rounded-full",src:"https://storage.googleapis.com/a1aa/image/pAPj3YDQYpFx78uqBMFpD5CY1oR_QcLARFVgoJVLIYE.jpg",alt:"user photo"})]}),e.jsx(kr,{isOpen:m,onClose:()=>d(!1)}),e.jsx(fr,{isOpen:p,onClose:()=>g(!1)}),l&&e.jsxs("div",{className:"absolute right-0 z-50 mt-3 w-56 text-base list-none bg-gray-700 divide-y divide-gray-400 rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("p",{className:"text-sm font-semibold text-white",children:h}),e.jsxs("p",{className:"text-sm text-gray-400 truncate",children:["(",Ja(),")"]})]}),e.jsxs("ul",{className:"p-1 space-y-1",children:[e.jsx("li",{children:e.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-3 w-full px-4 py-2 text-sm text-gray-300 hover:bg-gray-500 hover:text-white transition duration-200 ease-in-out rounded-md cursor-pointer",children:[e.jsx(ge,{icon:ls}),"Edit Nama & Email"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-3 w-full px-4 py-2 text-sm text-gray-300 hover:bg-gray-500 hover:text-white transition duration-200 ease-in-out rounded-md cursor-pointer",children:[e.jsx(ge,{icon:rs}),"Edit Password"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:c,disabled:i,className:"flex items-center gap-3 w-full px-4 py-2 text-sm text-red-400 hover:bg-red-600 hover:text-white disabled:opacity-50 transition duration-200 ease-in-out rounded-md cursor-pointer",children:[e.jsx(ge,{icon:Ve}),i?"Logging out...":"Log out"]})})]})]})]})]})})})},wr=()=>{const[a,s]=t.useState(()=>sessionStorage.getItem("dropdownDataPokok")==="true"),[l,r]=t.useState(()=>sessionStorage.getItem("submenuPesertaDidik")==="true"),[n,x]=t.useState(()=>sessionStorage.getItem("dropdownDataKewaliasuhan")==="true"),[b,i]=t.useState(()=>sessionStorage.getItem("dropdownDataKepesantrenan")==="true"),[m,d]=t.useState(()=>sessionStorage.getItem("dropdownDataKepegawaian")==="true"),[p,g]=t.useState(()=>sessionStorage.getItem("dropdownDataMahrom")==="true"),[h,c]=t.useState(()=>sessionStorage.getItem("dropdownDataKelembagaan")==="true"),[o,u]=t.useState(()=>sessionStorage.getItem("dropdownDataAkademik")==="true");t.useEffect(()=>{sessionStorage.setItem("dropdownDataPokok",a),sessionStorage.setItem("submenuPesertaDidik",l),sessionStorage.setItem("dropdownDataKewaliasuhan",n),sessionStorage.setItem("dropdownDataKepesantrenan",b),sessionStorage.setItem("dropdownDataKepegawaian",m),sessionStorage.setItem("dropdownDataMahrom",p),sessionStorage.setItem("dropdownDataKelembagaan",h),sessionStorage.setItem("dropdownDataAkademik",o)},[a,l,n,b,m,p,h,o]);const w=I=>I(D=>!D),[_,f]=t.useState(!1),[v,S]=t.useState(!1),j=t.useRef(null),y=t.useRef(null),N=t.useRef(null),T=()=>f(I=>!I),C=()=>{console.log("klik"),console.log(v),S(I=>!I),console.log(v)};t.useEffect(()=>{const I=D=>{j.current&&!j.current.contains(D.target)&&N.current&&!N.current.contains(D.target)&&S(!1),y.current&&!y.current.contains(D.target)&&f(!1)};return document.addEventListener("mousedown",I),()=>{document.removeEventListener("mousedown",I)}},[]);const P=Rt(),F=Ea(),M=Et(),L=t.useMemo(()=>F.pathname,[F.pathname]);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx(yr,{toggleDropdownProfil:T,toggleSidebar:C,isOpen:_,profilRef:y,toggleButtonRef:N}),e.jsx("div",{ref:j,children:e.jsx(jr,{submenuPesertaDidik:Ya,setSubmenuPesertaDidik:r,dropdownDataPokok:a,setDropdownDataPokok:s,dropdownDataKewaliasuhan:n,setDropdownKewaliasuhan:x,dropdownDataKepegawaian:m,setDropdownKepegawaian:d,dropdownDataKepesantrenan:b,setDropdownKepesantrenan:i,dropdownDataMahrom:p,setDropdownMahrom:g,dropdownDataKelembagaan:h,setDropdownDataKelembagaan:c,dropdownDataAkademik:o,setDropdownDataAkademik:u,isSidebarOpen:v,toggleDropdown:w})}),e.jsx("div",{className:"pr-6 sm:ml-56 overflow-y-auto overflow-x-hidden w-full max-w-full",children:e.jsx("div",{className:"pt-8 mt-8",children:e.jsx(Ut,{transition:!0,aliveRef:M,activeCacheKey:L,max:20,children:e.jsx(t.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:P})})})})]})})},vr=()=>{const[a,s]=t.useState(!1),[l,r]=t.useState(null);return{register:t.useCallback(async({name:x,email:b,password:i,passwordConfirmation:m})=>{const d=`${G}register`;s(!0),r(null);try{const p=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:x,email:b,password:i,password_confirmation:m})});if(!p.ok){const h=await p.json(),c=h.message||Object.values(h.errors||{}).flat().join(" ")||"Registrasi gagal";throw new Error(c)}const g=await p.json();return console.log("Registrasi berhasil:",g),g}catch(p){throw console.error("Register error:",p),r(p.message),p}finally{s(!1)}},[]),isRegistering:a,registerError:l}},Nr=()=>{const[a,s]=t.useState(""),[l,r]=t.useState(""),[n,x]=t.useState(""),[b,i]=t.useState(""),[m,d]=t.useState(!1),[p,g]=t.useState(!1),[h,c]=t.useState(""),o=je(),{register:u,isRegistering:w,registerError:_}=vr(),f=async S=>{if(S.preventDefault(),n!==b){c("Konfirmasi password tidak cocok.");return}try{await u({name:a,email:l,password:n,passwordConfirmation:b}),o("/login")}catch(j){c(j.message||"Terjadi kesalahan.")}},v=()=>e.jsx("div",{className:"col-span-3 flex justify-center items-left p-1",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-white"})});return e.jsxs("section",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center px-4 overflow-y-auto",children:[e.jsxs("div",{className:"flex flex-row items-center mb-6 gap-x-4",children:[e.jsx("img",{className:"w-20 h-20",src:Aa,alt:"logo"}),e.jsx("span",{className:"mt-2 text-4xl font-bold text-gray-900",children:"Pedatren"})]}),e.jsxs("div",{className:"w-full max-w-md bg-white rounded-lg shadow-lg p-6 sm:p-8 m-4",children:[e.jsx("h1",{className:"text-xl font-bold text-center text-gray-900 md:text-2xl mb-6",children:"Buat akun baru"}),e.jsxs("form",{className:"space-y-4",onSubmit:f,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block mb-2 text-sm font-medium text-gray-900",children:"Nama Lengkap"}),e.jsx("input",{type:"text",id:"name",className:"w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 text-gray-900",placeholder:"Nama Anda",required:!0,value:a,onChange:S=>s(S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-gray-900",children:"E-mail"}),e.jsx("input",{type:"email",id:"email",className:"w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 text-gray-900",placeholder:"name@company.com",required:!0,value:l,onChange:S=>r(S.target.value)})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"password",className:"block mb-2 text-sm font-medium text-gray-900",children:"Kata Sandi"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:m?"text":"password",id:"password",className:"w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 text-gray-900 pr-10",placeholder:"Kata sandi",required:!0,value:n,onChange:S=>x(S.target.value)}),e.jsx("button",{type:"button",onClick:()=>d(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",tabIndex:-1,children:m?e.jsx("i",{className:"fas fa-eye"}):e.jsx("i",{className:"fas fa-eye-slash"})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"confirm-password",className:"block mb-2 text-sm font-medium text-gray-900",children:"Konfirmasi Kata Sandi"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p?"text":"password",id:"confirm-password",className:"w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 text-gray-900 pr-10",placeholder:"Konfirmasi kata sandi",required:!0,value:b,onChange:S=>i(S.target.value)}),e.jsx("button",{type:"button",onClick:()=>g(!p),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",tabIndex:-1,children:p?e.jsx("i",{className:"fas fa-eye"}):e.jsx("i",{className:"fas fa-eye-slash"})})]})]}),e.jsx("button",{type:"submit",disabled:w,className:"w-full text-white bg-blue-600 hover:bg-blue-700 rounded-lg px-5 py-2.5 text-center",children:w?e.jsx(v,{}):"Daftar"}),(h||_)&&e.jsx("p",{className:"text-red-500 text-sm mt-2 text-center",children:h||_}),e.jsxs("p",{className:"text-sm text-center text-gray-500 mt-2",children:["Sudah punya akun?"," ",e.jsx(Ye,{to:"/login",className:"text-blue-600 hover:underline font-medium",children:"Masuk di sini"})]})]})]})]})},_r=()=>{const[a,s]=t.useState(!1),[l,r]=t.useState(null);return{login:t.useCallback(async({email:x,password:b,rememberMe:i})=>{const m=`${G}login`;s(!0),r(null);try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const d=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:x,password:b})});if(k.close(),!d.ok){const g=await d.json();throw new Error(g.message||"Login gagal")}const p=await d.json();if(console.log("Login berhasil:",p),p.token){const g=p.user.roles||[];console.log(g),console.log(JSON.stringify(g)),i?(Ns(p.token),localStorage.setItem("name",p.user.name),localStorage.setItem("roles",JSON.stringify(g))):(sessionStorage.setItem("token",p.token),sessionStorage.setItem("name",p.user.name),sessionStorage.setItem("roles",JSON.stringify(g)))}return sessionStorage.setItem("activeSession","true"),p}catch(d){throw console.error("Login error:",d),r(d.message),await k.fire({title:"Login Gagal",text:d.message||"Terjadi kesalahan saat login",icon:"error",confirmButtonText:"OK"}),d}finally{s(!1)}},[]),isLoggingIn:a,loginError:l}},Sr=()=>{const[a,s]=t.useState(""),[l,r]=t.useState(""),n=je(),[x,b]=t.useState(!1),[i,m]=t.useState(!1),{login:d,isLoggingIn:p,loginError:g}=_r(),h=async o=>{o.preventDefault();try{const u=await d({email:a,password:l,rememberMe:x});if(u.success===!1){k.fire({icon:"error",title:"Login Gagal",text:u.message||"Terjadi kesalahan saat login."});return}n("/dashboard")}catch(u){k.fire({icon:"error",title:"Error",text:u.message||"Terjadi kesalahan."})}},c=()=>e.jsx("div",{className:"col-span-3 flex justify-center items-left p-1",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-white"})});return e.jsxs("section",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center px-4 overflow-y-auto",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("img",{className:"w-20 h-20",src:Aa,alt:"logo"}),e.jsx("span",{className:"mt-2 text-4xl font-bold text-gray-900",children:"Pedatren"})]}),e.jsxs("div",{className:"w-full max-w-md bg-white rounded-lg shadow-lg p-6 sm:p-8 m-4",children:[e.jsx("h1",{className:"text-xl font-bold text-center text-gray-900 md:text-2xl mb-6",children:"Masuk ke akun anda"}),e.jsxs("form",{className:"space-y-4",onSubmit:h,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-gray-900",children:"E-mail"}),e.jsx("input",{type:"email",id:"email",className:"w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 text-gray-900",placeholder:"name@gmail.com",required:!0,value:a,onChange:o=>s(o.target.value)})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"password",className:"block mb-2 text-sm font-medium text-gray-900",children:"Kata Sandi"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:i?"text":"password",id:"password",className:"w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 text-gray-900 pr-10",placeholder:"Password",required:!0,value:l,onChange:o=>r(o.target.value)}),e.jsx("button",{type:"button",onClick:()=>m(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",tabIndex:-1,children:i?e.jsx("i",{className:"fas fa-eye"}):e.jsx("i",{className:"fas fa-eye-slash"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"flex items-center text-sm text-gray-500",children:[e.jsx("input",{type:"checkbox",className:"mr-2",checked:x,onChange:o=>b(o.target.checked)})," Ingat saya"]}),e.jsx(Ye,{to:"/forgot",className:"text-sm text-blue-600 hover:underline",children:"Lupa kata sandi?"})]}),e.jsx("button",{type:"submit",disabled:p,className:`w-full text-white rounded-lg px-5 py-2.5 text-center ${p?"bg-blue-700 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 cursor-pointer"}`,children:p?e.jsx(c,{}):"Login"}),g&&e.jsx("p",{className:"text-red-500 text-sm mt-2 text-center",children:g}),e.jsxs("p",{className:"text-sm text-center text-gray-500 mt-2",children:["Belum punya akun?"," ",e.jsx(Ye,{to:"/register",className:"text-blue-600 hover:underline font-medium",children:"Register"})]})]})]})]})},Tr=()=>e.jsx("section",{className:"bg-gray-900 h-screen flex items-center justify-center",children:e.jsxs("div",{className:"px-4 mx-auto max-w-screen-xl text-center",children:[e.jsx("h1",{className:"mb-4 text-7xl tracking-tight font-extrabold lg:text-9xl text-blue-500",children:"404"}),e.jsx("p",{className:"mb-4 text-3xl tracking-tight font-bold md:text-4xl text-white",children:"Somethings missing."}),e.jsx("p",{className:"mb-4 text-lg font-light text-gray-400",children:"Sorry, we cant find that page. Youll find lots to explore on the home page."}),e.jsx("a",{href:"/",className:"inline-flex text-white bg-blue-600 hover:bg-blue-800 focus:ring-4 focus:outline-none font-medium rounded-lg text-sm px-5 py-2.5 text-center focus:ring-blue-900 my-4",children:"Back to Homepage"})]})}),Pr=()=>{const[a,s]=t.useState(""),[l,r]=t.useState(!1),n=async x=>{if(x.preventDefault(),!a){k.fire({icon:"warning",title:"Email wajib diisi"});return}r(!0);try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const b=await fetch(`${G}forgot`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a})});k.close();const i=await b.json();if(!b.ok)throw new Error(i.message||"Terjadi kesalahan.");k.fire({icon:"success",title:"Permintaan Dikirim",text:i.message||"Silakan cek email Anda untuk reset password."}),s("")}catch(b){k.fire({icon:"error",title:"Gagal",text:b.message})}finally{r(!1)}};return e.jsx("section",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center px-4 overflow-y-auto",children:e.jsxs("div",{className:"max-w-md w-full bg-white p-6 rounded-xl shadow-md",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:Aa,alt:"Logo",className:"h-16"})}),e.jsx("h2",{className:"text-2xl font-semibold text-center mb-2",children:"Lupa Password"}),e.jsx("p",{className:"text-sm text-center text-gray-600 mb-6",children:"Masukkan email Anda untuk menerima tautan reset password."}),e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-gray-900",children:"E-mail"}),e.jsx("input",{type:"email",id:"email",className:"w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 text-gray-900",placeholder:"name@gmail.com",required:!0,value:a,onChange:x=>s(x.target.value)})]}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 transition duration-200",children:"Kirim Tautan Reset"})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsx(Ye,{to:"/",className:"text-sm text-blue-600 hover:underline",children:"Kembali ke Login"})})]})})},Cr=()=>{const[a]=qt(),s=je(),[l,r]=t.useState(!1),[n,x]=t.useState(!1),b=a.get("token")||"",i=a.get("email")||"",[m,d]=t.useState(""),[p,g]=t.useState(""),[h,c]=t.useState(!1),o=w=>({"passwords.token":"Token kadaluarsa. Silakan minta link reset password baru.","passwords.user":"Email tidak ditemukan."})[w]||w||"Terjadi kesalahan.",u=async w=>{if(w.preventDefault(),!m||!p){await k.fire({icon:"warning",title:"Perhatian",text:"Password dan konfirmasi password wajib diisi."});return}if(m!==p){await k.fire({icon:"warning",title:"Perhatian",text:"Password dan konfirmasi password tidak sama."});return}c(!0);try{k.fire({title:"Mohon tunggu...",html:"Sedang proses.",allowOutsideClick:!1,didOpen:()=>{k.showLoading()}});const _=await fetch("http://localhost:8000/api/reset",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:b,email:i,password:m,password_confirmation:p})});k.close();const f=await _.json();if(!_.ok){const v=o(f.message);throw new Error(v)}await k.fire({icon:"success",title:"Berhasil!",text:"Password berhasil direset. Silakan login kembali.",confirmButtonText:"OK"}),s("/login")}catch(_){await k.fire({icon:"error",title:"Gagal!",text:_.message||"Terjadi kesalahan saat reset password."})}finally{c(!1)}};if(!b||!i){(async()=>(await k.fire({icon:"warning",title:"Oops!",text:"Link reset password tidak valid atau sudah kadaluarsa.",confirmButtonText:"OK"}),s("/login")))();return}return e.jsx("section",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold text-center mb-4",children:"Reset Kata Sandi"}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"password",className:"block mb-2 text-sm font-medium text-gray-900",children:"Kata Sandi Baru"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:l?"text":"password",id:"password",className:"w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 text-gray-900 pr-10",placeholder:"Kata sandi",required:!0,value:m,onChange:w=>d(w.target.value)}),e.jsx("button",{type:"button",onClick:()=>r(!l),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",tabIndex:-1,children:l?e.jsx("i",{className:"fas fa-eye"}):e.jsx("i",{className:"fas fa-eye-slash"})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"confirm-password",className:"block mb-2 text-sm font-medium text-gray-900",children:"Konfirmasi Kata Sandi"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:n?"text":"password",id:"confirm-password",className:"w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 text-gray-900 pr-10",placeholder:"Konfirmasi kata sandi",required:!0,value:p,onChange:w=>g(w.target.value)}),e.jsx("button",{type:"button",onClick:()=>x(!n),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",tabIndex:-1,children:n?e.jsx("i",{className:"fas fa-eye"}):e.jsx("i",{className:"fas fa-eye-slash"})})]})]}),e.jsx("button",{type:"submit",disabled:h,className:"w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700",children:h?"Mengatur ulang...":"Reset"})]})]})})},Mt=()=>{console.log("isLoggedIn");const a=xe("token"),s=xe("expiredAt"),l=sessionStorage.getItem("token"),r=sessionStorage.getItem("activeSession")==="true";return!a&&!l?!1:(r&&console.log("masih aktif"),s&&Date.now()>parseInt(s,10)&&!r?(ht(),k.fire({title:"Sesi Berakhir",text:"Sesi anda telah berakhir, silakan login kembali.",icon:"warning",confirmButtonText:"OK"}),!1):!0)},Fr=()=>Mt()?e.jsx(Ua,{}):e.jsx(mt,{to:"/login",replace:!0}),$r=()=>Mt()?e.jsx(mt,{to:"/dashboard",replace:!0}):e.jsx(Ua,{}),Ar=()=>{const a=je(),s=t.useRef(!1);return t.useEffect(()=>{s.current||(console.log("direct"),a("/dashboard",{replace:!0}),s.current=!0)},[a]),null},Kr=()=>{const a=je(),{biodata_id:s}=Ue();return t.useEffect(()=>{s&&a(`/formulir/${s}/biodata`,{replace:!0})},[s,a]),null};function Ir(){return e.jsx(zt,{children:e.jsxs(Wt,{children:[e.jsxs(ze,{element:e.jsx($r,{}),children:[e.jsx(ze,{path:"/login",element:e.jsx(Sr,{})}),e.jsx(ze,{path:"/register",element:e.jsx(Nr,{})}),e.jsx(ze,{path:"/forgot",element:e.jsx(Pr,{})}),e.jsx(ze,{path:"/reset-password",element:e.jsx(Cr,{})})]}),e.jsx(ze,{element:e.jsx(Fr,{}),children:e.jsxs(ze,{path:"/",element:e.jsx(wr,{}),children:[e.jsx(ze,{index:!0,element:e.jsx(Ar,{})}),e.jsxs(ze,{path:"formulir/:biodata_id",element:e.jsx(St,{}),children:[e.jsx(ze,{index:!0,element:e.jsx(Kr,{})}),fa.map(a=>e.jsx(ze,{path:a.link,element:a.content},a.id))]}),[...Tt,...Pt,...Ct,...Ft,...$t,...At,...Ya,...Kt,...It].map(a=>e.jsx(ze,{path:a.link,element:a.content},a.id))]})}),e.jsx(ze,{path:"*",element:e.jsx(Tr,{})})]})})}Jt.createRoot(document.getElementById("root")).render(e.jsx(t.StrictMode,{children:e.jsx(Ir,{})}));
